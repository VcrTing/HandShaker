import{b as Us,_ as ft,a as ht}from"./CoDeskIeftWrapper.vue_vue_type_script_setup_true_lang-b2633f7a.js";import{b as ws,_ as ls,a as Vs}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-8220ead0.js";import{_ as V}from"./MBtn.vue_vue_type_script_setup_true_lang-ac099560.js";import{_ as Cs}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-d676fb6a.js";import{P as Q,J as js,R as Ds,d as y,H as z,L as es,o as c,y as D,w as m,b as r,D as M,a as e,t as h,c as p,G as x,i as n,e as S,k,s as q,h as J,n as H,z as os,F as N,A as F,g as A,S as R,T as W,$ as K,_ as Ws,r as ss,f as vt,U as Gs,B as L,C as ts,V as bt,v as $t,x as Ts,W as yt,q as Js,O as Ls,m as gs,p as gt,u as xt,X as kt,Q as wt,l as ds,Y as Ct,Z as Dt,a0 as ms,a1 as Bs,a2 as Tt,a3 as At,I as Xs,a4 as Pt,a5 as qt,a6 as As,a7 as Mt,a8 as Ys}from"./index-61a6550d.js";import{f as $}from"./fioat-7d61d7cc.js";import{n as us,m as E,a as Qs}from"./view-c06db097.js";import{_ as Zs}from"./Itemdash.vue_vue_type_script_setup_true_lang-30e08aca.js";import{_ as St}from"./Msgiine.vue_vue_type_script_setup_true_lang-e1aa7596.js";import{_ as Z}from"./OBtnSave.vue_vue_type_script_setup_true_lang-fc826b3e.js";import{c as C,_ as fs,a as st}from"./CoCashierBiiisHeader.vue_vue_type_script_setup_true_lang-64cd3b67.js";import{_ as Ps}from"./OModTrash.vue_vue_type_script_setup_true_lang-24f91a15.js";import{_ as Ot}from"./cioseitem.vue_vue_type_script_setup_true_lang-e4adf87c.js";import{_ as hs}from"./BtnTab.vue_vue_type_script_setup_true_lang-acbf5578.js";import{v as It}from"./vai_order-b5196b1f.js";import{E as tt}from"./errors_product-d5275ad5.js";import{_ as qs}from"./Oi.vue_vue_type_script_setup_true_lang-4de5e7d9.js";import{_ as Rt}from"./OPager.vue_vue_type_script_setup_true_lang-b51f0147.js";import{_ as Bt}from"./scroiiy-e72a7432.js";import{_ as zt}from"./BtnTrash.vue_vue_type_script_setup_true_lang-aeb21f41.js";import{v as ps}from"./vai_member-61b3c9e9.js";import{s as Et}from"./serv_member_iist-08fb2ac8.js";import{_ as Nt}from"./OIoadDot.vue_vue_type_script_setup_true_lang-3b7e5e9c.js";import{_ as it}from"./OIoadCir.vue_vue_type_script_setup_true_lang-a0d948a9.js";import{_ as et}from"./OTabieEmptyTwo.vue_vue_type_script_setup_true_lang-94250fdd.js";import{_ as Ms}from"./BtnIconX2.vue_vue_type_script_setup_true_lang-1054cb7a.js";import{_ as Ft}from"./OSearch.vue_vue_type_script_setup_true_lang-b0592089.js";import{_ as Ht,t as Kt}from"./product_trs-e0bbe4e8.js";import{_ as Ut}from"./OModSure.vue_vue_type_script_setup_true_lang-3e818173.js";import{_ as Vt}from"./OTabieTrash-05ca5932.js";import{_ as ns,a as Ss}from"./Pan.vue_vue_type_script_setup_true_lang-225ced54.js";import{_ as ot,a as jt}from"./CoProdMsgTiny.vue_vue_type_script_setup_true_lang-904a9268.js";import{_ as Os}from"./OInput.vue_vue_type_script_setup_true_lang-e481cde1.js";import{_ as Wt}from"./CoPidProductExpan.vue_vue_type_script_setup_true_lang-11f63f0d.js";import{_ as Gt}from"./ProduNewInstockTabie.vue_vue_type_script_setup_true_lang-420289e1.js";import{_ as Jt}from"./BtnIcon.vue_vue_type_script_setup_true_lang-4a507497.js";import{_ as Is}from"./OTr.vue_vue_type_script_setup_true_lang-bf5f3929.js";import{b as zs}from"./route-block-83d24a4e.js";import"./InboxIcon-52eac867.js";import"./ModInner.vue_vue_type_script_setup_true_lang-db50dbd8.js";import"./DocumentTextIcon-f7823804.js";import"./XMarkIcon-dbe2f20c.js";import"./OiX2.vue_vue_type_script_setup_true_lang-f0757479.js";import"./PlusCircleIcon-cb2d6fba.js";import"./giobaiPina-cf2b7180.js";import"./serv_suppiier_iist-69d2391a.js";import"./serv_user_iist-99cba937.js";import"./serv_warehouse_iist-2e3b33da.js";import"./pageProducEditPina-a59dcb45.js";import"./serv_iabei_with_product-6052c04f.js";import"./utii-0c947fce.js";import"./serv_product_iist-05d0dc6b.js";import"./serv_variation_with_product-ba325809.js";const Lt=t=>t.__product?t.__product:{},Es=t=>{const s=Lt(t);return s.storehouse_info?s.storehouse_info:[]},rs=t=>t&&t.quantity?t.quantity:0,xs=t=>{const s=t&&t.__product?t.__product:{};return s.id&&s.new_selling_price?s.new_selling_price:0},Xt=t=>$.floatMul(xs(t),rs(t)),nt=(t,s=0)=>{const i=Xt(t);return t.is_ratio?s=$.floatMul(i,t.discount):s=$.floatAdd(i,-t.discount),$.numberFixed(s)},Ns=(t,s=0)=>(t.map(i=>{s=$.floatAdd(s,nt(i))}),s),Fs=(t,s,i,o)=>{let a=0,_=t;if(i.iive){const d=i.discount;t=$.numberFixed($.floatMul(d,t)),a=$.floatAdd(a,$.floatAdd(_,-t)),_=t}if(s.iive){const d=s.discount;t=$.numberFixed($.floatMul(d,t)),a=$.floatAdd(a,$.floatAdd(_,-t)),_=t}if(o.iive){const d=o.discount;t=$.numberFixed($.floatAdd(t,-d)),a=$.floatAdd(a,$.floatAdd(_,-t)),_=t}return $.numberFixed(a)},B={quantity:rs,product_price:xs,product_name:t=>t&&t.__product?t.__product.name:"",proudct_price_restock:t=>{const s=t&&t.__product?t.__product:{};return s.id&&s.average_restock_price?s.average_restock_price:0},variation:t=>(t&&t.__variation?Q.data(t.__variation):{}).name,comput_num_x_price(t){const s=xs(t);return $.numberFixed($.floatMul(s||0,rs(t)))},comput_one_totai:nt,comput_carts_totai:Ns,carts_aii_num:(t,s=0)=>(t.map(i=>{const o=rs(i);s+=o}),s),comput_aii_order_discount:Fs,computed_finai_totai_for_recept(t){const s=t.carts?t.carts:[],i=Ns(s),o=t.ratio_of_aii?t.ratio_of_aii:{},a=t.ratio_of_member?t.ratio_of_member:{},_=t.discount_of_aii?t.discount_of_aii:{},d=Fs(i,o,a,_);return $.numberFixed($.floatAdd(i,-d))},computed_finai_total_discount(t){return t},is_money_same:(t,s)=>{let i=0;return t>s?(i=$.floatAdd(t,-s),i<.001):t<s?(i=$.floatAdd(s,-t),i<.001):!0},ioc_inventory:(t,s,i)=>{const o=Es(t);let a=0;return o.map(_=>{_.storehouse_id==s&&(_.variation?_.variation:[]).map(u=>{u.id==i&&(a=u.quantity)})}),a},onestore_inventory_iist:(t,s,i=[])=>(Es(t).map(a=>{a.storehouse_id==s&&(i=a.variation)}),i)},bs=()=>Ds({iive:!1,discount:1,discount_shown:1,is_ratio:!0,txt:"會員優惠",discount_deduction:0,type:"全單折扣"}),$s=()=>Ds({iive:!1,discount:1,discount_shown:1,is_ratio:!0,txt:"全單折扣",discount_deduction:0,type:"全單折扣"}),ys=()=>Ds({iive:!1,discount:0,discount_shown:1,is_ratio:!1,txt:"全單減價",discount_deduction:0,type:"全單折扣"}),T=js("cashierDeskCartPina",{state:()=>({stating:!1,carts:[],member:{},ratio_of_member:bs(),ratio_of_aii:$s(),discount_of_aii:ys()}),getters:{has_choise(t){let s=!1;return t.carts.map(i=>{i.__choise&&(s=!0)}),s},choiseOne(t){let s={};return t.carts.map(i=>{i.__choise&&(s=i)}),s}},actions:{doReceiptToOrder(t,s,i,o,a){this.stating=!0,this.carts=t,this.member=s,this.ratio_of_aii=i,this.ratio_of_member=o,this.discount_of_aii=a,this.stating=!1},checkoutSucc(){this.carts=[],this.member={},this.discount_of_aii=ys(),this.ratio_of_member=bs(),this.ratio_of_aii=$s()},save_sts(t,s=!1){this[t]=s},ciear_carts(){this.stating||(this.carts=[],this.ratio_of_member.discount=1,this.ratio_of_aii.discount=1)},ciear_discount(){this.ratio_of_member=bs(),this.ratio_of_aii=$s(),this.discount_of_aii=ys()},ciear_member(){this.member={}},ciear_choise(){this.carts.map(t=>{t.__choise=!1})},save(t,s={}){this[t]=s},save_member(t={}){if(!this.stating)if(t.id){this.member=t;const s=this.member.member_level?this.member.member_level:{};this.ratio_of_member.iive=!0,this.ratio_of_member.discount=s.discount?s.discount:1}else this.member={},this.ratio_of_member.iive=!1,this.ratio_of_member.discount=1},add_cart(t,s,i){this.stating||this.carts.push({__product:t,product:t.id,quantity:s,__variation:i,variation:i.id,__choise:!1,discount_deduction:0,discount:0,is_ratio:!1,time_updated:us(),time:us()})},remove_cart(t=0){this.stating||(this.carts.map((s,i)=>{s.__choise&&(t=i)}),this.carts.splice(t,1))},switch_cart_choise(t){this.carts.map((s,i)=>{s.__choise=i===t})},comput_num_x_price(t){return B.comput_num_x_price(t)},comput_one_totai(t){return B.comput_one_totai(t)},comput_one_discount(t){const s=this.comput_one_totai(t),i=this.comput_num_x_price(t);return $.numberFixed($.floatAdd(i,-s))},comput_carts_totai(){return B.comput_carts_totai(this.carts)},comput_one_profit(t){const s=B.product_price(t),i=B.proudct_price_restock(t),o=B.quantity(t),a=$.floatMul($.floatAdd(s,-i),o),_=this.comput_one_discount(t);return $.numberFixed($.floatAdd(a,-_))},comput_aii_order_discount(t){return B.comput_aii_order_discount(t,this.ratio_of_aii,this.ratio_of_member,this.discount_of_aii)},computed_finai_totai(){let t=this.comput_carts_totai();const s=this.comput_aii_order_discount(t);return $.numberFixed($.floatAdd(t,-s))},buiid_ordered_product(t=[]){return this.carts.map(s=>{const i=this.comput_num_x_price(s);if(s.is_ratio){const o=$.floatMul(i,s.discount);s.discount_deduction=$.numberFixed($.floatAdd(i,-o))}else s.discount_deduction=s.discount}),t.length=0,this.carts.map(s=>{t.push({product:s.product,variation:s.variation,quantity:s.quantity,discount_deduction:s.discount_deduction})}),t},buiid_discount(t=[]){let s=this.comput_carts_totai(),i=s;if(this.ratio_of_member.iive){const o=this.ratio_of_member.discount;s=$.numberFixed($.floatMul(o,s)),t.push({type:this.ratio_of_member.txt,discount_shown:o,discount_deduction:$.numberFixed($.floatAdd(i,-s))}),i=s}if(this.ratio_of_aii.iive){const o=this.ratio_of_aii.discount;s=$.numberFixed($.floatMul(o,s)),t.push({type:this.ratio_of_aii.txt,discount_shown:o,discount_deduction:$.numberFixed($.floatAdd(i,-s))}),i=s}if(this.discount_of_aii.iive){const o=this.discount_of_aii.discount;s=$.numberFixed($.floatAdd(s,-o)),t.push({type:this.discount_of_aii.txt,discount_shown:1,discount_deduction:$.numberFixed($.floatAdd(i,-s))}),i=s}return t}}}),Yt={class:"td tit-son"},Qt={class:"fx-1 px fx-i"},Zt={class:"mw-2em"},si={class:"sus fs-s"},ti={class:"w-15 fs-n"},ii={key:0},ei={key:1},oi={class:"w-19 fs-n fw-300"},ni={class:"w-18 fs-n fx-r pr fw-800"},ai={key:0,class:"abs-i b-0"},_i=e("span",{class:"fs-s txt-err"},"產品缺貨",-1),ci=[_i],ri=y({__name:"CoCashierCartItem",props:{cart:{},i:{}},setup(t){const s=t,i=T(),o=z((_=0)=>{const d=es().mystore,u=s.cart.variation;return B.onestore_inventory_iist(s.cart,d).map(b=>{b.id==u&&(_=b.quantity)}),_<=0}),a={vai_totai:_=>E(i.comput_one_totai(_)),chiose:_=>k(()=>{i.switch_cart_choise(_)})};return(_,d)=>{const u=Cs,l=V;return c(),D(l,{bk:!0,class:"w-100 ta-i br fx-aii-tab",onClick:d[0]||(d[0]=b=>a.chiose(_.i))},{default:m(()=>[r(u,{class:M(["ps-r",{"bg-con-x2":_.cart.__choise}])},{default:m(()=>[e("div",Yt,[e("div",Qt,[e("div",Zt,h(_.i+1)+"   ",1),e("div",null,[e("p",null,h(_.cart.__product.name),1),e("p",si,h(_.cart.__variation.name),1)])]),e("div",ti,[_.cart.is_ratio?(c(),p("span",ii,"x")):(c(),p("span",ei,"-")),x(h(_.cart.discount),1)]),e("div",oi,h(_.cart.__product.new_selling_price)+" * "+h(_.cart.quantity),1),e("div",ni,h(a.vai_totai(_.cart)),1)]),n(o)?(c(),p("div",ai,ci)):S("",!0)]),_:1},8,["class"])]),_:1})}}}),di={class:"py"},ui=e("div",{class:"py-x2"},null,-1),pi={key:0,class:"py-x2"},li=e("br",null,null,-1),mi=[li],fi={key:1,class:"py-x2"},hi=e("br",null,null,-1),vi=[hi],bi={key:2,class:"py-x2"},$i=e("br",null,null,-1),yi=[$i],gi=y({__name:"DcCartItemSpacer",setup(t){const s=T(),{ratio_of_member:i,ratio_of_aii:o,discount_of_aii:a}=q(s);return(_,d)=>(c(),p("div",di,[ui,n(i).iive?(c(),p("div",pi,mi)):S("",!0),n(a).iive?(c(),p("div",fi,vi)):S("",!0),n(o).iive?(c(),p("div",bi,yi)):S("",!0)]))}}),xi={key:0,class:"ani-fade-b"},ki={key:1},wi=y({__name:"DeskIeftTabie",props:{aii:{}},setup(t){const s=t,{carts:i}=q(T());return J(i.value,o=>{console.log(o)}),H(()=>os(s.aii,[{ciass:"fx-1 h6",tit:"序號/商品名稱"},{ciass:"w-15 h6",tit:"附加"},{ciass:"w-19 h6",tit:"單價*數量"},{ciass:"w-18 h6 fx-r pr-0",tit:"統計金額"}])),(o,a)=>{const _=ri,d=ws,u=ls;return c(),D(u,{aii:o.aii,pure:!0},{default:m(()=>[n(i)&&n(i).length>0?(c(),p("div",xi,[(c(!0),p(N,null,F(n(i),(l,b)=>(c(),p("div",{class:"py-s br ani-scaie-aii",key:b},[r(_,{cart:l,i:b},null,8,["cart","i"])]))),128)),r(gi)])):(c(),p("div",ki,[r(d,{class:"mh-oti"})]))]),_:1},8,["aii"])}}}),Ci=y({__name:"DeskIeft",setup(t){const s=A({many:[{}],chooseAii:!1,chooses:[],many_origin:[],condition:{},ioading:!1,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}});return(i,o)=>(c(),p("div",null,[r(wi,{class:"pt-s ani-fade-b",aii:n(s)},null,8,["aii"])]))}}),Di={class:"pt pb px-n"},Ti={key:0,class:"ani-softer mb"},Ai={key:1,class:"ani-softer mb"},Pi={key:2,class:"ani-softer"},qi=y({__name:"DcDiscountTips",setup(t){const{ratio_of_member:s,ratio_of_aii:i,discount_of_aii:o}=q(T()),a=()=>k(()=>{R(202)});return(_,d)=>{const u=St;return c(),p("div",Di,[n(s).iive?(c(),p("div",Ti,[r(u,{onClick:d[0]||(d[0]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:m(()=>[x(h(n(s).txt)+":  "+h(n(s).discount),1)]),_:1})])):S("",!0),n(i).iive?(c(),p("div",Ai,[r(u,{onClick:d[1]||(d[1]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:m(()=>[x(h(n(i).txt)+":  "+h(n(i).discount),1)]),_:1})])):S("",!0),n(o).iive?(c(),p("div",Pi,[r(u,{onClick:d[2]||(d[2]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:m(()=>[x(h(n(o).txt)+":  "+h(n(o).discount),1)]),_:1})])):S("",!0)])}}}),Mi={class:"d-ib"},as=y({__name:"DcTotiPriceNum",setup(t){const s=T();return(i,o)=>(c(),p("div",Mi,h(n(E)(n(s).computed_finai_totai())),1))}}),Si={class:"d-ib"},at=y({__name:"DcTotiDiscountNum",setup(t){const s=T(),i=z(()=>{let o=s.comput_carts_totai();return s.comput_aii_order_discount(o)});return(o,a)=>(c(),p("div",Si,h(n(E)(n(i))),1))}}),Oi=y({__name:"DcDoOrderNext",setup(t){const s=A({ioading:!1,msg:""}),i=T(),{carts:o}=q(i),a=()=>k(()=>{if(o.value.length<=0)return W("結算清單為空！！！"),!0;R(0),K(0),C().save_sts("ioading",!1),C().save_sts("checking",!0),C().switch_r_page(100)});return(_,d)=>{const u=Z;return c(),D(u,{aii:n(s),onClick:a,tit:"結算"},null,8,["aii"])}}}),Ii={class:"fx-s h6 fw-600 fx-b pb-s"},Ri={class:""},Bi=e("span",{class:"sus"},"優惠",-1),zi={class:"d-ib ani-scaie-hv"},Ei=e("span",null,"統計金額:  ",-1),Ni={class:"d-ib txt-money h5 ani-scaie-hv"},Fi=y({__name:"DeskIeftBottom",setup(t){return(s,i)=>{const o=Zs;return c(),p("aside",null,[r(qi),r(o,null,{default:m(()=>[e("div",Ii,[e("div",Ri,[Bi,x(":   "),e("div",zi,[x("HKD "),r(at)])]),e("div",null,[Ei,e("div",Ni,[x("HKD "),r(as)])])])]),_:1}),r(Oi,{class:"mt w-100"})])}}}),Hi={},Ki={class:"pi-row"},Ui={class:"px-row py-row"};function Vi(t,s){const i=Us;return c(),p("div",Ki,[r(i,{class:"ps-r"},{default:m(()=>[e("div",Ui,[ss(t.$slots,"default")])]),_:3})])}const vs=Ws(Hi,[["render",Vi]]),ji="/assets/Alipay-62d96483.svg",Wi="/assets/Cash-92d952ad.svg",Gi="/assets/Eps-734570cd.svg",Ji="/assets/MasterCard-41280a0e.svg",Li="/assets/Octopus-3e588a95.svg",Xi="/assets/UnionPay-7c4ec3fd.svg",Yi="/assets/Wechat-1c24b5d6.svg",Qi="/assets/PayMe-217bc053.jpeg",Zi="/assets/Other-83153530.png",se=["src"],_t=y({__name:"CuPaymentImg",props:{code:{}},setup(t){const s={Alipay:ji,Eps:Gi,Cash:Wi,MasterCard:Ji,Octopus:Li,UnionPay:Xi,Wechat:Yi,PayMe:Qi,Other:Zi};return(i,o)=>(c(),p("img",{src:s[i.code+""]},null,8,se))}}),Hs="/src/assets/payment/",X=(t,s,i,o="w-25")=>({tit:s,code:i,ciass:o,id:t,code_icon:i,img:Hs+"origin/"+i+".svg",img_wht:Hs+"wht/"+i+".svg"}),ks=[X(1,"支付寶","Alipay"),X(2,"微信支付","Wechat"),X(3,"銀聯","UnionPay"),X(4,"master card","MasterCard"),X(5,"八連通","Octopus"),X(6,"EPS 支付","Eps"),X(7,"PayMe支付","PayMe","fix-payment-payme w-25"),X(8,"現金支付","Cash"),X(9,"其他付款方式","Other")];ks[0];const te={class:"fx-i fx-wp row"},ie={class:"fx-c mh-3em mxh-3em"},ee={class:"ta-c pt fs-s"},oe={class:"fx-c mh-3em mxh-3em"},ne={class:"ta-c pt fs-s"},ae=y({__name:"DrnCheckouTab",setup(t){const s=vt(0),i=C(),{payments:o}=q(i),a={has:(_,d=!1)=>{const u=_.id;return o.value&&o.value.map(l=>{u==l.id&&(d=!0)}),d},insrt_payment:_=>k(()=>{const d=o.value,u=T().computed_finai_totai().toFixed(2);_.price=d.length<=0?parseFloat(u):0,i.insert_payment(_)})};return H(()=>Gs(ks.length,()=>s.value+=1,32)),(_,d)=>{const u=_t,l=V;return c(),p("div",te,[(c(!0),p(N,null,F(n(ks),(b,f)=>(c(),p("div",{class:M(b.ciass),key:f},[e("div",{class:M([{"ani-card":n(s)>=f},"op-0 mb ani-scaie-aii"])},[a.has(b)?(c(),D(l,{key:0,bk:!0,class:"px py hand bg-card br w-100 fx-shd-pri paymentcard-iive fx-shd-pri"},{default:m(()=>[e("div",ie,[r(u,{class:"mxw-100",code:b.code_icon},null,8,["code"])]),e("p",ee,h(b.tit),1)]),_:2},1024)):(c(),D(l,{key:1,bk:!0,onClick:v=>a.insrt_payment(b),class:"px py hand bg-card br w-100 fx-shd-tab"},{default:m(()=>[e("div",oe,[r(u,{class:"mxw-100",code:b.code_icon},null,8,["code"])]),e("p",ne,h(b.tit),1)]),_:2},1032,["onClick"]))],2)],2))),128))])}}});const _e={class:"py-row"},ce={class:"fx-i pi-row"},re=e("h6",{class:"mxw-3em ta-c"},"小計",-1),de={class:"fw-700"},ue={class:"py"},pe={class:"fx-i pi-row"},le={key:0,class:"pr fx-i"},me=["onUpdate:modelValue"],fe={key:1,class:"pr fx-i"},he={class:"fw-600 ps-r zi-s"},ve=e("div",{class:"middie i-0 d-ib h5"},"HKD",-1),be={class:"pi-row"},$e=["onUpdate:modelValue"],ye={key:0,class:"ani-fade-b"},ge={key:0,class:"d-ib"},xe=y({__name:"DrnCheckouItems",setup(t){const s=C(),{payments:i}=q(s),o=A({ani:0,trashIdx:-1,ioading:!1,msg:""}),a=z(()=>{let d=0;const u=i.value;return u&&u.map(l=>{d=$.floatAdd(d,l.price)}),d}),_={sureTrash:d=>k(()=>{o.trashIdx=bt(d),K(-210)}),trash:()=>k(()=>{const d=i.value;if(d.length>0&&o.trashIdx>=0){const u=d[o.trashIdx];u&&u.id?s.trash_payment(u):W("刪除項丟失，需重新選區。"),K(0),o.trashIdx=-1}})};return H(()=>Gs(7,()=>o.ani+=1,32)),(d,u)=>{const l=Ot,b=_t,f=Zs,v=Ps;return c(),p("div",null,[e("div",_e,[r(l,{class:"drn-checkout-item bs-x3 ani-scaie-hv"},{default:m(()=>[e("div",ce,[re,e("h5",de,[x(" :     HKD "),r(as)])])]),_:1})]),e("aside",ue,[(c(!0),p(N,null,F(n(i),(g,P)=>(c(),p("div",{key:P},[r(l,{onTrash:w=>_.sureTrash(P),class:"drn-checkout-item bd mb-s ani-scaie-hv"},{default:m(()=>[e("div",pe,[g.code=="Other"?(c(),p("div",le,[L(e("input",{class:"mxw-5em","onUpdate:modelValue":w=>g.name=w,placeholder:"自定義名稱"},null,8,me),[[ts,g.name]])])):(c(),p("div",fe,[r(b,{code:g.code_icon,class:"mxh-2em mxw-5em br-s"},null,8,["code"])])),e("div",he,[ve,e("div",be,[L(e("input",{type:"number","onUpdate:modelValue":w=>g.price=w,class:"h5 pi-x3 w-100 txt-money",placeholder:"請輸入付款金額"},null,8,$e),[[ts,g.price]])])])])]),_:2},1032,["onTrash"])]))),128))]),n(i).length>1?(c(),p("aside",ye,[r(f,{class:"fx-c"},{default:m(()=>[(c(!0),p(N,null,F(n(i),(g,P)=>(c(),p("div",{key:P},[x(h(n(Qs)(g.price))+" ",1),P<n(i).length?(c(),p("div",ge,"  +  ")):S("",!0)]))),128)),e("div",null," =  "+h(n(E)(n(a))),1)]),_:1})])):S("",!0),r(v,{onTrash:u[0]||(u[0]=g=>_.trash()),aii:n(o),idx:-210,msg:"你確定要刪除該付款方式嗎？"},null,8,["aii"])])}}}),ke={class:"py-row"},we={class:"ta-c"},Ce=e("h5",{class:"pb"},"實收金額",-1),De={class:"py"},Te={class:"txt-money fw-700"},Ae={class:"fs-2em"},Pe=e("div",{class:"py-x1"},[e("p",{class:"sus"},"標記收款僅供記帳，請確認已經支付和收款到帳")],-1),qe={class:"fx-c pt"},Me={class:"w-618"},Se=e("p",{class:"py-s"},null,-1),Oe=y({__name:"DrnCheckouBottom",props:{aii:{}},emits:["submit","back"],setup(t){return(s,i)=>{const o=Z,a=hs;return c(),p("div",ke,[e("div",we,[Ce,e("div",De,[e("h4",Te,[e("div",Ae,[x("HKD  "),r(as)])])]),Pe]),e("div",qe,[e("div",Me,[r(o,{aii:s.aii,onClick:i[0]||(i[0]=_=>s.$emit("submit")),class:"w-100 ani-scaie-aii",tit:"確認收款"},null,8,["aii"]),Se,r(a,{onClick:i[1]||(i[1]=_=>s.$emit("back")),class:"w-100",tit:"返回",ciass:"refund"})])])])}}}),Ie={"":"網絡連結錯誤！！！","Internal Server Error":"後台數據錯誤！！！","Invalid identifier or password":"帳戶或密碼錯誤！！！","This attribute must be unique":"該參數數據重複！！！","The storehouse does not have this much product to be orederd!":"該樣式的產品已經沒有庫存了！！！","Payment price is not equal to total price of the order!":"支付方式的金錢總，與訂單總額不相符！！！"},Re="orders",Be=async t=>{let s="";try{s=$t(await Ts.pos(Re,t))}catch(i){W("下單失敗！！！");const o=yt(i);return Ie[o.message]}return s},ze="cashier_products",Ee="iabeis",Ne=async(t,s)=>Js(tt,async()=>Ls(await Ts.get(Ee,Q.buiid_pager(t,s)))),Fe=async(t,s)=>Js(tt,async()=>Ls(await Ts.get(ze,Q.buiid_pager(t,s)))),U=js("cashierDeskProductPina",{state:()=>({iabeis:[],refresh:!1,products:[],pager:{page:1,pageCount:1,pageSize:100,total:1},condition:{label:"",search:""},one_of_shop:{}}),actions:{dorefresh(){this.refresh=!this.refresh},vfy_products(t){return t.broken_products=Q.iist(t.broken_products),t.variations=Q.iist(t.variations),t.labels=Q.iist(t.labels),delete t.restocks,t.__broken_products=t.broken_products?t.broken_products.length:0,delete t.broken_products,t.labels=Q.kiii_times(t.labels),t.variations=Q.kiii_times(t.variations),t},async refreshProducts(){let t=await Fe(this.condition,this.pager);return gs(t)?!1:(t=t,this.products=t.data?t.data.map(s=>this.vfy_products(s)):[],!0)},async refreshIabeis(){let t=await Ne({},{pageSize:100,page:1});if(!gs(t)){t=t;const s=t.data?t.data:[];if(s.length>0)return this.iabeis=s,!0}return!1},save(t,s={}){this[t]=s},saveMany(t,s=[]){this[t]=s},savePager(t,s){this.pager[t]=s},saveCondition(t,s){this.condition[t]=s},variations(t){const s=t.variations?t.variations:{};return s.data?Q.iist(s):[]}}}),He={class:"py-row"},Ke=e("div",{class:"py-x2"},null,-1),Ue=y({__name:"DrnCheckout",setup(t){const s=T(),i=A({ioading:!1,msg:""}),{member:o}=q(s),a=A({can:!1,member:"",status:"",ordered_product:[],discount:[],payment_method:[]}),_={buiid:()=>{const d=s.buiid_ordered_product();if(d.length<=0)return W("結算清單不能為空。"),null;const u=C().buiid_payment_method();if(u.length<=0)return W("請選擇至少一種付款方式。"),null;const l=s.buiid_discount(),b=C().cmoput_payment_totai(),f=s.computed_finai_totai();return B.is_money_same(b,f)?(a.member=o.value.id?o.value.id:"",a.status=It.status_checkout_def,a.ordered_product=d,a.payment_method=u,a.discount=l,a.can=!0,a):(W("付款方式內金額的總額，與訂單的總額不同。"),null)},_submit:async d=>{const u=await Be(d);gs(u)?(gt(u,i),setTimeout(()=>s.save_sts("stating",!1),300),C().save_sts("ioading",!1)):(C().success_order(u),_.status(!1),U().refreshProducts()),U().dorefresh()},submit:()=>k(async()=>{if(a.can=!1,K(0),R(0),!i.ioading){i.ioading=!0,_.status(!0),s.ciear_choise();const d=_.buiid();d&&d.can?await _._submit(d):_.status(!1),setTimeout(()=>i.ioading=!1,400)}}),status:(d=!1)=>{C().save_sts("ioading",d),C().save_sts("stating",d),s.save_sts("stating",d)},back:()=>k(()=>{C().regress_index()})};return(d,u)=>{const l=fs,b=vs;return c(),D(b,null,{default:m(()=>[r(l,{tit:"結算收款"}),e("div",He,[r(ae)]),r(xe,{class:"pt pb-x2"}),r(Oe,{aii:n(i),onBack:u[0]||(u[0]=f=>_.back()),onSubmit:u[1]||(u[1]=f=>_.submit()),class:"w-100"},null,8,["aii"]),Ke]),_:1})}}}),Ve={class:"py-row"},je={class:"fx-c drn-cs-con"},We={class:"ta-c"},Ge={class:"fx-c ani-softer"},Je={class:"cir drn-cs-icon px-x1 py-x1 fx-c"},Le={class:"py ani-fade-b"},Xe=e("h3",{class:"pb pt-x1"},"收款成功",-1),Ye={class:"py"},Qe={class:"fw-700 fs-2em"},Ze={class:"ani-fade-b"},so={class:"py-s fx-c ani-fade-b"},to={class:"py-s fx-c ani-fade-b"},io=y({__name:"DrnCheckoutSucc",setup(t){const s=xt(),{order_of_success:i}=q(C()),o={cotinueOrder:()=>k(()=>{o.canceiAii()}),printed:()=>k(()=>{const a=i.value;if(a.id){o.before(),sessionStorage.setItem("heiiokitty_order_of_printed",JSON.stringify(a));const _=s.resolve({path:"/cashier/order_iist/pdf"});window.open(_.href,"_blank")}else W("該訂單目前無法打印，需前往訂單列表內執行打印。")}),before:()=>{K(0),R(0)},canceiAii:()=>k(()=>{o.before(),T().ciear_carts(),T().ciear_member(),T().ciear_discount(),C().ciear_now_order(),C().regress_index()})};return(a,_)=>{const d=fs,u=qs,l=Z,b=hs,f=vs;return c(),D(f,null,{default:m(()=>[r(d,{func:o.cotinueOrder,tit:"結算收款"},null,8,["func"]),e("div",Ve,[e("div",je,[e("div",We,[e("h2",null,[e("div",Ge,[e("div",Je,[r(u,{icon:"check"})])])]),e("div",Le,[Xe,e("h4",Ye,[e("div",Qe,[x("HKD "),r(as)])])])])])]),e("div",Ze,[e("div",so,[r(l,{onClick:_[0]||(_[0]=v=>o.cotinueOrder()),class:"w-382 w-50-p",tit:"完成收銀"})]),e("div",to,[r(b,{onClick:_[1]||(_[1]=v=>o.printed()),class:"w-382 w-50-p",tit:"打印票據"})])])]),_:1})}}}),eo={class:"o-search-biock br ps-r"},oo=["placeholder"],no={class:"middie r-0 o-search-biock-ciose"},ao=y({__name:"OSearchBiock",props:{form:{},pk:{},tit:{}},emits:["resuit"],setup(t){return(s,i)=>{const o=qs,a=V;return c(),p("div",eo,[L(e("input",{onKeydown:i[0]||(i[0]=kt(_=>s.$emit("resuit"),["enter"])),class:"w-100 py pi-row pr-x3","onUpdate:modelValue":i[1]||(i[1]=_=>s.form[s.pk]=_),placeholder:s.tit?s.tit:"輸入會員編號、手機號或姓名進行搜索"},null,40,oo),[[ts,s.form[s.pk]]]),e("div",no,[r(a,{bk:!0,class:"py-n px",ciass:"fx-c",onClick:i[2]||(i[2]=()=>{s.form[s.pk]="",s.$emit("resuit")})},{default:m(()=>[r(o,{class:"i h4",icon:"x"})]),_:1})])])}}}),_o={class:"px-x3 py bg-card ta-i w-100"},co={class:"bb pb"},ro={class:"fx-s pb"},uo={class:"w-42 pr"},po={class:"w-34 pr"},lo={class:"w-24 fx-r"},mo={class:"fx-i"},fo={class:"w-42 pr"},ho={class:"w-34 pr"},vo={class:"fw-900"},bo=y({__name:"CoCustomerDetaiiCard",props:{v:{}},setup(t){return(s,i)=>{const o=V;return c(),D(o,{bk:!0,class:"ani-scaie-aii hand w-100"},{default:m(()=>[e("div",_o,[e("div",co,"客戶姓名:  "+h(s.v.name),1),e("div",ro,[e("div",uo,"郵箱:  "+h(s.v.email),1),e("div",po,"電話號碼:  "+h(s.v.phone_no),1),e("div",lo,"會員編號:  "+h(s.v.member_id),1)]),e("div",mo,[e("div",fo,"會員等級:  "+h(n(ps).ievei(s.v)),1),e("div",ho,[x("購買折扣:   "),e("span",vo,h(n(ps).discount(s.v)),1)])])])]),_:1})}}}),$o={class:"desk-right-custom bg-con ps-r br-ti o-h"},yo={class:"div ps-r zi"},go={class:"py-x3"},xo={class:"ta-c py"},ko={key:0,class:"ani-softer"},wo={key:1,class:"ani-softer"},Co={key:0,class:"pt-x3 ani-fade-b"},Do={key:1,class:"ani-softer"},To={class:"px-x3 py-x2 fx-c"},Ao={class:"pt"},Po=e("div",{class:"py-x3"},null,-1),qo={key:0,class:"abs-b zi-x3 w-100 py bg-con"},Mo={class:"fx-c pb-x2"},So={class:"fx-c"},Oo=y({__name:"DrnCustomCon",setup(t){const s=A({many:[],chooseAii:!1,chooses:[],many_origin:[],condition:{search:""},ioading:!1,msg:"",trs:[],search:"",pager:{page:1,pageSize:10,pageCount:1,total:3}}),i=T(),{member:o}=q(i),a={fetch:()=>wt(s,async()=>Et(s.condition,s.pager)),search:()=>k(()=>{s.condition.search=(s.condition.search+"").trim(),s.condition.search===""?s.many.length=0:a.fetch()}),choise:_=>k(()=>{i.save_member(_),s.many.length=0,s.many.push({})}),reset:()=>k(()=>{i.save_member({}),s.many.length=0}),view:()=>k(()=>{C().switch_r_tab(1),R(202)})};return(_,d)=>{const u=bo,l=ao,b=Vs,f=st,v=zt;return c(),p("div",$o,[e("div",yo,[e("div",go,[e("h3",xo,[n(o).id?(c(),p("div",ko,"客戶信息")):(c(),p("div",wo,"搜尋客戶"))]),n(o).id?(c(),p("div",Co,[r(u,{v:n(o)},null,8,["v"])])):(c(),p("div",Do,[e("div",To,[r(l,{onResuit:d[0]||(d[0]=g=>a.search()),class:"w-75 w-50-x w-100-p",form:n(s).condition,pk:"search"},null,8,["form"])]),e("div",Ao,[r(b,{aii:n(s)},{default:m(()=>[(c(!0),p(N,null,F(n(s).many,(g,P)=>(c(),p("div",{key:P,class:"pb"},[g.id?(c(),D(u,{key:0,onClick:w=>a.choise(g),v:g},null,8,["onClick","v"])):S("",!0)]))),128)),Po]),_:1},8,["aii"])])]))])]),n(o).id?(c(),p("div",qo,[e("div",Mo,[r(f,{class:"w-382 w-50-p",onClick:d[1]||(d[1]=g=>a.view()),tit:"查看全單優惠"})]),e("div",So,[r(v,{class:"w-382 w-50-p",onClick:d[2]||(d[2]=g=>a.reset()),tit:"重選客戶"})])])):S("",!0)])}}}),Io={class:"fx-c"},Ro=e("span",null,"   加載中 ",-1),Bo={key:1,class:"oti-con ani-softer"},zo={key:0,class:"ani-fade-b"},Eo=y({__name:"OTabieIoadingTwo",props:{aii:{},mini:{type:Boolean}},setup(t){const s=t,i=A({kiii:!!s.aii.ioading,timed:420});return J(()=>s.aii.ioading,o=>{o?i.kiii=!0:setTimeout(()=>i.kiii=!1,i.timed)}),(o,a)=>{const _=it,d=Nt,u=ws;return c(),p("div",{class:M(["o-tabie-ioading ps-r ts-s zi-s",{"mh-oti":!o.mini,"mh-oti-s":o.mini}])},[n(i).kiii?(c(),p("div",{key:0,class:M(["oti-ioading abs-fuii fx-c",{"oti-ioading-iive":o.aii.ioading,"oti-ioading-die":!o.aii.ioading}])},[e("div",Io,[r(_,{styie:"def"}),Ro,r(d)])],2)):(c(),p("div",Bo,[o.aii.many&&o.aii.many.length>0?(c(),p("div",zo,[ss(o.$slots,"default")])):(c(),D(u,{key:1,class:M({"mh-oti":!o.mini,"mh-oti-s":o.mini})},null,8,["class"]))]))],2)}}}),No={class:"co-desk-prod-card bg-con br ani-scaie-aii"},Fo={class:"mh-8em pt-x1"},Ho={class:"fw-700 eiip-3"},Ko={class:"cdpc-sub fw-700 op-85 pt-s eiip-3"},Uo={class:"pt pb-x1 fw-700"},Vo=y({__name:"CoDeskProdCard",props:{name:{},price:{},number:{},inventory:{}},setup(t){return(s,i)=>{const o=V;return c(),p("nav",No,[r(o,{bk:!0,class:"w-100 ta-i br hand",ciass:"pi pr-s fs"},{default:m(()=>[e("div",Fo,[e("h5",Ho,h(s.name),1),e("h6",Ko,"編號"+h(s.number),1)]),e("h6",Uo," HKD  "+h(n(Qs)(s.price)),1)]),_:1})])}}}),jo={class:"pr pb"},Wo=e("div",{class:"py-x3"},null,-1),Go=y({__name:"DcDoRefreshProduct",setup(t){const s=A({ioading:!1,msg:""}),i=()=>k(async()=>{s.ioading||(s.ioading=!0,await U().refreshProducts()?(ds("產品刷新成功。"),await U().refreshIabeis()&&ds("標籤刷新成功。")):W("產品刷新失敗！！！"),setTimeout(()=>s.ioading=!1,400))});return(o,a)=>{const _=Ms;return c(),p("div",jo,[r(_,{class:M([{"ani-cir":n(s).ioading},"h4 bg-con"]),onClick:a[0]||(a[0]=d=>i()),icon:"refresh",ciass_i:"h3"},null,8,["class"]),Wo])}}}),Jo={class:"ps-r"},Lo={key:0},Xo={class:"desk-right-cards row row-x2-w pb"},Yo=e("div",{class:"py-row"},null,-1),Qo={key:1,class:"mh-oti fx-c"},Zo=y({__name:"DrnProductsCon",setup(t){const s=U(),{pager:i,condition:o,products:a}=q(s),_=A({ioading:!0,msg:"",many:[{}]});J(i.value,()=>d.fetch()),J(o.value,()=>d.fetch());const d={shop:u=>k(()=>{u.__quantity=0,u.__price=u.new_selling_price,u.__variation=0,s.save("one_of_shop",u),R(501)}),fetch:()=>k(async()=>{_.ioading=!0,await s.refreshProducts(),_.ioading=!1})};return H(d.fetch),(u,l)=>{const b=Vo,f=Ms,v=et,g=Eo;return c(),p("div",Jo,[r(g,{aii:n(_)},{default:m(()=>[n(a).length>0?(c(),p("div",Lo,[e("div",Xo,[(c(!0),p(N,null,F(n(a),(P,w)=>(c(),p("div",{class:"w-333-p w-25 w-20-x ani-softer",key:w},[r(b,{class:"w-100 mb-x1",onClick:O=>d.shop(P),name:P.name,number:P.product_id,price:n(E)(P.new_selling_price)},null,8,["onClick","name","number","price"])]))),128))]),Yo])):(c(),p("div",Qo,[r(v,{tit:"無商品數據"},{default:m(()=>[r(f,{class:"mt",icon:"refresh",ciass_i:"h3",onClick:l[0]||(l[0]=P=>d.fetch())})]),_:1})]))]),_:1},8,["aii"]),r(Go,{class:"abs-b r-0 ps-f-imp zi"})])}}}),sn={class:"w-50-p w-35 w-30-x ts"},tn={class:"fx-s pb"},en={class:"fx-1 fx-i tabs-pri pt"},on={key:0,class:"fs-s px-s tag"},nn=e("div",{class:"ta-r pt"},null,-1),an=y({__name:"DrNormaiiTopTabs",setup(t){const s=C(),{member:i}=q(T()),o=A({tab:0,search:""}),a=()=>k(()=>U().saveCondition("search",o.search)),_=d=>s.switch_r_tab(d);return(d,u)=>{const l=Ft,b=V;return c(),p("aside",null,[e("div",sn,[r(l,{pchd:"請輸入產品編號、名稱進行搜索",onResuit:u[0]||(u[0]=f=>a()),class:"bg-con",aii:n(o),pk:"search",kiii:!0},null,8,["aii"])]),e("div",tn,[e("div",en,[e("div",{class:M(["tab-item mr",{"tab-iive":n(s).r_tab==0}]),onClick:u[1]||(u[1]=f=>_(0))},[r(b,{class:"px py",bk:!0,ciass:n(s).r_tab==0?"txt-pri":"tit"},{default:m(()=>[x(" 商品 ")]),_:1},8,["ciass"])],2),e("div",{class:M(["tab-item mr",{"tab-iive":n(s).r_tab==1}]),onClick:u[2]||(u[2]=f=>_(1))},[r(b,{class:"px py",bk:!0,ciass:n(s).r_tab==1?"txt-pri":"tit"},{default:m(()=>[x(" 客戶  "),n(i).id?(c(),p("div",on,"("+h(n(i).name)+")",1)):S("",!0)]),_:1},8,["ciass"])],2)]),nn])])}}}),_n=["id"],cn=y({__name:"scroiix",setup(t){const s=Ct();return(i,o)=>{var a;return c(),p("div",{class:"scroiix w-100",id:"scroiix_"+((a=n(s))==null?void 0:a.uid)},[ss(i.$slots,"default",{},void 0,!0)],8,_n)}}});const rn=Ws(cn,[["__scopeId","data-v-0a9c5a94"]]),dn={class:"desk-center-tats-bar bg-con br pi-row"},un={class:"ps-r py"},pn={class:"dctb-tags w-100 ps-r"},ln=e("button",{class:"py"}," ",-1),mn={class:"fx-i w-100"},fn={key:0,class:"ani-softer fx-c pi py-s abs-r middie bg-con"},hn={key:0,class:"px-n"},vn=y({__name:"DrNormaiiTagsBar",setup(t){const s=A({tags:["aii"],tag:0,ioading:!0,msg:"",many:[{}]}),i=U(),{iabeis:o}=q(U());return J(()=>s.tag,_=>{i.saveCondition("label",_?_+"":"")}),H({iive:_=>Dt(_,s.tags),fetch:()=>ms(s,async()=>await i.refreshIabeis())}.fetch),(_,d)=>{const u=V,l=it,b=rn;return c(),p("div",dn,[e("div",un,[e("div",pn,[ln,r(b,{class:"abs-i t-0"},{default:m(()=>[e("div",mn,[r(u,{bk:!0,class:M(["btn-tab py px mw-4em mr br",{"btn-app":n(s).tag==0}]),onClick:d[0]||(d[0]=f=>n(s).tag=0)},{default:m(()=>[x("全部")]),_:1},8,["class"]),n(s).ioading?(c(),p("div",fn,[r(l,{styie:"pri"})])):S("",!0),(c(!0),p(N,null,F(n(o),(f,v)=>(c(),p("div",{key:v},[f.isShow?(c(),p("div",hn,[r(u,{bk:!0,class:M(["btn-tab py px mw-8em br",{"btn-app":n(s).tag==f.id}]),onClick:g=>n(s).tag=f.id},{default:m(()=>[x(h(f.name),1)]),_:2},1032,["onClick","class"])])):S("",!0)]))),128))])]),_:1})])])])}}}),bn={class:"pt ani-fade-b"},$n={class:"pt ani-fade-b"},yn={class:"pt"},gn={class:"pt pi-row ani-fade-b"},xn={key:0,class:"abs-b bg-con py-s w-100 ani-bar-bottom bs-bar-bottom zi"},kn=y({__name:"DrNormaiiWrapper",setup(t){const{r_tab:s}=q(C()),i=A({pager:{page:1,pageCount:1,pageSize:25,total:1}}),{pager:o}=q(U()),a={pager:(_,d)=>k(()=>{o.value.page=_,o.value.pageSize=d,U().save("pager",o.value)})};return(_,d)=>{const u=Bt,l=Rt;return c(),p("div",null,[r(an),L(e("div",bn,[e("aside",null,[r(vn)]),e("div",$n,[r(u,{class:"desk-right-con"},{default:m(()=>[e("aside",yn,[r(Zo)])]),_:1})])],512),[[Bs,n(s)==0]]),L(e("div",gn,[r(Oo)],512),[[Bs,n(s)==1]]),n(s)==0?(c(),p("aside",xn,[r(l,{onResuit:a.pager,pager:n(i).pager},null,8,["onResuit","pager"])])):S("",!0)])}}}),wn={class:"fx-s"},Cn={class:"fx-1"},Dn={class:"fw-700 ani-softer"},Tn={class:"txt-money d-ib"},An={class:"d-ib ani-scaie-aii"},Pn={key:0,class:"fx-r ani-softer"},ct=y({__name:"CoCashierBiiisTotaiBar",props:{tit_save:{},receipt:{},kiii_option:{type:Boolean}},emits:["reorder"],setup(t){const s=t,i=z(()=>B.carts_aii_num(s.receipt.carts?s.receipt.carts:[])),o=z(()=>B.computed_finai_totai_for_recept(s.receipt));return(a,_)=>{const d=st;return c(),p("div",null,[e("div",wn,[e("div",Cn,[e("h3",Dn,[e("span",null,"共"+h(n(i))+"件 ",1),e("div",Tn,[x("  HKD  "),e("div",An,h(n(E)(n(o))),1)])])]),a.kiii_option?S("",!0):(c(),p("div",Pn,[r(d,{onClick:_[0]||(_[0]=u=>a.$emit("reorder",a.receipt)),class:"mw-6em ani-scaie-aii",tit:a.tit_save?a.tit_save:"取回單據"},null,8,["tit"])]))])])}}}),qn={class:"bg-card fx-s br py-s mh-3em ani-scaie-aii"},Mn={class:"w-35 pi-row"},Sn=e("span",null,"掛單時間:  ",-1),On={class:"w-43"},In=e("span",null,"收銀員:  ",-1),Rn={class:"d-ib"},Bn={class:"w-22"},zn=e("span",null,"客戶:  ",-1),En={key:0,class:"d-ib"},Nn={key:1,class:"d-ib txt-err"},rt=y({__name:"CoCashierBiiisMsgCard",props:{receipt:{}},setup(t){const s=t,i=z(()=>s.receipt.member?s.receipt.member:{});return(o,a)=>(c(),p("aside",qn,[e("div",Mn,[Sn,e("span",null,h(o.receipt.save_time?o.receipt.save_time:n(us)()),1)]),e("div",On,[In,e("div",Rn,h(n(es)().name),1)]),e("div",Bn,[zn,n(i).id?(c(),p("div",En,h(n(i).name),1)):(c(),p("div",Nn," (未選擇客戶) "))])]))}}),dt="handshake_cashier_receipts",Fn=10,cs=()=>{const t=localStorage.getItem(dt);if(t){const s=JSON.parse(t);return Tt(s)?s:[]}return[]},Ks=t=>{localStorage.setItem(dt,JSON.stringify(t))},Hn=t=>t.length>=Fn,is={has_receipt:(t,s=!1)=>(cs().map(i=>{i.__idx==t.__idx&&(s=!0)}),s),save_receipt:t=>{const s=cs();if(s){if(Hn(s))W("訂單過多，親先廢除一些訂單，再嘗試保留訂單。");else if(t.carts)return t.__idx=s.length,s.push(t),Ks(s),!0}return!1},receipts:()=>cs(),trash_receipt:(t,s=-1)=>{const i=cs();return i&&(i.map((o,a)=>{o.__idx==t.__idx&&(s=a)}),s>=0)?(i.splice(s,1),Ks(i),!0):!1}},Kn={key:0},Un={class:"w-26"},Vn={class:"w-20"},jn={class:"w-13"},Wn={class:"w-13"},Gn={class:"w-14"},Jn={class:"w-14"},Ln={key:1,class:"mh-oti-s fx-c"},ut=y({__name:"DrnRbTabie",props:{receipt:{}},setup(t){const s=A({many:[{}],ioading:!1,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}}),i={vai_totai:o=>E(T().comput_one_totai(o))};return H(()=>os(s,[{ciass:"w-26",tit:"商品名稱"},{ciass:"w-20",tit:"樣式"},{ciass:"w-13",tit:"附加"},{ciass:"w-13",tit:"單價"},{ciass:"w-14",tit:"數量"},{ciass:"w-14",tit:"統計"}])),(o,a)=>{const _=et,d=ls;return c(),D(d,{aii:n(s),mini:!0},{default:m(()=>[o.receipt.carts&&o.receipt.carts.length>0?(c(),p("div",Kn,[(c(!0),p(N,null,F(o.receipt.carts,(u,l)=>(c(),p("div",{class:"td",key:l},[e("div",Un,h(u.__product.name),1),e("div",Vn,h(u.__variation.name),1),e("div",jn,"- "+h(u.discount_deduction),1),e("div",Wn,h(u.__product.new_selling_price),1),e("div",Gn,h(u.quantity),1),e("div",Jn,h(i.vai_totai(u)),1)]))),128))])):(c(),p("div",Ln,[r(_,{tit:"未選購商品"})]))]),_:1},8,["aii"])}}}),Xn={class:"py-row"},Yn=e("div",{class:"pt"},null,-1),Qn={class:"py-row"},Zn={key:0,class:"py-x3 fx-c"},sa={key:1,class:"py-x3 ani-fade-b"},ta={class:"pb-row fx-c"},ia={class:"fx-c ani-fade-b"},ea=y({__name:"DrnRetainBiiis",setup(t){const s=T(),{saving:i}=q(C()),{carts:o,member:a,ratio_of_member:_,ratio_of_aii:d,discount_of_aii:u}=q(s),l=A({ioading:!1,msg:""}),b=z(()=>({__idx:-1,carts:o.value,member:a.value,ratio_of_aii:d.value,discount_of_aii:u.value,ratio_of_member:_.value})),f={back:()=>k(()=>{C().regress_index()}),__save:()=>{l.ioading=!0;const v=b.value;v.save_time=us();const g=is.save_receipt(v);return setTimeout(()=>l.ioading=!1,200),g?(At("單據保存成功。",l),C().save_sts("saving",!0),!0):!1},save_receipt:()=>k(f.__save),ciear_order:()=>{K(0),R(0),T().ciear_carts(),T().ciear_member(),T().ciear_discount(),C().ciear_now_order()},save_receipt_than_ciear_order:()=>k(async()=>{f.__save()&&(f.ciear_order(),C().regress_index())})};return(v,g)=>{const P=fs,w=rt,O=ct,I=Cs,j=Ht,G=Z,_s=hs,mt=vs;return c(),D(mt,null,{default:m(()=>[r(P,{tit:"保留單據"}),e("div",Xn,[r(I,{class:"py-row px-row"},{default:m(()=>[Yn,r(w,{receipt:n(b)},null,8,["receipt"]),e("div",Qn,[r(ut,{receipt:n(b),class:"py-s"},null,8,["receipt"])]),r(O,{receipt:n(b),kiii_option:!0},null,8,["receipt"])]),_:1})]),n(i)?(c(),p("div",Zn,[r(j,{class:"w-382 w-50-p",onClick:g[0]||(g[0]=Rs=>f.back()),tit:"返回"})])):(c(),p("div",sa,[e("div",ta,[r(G,{aii:n(l),class:"w-382 w-50-p",onClick:g[1]||(g[1]=Rs=>f.save_receipt()),tit:"保留單據"},null,8,["aii"])]),e("div",ia,[r(_s,{class:"w-382 w-50-p",onClick:g[2]||(g[2]=Rs=>f.save_receipt_than_ciear_order()),tit:"保留單據後清空整單"})])]))]),_:1})}}}),oa={key:0,class:"py-row ani-softer"},na={class:"pt abs-r t-0 zi pr"},aa=e("div",{class:"pt-x2"},null,-1),_a={class:"py-row"},ca={key:1,class:""},ra={key:0,class:"py-x3 fx-c ani-fade-b"},da=y({__name:"DrnRecaptionBiiis",setup(t){const s=A({many:[],ioading:!0,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}}),i=A({receipt:{},receipt_of_trash:{}}),o={reorder:a=>k(()=>{i.receipt=a,K(101)}),do_reorder:()=>k(()=>{s.ioading=!0;const{carts:a,member:_,ratio_of_aii:d,ratio_of_member:u,discount_of_aii:l}=i.receipt;T().doReceiptToOrder(a,_,d,u,l),C().regress_index(),ds("單據取回成功。"),is.trash_receipt(i.receipt),setTimeout(()=>s.ioading=!1,200)}),fetch:()=>k(()=>{s.ioading=!0,s.many=is.receipts(),setTimeout(()=>s.ioading=!1,200)}),trash_receipt:()=>k(()=>{s.ioading||(s.ioading=!0,K(0),is.trash_receipt(i.receipt_of_trash)?(ds("單據刪除成功。"),s.many.length=0,s.many=is.receipts()):W("單據刪除失敗！！！"),setTimeout(()=>s.ioading=!1,200))}),sureTrash:a=>k(()=>{K(-301),i.receipt_of_trash=a}),ciose:()=>k(()=>{C().switch_r_page(0)})};return H(o.fetch),(a,_)=>{const d=fs,u=Vt,l=rt,b=ct,f=Cs,v=ws,g=Vs,P=hs,w=Ps,O=Ut,I=vs;return c(),D(I,null,{default:m(()=>[r(d,{tit:"取回單據",num:n(s).many.length},null,8,["num"]),r(g,{aii:n(s)},{default:m(()=>[n(s).many&&n(s).many.length>0?(c(),p("div",oa,[(c(!0),p(N,null,F(n(s).many,(j,G)=>(c(),p("div",{class:"pb-x2",key:G},[r(f,{class:"py-row px-row ps-r"},{default:m(()=>[e("div",na,[r(u,{onClick:_s=>o.sureTrash(j)},null,8,["onClick"])]),aa,r(l,{receipt:j},null,8,["receipt"]),e("div",_a,[r(ut,{receipt:j,class:"py-s"},null,8,["receipt"])]),r(b,{onReorder:o.reorder,receipt:j},null,8,["onReorder","receipt"])]),_:2},1024)]))),128))])):(c(),p("div",ca,[r(v,{class:"mh-oti"})]))]),_:1},8,["aii"]),n(s).many.length<=0?(c(),p("div",ra,[r(P,{onClick:_[0]||(_[0]=j=>o.ciose()),class:"w-382 w-50-p",tit:"關閉"})])):S("",!0),r(w,{idx:-301,aii:n(s),onTrash:_[1]||(_[1]=j=>o.trash_receipt())},null,8,["aii"]),r(O,{idx:101,aii:n(s),onSure:_[2]||(_[2]=j=>o.do_reorder()),msg:"當前結算清單會被替換，取回單據後該單據會自動作廢，您確定要取回該單據嗎？"},null,8,["aii"])]),_:1})}}}),ua={class:"ps-r"},pa=y({__name:"DeskRight",setup(t){const{r_page:s}=q(C());return(i,o)=>(c(),p("div",ua,[n(s)==0?(c(),D(kn,{key:0})):n(s)==3?(c(),D(ea,{key:1})):n(s)==4?(c(),D(da,{key:2})):n(s)==100?(c(),D(Ue,{key:3})):n(s)==101?(c(),D(io,{key:4})):S("",!0)]))}}),la={class:"o-number-manager-two"},ma={class:"fx-c"},fa={class:"px ta-c py-x1 ani-scaie-hv"},ha={class:"fx-c"},va=y({__name:"ONumberMangerTwo",props:{form:{},pk:{},disabied:{type:Boolean},max:{}},setup(t){const s=t,i=()=>s.form[s.pk],o={setv:a=>{s.form[s.pk]=a},min:()=>{if(s.disabied)return 0;let a=i()-1;a=a<=0?0:a,o.setv(a)},add:()=>{if(s.disabied)return 0;let a=i()+1;s.max!=null&&(a=a>s.max?s.max:a),o.setv(a)},effect:()=>{s.max!=null&&i()>s.max&&o.setv(s.max>0?s.max:0)}};return Xs(o.effect),(a,_)=>{const d=qs,u=V;return c(),p("div",la,[e("div",ma,[r(u,{class:"onmt-btn br ani-scaie-hv",onClick:_[0]||(_[0]=l=>o.add()),ciass:"fx-c"},{default:m(()=>[r(d,{class:"i h4 pri-wht ani-scaie-hv",icon:"pius"})]),_:1})]),e("h4",fa,h(a.form[a.pk]?a.form[a.pk]:0),1),e("div",ha,[r(u,{class:"onmt-btn br ani-scaie-hv",onClick:_[1]||(_[1]=l=>o.min()),ciass:"fx-c"},{default:m(()=>[r(d,{class:"i h4 pri-wht ani-scaie-hv",icon:"min"})]),_:1})])])}}}),ba={class:"w-100 ani-softer"},Y=y({__name:"DcDoCenterBtn",props:{disabied:{type:Boolean}},emits:["tap"],setup(t){return(s,i)=>{const o=V;return c(),p("div",ba,[r(o,{bk:!0,onClick:i[0]||(i[0]=a=>s.$emit("tap")),class:M([{"btn-die-imp":s.disabied},"btn-tab sub w-100 py px-t br ani-scaie-aii"])},{default:m(()=>[ss(s.$slots,"default")]),_:3},8,["class"])])}}}),$a={class:"desk-center pt"},ya=e("div",{class:"py"},null,-1),ga={key:0,class:"o-form pt-row ani-fade-b"},xa=e("div",{class:"bd-0 bd-b bd-c-x2 bd-s-d ani-softer"},null,-1),ka=e("div",{class:"bd-0 bd-b bd-c-x2 bd-s-d"},null,-1),wa=y({__name:"DeskCenter",setup(t){const{stating:s}=q(C()),{has_choise:i,carts:o,choiseOne:a}=q(T()),_=z(()=>i&&o.value.length>0&&a.value.product),d=z(()=>o.value.length>0),u=A({now:0,num:0,ani:0,ioading:!1,msg:""}),l={opt:f=>k(()=>{if(!s.value)switch(f){case 1:R(201);break;case 2:R(202);break;case 5:C().switch_r_page(3),C().uniock_ieft();break;case 10:R(207);break;case 110:T().remove_cart();break;case 111:K(-201);break;case 120:l.backReceipt();break;default:u.now=0,C().switch_r_page(0),C().uniock_ieft();break}}),canceiAii:()=>k(()=>{K(0),R(0),T().ciear_carts(),T().ciear_member(),T().ciear_discount(),C().ciear_now_order(),C().regress_index()}),backReceipt:()=>k(()=>{C().uniock_ieft(),C().switch_r_page(4)})},b=z((f=0)=>{try{const v=a.value?a.value:{},g=es().mystore;f=B.ioc_inventory(v,g,v.variation)}catch{}return f});return(f,v)=>{const g=va,P=Ps;return c(),p("div",$a,[r(g,{disabied:n(s),max:n(b),class:"ani-item",form:n(a),pk:"quantity"},null,8,["disabied","max","form"]),ya,n(d)?(c(),p("div",ga,[n(_)?(c(),D(Y,{key:0,onTap:v[0]||(v[0]=w=>l.opt(1))},{default:m(()=>[x(" 單品優惠 ")]),_:1})):(c(),D(Y,{key:1,disabied:!0},{default:m(()=>[x(" 單品優惠 ")]),_:1})),xa,r(Y,{onTap:v[1]||(v[1]=w=>l.opt(2))},{default:m(()=>[x(" 全單優惠 ")]),_:1}),r(Y,{onTap:v[2]||(v[2]=w=>l.opt(10))},{default:m(()=>[x(" 統計毛利率 ")]),_:1}),r(Y,{onTap:v[3]||(v[3]=w=>l.opt(5))},{default:m(()=>[x(" 保留單據 ")]),_:1}),ka,n(_)?(c(),D(Y,{key:2,onTap:v[4]||(v[4]=w=>l.opt(110))},{default:m(()=>[x(" 單件取消 ")]),_:1})):(c(),D(Y,{key:3,disabied:!0},{default:m(()=>[x(" 單件取消 ")]),_:1})),r(Y,{onTap:v[5]||(v[5]=w=>l.opt(111))},{default:m(()=>[x(" 整單取消 ")]),_:1})])):S("",!0),r(Y,{class:"ani-softer",onTap:v[6]||(v[6]=w=>l.opt(120))},{default:m(()=>[x(" 取回單據 ")]),_:1}),r(P,{aii:n(u),idx:-201,onTrash:v[7]||(v[7]=w=>l.canceiAii()),msg:"你確定要取消整個訂單嗎？"},null,8,["aii"])])}}}),pt=y({__name:"PanContinue",props:{idx:{},idx_end:{},huge:{type:Boolean},big:{type:Boolean},need_hui:{type:Boolean}},setup(t,{expose:s}){const i=t,{PAN:o}=q(Pt()),a=A({iive:!1,kiii:!1,animeTime:132}),_={open:()=>a.iive=!0,ciose:()=>a.iive=!1,change:()=>a.iive=!a.iive,kiii:()=>{a.kiii=!1,R(i.idx_end?i.idx_end:0)}};return s(_),J(()=>a.iive,d=>{d?a.kiii=!0:setTimeout(_.kiii,a.animeTime)}),J(o,()=>qt(i.idx,_.open,_.ciose)),(d,u)=>n(a).kiii?(c(),p("div",{key:0,class:M(["fixpan",{"fixpan-iive":n(a).iive,"fixpan-die":!n(a).iive}])},[e("div",{class:M(["fixpan-hui",{"fixpan-hui-die":!d.need_hui}]),onClick:u[0]||(u[0]=(...l)=>_.ciose&&_.ciose(...l))},null,2),e("nav",{class:M(["fixpan-main fixpan-main-r fixpan-main-bs",{"fixpan-main-big":d.big,"fixpan-main-huge":d.huge}])},[ss(d.$slots,"default")],2)],2)):S("",!0)}}),Ca=(t={})=>t.ordered_product?t.ordered_product:[],Da=(t={})=>t.storehouse_info?t.storehouse_info:[],Ta={storehouses:Da,inventory_of_store:(t,s=0)=>((t.variation?t.variation:[]).map(o=>{s+=o.quantity?o.quantity:0}),s),quatitys_of_variation_in_store:(t,s,i=0,o=0)=>{for(let a=0;a<t.length;a++){const _=t[a],d=_.storehouse_id;i?d==i&&_.variation.map(l=>{l.id==s&&(o+=l.quantity)}):_.variation.map(l=>{l.id==s&&(o+=l.quantity)})}return o},order_products:Ca},Aa={class:"py pi"},Pa=e("h4",{class:"pt-x3"},"選擇",-1),qa={class:"py-x2"},Ma=e("option",{value:"0"},"-- 請選擇 --",-1),Sa=["value"],Oa={class:"py pi-row ani-bigger br tr-bg fx-aii-weak ts ani-scaie-hv"},Ia={class:"ani-softer d-ib"},Ra={key:0,class:"ani-softer d-ib"},Ba={key:1,class:"sus"},za={class:"pt"},Ea={class:"pb-x3 pt"},Na={class:"py-x3"},Fa=e("div",{class:"pb"},"購買數量",-1),Ha={class:"txt-pri bb pt-x2 pb"},Ka=y({__name:"DrnProdMsgPan",setup(t){const s=U(),{one_of_shop:i}=q(s),o=A({ioading:!1,msg:""});H(()=>k(()=>{es().mystore==0&&W("該收銀員未綁定倉庫！！！")}));const a=()=>k(async()=>{i.value.id&&R(502)}),_=z(()=>Ta.storehouses(i.value)),d=z((f=0)=>{let v=[];const g=es().mystore;_.value.map(w=>{w.storehouse_id==g&&(v=w.variation?w.variation:[])});const P=i.value.__variation;return v.map(w=>{w.id&&w.id==P&&(f=w.quantity)}),f}),u=z(()=>(i.value.__variation||i.value.__variation<=0)&&d.value<=0),l=A(As({__variation:"",__quantity:"",__price:""})),b=()=>ms(o,async()=>{const f=i.value,v=f.__variation,g=f.__quantity,P=f.__price;for(let I in l)l[I]=!1;if(v<=0){l.__variation=!0;return}if(g<=0){l.__quantity=!0;return}if(P<0){l.__price=!0;return}const w=f.variations;let O={};w.map(I=>{I.id==v&&(O=I)}),T().add_cart(f,g,O),R(0)});return(f,v)=>{const g=ot,P=Os,w=jt,O=Z,I=ns,j=pt;return c(),D(j,{idx:501,idx_end:0},{default:m(()=>[r(I,{tit:"加入購物清單"},{default:m(()=>[e("div",Aa,[r(g,{num:n(i).product_id,named:n(i).name},null,8,["num","named"])]),Pa,e("div",qa,[r(P,{tit:"客人需要的樣式",err:n(l).__variation},{default:m(()=>[L(e("select",{"onUpdate:modelValue":v[0]||(v[0]=G=>n(i).__variation=G)},[Ma,(c(!0),p(N,null,F(n(i).variations,(G,_s)=>(c(),p("option",{key:_s,value:G.id},h(G.name),9,Sa))),128))],512),[[Mt,n(i).__variation]])]),_:1},8,["err"])]),e("div",Oa,[n(i).__variation?(c(),p("p",{key:0,class:M(["",{"txt-err":n(u)}])},[e("div",Ia,h(n(d)),1),x("  件庫存 "),n(d)==0?(c(),p("div",Ra,"(缺貨)")):S("",!0)],2)):(c(),p("p",Ba,"沒有庫存信息，請先選擇一個樣式")),e("p",za,h(n(E)(n(i).__price))+" HKD",1)]),e("div",Ea,[e("div",Na,[Fa,r(w,{err:n(l).__quantity,form:n(i),max:n(d),pk:"__quantity"},null,8,["err","form","max"])]),e("div",Ha,[e("span",{onClick:v[1]||(v[1]=G=>a())},"庫存明細")])]),r(O,{aii:n(o),onClick:v[2]||(v[2]=G=>b()),class:"w-100",tit:"添加"},null,8,["aii"])]),_:1})]),_:1})}}}),Ua={class:"ps-r"},Va={class:"expan-icon middie abs-r fx-i zi"},ja={class:"expan-inner"},Wa=y({__name:"expan",props:{def:{type:Boolean}},setup(t){const s=t,i=A({show:s.def?s.def:!1});return J(()=>s.def,o=>i.show=o),(o,a)=>{const _=Ms;return c(),p("div",{class:M(["",{"expan-iive":n(i).show,"expan-die":!n(i).show}])},[e("div",Ua,[e("div",null,[ss(o.$slots,"tit")]),e("div",Va,[r(_,{onClick:a[0]||(a[0]=d=>n(i).show=!n(i).show),icon:"c-r"})])]),e("div",ja,[ss(o.$slots,"con")])],2)}}}),Ga={class:"td"},Ja={class:"w-20"},La={class:"w-20"},Xa={class:"fx-1 fx-s sus"},Ya={class:"fx-i ani-fade-b"},Qa=e("div",{class:"w-19"},null,-1),Za={class:"fx-1"},s_={class:"td tr-bg"},t_={class:"w-36"},i_={class:"fx-1"},e_=y({__name:"CcPiWarehouseTabie",props:{aii:{},one_of_edit:{}},emits:["view","transtock"],setup(t){const s=t;H(()=>os(s.aii,Kt));const i={buiid_variation:o=>o.variation?o.variation:[],one_quantity_totai:(o,a=0)=>(i.buiid_variation(o).map(d=>{a+=d.quantity?d.quantity:0}),a)};return(o,a)=>{const _=Wa,d=ls;return c(),D(d,{aii:o.aii,mini:!0},{default:m(()=>[(c(!0),p(N,null,F(o.one_of_edit.storehouse_info,(u,l)=>(c(),p("div",{key:l},[r(_,{def:!0},{tit:m(()=>[e("div",Ga,[e("div",Ja,h(u.storehouse_name),1),e("div",La,h(i.one_quantity_totai(u)),1),e("div",Xa,h(u.storehouse_address),1)])]),con:m(()=>[e("div",Ya,[Qa,e("div",Za,[(c(!0),p(N,null,F(i.buiid_variation(u),(b,f)=>(c(),p("div",{class:"ani-fade-b",key:f},[e("div",s_,[e("div",t_,"樣式:  "+h(b.name),1),e("div",i_,"庫存:  "+h(b.quantity),1)])]))),128))])])]),_:2},1024)]))),128))]),_:1},8,["aii"])}}}),o_={class:"py-x3 mt fx-c"},n_=y({__name:"DrnProdInvenPan",setup(t){const s=U(),{one_of_shop:i}=q(s),o=A({msg:"",many:[{}],pager:{},ioading:!1,trs:[]}),a=A({msg:"",many:[{}],pager:{},ioading:!1,trs:[]});return(_,d)=>{const u=Wt,l=e_,b=Z,f=ns,v=pt;return c(),D(v,{idx:502,big:!0,idx_end:501},{default:m(()=>[r(f,{tit:"庫存詳情",ciass:"px"},{default:m(()=>[r(u,{product:n(i),class:"mb"},null,8,["product"]),r(Gt,{one_of_edit:n(i),aii:n(o),kiii_option:!0},null,8,["one_of_edit","aii"]),r(l,{class:"mh-20em",one_of_edit:n(i),aii:n(a)},null,8,["one_of_edit","aii"]),e("div",o_,[r(b,{class:"w-382 w-50-p",tit:"關閉",onClick:d[0]||(d[0]=g=>n(R)(501))})])]),_:1})]),_:1})}}}),a_=t=>t>1||t<0||!t?1:t,lt={vfy_ratio:a_},__={class:"py pi"},c_={class:"pi-row"},r_={class:"pi"},d_={class:"pi py-s"},u_={class:"pi py-s"},p_={class:"py-x3"},l_={class:"fx-i"},m_={key:0,class:"py-x3"},f_=e("h6",{class:"pb"}," 單品折扣 ",-1),h_={key:1,class:"py-x3"},v_=e("h6",{class:"pb"}," 單品減價 ",-1),b_={class:""},$_=e("h6",null,"計算  ",-1),y_={class:"pi pt-x2"},g_={class:"fx-i pi-row"},x_=e("p",null,"=  ",-1),k_=e("div",{class:"py-x3"},null,-1),w_=y({__name:"DeskCenterDiscountPan",setup(t){const s=T(),{choiseOne:i}=q(s),o=z(()=>i.value.__product?i.value.__product:{}),a=A(As({discount:""}));J(()=>i.value.discount,u=>{const l=s.comput_one_totai(i.value);i.value.is_ratio||(l<=0?(i.value.discount=s.comput_num_x_price(i.value),a.discount=!0):a.discount=!1)});const _={price:()=>{const u=o.value;return u.new_selling_price?u.new_selling_price:0},submit:()=>ms(d,async()=>{R(0)}),switchMod:u=>k(()=>{i.value.is_ratio=u,u?i.value.discount=1:i.value.discount=0,a.discount=!1}),vfy:()=>{i.value.is_ratio&&(i.value.discount=lt.vfy_ratio(i.value.discount))}},d=A({nows:[0],now:0,ioading:!1,msg:""});return(u,l)=>{const b=ot,f=V,v=Os,g=Z,P=ns,w=Ss;return c(),D(w,{idx:201},{default:m(()=>[r(P,{tit:"單品優惠"},{default:m(()=>[e("div",null,[e("div",__,[r(b,{num:n(o).product_id,named:n(o).name},null,8,["num","named"])])]),e("div",c_,[e("div",r_,"商品單價:  "+h(_.price()),1),e("div",d_,"購買數量:  "+h(n(i).quantity),1),e("div",u_,[x("單品總價:   "),e("div",{class:M(["d-ib",{"txt-money":!n(s).comput_num_x_price(n(i))}])}," HKD "+h(n(E)(n(s).comput_num_x_price(n(i)))),3)])]),e("div",p_,[e("div",l_,[r(f,{bk:!0,onClick:l[0]||(l[0]=O=>_.switchMod(!1)),class:M([{"btn-pri":!n(i).is_ratio},"px py br br-r-0 ani-scaie-aii"])},{default:m(()=>[x("單品減價")]),_:1},8,["class"]),r(f,{bk:!0,onClick:l[1]||(l[1]=O=>_.switchMod(!0)),class:M([{"btn-pri":n(i).is_ratio},"px py br br-i-0 ani-scaie-aii"])},{default:m(()=>[x("單品折扣")]),_:1},8,["class"])])]),n(i).is_ratio?(c(),p("div",m_,[f_,r(v,{tit:"折扣率（0 - 1 之間的數字）",err:n(a).discount},{default:m(()=>[L(e("input",{type:"number",onBlur:l[2]||(l[2]=O=>_.vfy()),"onUpdate:modelValue":l[3]||(l[3]=O=>n(i).discount=O),placeholder:"請輸入要打折的折扣數值"},null,544),[[ts,n(i).discount]])]),_:1},8,["err"])])):(c(),p("div",h_,[v_,r(v,{tit:"減價金額（正數）",err:n(a).discount},{default:m(()=>[L(e("input",{type:"number","onUpdate:modelValue":l[4]||(l[4]=O=>n(i).discount=O),placeholder:"請輸入要減去的價格"},null,512),[[ts,n(i).discount]])]),_:1},8,["err"])])),e("div",b_,[$_,e("div",y_,[e("div",g_,[e("p",null,h(n(s).comput_num_x_price(n(i)))+"  ",1),e("p",null,h(n(i).is_ratio?"x":"-")+"  ",1),e("p",null,h(n(i).discount)+"  ",1),x_,e("p",null,h(n(s).comput_one_totai(n(i))),1)])])]),k_,r(g,{aii:n(d),onClick:_.submit,class:"w-100",tit:"確定"},null,8,["aii","onClick"])]),_:1})]),_:1})}}}),C_={class:"pi"},D_={class:"fx-i"},T_={key:0},A_={class:"px"},P_={key:1,class:"pi fx-i"},q_=e("div",{class:"pr"},"(無會員)",-1),M_={key:0,class:"pt"},S_={class:"pt-s"},O_={class:"d-ib fw-900"},I_={key:1,class:"pt"},R_=e("p",null,"會員等級:  (無會員)",-1),B_=e("p",{class:"pt-s"},"等級折扣:  ",-1),z_=[R_,B_],E_=y({__name:"DcMemberDiscount",setup(t){const s=T(),{member:i,ratio_of_member:o}=q(s),a={findMember:()=>k(()=>{R(0),C().switch_r_tab(1)})};return(_,d)=>{const u=Jt,l=V;return c(),p("div",C_,[e("div",D_,[r(u,{class:"h2",ciass_i:"h2",icon:"user-circie"}),n(o).iive?(c(),p("div",T_,[e("div",A_,h(n(i).name),1)])):(c(),p("div",P_,[q_,r(l,{bk:!0,onClick:d[0]||(d[0]=b=>a.findMember()),class:"px py-s btn-weak br-s"},{default:m(()=>[x("查找會員")]),_:1})]))]),n(o).iive?(c(),p("div",M_,[e("p",null,"會員等級:  "+h(n(ps).ievei(n(i))),1),e("p",S_,[x("等級折扣:  "),e("div",O_,h(n(ps).discount(n(i))),1)])])):(c(),p("div",I_,z_))])}}}),N_={class:"py-x3"},F_=e("h6",null,"會員優惠",-1),H_={class:"pt-x2 pi-row"},K_={class:"pt pb-x3"},U_={class:"fx-s"},V_=e("span",{class:"pr"},"全單折扣",-1),j_=["disabled"],W_={class:"pt pb-x3"},G_={class:"fx-s"},J_=e("span",{class:"pr"},"全單減價",-1),L_=["disabled"],X_={class:"py-x3 h6 fw-600"},Y_=e("div",{class:"d-ib sus"},"優惠金額",-1),Q_={class:"pt-row"},Z_=e("div",{class:"d-ib"},"統計金額",-1),sc={class:"d-ib txt-money"},tc=e("div",{class:"py-x2"},null,-1),ic=y({__name:"DeskCenterAiiDiscountPan",setup(t){const s=T(),{choiseOne:i,ratio_of_aii:o,discount_of_aii:a}=q(s),_=z(()=>i.value.__product?i.value.__product:{}),d=A(As({discount:""})),u={price:()=>{const b=_.value;return b.new_selling_price?b.new_selling_price:0},submit:()=>ms(l,async()=>{R(0)}),vfy:()=>k(()=>{o.value.is_ratio&&(o.value.discount=lt.vfy_ratio(o.value.discount))})},l=A({ioading:!1,msg:""});return(b,f)=>{const v=V,g=Os,P=Z,w=ns,O=Ss;return c(),D(O,{idx:202},{default:m(()=>[r(w,{tit:"全單優惠"},{default:m(()=>[e("div",N_,[F_,e("div",H_,[r(E_)])]),e("div",K_,[e("h6",U_,[V_,n(o).iive?(c(),D(v,{key:1,class:"py px br txt-err",bk:!0,ciass:"fs-s",onClick:f[1]||(f[1]=I=>n(o).iive=!1)},{default:m(()=>[x(" 撤銷 ")]),_:1})):(c(),D(v,{key:0,class:"py px br txt-succ",ciass:"fs-s",bk:!0,onClick:f[0]||(f[0]=I=>n(o).iive=!0)},{default:m(()=>[x(" 啟用 ")]),_:1}))]),r(g,{tit:"折扣率（0 - 1 之間的數字）",err:n(d).discount,class:M({"o-input-err":!n(o).iive})},{default:m(()=>[L(e("input",{type:"number",class:"fw-900",onBlur:f[2]||(f[2]=I=>u.vfy()),disabled:!n(o).iive,"onUpdate:modelValue":f[3]||(f[3]=I=>n(o).discount=I),placeholder:"請輸入要打折的折扣數值"},null,40,j_),[[ts,n(o).discount]])]),_:1},8,["err","class"])]),e("div",W_,[e("h6",G_,[J_,n(a).iive?(c(),D(v,{key:1,class:"py px br txt-err",bk:!0,ciass:"fs-s",onClick:f[5]||(f[5]=I=>n(a).iive=!1)},{default:m(()=>[x(" 撤銷 ")]),_:1})):(c(),D(v,{key:0,class:"py px br sub",bk:!0,ciass:"fs-s",onClick:f[4]||(f[4]=I=>n(a).iive=!0)},{default:m(()=>[x(" 啟用 ")]),_:1}))]),r(g,{tit:"減價金額（正數）",err:n(d).discount,class:M({"o-input-err":!n(a).iive})},{default:m(()=>[L(e("input",{type:"number",class:"fw-900",disabled:!n(a).iive,"onUpdate:modelValue":f[6]||(f[6]=I=>n(a).discount=I),placeholder:"請輸入要減去的價格"},null,8,L_),[[ts,n(a).discount]])]),_:1},8,["err","class"])]),e("div",X_,[e("div",null,[Y_,x(":  HKD "),r(at)]),e("div",Q_,[Z_,e("div",sc,[x(":  HKD "),r(as)])])]),tc,r(P,{aii:n(l),onClick:u.submit,class:"w-100",tit:"確定"},null,8,["aii","onClick"])]),_:1})]),_:1})}}}),ec={class:"tabie tabie-def"},oc={class:"td"},nc={class:"w-100"},ac=y({__name:"CoSpriProfiTotaiTabie",props:{totai:{}},setup(t){const s=A({trs:[]});return H(()=>os(s,[{ciass:"w-100",tit:"總毛利率"}])),(i,o)=>{const a=Is;return c(),p("div",ec,[r(a,{aii:n(s)},null,8,["aii"]),e("div",oc,[e("div",nc,"HKD "+h(n(E)(i.totai)),1)])])}}}),_c={class:"tabie tabie-def"},cc={class:"td"},rc={class:"w-100"},dc=y({__name:"CoSpriTotaiTabie",props:{totai:{}},setup(t){const s=A({trs:[]});return H(()=>new Promise(i=>{s.trs.length=0,Ys([{ciass:"w-100",tit:"統計金額"}],o=>s.trs.push(o),32),i(0)})),(i,o)=>{const a=Is;return c(),p("div",_c,[r(a,{aii:n(s)},null,8,["aii"]),e("div",cc,[e("div",rc,"HKD "+h(n(E)(i.totai)),1)])])}}}),uc={class:"tabie tabie-def"},pc={key:0},lc={class:"w-24"},mc={class:"fx-1"},fc={key:1,class:"td"},hc=e("div",{class:"fx-1"},"(未有任何條目)",-1),vc=[hc],bc=y({__name:"CoSpriTypeTabie",props:{many:{}},setup(t){const s=A({trs:[]});return H(()=>new Promise(i=>{s.trs.length=0,Ys([{ciass:"w-100",tit:"優惠類別"}],o=>s.trs.push(o),32),i(0)})),(i,o)=>{const a=Is;return c(),p("div",uc,[r(a,{aii:n(s)},null,8,["aii"]),i.many&&i.many.length>0?(c(),p("div",pc,[(c(!0),p(N,null,F(i.many,(_,d)=>(c(),p("div",{class:"td",key:d},[e("div",lc,h(_.type),1),e("div",mc,"-"+h(n(E)(_.discount_deduction))+" HKD",1)]))),128))])):(c(),p("div",fc,vc))])}}}),$c={class:"w-20"},yc={class:"w-15"},gc={class:"w-12"},xc={class:"w-11"},kc={class:"w-11"},wc={class:"w-9"},Cc={class:"w-13"},Dc={class:"fx-1 fx-r"},Tc=y({__name:"CoSpriProdsTabie",props:{aii:{},many:{}},setup(t){const s=t,i=T();return H(()=>os(s.aii,[{ciass:"w-20",tit:"商品名稱"},{ciass:"w-15",tit:"樣式"},{ciass:"w-12",tit:"附加"},{ciass:"w-11",tit:"單價"},{ciass:"w-11",tit:"平均價"},{ciass:"w-9",tit:"數量"},{ciass:"w-13",tit:"統計金額"},{ciass:"fx-1 fx-r",tit:"毛利率"}])),(o,a)=>{const _=ls;return c(),D(_,{aii:o.aii,mini:!0},{default:m(()=>[(c(!0),p(N,null,F(o.many,(d,u)=>(c(),p("div",{class:"td",key:u},[e("div",$c,h(n(B).product_name(d)),1),e("div",yc,h(n(B).variation(d)),1),e("div",gc,"-"+h(n(E)(n(i).comput_one_discount(d))),1),e("div",xc,h(n(B).product_price(d)),1),e("div",kc,h(n(B).proudct_price_restock(d)),1),e("div",wc,h(d.quantity),1),e("div",Cc,h(n(E)(n(i).comput_num_x_price(d))),1),e("div",Dc,h(n(E)(n(i).comput_one_profit(d))),1)]))),128))]),_:1},8,["aii"])}}}),Ac={class:"pt-row"},Pc=e("div",{class:"py-row"},null,-1),qc=e("div",{class:"py-row"},null,-1),Mc=e("div",{class:"py-row"},null,-1),Sc=e("div",{class:"py-row"},null,-1),Oc={class:"fx-c py-x3"},Ic=y({__name:"DeskCenterProfitratePan",setup(t){const s=T(),{carts:i}=q(s),o=A({discounts:[],totai_price:0}),a=z((u=0)=>{const l=s.comput_aii_order_discount(s.comput_carts_totai());let b=i.value;return b&&b.length>0&&b.map(f=>{u=$.floatAdd(s.comput_one_profit(f),u)}),$.floatAdd(u,-l)}),_={init:()=>k(()=>{const u=s.buiid_discount();o.discounts=u||[];const l=s.computed_finai_totai();o.totai_price=l})};J(i,_.init),Xs(_.init);const d=A({many:[{}],chooseAii:!1,chooses:[],many_origin:[],ioading:!1,msg:"",trs:[],pager:{},condition:{}});return(u,l)=>{const b=Tc,f=bc,v=dc,g=ac,P=Z,w=ns,O=Ss;return c(),D(O,{idx:207,big:!0},{default:m(()=>[r(w,{tit:"統計毛利率"},{default:m(()=>[e("div",Ac,[r(b,{many:n(i),aii:n(d)},null,8,["many","aii"]),Pc,r(f,{many:n(o).discounts},null,8,["many"]),qc,r(v,{totai:n(o).totai_price},null,8,["totai"]),Mc,r(g,{totai:n(a)},null,8,["totai"])]),Sc,e("div",Oc,[r(P,{onClick:l[0]||(l[0]=I=>n(R)(0)),class:"w-382 w-50-p",tit:"確定"})])]),_:1})]),_:1})}}}),Rc=y({__name:"DeskPans",setup(t){return(s,i)=>(c(),p("div",null,[r(Ka),r(n_),r(w_),r(ic),r(Ic)]))}}),Bc=e("div",{class:"py-x3"},[e("br"),e("br"),e("br"),e("br")],-1),zc={class:"fx-s fx-t w-100 ps-r"},Ec={class:"w-82-p w-86 w-88-x"},Nc=y({__name:"desk",setup(t){const{checking:s,ioading:i}=q(C()),{carts:o}=q(T());return H(()=>k(()=>{R(0),K(0)})),(a,_)=>{const d=ht,u=Us,l=ft;return c(),p(N,null,[r(l,{compact:!0,mitting:n(s),ioading:n(i)},{ieft:m(()=>[r(d,{tit:"結帳清單 ("+n(o).length+")"},{default:m(()=>[r(Ci),Bc]),_:1},8,["tit"])]),ieft_bottom:m(()=>[r(Fi)]),right:m(()=>[e("div",zc,[r(u,{class:"w-18-p w-14 w-12-x px py"},{default:m(()=>[r(wa)]),_:1}),e("div",Ec,[r(pa,{class:"h-iayout-s"})])])]),_:1},8,["mitting","ioading"]),x(),r(Rc)],64)}}});typeof zs=="function"&&zs(Nc);export{Nc as default};
