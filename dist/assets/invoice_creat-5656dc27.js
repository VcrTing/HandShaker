import{_ as Z}from"./IayoutPan.vue_vue_type_script_setup_true_lang-37935b4c.js";import{_ as J}from"./ModInner.vue_vue_type_script_setup_true_lang-61670ec7.js";import{d as C,o as n,y as V,w as p,r as Q,c as u,a as o,i as l,b as a,N as F,t as E,g as T,a6 as G,h as B,G as g,H as b,ae as I,e as w,B as z,u as R,X as P,F as x,D as O,A as N,a7 as L,k,m as q,s as X,n as W,C as ss,R as ts,M as is,$ as H,q as es,v as os,x as as,a9 as ns,au as rs,j as _s,a0 as cs,p as ds,l as ls}from"./index-c11058df.js";import{_ as j}from"./OBtnSave.vue_vue_type_script_setup_true_lang-3f258e61.js";import{f as U}from"./fioat-e27af979.js";import{_ as K}from"./IayoutForm.vue_vue_type_script_setup_true_lang-39198a4d.js";import{a as us,_ as ps}from"./CoWarehouseSeiectPure.vue_vue_type_script_setup_true_lang-10ff00fd.js";import{_ as ms}from"./OInput.vue_vue_type_script_setup_true_lang-8dac29e8.js";import{_ as fs}from"./CoSuppiierSeiect.vue_vue_type_script_setup_true_lang-ce70b211.js";import{_ as vs}from"./OInputI.vue_vue_type_script_setup_true_lang-69a876a6.js";import{_ as hs}from"./OTime.vue_vue_type_script_setup_true_lang-dec236a1.js";import{_ as ys}from"./OModTrash.vue_vue_type_script_setup_true_lang-d940f241.js";import{b as ws,_ as As}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-07d85c00.js";import{_ as $s}from"./BtnTab.vue_vue_type_script_setup_true_lang-3396e7d6.js";import{_ as Y}from"./BtnIcon.vue_vue_type_script_setup_true_lang-ecc1f77c.js";import{_ as gs}from"./BtnIconX2.vue_vue_type_script_setup_true_lang-fd23133d.js";import{_ as bs}from"./OIoadDot.vue_vue_type_script_setup_true_lang-bff55fa4.js";import{_ as ks}from"./OIoadCir.vue_vue_type_script_setup_true_lang-40cf9214.js";import{_ as Cs}from"./MBtn.vue_vue_type_script_setup_true_lang-c2fb56bf.js";import{_ as Bs}from"./Oi.vue_vue_type_script_setup_true_lang-d4a1d279.js";import{invoiceCreatPina as M}from"./invoiceCreatPina-2c87085f.js";import{E as Vs}from"./errors_product-d5275ad5.js";import{b as S}from"./route-block-83d24a4e.js";import"./giobaiPina-fc53bcaf.js";import"./serv_suppiier_iist-fdba3c1c.js";import"./serv_user_iist-1ed2ed86.js";import"./serv_warehouse_iist-2f84ce0d.js";import"./Dropdown.vue_vue_type_script_setup_true_lang-4d07a73e.js";import"./OTabieEmptyTwo.vue_vue_type_script_setup_true_lang-2247a73d.js";import"./InboxIcon-060c2807.js";import"./ODropdownNetItem.vue_vue_type_script_setup_true_lang-f0b38c48.js";import"./datepicker.esm-edc88a1c.js";import"./OTr.vue_vue_type_script_setup_true_lang-bab54681.js";import"./OiX2.vue_vue_type_script_setup_true_lang-652a82d6.js";import"./DocumentTextIcon-5477de73.js";import"./PlusCircleIcon-0008dce7.js";import"./XMarkIcon-e65d7d10.js";import"./serv_product_iist-988f1e7c.js";const Ds=C({__name:"OModPure",props:{idx:{},aii:{},msg:{}},emits:["sure"],setup(y){return(i,m)=>{const _=J;return n(),V(_,{class:"mod-s",idx:i.idx?i.idx:100,stat:i.aii.ioading,pure:!0},{default:p(()=>[Q(i.$slots,"default")]),_:3},8,["idx","stat"])}}}),Is="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALeSURBVHgB7ZtBctMwFIb/5zRdQSdHMDuGKSU3aHKCdkGgO5ITlJ6AcgLICUi2FGZygyQnaIYybMkRyhawH89OFikOiV3JT6XWN5NkImtk6bf0JD09Ax6Px1NhCI7gp52u/Bymf4gm9OXjEA5QF4DD4wYe1Mdy5yZu1mSG4FebZqNrKBJAm73dN5nGJ7Ck/d55DWX0BWA+/uc1olMooy8AEG641oAyLgS4U6gYwdTwPawnXT+x+t3NuWkktRppzQqlCpA2fG/3VMZ9YtyKdu+52IQBgp/9MmeG0gTg/ectacAHbB7zeZiLgD36+mmCEijFBvDBC5nqaAzzxiMtQ8pKyywB6z0grSjzOcqA6Fxsw1tYxKoAfPBSxnv8HmVCdCYiWLuHNQH48UmIevQd5XONCG36djGDBezZgHo0hg4N1PAOlrAiwHJnF0KPltiaV7CArR5QioXeCHMXFjC2Afyk05QueYliDOQz/aukllSn2FNlbpuuD3ZgCqUVRyEiTMWIDVaTZBglPwUFSLfVExhgPgQCOoIrAmrBEHMBiNW3sCs8gyHmAjA14Q5j8f93f0DlBTDGC4CK4wVAxfECoOKY7wVuQw2Hy7X/CrfYU1jAjQCLs4HuzSQ3B9XeBsAVzBP57smDTw5N5nCEmyHAPBNHRnslpS82IfEptqCMmx7AWHfu5yRCxJEAlD3ri934FdwIUFvj+gr0gyMSXE2DLd7vXIr8AxkOP7DwBYZwgCsBkMYJMco9RsuBjxDJm3F53r/Obd2FWwaZFOZh3vOC/EOAKIT7xq6jm0mJaYqc+KUwKs79FKDAxjK/DWCeywpugLsHZ1JI6urx5ELNDbNhHZElQt9WDNA29JbCsewAaznXEQGrbY1VHXHi9EiiyMIt2eZ0dfEISuhOg8y97ZniMyiiKsByfZ6IsC74OYn/69HV5xEUceKL5uZJiDg6kgYvgitq6ftCQ+33hTwej6fy/AGfJrsXt0lXRAAAAABJRU5ErkJggg==",xs={class:"ta-c"},Ms={class:"w-100 fx-c pt"},Os={class:"w-30 cms-warning-icon cir fx-c ani-scaie-aii"},Us=["src"],Es=o("div",{class:"pb-x1 px bg-con"},[o("h3",{class:"pb pt-x2"},"確認儲存？"),o("div",{class:"fx-c"},[o("p",{class:"w-64"},"確認儲存後，產品的數量將加入庫存，屆時修改產品數量需要到產品庫存頁面內修改。")])],-1),Ts={class:"py px"},Fs=C({__name:"CoInvoiceModSure",props:{aii:{}},emits:["save"],setup(y){return(i,m)=>{const _=j;return n(),u("div",xs,[o("div",Ms,[o("div",Os,[o("img",{class:"w-50 ani-scaie-aii",src:l(Is)},null,8,Us)])]),Es,o("div",Ts,[a(_,{aii:i.aii,tit:"確認",class:"btn-warning w-100 py ani-fade-b ani-scaie-aii",onClick:m[0]||(m[0]=e=>i.$emit("save"))},null,8,["aii"])])])}}}),Hs={class:"row"},Ns={class:"w-50"},Ss=o("div",null," 合計數量 ",-1),Qs={class:"pt"},Rs={class:"w-50"},qs=o("div",null," 合計金額 ",-1),Xs={class:"pt"},js=C({__name:"OrderInTotai",props:{many:{}},setup(y){const i=y,m=F(()=>{let e=0;return i.many.map(r=>{const s=r.data_of_vars;s&&s.map(t=>{t.quantity&&(e+=t.quantity)})}),e}),_=F(()=>{let e=0;return i.many.map(r=>{const s=r.total_amount;return e=U.floatAdd(e,s),r}),e});return(e,r)=>(n(),u("div",Hs,[o("div",Ns,[Ss,o("div",Qs,[o("h4",null,E(l(m)),1)])]),o("div",Rs,[qs,o("div",Xs,[o("h4",null,E(l(_)),1)])])]))}}),Ks={class:"row"},Ys={class:"w-333"},Zs={class:"w-333"},Js={class:"w-333"},Gs={class:"row pt"},zs={class:"w-333"},Ps={class:"w-333"},Ls={class:"w-333"},Ws=C({__name:"OrderInCreatBase",props:{form:{},aii:{}},setup(y){const i=y,m=["supplier","storehouse","date","invoice_id","invoice_address","delivery_address"],_=T(G(i.form));return B(()=>i.aii.sign,()=>{m.map(e=>{if(I(_,e,i.form[e],i.aii)){i.aii.can=!1;return}}),i.aii.can=!0}),B(()=>i.form.date,e=>I(_,"date",e,i.aii)),B(()=>i.form.supplier,e=>I(_,"supplier",e,i.aii)),B(()=>i.form.storehouse,e=>I(_,"storehouse",e,i.aii)),B(()=>i.form.invoice_id,e=>I(_,"invoice_id",e,i.aii)),B(()=>i.form.invoice_address,e=>I(_,"invoice_address",e,i.aii)),(e,r)=>{const s=hs,t=vs,d=fs,f=ms,$=us,A=K;return n(),V(A,{tit:"基本信息",class:"pb-x3 mb"},{default:p(()=>[o("div",Ks,[o("div",Ys,[a(t,{tit:"發票日期",err:l(_).date,icon:"date"},{default:p(()=>[a(s,{form:e.form,pk:"date"},null,8,["form"])]),_:1},8,["err"])]),o("div",Zs,[a(f,{tit:"供應商名稱",err:l(_).supplier},{default:p(()=>[a(d,{form:e.form,pk:"supplier"},null,8,["form"])]),_:1},8,["err"])]),o("div",Js,[a(f,{tit:"入貨倉庫",err:l(_).storehouse},{default:p(()=>[a($,{form:e.form,pk:"storehouse"},null,8,["form"])]),_:1},8,["err"])])]),o("div",Gs,[o("div",zs,[a(f,{tit:"訂單號碼",err:l(_).invoice_id},{default:p(()=>[g(o("input",{"onUpdate:modelValue":r[0]||(r[0]=c=>e.form.invoice_id=c),placeholder:"請輸入"},null,512),[[b,e.form.invoice_id]])]),_:1},8,["err"])]),o("div",Ps,[a(f,{tit:"帳單地址",err:l(_).invoice_address},{default:p(()=>[g(o("input",{"onUpdate:modelValue":r[1]||(r[1]=c=>e.form.invoice_address=c),placeholder:"請輸入"},null,512),[[b,e.form.invoice_address]])]),_:1},8,["err"])]),o("div",Ls,[a(f,{tit:"送貨地址",err:l(_).delivery_address},{default:p(()=>[g(o("input",{"onUpdate:modelValue":r[2]||(r[2]=c=>e.form.delivery_address=c),placeholder:"請輸入"},null,512),[[b,e.form.delivery_address]])]),_:1},8,["err"])])])]),_:1})}}}),st={class:"fx-s py-s"},tt={key:1,class:"mw-4em py-s fx-i ani-softer"},it={class:"pi-s"},et=C({__name:"OBtnSearchMini",props:{ioad:{type:Boolean},tit:{}},emits:["tap"],setup(y){return(i,m)=>{const _=Bs,e=Cs,r=ks,s=bs;return n(),u("div",null,[i.ioad?w("",!0):(n(),V(e,{key:0,onClick:m[0]||(m[0]=t=>i.$emit("tap")),class:"btn-pri hand br mw-4em ts ani-softer",ciass:"fx-c"},{default:p(()=>[o("div",st,[a(_,{icon:"search",class:"i h4"})])]),_:1})),i.ioad?(n(),u("div",tt,[a(r),o("div",it,[z(E(i.tit?i.tit:"搜索中")+" ",1),a(s)])])):w("",!0)])}}}),ot={class:"ai-fs-imp"},at={class:"w-11"},nt={class:"w-15"},rt={key:0,class:"w-15 ani-softer"},_t=["onUpdate:modelValue"],ct=["value"],dt={key:0,class:"d-ib pr pi-s"},lt={key:1,class:"d-ib pr pi-s"},ut={key:1,class:"w-8 ani-softer"},pt=["onUpdate:modelValue"],mt={key:2,class:"w-9 ani-softer"},ft={key:3,class:"w-8 ani-softer"},vt={key:4,class:"w-10 ani-softer pi"},ht=["value"],yt={key:5,class:"w-7 ani-softer"},wt=["value"],At={key:6,class:"w-8 ani-softer"},$t=["value"],gt={key:7,class:"w-6 ani-softer"},bt=["value"],kt={class:"fx-1 pi fx-r"},Ct=C({__name:"OciiTd",props:{v:{}},setup(y){const i=y,m=R(),_=M(),e=F(()=>{const s=i.v.__product;return s&&s.id}),r={pro:()=>e.value?i.v.__product:null,search:()=>k(async()=>{const s=i.v;if(s.__ioad)return;const t=s.number?s.number.trim():void 0;if(t){s.__ioad=!0;try{let d=await _.searchPro(t);if(!q(d))d=d,d&&d.id&&r.insert_pro(d,s);else{const f=m.resolve({path:"/admin/product_inventory_iist/creat"});window.open(f.href,"_blank")}}catch{}setTimeout(()=>s.__ioad=!1,200)}}),insert_pro:(s,t)=>{t.product=s.id,t.__product=s,t.number=s.product_id,t.name=s.name,t.selling_price=s.new_selling_price,t.net_price=s.new_restock_price,t.lowest_price=s.new_lowest_price,t.data_of_vars||(t.data_of_vars=[]),t.data_of_vars.length<=0&&r.piusDFV()},proVariations:()=>{const s=r.pro();return s?s.variations:[]},piusDFV:()=>k(()=>{const s=_.genDFV(i.v);i.v.data_of_vars.push(s)}),trashDFV:s=>k(()=>{try{i.v.data_of_vars.splice(s,1)}catch{}})};return(s,t)=>{const d=ps,f=et,$=gs,A=Y;return n(),u("div",ot,[o("div",at,[a(d,null,{default:p(()=>[g(o("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>s.v.number=c),onKeydown:t[1]||(t[1]=P(c=>r.search(),["enter"])),placeholder:"請輸入後按回車"},null,544),[[b,s.v.number]])]),_:1})]),o("div",nt,[l(e)?(n(),V(d,{key:0,class:"ani-softer"},{default:p(()=>[g(o("input",{"onUpdate:modelValue":t[2]||(t[2]=c=>s.v.name=c),placeholder:"請輸入"},null,512),[[b,s.v.name]])]),_:1})):(n(),V(f,{key:1,class:"mi-s",onTap:t[3]||(t[3]=c=>r.search()),ioad:s.v.__ioad},null,8,["ioad"]))]),l(e)?(n(),u("div",rt,[(n(!0),u(x,null,O(s.v.data_of_vars,(c,h)=>(n(),u("div",{class:N(["w-100 fx-s ani-softer",{"pt-s":h>0}]),key:h},[a(d,{class:"fx-1"},{default:p(()=>[g(o("select",{"onUpdate:modelValue":v=>c.variation=v},[(n(!0),u(x,null,O(r.proVariations(),(v,D)=>(n(),u("option",{key:D,value:v.id},E(v.name),9,ct))),128))],8,_t),[[L,c.variation]])]),_:2},1024),h==0?(n(),u("div",dt,[a($,{icon:"pius-c",ciass_i:"sub",onClick:t[4]||(t[4]=v=>r.piusDFV())})])):(n(),u("div",lt,[a(A,{ciass_i:"",icon:"x",onClick:v=>r.trashDFV(h)},null,8,["onClick"])]))],2))),128))])):w("",!0),l(e)?(n(),u("div",ut,[(n(!0),u(x,null,O(s.v.data_of_vars,(c,h)=>(n(),u("div",{class:N(["w-100 ani-softer",{"pt-s":h>0}]),key:h},[a(d,{err:!c.quantity},{default:p(()=>[g(o("input",{type:"number","onUpdate:modelValue":v=>c.quantity=v,placeholder:"請輸入"},null,8,pt),[[b,c.quantity]])]),_:2},1032,["err"])],2))),128))])):w("",!0),l(e)?(n(),u("div",mt,[a(d,null,{default:p(()=>[g(o("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=c=>s.v.price=c),placeholder:"請輸入"},null,512),[[b,s.v.price]])]),_:1})])):w("",!0),l(e)?(n(),u("div",ft,[a(d,null,{default:p(()=>[g(o("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=c=>s.v.discount=c),placeholder:"請輸入"},null,512),[[b,s.v.discount]])]),_:1})])):w("",!0),l(e)?(n(),u("div",vt,[a(d,{class:"bd-c-t-imp"},{default:p(()=>[o("input",{value:s.v.new_stock_price,disabled:!0},null,8,ht)]),_:1})])):w("",!0),l(e)?(n(),u("div",yt,[a(d,{class:"bd-c-t-imp"},{default:p(()=>[o("input",{value:s.v.total_amount,disabled:!0},null,8,wt)]),_:1})])):w("",!0),l(e)?(n(),u("div",At,[a(d,{class:"bd-c-t-imp bg-card"},{default:p(()=>[o("input",{value:s.v.lowest_price,disabled:!0},null,8,$t)]),_:1})])):w("",!0),l(e)?(n(),u("div",gt,[a(d,{class:"bd-c-t-imp bg-card"},{default:p(()=>[o("input",{value:s.v.selling_price,disabled:!0},null,8,bt)]),_:1})])):w("",!0),o("div",kt,[Q(s.$slots,"default")])])}}}),Bt={key:0,class:"pb-x2 ani-softer"},Vt={class:"mh-input-s py-n"},Dt={key:1,class:"oti-con ani-softer"},It={class:"ani-fade-b"},xt=C({__name:"OrderInCreatInIist",emits:["sureTrash"],setup(y,{emit:i}){const m=T({many:[{__edit:!0}],chooseAii:!1,chooses:[],many_origin:[],ioading:!1,msg:"",trs:[],condition:{search:""},pager:{page:1,pageCount:1,pageSize:25,total:1}}),{many:_}=X(M()),e=T({origin:{},trashIdx:0});W(()=>ss(m,[{ciass:"w-11",tit:"貨號"},{ciass:"w-15",tit:"貨品名稱 / 摘要"},{ciass:"w-15",tit:"樣式"},{ciass:"w-8",tit:"數量"},{ciass:"w-9",tit:"單價"},{ciass:"w-8",tit:"折扣"},{ciass:"w-10",tit:"最新入貨價錢"},{ciass:"w-7",tit:"統計"},{ciass:"w-8",tit:"最低價錢"},{ciass:"w-6",tit:"售價"},{ciass:"fx-1",tit:""}]));const r={pius:()=>k(()=>{M().pius()}),edit:s=>k(()=>{s.__edit=!0,e.origin[s.id+""]=ts(s)}),cancei:s=>k(()=>{const t=e.origin[s.id+""];t?(t.__edit=!1,is(t,s)):s.edit=!1}),sureTrash:s=>k(()=>{e.trashIdx=s,i("sureTrash",s),H(-201)}),trash:()=>k(()=>{_.value.splice(e.trashIdx,1),H(0)})};return(s,t)=>{const d=Y,f=ws,$=$s,A=As,c=K,h=ys;return n(),u(x,null,[a(c,{tit:"產品入單列表",class:"pb-x3 mb"},{default:p(()=>[a(A,{aii:l(m),mini:!0},{default:p(()=>[l(_).length>0?(n(),u("div",Bt,[(n(!0),u(x,null,O(l(_),(v,D)=>(n(),u("div",{key:D,class:"ani-softer"},[v.__edit?(n(),V(Ct,{key:0,class:"td",v},{default:p(()=>[o("div",Vt,[a(d,{icon:"trash",ciass_i:"txt-err",onClick:Ft=>r.sureTrash(D)},null,8,["onClick"])])]),_:2},1032,["v"])):w("",!0)]))),128))])):(n(),u("div",Dt,[a(f,{class:"mh-oti-s"})])),o("div",It,[a($,{onClick:t[0]||(t[0]=v=>r.pius()),class:"w-100 py-s ani-scaie-aii",tit:"添加項目"})])]),_:1},8,["aii"])]),_:1}),a(h,{idx:-201,aii:l(m),onTrash:r.trash},null,8,["aii","onTrash"])],64)}}}),Mt="invoices",Ot=async y=>es(Vs,async()=>os(await as.pos(Mt,y))),Ut={class:"fx-r"},Et=o("div",{class:"py-x3"},null,-1),Tt=C({__name:"invoice_creat",setup(y){const i=T({ioading:!1,msg:"",can:!1,sign:0,aiiow:!1}),{form:m,many:_}=X(M()),e=R();B(_,s=>{s.map(t=>{if(t.product){const d=t.data_of_vars;if(d&&d.length>0){const f=t.price?t.price:0,$=t.discount?t.discount:0,A=U.floatAdd(f,-$);let c=0;d.map(h=>{if(h){const v=h.quantity?h.quantity:0;v?i.aiiow=!0:i.aiiow=!1;const D=U.floatMul(A,v);c=U.floatAdd(D,c)}}),t.total_amount=c,t.new_stock_price=A}}})},{immediate:!0,deep:!0});const r={buiid:()=>ns(["supplier","storehouse","date","invoice_id","invoice_address","delivery_address"],m.value)?i.aiiow?{...m.value,restocks:_.value.map(s=>(s.variations=s.data_of_vars,s))}:(rs("入單產品列表內，數量的值填寫不完善。"),null):null,submit:()=>_s(i,r.buiid,async s=>{s&&H(300)}),__submit:()=>cs(i,async()=>{const s=r.buiid();if(!s)return;const t=await Ot(s);q(t)?ds(t,i):(ls("產品入單成功！！！"),e.push("/admin/invoice_iist"),M().ciear())})};return(s,t)=>{const d=j,f=Fs,$=Ds,A=Z;return n(),V(A,{tit:"快速入單",ciass:"w-100"},{default:p(()=>[o("div",Ut,[a(d,{class:"mw-10em",aii:l(i),tit:"儲存",onClick:t[0]||(t[0]=c=>r.submit())},null,8,["aii"])]),a(Ws,{aii:l(i),form:l(m)},null,8,["aii","form"]),a(xt),a(js,{many:l(_)},null,8,["many"]),Et,a($,{aii:l(i),idx:300},{default:p(()=>[a(f,{aii:l(i),onSave:t[1]||(t[1]=c=>r.__submit())},null,8,["aii"])]),_:1},8,["aii"])]),_:1})}}});typeof S=="function"&&S(Tt);export{Tt as default};
