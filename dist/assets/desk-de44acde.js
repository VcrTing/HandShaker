import{b as jt,_ as hs,a as vs}from"./CoDeskIeftWrapper.vue_vue_type_script_setup_true_lang-adf03325.js";import{b as Dt,_ as ft,a as Wt}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-46299d33.js";import{_ as j}from"./MBtn.vue_vue_type_script_setup_true_lang-571d1e55.js";import{_ as Tt}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-bc8b1a0c.js";import{P as Y,J as Gt,R as At,d as y,o as c,y as T,w as f,b as _,D as M,a as e,t as h,c as p,G as w,k,s as S,i as n,e as R,h as G,n as K,z as ot,F as N,A as H,g as P,S as I,H as B,T as W,$ as U,_ as Jt,r as st,f as bs,U as Qt,B as Q,C as it,V as $s,v as ys,x as Pt,W as gs,q as Lt,O as Xt,m as wt,p as xs,u as ws,X as ks,Q as Cs,l as ut,Y as Ds,Z as Ts,a0 as ht,a1 as zt,L as pt,a2 as As,a3 as Ps,I as Yt,a4 as Et,a5 as qs,a6 as Ss,a7 as Ms,a8 as qt,a9 as Os,aa as Zt}from"./index-3f210c36.js";import{n as lt,m as E,a as ts}from"./view-8eea32ba.js";import{f as $}from"./fioat-7d61d7cc.js";import{_ as ss}from"./Itemdash.vue_vue_type_script_setup_true_lang-60c3c167.js";import{_ as Is}from"./Msgiine.vue_vue_type_script_setup_true_lang-eba6641a.js";import{_ as Z}from"./OBtnSave.vue_vue_type_script_setup_true_lang-6875b8de.js";import{c as C,_ as vt,a as is}from"./CoCashierBiiisHeader.vue_vue_type_script_setup_true_lang-5cff56e7.js";import{_ as St}from"./OModTrash.vue_vue_type_script_setup_true_lang-da1fbe39.js";import{_ as Rs}from"./cioseitem.vue_vue_type_script_setup_true_lang-c08547ca.js";import{_ as bt}from"./BtnTab.vue_vue_type_script_setup_true_lang-6411ffe1.js";import{v as Bs}from"./vai_order-c4f76c7b.js";import{E as es}from"./errors_product-d5275ad5.js";import{_ as Mt}from"./Oi.vue_vue_type_script_setup_true_lang-79b15816.js";import{_ as zs}from"./OPager.vue_vue_type_script_setup_true_lang-2c3ed293.js";import{_ as Es}from"./scroiiy-d37a0fa1.js";import{_ as Ns}from"./BtnTrash.vue_vue_type_script_setup_true_lang-7f75cd1f.js";import{v as mt}from"./vai_member-b1f797a5.js";import{s as Fs}from"./serv_member_iist-066fffaf.js";import{_ as Hs}from"./OIoadDot.vue_vue_type_script_setup_true_lang-af76cdf9.js";import{_ as os}from"./OIoadCir.vue_vue_type_script_setup_true_lang-cd7e445b.js";import{_ as ns}from"./OTabieEmptyTwo.vue_vue_type_script_setup_true_lang-8251cf68.js";import{_ as Ot}from"./BtnIconX2.vue_vue_type_script_setup_true_lang-e83598ac.js";import{_ as Ks}from"./OSearch.vue_vue_type_script_setup_true_lang-af3f1f51.js";import{_ as Us,t as Vs}from"./product_trs-18cd6a1b.js";import{_ as js}from"./OModSure.vue_vue_type_script_setup_true_lang-55053b2e.js";import{_ as Ws}from"./OTabieTrash-24b30c5f.js";import{_ as nt,a as It}from"./Pan.vue_vue_type_script_setup_true_lang-2783903a.js";import{_ as as,a as Gs}from"./CoProdMsgTiny.vue_vue_type_script_setup_true_lang-596ccea1.js";import{_ as Rt}from"./OInput.vue_vue_type_script_setup_true_lang-8ac22f88.js";import{_ as Js}from"./CoPidProductExpan.vue_vue_type_script_setup_true_lang-1a0d1451.js";import{_ as Qs}from"./ProduNewInstockTabie.vue_vue_type_script_setup_true_lang-908f5a8d.js";import{_ as Ls}from"./BtnIcon.vue_vue_type_script_setup_true_lang-05387565.js";import{_ as Bt}from"./OTr.vue_vue_type_script_setup_true_lang-0a30d662.js";import{b as Nt}from"./route-block-83d24a4e.js";import"./InboxIcon-acbdb2a0.js";import"./ModInner.vue_vue_type_script_setup_true_lang-3458ce99.js";import"./DocumentTextIcon-6028e20d.js";import"./XMarkIcon-46811c9d.js";import"./OiX2.vue_vue_type_script_setup_true_lang-2b9096fd.js";import"./PlusCircleIcon-4ae86fbe.js";import"./giobaiPina-50220297.js";import"./serv_suppiier_iist-9d1ccffd.js";import"./serv_user_iist-508f244f.js";import"./serv_warehouse_iist-40d2e341.js";import"./pageProducEditPina-e260a093.js";import"./serv_iabei_with_product-a18b1928.js";import"./utii-02a58f35.js";import"./serv_product_iist-51e64ef5.js";import"./serv_variation_with_product-edff2ebd.js";const Xs=i=>i.__product?i.__product:{},Ft=i=>{const t=Xs(i);return t.storehouse_info?t.storehouse_info:[]},dt=i=>i&&i.quantity?i.quantity:0,kt=i=>{const t=i&&i.__product?i.__product:{};return t.id&&t.new_selling_price?t.new_selling_price:0},Ys=i=>$.floatMul(kt(i),dt(i)),_s=(i,t=0)=>{const s=Ys(i);return i.is_ratio?t=$.floatMul(s,i.discount):t=$.floatAdd(s,-i.discount),$.numberFixed(t)},Ht=(i,t=0)=>(i.map(s=>{t=$.floatAdd(t,_s(s))}),t),Kt=(i,t,s,o)=>{let a=0,r=i;if(s.iive){const d=s.discount;i=$.numberFixed($.floatMul(d,i)),a=$.floatAdd(a,$.floatAdd(r,-i)),r=i}if(t.iive){const d=t.discount;i=$.numberFixed($.floatMul(d,i)),a=$.floatAdd(a,$.floatAdd(r,-i)),r=i}if(o.iive){const d=o.discount;i=$.numberFixed($.floatAdd(i,-d)),a=$.floatAdd(a,$.floatAdd(r,-i)),r=i}return $.numberFixed(a)},z={quantity:dt,product_price:kt,product_name:i=>i&&i.__product?i.__product.name:"",proudct_price_restock:i=>{const t=i&&i.__product?i.__product:{};return t.id&&t.average_restock_price?t.average_restock_price:0},variation:i=>(i&&i.__variation?Y.data(i.__variation):{}).name,comput_num_x_price(i){const t=kt(i);return $.numberFixed($.floatMul(t||0,dt(i)))},comput_one_totai:_s,comput_carts_totai:Ht,carts_aii_num:(i,t=0)=>(i.map(s=>{const o=dt(s);t+=o}),t),comput_aii_order_discount:Kt,computed_finai_totai_for_recept(i){const t=i.carts?i.carts:[],s=Ht(t),o=i.ratio_of_aii?i.ratio_of_aii:{},a=i.ratio_of_member?i.ratio_of_member:{},r=i.discount_of_aii?i.discount_of_aii:{},d=Kt(s,o,a,r);return $.numberFixed($.floatAdd(s,-d))},computed_finai_total_discount(i){return i},is_money_same:(i,t)=>{let s=0;return i>t?(s=$.floatAdd(i,-t),s<.001):i<t?(s=$.floatAdd(t,-i),s<.001):!0},ioc_inventory:(i,t,s)=>{const o=Ft(i);let a=0;return o.map(r=>{r.storehouse_id==t&&(r.variation?r.variation:[]).map(u=>{u.id==s&&(a=u.quantity)})}),a},onestore_inventory_iist:(i,t,s=[])=>(Ft(i).map(a=>{a.storehouse_id==t&&(s=a.variation)}),s)},yt=()=>At({iive:!1,discount:1,discount_shown:1,is_ratio:!0,txt:"會員優惠",discount_deduction:0,type:"全單折扣"}),gt=()=>At({iive:!1,discount:1,discount_shown:1,is_ratio:!0,txt:"全單折扣",discount_deduction:0,type:"全單折扣"}),xt=()=>At({iive:!1,discount:0,discount_shown:1,is_ratio:!1,txt:"全單減價",discount_deduction:0,type:"全單折扣"}),A=Gt("cashierDeskCartPina",{state:()=>({stating:!1,carts:[],member:{},ratio_of_member:yt(),ratio_of_aii:gt(),discount_of_aii:xt()}),getters:{has_choise(i){let t=!1;return i.carts.map(s=>{s.__choise&&(t=!0)}),t},choiseOne(i){let t={};return i.carts.map(s=>{s.__choise&&(t=s)}),t},choiseOneIndex(i){let t=0;return i.carts.map((s,o)=>{s.__choise&&(t=o)}),t}},actions:{cartQuantity(i,t={}){return this.carts.map(s=>{s.product==i&&(t=s)}),t.quantity?t.quantity:0},doReceiptToOrder(i,t,s,o,a){this.stating=!0,this.carts=i,this.member=t,this.ratio_of_aii=s,this.ratio_of_member=o,this.discount_of_aii=a,this.stating=!1},checkoutSucc(){this.carts=[],this.member={},this.discount_of_aii=xt(),this.ratio_of_member=yt(),this.ratio_of_aii=gt()},save_sts(i,t=!1){this[i]=t},ciear_carts(){this.stating||(this.carts=[],this.ratio_of_member.discount=1,this.ratio_of_aii.discount=1)},ciear_discount(){this.ratio_of_member=yt(),this.ratio_of_aii=gt(),this.discount_of_aii=xt()},ciear_member(){this.member={}},ciear_choise(){this.carts.map(i=>{i.__choise=!1})},save(i,t={}){this[i]=t},save_member(i={}){if(!this.stating)if(i.id){this.member=i;const t=this.member.member_level?this.member.member_level:{};this.ratio_of_member.iive=!0,this.ratio_of_member.discount=t.discount?t.discount:1}else this.member={},this.ratio_of_member.iive=!1,this.ratio_of_member.discount=1},add_cart(i,t,s){this.stating||this.carts.push({__product:i,product:i.id,quantity:t,__variation:s,variation:s.id,__choise:!1,discount_deduction:0,discount:0,is_ratio:!1,time_updated:lt(),time:lt()})},remove_cart(i=0){this.stating||(this.carts.map((t,s)=>{t.__choise&&(i=s)}),this.carts.splice(i,1))},switch_cart_choise(i){this.carts.map((t,s)=>{t.__choise=s===i})},comput_num_x_price(i){return z.comput_num_x_price(i)},comput_one_totai(i){return z.comput_one_totai(i)},comput_one_discount(i){const t=this.comput_one_totai(i),s=this.comput_num_x_price(i);return $.numberFixed($.floatAdd(s,-t))},comput_carts_totai(){return z.comput_carts_totai(this.carts)},comput_one_profit(i){const t=z.product_price(i),s=z.proudct_price_restock(i),o=z.quantity(i),a=$.floatMul($.floatAdd(t,-s),o),r=this.comput_one_discount(i);return $.numberFixed($.floatAdd(a,-r))},comput_aii_order_discount(i){return z.comput_aii_order_discount(i,this.ratio_of_aii,this.ratio_of_member,this.discount_of_aii)},computed_finai_totai(){let i=this.comput_carts_totai();const t=this.comput_aii_order_discount(i);return $.numberFixed($.floatAdd(i,-t))},buiid_ordered_product(i=[]){return this.carts.map(t=>{const s=this.comput_num_x_price(t);if(t.is_ratio){const o=$.floatMul(s,t.discount);t.discount_deduction=$.numberFixed($.floatAdd(s,-o))}else t.discount_deduction=t.discount}),i.length=0,this.carts.map(t=>{i.push({product:t.product,variation:t.variation,quantity:t.quantity,discount_deduction:t.discount_deduction})}),i},buiid_discount(i=[]){let t=this.comput_carts_totai(),s=t;if(this.ratio_of_member.iive){const o=this.ratio_of_member.discount;t=$.numberFixed($.floatMul(o,t)),i.push({type:this.ratio_of_member.txt,discount_shown:o,discount_deduction:$.numberFixed($.floatAdd(s,-t))}),s=t}if(this.ratio_of_aii.iive){const o=this.ratio_of_aii.discount;t=$.numberFixed($.floatMul(o,t)),i.push({type:this.ratio_of_aii.txt,discount_shown:o,discount_deduction:$.numberFixed($.floatAdd(s,-t))}),s=t}if(this.discount_of_aii.iive){const o=this.discount_of_aii.discount;t=$.numberFixed($.floatAdd(t,-o)),i.push({type:this.discount_of_aii.txt,discount_shown:1,discount_deduction:$.numberFixed($.floatAdd(s,-t))}),s=t}return i}}}),Zs={class:"td tit-son"},ti={class:"fx-1 px fx-i"},si={class:"mw-2em"},ii={class:"sus fs-s"},ei={class:"w-15 fs-n"},oi={key:0},ni={key:1},ai={class:"w-19 fs-n fw-300"},_i={class:"w-18 fs-n fx-r pr fw-800"},ci=y({__name:"CoCashierCartItem",props:{cart:{},i:{}},setup(i){const t=A(),s={vai_totai:o=>E(t.comput_one_totai(o)),chiose:o=>k(()=>{t.switch_cart_choise(o)})};return(o,a)=>{const r=Tt,d=j;return c(),T(d,{bk:!0,class:"w-100 ta-i br fx-aii-tab",onClick:a[0]||(a[0]=u=>s.chiose(o.i))},{default:f(()=>[_(r,{class:M(["ps-r",{"bg-con-x2":o.cart.__choise}])},{default:f(()=>[e("div",Zs,[e("div",ti,[e("div",si,h(o.i+1)+"   ",1),e("div",null,[e("p",null,h(o.cart.__product.name),1),e("p",ii,h(o.cart.__variation.name),1)])]),e("div",ei,[o.cart.is_ratio?(c(),p("span",oi,"x")):(c(),p("span",ni,"-")),w(h(o.cart.discount),1)]),e("div",ai,h(o.cart.__product.new_selling_price)+" * "+h(o.cart.quantity),1),e("div",_i,h(s.vai_totai(o.cart)),1)])]),_:1},8,["class"])]),_:1})}}}),ri={class:"py"},di=e("div",{class:"py-x2"},null,-1),ui={key:0,class:"py-x2"},pi=e("br",null,null,-1),li=[pi],mi={key:1,class:"py-x2"},fi=e("br",null,null,-1),hi=[fi],vi={key:2,class:"py-x2"},bi=e("br",null,null,-1),$i=[bi],yi=y({__name:"DcCartItemSpacer",setup(i){const t=A(),{ratio_of_member:s,ratio_of_aii:o,discount_of_aii:a}=S(t);return(r,d)=>(c(),p("div",ri,[di,n(s).iive?(c(),p("div",ui,li)):R("",!0),n(a).iive?(c(),p("div",mi,hi)):R("",!0),n(o).iive?(c(),p("div",vi,$i)):R("",!0)]))}}),gi={key:0,class:"ani-fade-b"},xi={key:1},wi=y({__name:"DeskIeftTabie",props:{aii:{}},setup(i){const t=i,{carts:s}=S(A());return G(s.value,o=>{console.log(o)}),K(()=>ot(t.aii,[{ciass:"fx-1 h6",tit:"序號/商品名稱"},{ciass:"w-15 h6",tit:"附加"},{ciass:"w-19 h6",tit:"單價*數量"},{ciass:"w-18 h6 fx-r pr-0",tit:"統計金額"}])),(o,a)=>{const r=ci,d=Dt,u=ft;return c(),T(u,{aii:o.aii,pure:!0},{default:f(()=>[n(s)&&n(s).length>0?(c(),p("div",gi,[(c(!0),p(N,null,H(n(s),(l,v)=>(c(),p("div",{class:"py-s br ani-scaie-aii",key:v},[_(r,{cart:l,i:v},null,8,["cart","i"])]))),128)),_(yi)])):(c(),p("div",xi,[_(d,{class:"mh-oti"})]))]),_:1},8,["aii"])}}}),ki=y({__name:"DeskIeft",setup(i){const t=P({many:[{}],chooseAii:!1,chooses:[],many_origin:[],condition:{},ioading:!1,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}});return(s,o)=>(c(),p("div",null,[_(wi,{class:"pt-s ani-fade-b",aii:n(t)},null,8,["aii"])]))}}),Ci={class:"pt pb px-n"},Di={key:0,class:"ani-softer mb"},Ti={key:1,class:"ani-softer mb"},Ai={key:2,class:"ani-softer"},Pi=y({__name:"DcDiscountTips",setup(i){const{ratio_of_member:t,ratio_of_aii:s,discount_of_aii:o}=S(A()),a=()=>k(()=>{I(202)});return(r,d)=>{const u=Is;return c(),p("div",Ci,[n(t).iive?(c(),p("div",Di,[_(u,{onClick:d[0]||(d[0]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:f(()=>[w(h(n(t).txt)+":  "+h(n(t).discount),1)]),_:1})])):R("",!0),n(s).iive?(c(),p("div",Ti,[_(u,{onClick:d[1]||(d[1]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:f(()=>[w(h(n(s).txt)+":  "+h(n(s).discount),1)]),_:1})])):R("",!0),n(o).iive?(c(),p("div",Ai,[_(u,{onClick:d[2]||(d[2]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:f(()=>[w(h(n(o).txt)+":  "+h(n(o).discount),1)]),_:1})])):R("",!0)])}}}),qi={class:"d-ib"},at=y({__name:"DcTotiPriceNum",setup(i){const t=A();return(s,o)=>(c(),p("div",qi,h(n(E)(n(t).computed_finai_totai())),1))}}),Si={class:"d-ib"},cs=y({__name:"DcTotiDiscountNum",setup(i){const t=A(),s=B(()=>{let o=t.comput_carts_totai();return t.comput_aii_order_discount(o)});return(o,a)=>(c(),p("div",Si,h(n(E)(n(s))),1))}}),Mi=y({__name:"DcDoOrderNext",setup(i){const t=P({ioading:!1,msg:""}),s=A(),{carts:o}=S(s),a=()=>k(()=>{if(o.value.length<=0)return W("結算清單為空！！！"),!0;I(0),U(0),C().save_sts("ioading",!1),C().save_sts("checking",!0),C().switch_r_page(100)});return(r,d)=>{const u=Z;return c(),T(u,{aii:n(t),onClick:a,tit:"結算"},null,8,["aii"])}}}),Oi={class:"fx-s h6 fw-600 fx-b pb-s"},Ii={class:""},Ri=e("span",{class:"sus"},"優惠",-1),Bi={class:"d-ib ani-scaie-hv"},zi=e("span",null,"統計金額:  ",-1),Ei={class:"d-ib txt-money h5 ani-scaie-hv"},Ni=y({__name:"DeskIeftBottom",setup(i){return(t,s)=>{const o=ss;return c(),p("aside",null,[_(Pi),_(o,null,{default:f(()=>[e("div",Oi,[e("div",Ii,[Ri,w(":   "),e("div",Bi,[w("HKD "),_(cs)])]),e("div",null,[zi,e("div",Ei,[w("HKD "),_(at)])])])]),_:1}),_(Mi,{class:"mt w-100"})])}}}),Fi={},Hi={class:"pi-row"},Ki={class:"px-row py-row"};function Ui(i,t){const s=jt;return c(),p("div",Hi,[_(s,{class:"ps-r"},{default:f(()=>[e("div",Ki,[st(i.$slots,"default")])]),_:3})])}const $t=Jt(Fi,[["render",Ui]]),Vi="/assets/Alipay-62d96483.svg",ji="/assets/Cash-92d952ad.svg",Wi="/assets/Eps-734570cd.svg",Gi="/assets/MasterCard-41280a0e.svg",Ji="/assets/Octopus-3e588a95.svg",Qi="/assets/UnionPay-7c4ec3fd.svg",Li="/assets/Wechat-1c24b5d6.svg",Xi=["src"],rs=y({__name:"CuPaymentImg",props:{code:{}},setup(i){const t={Alipay:Vi,Eps:Wi,Cash:ji,MasterCard:Gi,Octopus:Ji,UnionPay:Qi,Wechat:Li};return(s,o)=>(c(),p("img",{src:t[s.code+""]},null,8,Xi))}}),Ut="/src/assets/payment/",L=(i,t,s,o="w-25")=>({tit:t,code:s,ciass:o,id:i,code_icon:s,img:Ut+"origin/"+s+".svg",img_wht:Ut+"wht/"+s+".svg"}),Ct=[L(1,"支付寶","Alipay"),L(2,"微信支付","Wechat"),L(3,"銀聯","UnionPay"),L(4,"master card","MasterCard"),L(5,"八連通","Octopus"),L(6,"EPS 支付","Eps"),L(7,"PayMe支付","PayMe","fix-payment-payme w-25"),L(8,"現金支付","Cash"),L(9,"其他付款方式","Other")];Ct[0];const Yi={class:"fx-i fx-wp row"},Zi={class:"fx-c mh-3em mxh-3em"},te={class:"ta-c pt fs-s"},se={class:"fx-c mh-3em mxh-3em"},ie={class:"ta-c pt fs-s"},ee=y({__name:"DrnCheckouTab",setup(i){const t=bs(0),s=C(),{payments:o}=S(s),a={has:(r,d=!1)=>{const u=r.id;return o.value&&o.value.map(l=>{u==l.id&&(d=!0)}),d},insrt_payment:r=>k(()=>{const d=o.value,u=A().computed_finai_totai().toFixed(2);r.price=d.length<=0?parseFloat(u):0,s.insert_payment(r)})};return K(()=>Qt(Ct.length,()=>t.value+=1,32)),(r,d)=>{const u=rs,l=j;return c(),p("div",Yi,[(c(!0),p(N,null,H(n(Ct),(v,b)=>(c(),p("div",{class:M(v.ciass),key:b},[e("div",{class:M([{"ani-card":n(t)>=b},"op-0 mb ani-scaie-aii"])},[a.has(v)?(c(),T(l,{key:0,bk:!0,class:"px py hand bg-card br w-100 fx-shd-pri paymentcard-iive fx-shd-pri"},{default:f(()=>[e("div",Zi,[_(u,{class:"mxw-100",code:v.code_icon},null,8,["code"])]),e("p",te,h(v.tit),1)]),_:2},1024)):(c(),T(l,{key:1,bk:!0,onClick:x=>a.insrt_payment(v),class:"px py hand bg-card br w-100 fx-shd-tab"},{default:f(()=>[e("div",se,[_(u,{class:"mxw-100",code:v.code_icon},null,8,["code"])]),e("p",ie,h(v.tit),1)]),_:2},1032,["onClick"]))],2)],2))),128))])}}});const oe={class:"py-row"},ne={class:"fx-i pi-row"},ae=e("h6",{class:"mxw-3em ta-c"},"小計",-1),_e={class:"fw-700"},ce={class:"py"},re={class:"fx-i pi-row"},de={key:0,class:"pr fx-i"},ue=["onUpdate:modelValue"],pe={key:1,class:"pr fx-i"},le={class:"fw-600 ps-r zi-s"},me=e("div",{class:"middie i-0 d-ib h5"},"HKD",-1),fe={class:"pi-row"},he=["onUpdate:modelValue"],ve={key:0,class:"ani-fade-b"},be={key:0,class:"d-ib"},$e=y({__name:"DrnCheckouItems",setup(i){const t=C(),{payments:s}=S(t),o=P({ani:0,trashIdx:-1,ioading:!1,msg:""}),a=B(()=>{let d=0;const u=s.value;return u&&u.map(l=>{d=$.floatAdd(d,l.price)}),d}),r={sureTrash:d=>k(()=>{o.trashIdx=$s(d),U(-210)}),trash:()=>k(()=>{const d=s.value;if(d.length>0&&o.trashIdx>=0){const u=d[o.trashIdx];u&&u.id?t.trash_payment(u):W("刪除項丟失，需重新選區。"),U(0),o.trashIdx=-1}})};return K(()=>Qt(7,()=>o.ani+=1,32)),(d,u)=>{const l=Rs,v=rs,b=ss,x=St;return c(),p("div",null,[e("div",oe,[_(l,{class:"drn-checkout-item bs-x3 ani-scaie-hv"},{default:f(()=>[e("div",ne,[ae,e("h5",_e,[w(" :     HKD "),_(at)])])]),_:1})]),e("aside",ce,[(c(!0),p(N,null,H(n(s),(m,g)=>(c(),p("div",{key:g},[_(l,{onTrash:D=>r.sureTrash(g),class:"drn-checkout-item bd mb-s ani-scaie-hv"},{default:f(()=>[e("div",re,[m.code=="Other"?(c(),p("div",de,[Q(e("input",{class:"mxw-5em","onUpdate:modelValue":D=>m.name=D,placeholder:"自定義名稱"},null,8,ue),[[it,m.name]])])):(c(),p("div",pe,[_(v,{code:m.code_icon,class:"mxh-2em mxw-5em br-s"},null,8,["code"])])),e("div",le,[me,e("div",fe,[Q(e("input",{type:"number","onUpdate:modelValue":D=>m.price=D,class:"h5 pi-x3 w-100 txt-money",placeholder:"請輸入付款金額"},null,8,he),[[it,m.price]])])])])]),_:2},1032,["onTrash"])]))),128))]),n(s).length>1?(c(),p("aside",ve,[_(b,{class:"fx-c"},{default:f(()=>[(c(!0),p(N,null,H(n(s),(m,g)=>(c(),p("div",{key:g},[w(h(n(ts)(m.price))+" ",1),g<n(s).length?(c(),p("div",be,"  +  ")):R("",!0)]))),128)),e("div",null," =  "+h(n(E)(n(a))),1)]),_:1})])):R("",!0),_(x,{onTrash:u[0]||(u[0]=m=>r.trash()),aii:n(o),idx:-210,msg:"你確定要刪除該付款方式嗎？"},null,8,["aii"])])}}}),ye={class:"py-row"},ge={class:"ta-c"},xe=e("h5",{class:"pb"},"實收金額",-1),we={class:"py"},ke={class:"txt-money fw-700"},Ce={class:"fs-2em"},De=e("div",{class:"py-x1"},[e("p",{class:"sus"},"標記收款僅供記帳，請確認已經支付和收款到帳")],-1),Te={class:"fx-c pt"},Ae={class:"w-618"},Pe=e("p",{class:"py-s"},null,-1),qe=y({__name:"DrnCheckouBottom",props:{aii:{}},emits:["submit","back"],setup(i){return(t,s)=>{const o=Z,a=bt;return c(),p("div",ye,[e("div",ge,[xe,e("div",we,[e("h4",ke,[e("div",Ce,[w("HKD  "),_(at)])])]),De]),e("div",Te,[e("div",Ae,[_(o,{aii:t.aii,onClick:s[0]||(s[0]=r=>t.$emit("submit")),class:"w-100 ani-scaie-aii",tit:"確認收款"},null,8,["aii"]),Pe,_(a,{onClick:s[1]||(s[1]=r=>t.$emit("back")),class:"w-100",tit:"返回",ciass:"refund"})])])])}}}),Se={"":"網絡連結錯誤！！！","Internal Server Error":"後台數據錯誤！！！","Invalid identifier or password":"帳戶或密碼錯誤！！！","This attribute must be unique":"該參數數據重複！！！","The storehouse does not have this much product to be orederd!":"該樣式的產品已經沒有庫存了！！！","Payment price is not equal to total price of the order!":"支付方式的金錢總，與訂單總額不相符！！！"},Me="orders",Oe=async i=>{let t="";try{t=ys(await Pt.pos(Me,i))}catch(s){W("下單失敗！！！"),console.log(s);const o=gs(s);return Se[o.message]}return t},Ie="cashier_products",Re="iabeis",Be=async(i,t)=>Lt(es,async()=>Xt(await Pt.get(Re,Y.buiid_pager(i,t)))),ze=async(i,t)=>Lt(es,async()=>Xt(await Pt.get(Ie,Y.buiid_pager(i,t)))),V=Gt("cashierDeskProductPina",{state:()=>({iabeis:[],refresh:!1,products:[],pager:{page:1,pageCount:1,pageSize:100,total:1},condition:{label:"",search:""},one_of_shop:{}}),actions:{dorefresh(){this.refresh=!this.refresh},vfy_products(i){return i.broken_products=Y.iist(i.broken_products),i.variations=Y.iist(i.variations),i.labels=Y.iist(i.labels),delete i.restocks,i.__broken_products=i.broken_products?i.broken_products.length:0,delete i.broken_products,i.labels=Y.kiii_times(i.labels),i.variations=Y.kiii_times(i.variations),i},async refreshProducts(){let i=await ze(this.condition,this.pager);return wt(i)?!1:(i=i,this.products=i.data?i.data.map(t=>this.vfy_products(t)):[],!0)},async refreshIabeis(){let i=await Be({},{pageSize:100,page:1});if(!wt(i)){i=i;const t=i.data?i.data:[];if(t.length>0)return this.iabeis=t,!0}return!1},save(i,t={}){this[i]=t},saveMany(i,t=[]){this[i]=t},savePager(i,t){this.pager[i]=t},saveCondition(i,t){this.condition[i]=t},variations(i){const t=i.variations?i.variations:{};return t.data?Y.iist(t):[]}}}),Ee={class:"py-row"},Ne=e("div",{class:"py-x2"},null,-1),Fe=y({__name:"DrnCheckout",setup(i){const t=A(),s=P({ioading:!1,msg:""}),{member:o}=S(t),a=P({can:!1,member:"",status:"",ordered_product:[],discount:[],payment_method:[]}),r={buiid:()=>{const d=t.buiid_ordered_product();if(d.length<=0)return W("結算清單不能為空。"),null;const u=C().buiid_payment_method();if(u.length<=0)return W("請選擇至少一種付款方式。"),null;const l=t.buiid_discount(),v=C().cmoput_payment_totai(),b=t.computed_finai_totai();return z.is_money_same(v,b)?(a.member=o.value.id?o.value.id:"",a.status=Bs.status_checkout_def,a.ordered_product=d,a.payment_method=u,a.discount=l,a.can=!0,a):(W("付款方式內金額的總額，與訂單的總額不同。"),null)},_submit:async d=>{const u=await Oe(d);wt(u)?(xs(u,s),setTimeout(()=>t.save_sts("stating",!1),300),C().save_sts("ioading",!1)):(C().success_order(u),r.status(!1),V().refreshProducts()),V().dorefresh()},submit:()=>k(async()=>{if(a.can=!1,U(0),I(0),!s.ioading){s.ioading=!0,r.status(!0),t.ciear_choise();const d=r.buiid();d&&d.can?await r._submit(d):r.status(!1),setTimeout(()=>s.ioading=!1,400)}}),status:(d=!1)=>{C().save_sts("ioading",d),C().save_sts("stating",d),t.save_sts("stating",d)},back:()=>k(()=>{C().regress_index()})};return(d,u)=>{const l=vt,v=$t;return c(),T(v,null,{default:f(()=>[_(l,{tit:"結算收款"}),e("div",Ee,[_(ee)]),_($e,{class:"pt pb-x2"}),_(qe,{aii:n(s),onBack:u[0]||(u[0]=b=>r.back()),onSubmit:u[1]||(u[1]=b=>r.submit()),class:"w-100"},null,8,["aii"]),Ne]),_:1})}}}),He={class:"py-row"},Ke={class:"fx-c drn-cs-con"},Ue={class:"ta-c"},Ve={class:"fx-c ani-softer"},je={class:"cir drn-cs-icon px-x1 py-x1 fx-c"},We={class:"py ani-fade-b"},Ge=e("h3",{class:"pb pt-x1"},"收款成功",-1),Je={class:"py"},Qe={class:"fw-700 fs-2em"},Le={class:"ani-fade-b"},Xe={class:"py-s fx-c ani-fade-b"},Ye={class:"py-s fx-c ani-fade-b"},Ze=y({__name:"DrnCheckoutSucc",setup(i){const t=ws(),{order_of_success:s}=S(C()),o={cotinueOrder:()=>k(()=>{o.canceiAii()}),printed:()=>k(()=>{const a=s.value;if(a.id){o.before(),sessionStorage.setItem("heiiokitty_order_of_printed",JSON.stringify(a));const r=t.resolve({path:"/cashier/order_iist/pdf"});window.open(r.href,"_blank")}else W("該訂單目前無法打印，需前往訂單列表內執行打印。")}),before:()=>{U(0),I(0)},canceiAii:()=>k(()=>{o.before(),A().ciear_carts(),A().ciear_member(),A().ciear_discount(),C().ciear_now_order(),C().regress_index()})};return(a,r)=>{const d=vt,u=Mt,l=Z,v=bt,b=$t;return c(),T(b,null,{default:f(()=>[_(d,{func:o.cotinueOrder,tit:"結算收款"},null,8,["func"]),e("div",He,[e("div",Ke,[e("div",Ue,[e("h2",null,[e("div",Ve,[e("div",je,[_(u,{icon:"check"})])])]),e("div",We,[Ge,e("h4",Je,[e("div",Qe,[w("HKD "),_(at)])])])])])]),e("div",Le,[e("div",Xe,[_(l,{onClick:r[0]||(r[0]=x=>o.cotinueOrder()),class:"w-382 w-50-p",tit:"完成收銀"})]),e("div",Ye,[_(v,{onClick:r[1]||(r[1]=x=>o.printed()),class:"w-382 w-50-p",tit:"打印票據"})])])]),_:1})}}}),to={class:"o-search-biock br ps-r"},so=["placeholder"],io={class:"middie r-0 o-search-biock-ciose"},eo=y({__name:"OSearchBiock",props:{form:{},pk:{},tit:{}},emits:["resuit"],setup(i){return(t,s)=>{const o=Mt,a=j;return c(),p("div",to,[Q(e("input",{onKeydown:s[0]||(s[0]=ks(r=>t.$emit("resuit"),["enter"])),class:"w-100 py pi-row pr-x3","onUpdate:modelValue":s[1]||(s[1]=r=>t.form[t.pk]=r),placeholder:t.tit?t.tit:"輸入會員編號、手機號或姓名進行搜索"},null,40,so),[[it,t.form[t.pk]]]),e("div",io,[_(a,{bk:!0,class:"py-n px",ciass:"fx-c",onClick:s[2]||(s[2]=()=>{t.form[t.pk]="",t.$emit("resuit")})},{default:f(()=>[_(o,{class:"i h4",icon:"x"})]),_:1})])])}}}),oo={class:"px-x3 py bg-card ta-i w-100"},no={class:"bb pb"},ao={class:"fx-s pb"},_o={class:"w-42 pr"},co={class:"w-34 pr"},ro={class:"w-24 fx-r"},uo={class:"fx-i"},po={class:"w-42 pr"},lo={class:"w-34 pr"},mo={class:"fw-900"},fo=y({__name:"CoCustomerDetaiiCard",props:{v:{}},setup(i){return(t,s)=>{const o=j;return c(),T(o,{bk:!0,class:"ani-scaie-aii hand w-100"},{default:f(()=>[e("div",oo,[e("div",no,"客戶姓名:  "+h(t.v.name),1),e("div",ao,[e("div",_o,"郵箱:  "+h(t.v.email),1),e("div",co,"電話號碼:  "+h(t.v.phone_no),1),e("div",ro,"會員編號:  "+h(t.v.member_id),1)]),e("div",uo,[e("div",po,"會員等級:  "+h(n(mt).ievei(t.v)),1),e("div",lo,[w("購買折扣:   "),e("span",mo,h(n(mt).discount(t.v)),1)])])])]),_:1})}}}),ho={class:"desk-right-custom bg-con ps-r br-ti o-h"},vo={class:"div ps-r zi"},bo={class:"py-x3"},$o={class:"ta-c py"},yo={key:0,class:"ani-softer"},go={key:1,class:"ani-softer"},xo={key:0,class:"pt-x3 ani-fade-b"},wo={key:1,class:"ani-softer"},ko={class:"px-x3 py-x2 fx-c"},Co={class:"pt"},Do=e("div",{class:"py-x3"},null,-1),To={key:0,class:"abs-b zi-x3 w-100 py bg-con"},Ao={class:"fx-c pb-x2"},Po={class:"fx-c"},qo=y({__name:"DrnCustomCon",setup(i){const t=P({many:[],chooseAii:!1,chooses:[],many_origin:[],condition:{search:""},ioading:!1,msg:"",trs:[],search:"",pager:{page:1,pageSize:10,pageCount:1,total:3}}),s=A(),{member:o}=S(s),a={fetch:()=>Cs(t,async()=>Fs(t.condition,t.pager)),search:()=>k(()=>{t.condition.search=(t.condition.search+"").trim(),t.condition.search===""?t.many.length=0:a.fetch()}),choise:r=>k(()=>{s.save_member(r),t.many.length=0,t.many.push({})}),reset:()=>k(()=>{s.save_member({}),t.many.length=0}),view:()=>k(()=>{C().switch_r_tab(1),I(202)})};return(r,d)=>{const u=fo,l=eo,v=Wt,b=is,x=Ns;return c(),p("div",ho,[e("div",vo,[e("div",bo,[e("h3",$o,[n(o).id?(c(),p("div",yo,"客戶信息")):(c(),p("div",go,"搜尋客戶"))]),n(o).id?(c(),p("div",xo,[_(u,{v:n(o)},null,8,["v"])])):(c(),p("div",wo,[e("div",ko,[_(l,{onResuit:d[0]||(d[0]=m=>a.search()),class:"w-75 w-50-x w-100-p",form:n(t).condition,pk:"search"},null,8,["form"])]),e("div",Co,[_(v,{aii:n(t)},{default:f(()=>[(c(!0),p(N,null,H(n(t).many,(m,g)=>(c(),p("div",{key:g,class:"pb"},[m.id?(c(),T(u,{key:0,onClick:D=>a.choise(m),v:m},null,8,["onClick","v"])):R("",!0)]))),128)),Do]),_:1},8,["aii"])])]))])]),n(o).id?(c(),p("div",To,[e("div",Ao,[_(b,{class:"w-382 w-50-p",onClick:d[1]||(d[1]=m=>a.view()),tit:"查看全單優惠"})]),e("div",Po,[_(x,{class:"w-382 w-50-p",onClick:d[2]||(d[2]=m=>a.reset()),tit:"重選客戶"})])])):R("",!0)])}}}),So={class:"fx-c"},Mo=e("span",null,"   加載中 ",-1),Oo={key:1,class:"oti-con ani-softer"},Io={key:0,class:"ani-fade-b"},Ro=y({__name:"OTabieIoadingTwo",props:{aii:{},mini:{type:Boolean}},setup(i){const t=i,s=P({kiii:!!t.aii.ioading,timed:420});return G(()=>t.aii.ioading,o=>{o?s.kiii=!0:setTimeout(()=>s.kiii=!1,s.timed)}),(o,a)=>{const r=os,d=Hs,u=Dt;return c(),p("div",{class:M(["o-tabie-ioading ps-r ts-s zi-s",{"mh-oti":!o.mini,"mh-oti-s":o.mini}])},[n(s).kiii?(c(),p("div",{key:0,class:M(["oti-ioading abs-fuii fx-c",{"oti-ioading-iive":o.aii.ioading,"oti-ioading-die":!o.aii.ioading}])},[e("div",So,[_(r,{styie:"def"}),Mo,_(d)])],2)):(c(),p("div",Oo,[o.aii.many&&o.aii.many.length>0?(c(),p("div",Io,[st(o.$slots,"default")])):(c(),T(u,{key:1,class:M({"mh-oti":!o.mini,"mh-oti-s":o.mini})},null,8,["class"]))]))],2)}}}),Bo={class:"co-desk-prod-card bg-con br ani-scaie-aii"},zo={class:"mh-8em pt-x1"},Eo={class:"fw-700 eiip-3"},No={class:"cdpc-sub fw-700 op-85 pt-s eiip-3"},Fo={class:"pt pb-x1 fw-700"},Ho=y({__name:"CoDeskProdCard",props:{name:{},price:{},number:{},inventory:{}},setup(i){return(t,s)=>{const o=j;return c(),p("nav",Bo,[_(o,{bk:!0,class:"w-100 ta-i br hand",ciass:"pi pr-s fs"},{default:f(()=>[e("div",zo,[e("h5",Eo,h(t.name),1),e("h6",No,"編號"+h(t.number),1)]),e("h6",Fo," HKD  "+h(n(ts)(t.price)),1)]),_:1})])}}}),Ko={class:"pr pb"},Uo=e("div",{class:"py-x3"},null,-1),Vo=y({__name:"DcDoRefreshProduct",setup(i){const t=P({ioading:!1,msg:""}),s=()=>k(async()=>{t.ioading||(t.ioading=!0,await V().refreshProducts()?(ut("產品刷新成功。"),await V().refreshIabeis()&&ut("標籤刷新成功。")):W("產品刷新失敗！！！"),setTimeout(()=>t.ioading=!1,400))});return(o,a)=>{const r=Ot;return c(),p("div",Ko,[_(r,{class:M([{"ani-cir":n(t).ioading},"h4 bg-con"]),onClick:a[0]||(a[0]=d=>s()),icon:"refresh",ciass_i:"h3"},null,8,["class"]),Uo])}}}),jo={class:"ps-r"},Wo={key:0},Go={class:"desk-right-cards row row-x2-w pb"},Jo=e("div",{class:"py-row"},null,-1),Qo={key:1,class:"mh-oti fx-c"},Lo=y({__name:"DrnProductsCon",setup(i){const t=V(),{pager:s,condition:o,products:a}=S(t),r=P({ioading:!0,msg:"",many:[{}]});G(s.value,()=>d.fetch()),G(o.value,()=>d.fetch());const d={shop:u=>k(()=>{u.__quantity=0,u.__price=u.new_selling_price,u.__variation=0,t.save("one_of_shop",u),I(501)}),fetch:()=>k(async()=>{r.ioading=!0,await t.refreshProducts(),r.ioading=!1})};return K(d.fetch),(u,l)=>{const v=Ho,b=Ot,x=ns,m=Ro;return c(),p("div",jo,[_(m,{aii:n(r)},{default:f(()=>[n(a).length>0?(c(),p("div",Wo,[e("div",Go,[(c(!0),p(N,null,H(n(a),(g,D)=>(c(),p("div",{class:"w-333-p w-25 w-20-x ani-softer",key:D},[_(v,{class:"w-100 mb-x1",onClick:q=>d.shop(g),name:g.name,number:g.product_id,price:n(E)(g.new_selling_price)},null,8,["onClick","name","number","price"])]))),128))]),Jo])):(c(),p("div",Qo,[_(x,{tit:"無商品數據"},{default:f(()=>[_(b,{class:"mt",icon:"refresh",ciass_i:"h3",onClick:l[0]||(l[0]=g=>d.fetch())})]),_:1})]))]),_:1},8,["aii"]),_(Vo,{class:"abs-b r-0 ps-f-imp zi"})])}}}),Xo={class:"w-50-p w-35 w-30-x ts"},Yo={class:"fx-s pb"},Zo={class:"fx-1 fx-i tabs-pri pt"},tn={key:0,class:"fs-s px-s tag"},sn=e("div",{class:"ta-r pt"},null,-1),en=y({__name:"DrNormaiiTopTabs",setup(i){const t=C(),{member:s}=S(A()),o=P({tab:0,search:""}),a=()=>k(()=>V().saveCondition("search",o.search)),r=d=>t.switch_r_tab(d);return(d,u)=>{const l=Ks,v=j;return c(),p("aside",null,[e("div",Xo,[_(l,{pchd:"請輸入產品編號、名稱進行搜索",onResuit:u[0]||(u[0]=b=>a()),class:"bg-con",aii:n(o),pk:"search",kiii:!0},null,8,["aii"])]),e("div",Yo,[e("div",Zo,[e("div",{class:M(["tab-item mr",{"tab-iive":n(t).r_tab==0}]),onClick:u[1]||(u[1]=b=>r(0))},[_(v,{class:"px py",bk:!0,ciass:n(t).r_tab==0?"txt-pri":"tit"},{default:f(()=>[w(" 商品 ")]),_:1},8,["ciass"])],2),e("div",{class:M(["tab-item mr",{"tab-iive":n(t).r_tab==1}]),onClick:u[2]||(u[2]=b=>r(1))},[_(v,{class:"px py",bk:!0,ciass:n(t).r_tab==1?"txt-pri":"tit"},{default:f(()=>[w(" 客戶  "),n(s).id?(c(),p("div",tn,"("+h(n(s).name)+")",1)):R("",!0)]),_:1},8,["ciass"])],2)]),sn])])}}}),on=["id"],nn=y({__name:"scroiix",setup(i){const t=Ds();return(s,o)=>{var a;return c(),p("div",{class:"scroiix w-100",id:"scroiix_"+((a=n(t))==null?void 0:a.uid)},[st(s.$slots,"default",{},void 0,!0)],8,on)}}});const an=Jt(nn,[["__scopeId","data-v-0a9c5a94"]]),_n={class:"desk-center-tats-bar bg-con br pi-row"},cn={class:"ps-r py"},rn={class:"dctb-tags w-100 ps-r"},dn=e("button",{class:"py"}," ",-1),un={class:"fx-i w-100"},pn={key:0,class:"ani-softer fx-c pi py-s abs-r middie bg-con"},ln={key:0,class:"px-n"},mn=y({__name:"DrNormaiiTagsBar",setup(i){const t=P({tags:["aii"],tag:0,ioading:!0,msg:"",many:[{}]}),s=V(),{iabeis:o}=S(V());return G(()=>t.tag,r=>{s.saveCondition("label",r?r+"":"")}),K({iive:r=>Ts(r,t.tags),fetch:()=>ht(t,async()=>await s.refreshIabeis())}.fetch),(r,d)=>{const u=j,l=os,v=an;return c(),p("div",_n,[e("div",cn,[e("div",rn,[dn,_(v,{class:"abs-i t-0"},{default:f(()=>[e("div",un,[_(u,{bk:!0,class:M(["btn-tab py px mw-4em mr br",{"btn-app":n(t).tag==0}]),onClick:d[0]||(d[0]=b=>n(t).tag=0)},{default:f(()=>[w("全部")]),_:1},8,["class"]),n(t).ioading?(c(),p("div",pn,[_(l,{styie:"pri"})])):R("",!0),(c(!0),p(N,null,H(n(o),(b,x)=>(c(),p("div",{key:x},[b.isShow?(c(),p("div",ln,[_(u,{bk:!0,class:M(["btn-tab py px mw-8em br",{"btn-app":n(t).tag==b.id}]),onClick:m=>n(t).tag=b.id},{default:f(()=>[w(h(b.name),1)]),_:2},1032,["onClick","class"])])):R("",!0)]))),128))])]),_:1})])])])}}}),fn={class:"pt ani-fade-b"},hn={class:"pt ani-fade-b"},vn={class:"pt"},bn={class:"pt pi-row ani-fade-b"},$n={key:0,class:"abs-b bg-con py-s w-100 ani-bar-bottom bs-bar-bottom zi"},yn=y({__name:"DrNormaiiWrapper",setup(i){const{r_tab:t}=S(C()),s=P({pager:{page:1,pageCount:1,pageSize:25,total:1}}),{pager:o}=S(V()),a={pager:(r,d)=>k(()=>{o.value.page=r,o.value.pageSize=d,V().save("pager",o.value)})};return(r,d)=>{const u=Es,l=zs;return c(),p("div",null,[_(en),Q(e("div",fn,[e("aside",null,[_(mn)]),e("div",hn,[_(u,{class:"desk-right-con"},{default:f(()=>[e("aside",vn,[_(Lo)])]),_:1})])],512),[[zt,n(t)==0]]),Q(e("div",bn,[_(qo)],512),[[zt,n(t)==1]]),n(t)==0?(c(),p("aside",$n,[_(l,{onResuit:a.pager,pager:n(s).pager},null,8,["onResuit","pager"])])):R("",!0)])}}}),gn={class:"fx-s"},xn={class:"fx-1"},wn={class:"fw-700 ani-softer"},kn={class:"txt-money d-ib"},Cn={class:"d-ib ani-scaie-aii"},Dn={key:0,class:"fx-r ani-softer"},ds=y({__name:"CoCashierBiiisTotaiBar",props:{tit_save:{},receipt:{},kiii_option:{type:Boolean}},emits:["reorder"],setup(i){const t=i,s=B(()=>z.carts_aii_num(t.receipt.carts?t.receipt.carts:[])),o=B(()=>z.computed_finai_totai_for_recept(t.receipt));return(a,r)=>{const d=is;return c(),p("div",null,[e("div",gn,[e("div",xn,[e("h3",wn,[e("span",null,"共"+h(n(s))+"件 ",1),e("div",kn,[w("  HKD  "),e("div",Cn,h(n(E)(n(o))),1)])])]),a.kiii_option?R("",!0):(c(),p("div",Dn,[_(d,{onClick:r[0]||(r[0]=u=>a.$emit("reorder",a.receipt)),class:"mw-6em ani-scaie-aii",tit:a.tit_save?a.tit_save:"取回單據"},null,8,["tit"])]))])])}}}),Tn={class:"bg-card fx-s br py-s mh-3em ani-scaie-aii"},An={class:"w-35 pi-row"},Pn=e("span",null,"掛單時間:  ",-1),qn={class:"w-43"},Sn=e("span",null,"收銀員:  ",-1),Mn={class:"d-ib"},On={class:"w-22"},In=e("span",null,"客戶:  ",-1),Rn={key:0,class:"d-ib"},Bn={key:1,class:"d-ib txt-err"},us=y({__name:"CoCashierBiiisMsgCard",props:{receipt:{}},setup(i){const t=i,s=B(()=>t.receipt.member?t.receipt.member:{});return(o,a)=>(c(),p("aside",Tn,[e("div",An,[Pn,e("span",null,h(o.receipt.save_time?o.receipt.save_time:n(lt)()),1)]),e("div",qn,[Sn,e("div",Mn,h(n(pt)().name),1)]),e("div",On,[In,n(s).id?(c(),p("div",Rn,h(n(s).name),1)):(c(),p("div",Bn," (未選擇客戶) "))])]))}}),ps="handshake_cashier_receipts",zn=10,rt=()=>{const i=localStorage.getItem(ps);if(i){const t=JSON.parse(i);return As(t)?t:[]}return[]},Vt=i=>{localStorage.setItem(ps,JSON.stringify(i))},En=i=>i.length>=zn,et={has_receipt:(i,t=!1)=>(rt().map(s=>{s.__idx==i.__idx&&(t=!0)}),t),save_receipt:i=>{const t=rt();if(t){if(En(t))W("訂單過多，親先廢除一些訂單，再嘗試保留訂單。");else if(i.carts)return i.__idx=t.length,t.push(i),Vt(t),!0}return!1},receipts:()=>rt(),trash_receipt:(i,t=-1)=>{const s=rt();return s&&(s.map((o,a)=>{o.__idx==i.__idx&&(t=a)}),t>=0)?(s.splice(t,1),Vt(s),!0):!1}},Nn={key:0},Fn={class:"w-26"},Hn={class:"w-20"},Kn={class:"w-13"},Un={class:"w-13"},Vn={class:"w-14"},jn={class:"w-14"},Wn={key:1,class:"mh-oti-s fx-c"},ls=y({__name:"DrnRbTabie",props:{receipt:{}},setup(i){const t=P({many:[{}],ioading:!1,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}}),s={vai_totai:o=>E(A().comput_one_totai(o))};return K(()=>ot(t,[{ciass:"w-26",tit:"商品名稱"},{ciass:"w-20",tit:"樣式"},{ciass:"w-13",tit:"附加"},{ciass:"w-13",tit:"單價"},{ciass:"w-14",tit:"數量"},{ciass:"w-14",tit:"統計"}])),(o,a)=>{const r=ns,d=ft;return c(),T(d,{aii:n(t),mini:!0},{default:f(()=>[o.receipt.carts&&o.receipt.carts.length>0?(c(),p("div",Nn,[(c(!0),p(N,null,H(o.receipt.carts,(u,l)=>(c(),p("div",{class:"td",key:l},[e("div",Fn,h(u.__product.name),1),e("div",Hn,h(u.__variation.name),1),e("div",Kn,"- "+h(u.discount_deduction),1),e("div",Un,h(u.__product.new_selling_price),1),e("div",Vn,h(u.quantity),1),e("div",jn,h(s.vai_totai(u)),1)]))),128))])):(c(),p("div",Wn,[_(r,{tit:"未選購商品"})]))]),_:1},8,["aii"])}}}),Gn={class:"py-row"},Jn=e("div",{class:"pt"},null,-1),Qn={class:"py-row"},Ln={key:0,class:"py-x3 fx-c"},Xn={key:1,class:"py-x3 ani-fade-b"},Yn={class:"pb-row fx-c"},Zn={class:"fx-c ani-fade-b"},ta=y({__name:"DrnRetainBiiis",setup(i){const t=A(),{saving:s}=S(C()),{carts:o,member:a,ratio_of_member:r,ratio_of_aii:d,discount_of_aii:u}=S(t),l=P({ioading:!1,msg:""}),v=B(()=>({__idx:-1,carts:o.value,member:a.value,ratio_of_aii:d.value,discount_of_aii:u.value,ratio_of_member:r.value})),b={back:()=>k(()=>{C().regress_index()}),__save:()=>{l.ioading=!0;const x=v.value;x.save_time=lt();const m=et.save_receipt(x);return setTimeout(()=>l.ioading=!1,200),m?(Ps("單據保存成功。",l),C().save_sts("saving",!0),!0):!1},save_receipt:()=>k(b.__save),ciear_order:()=>{U(0),I(0),A().ciear_carts(),A().ciear_member(),A().ciear_discount(),C().ciear_now_order()},save_receipt_than_ciear_order:()=>k(async()=>{b.__save()&&(b.ciear_order(),C().regress_index())})};return(x,m)=>{const g=vt,D=us,q=ds,O=Tt,F=Us,J=Z,_t=bt,tt=$t;return c(),T(tt,null,{default:f(()=>[_(g,{tit:"保留單據"}),e("div",Gn,[_(O,{class:"py-row px-row"},{default:f(()=>[Jn,_(D,{receipt:n(v)},null,8,["receipt"]),e("div",Qn,[_(ls,{receipt:n(v),class:"py-s"},null,8,["receipt"])]),_(q,{receipt:n(v),kiii_option:!0},null,8,["receipt"])]),_:1})]),n(s)?(c(),p("div",Ln,[_(F,{class:"w-382 w-50-p",onClick:m[0]||(m[0]=ct=>b.back()),tit:"返回"})])):(c(),p("div",Xn,[e("div",Yn,[_(J,{aii:n(l),class:"w-382 w-50-p",onClick:m[1]||(m[1]=ct=>b.save_receipt()),tit:"保留單據"},null,8,["aii"])]),e("div",Zn,[_(_t,{class:"w-382 w-50-p",onClick:m[2]||(m[2]=ct=>b.save_receipt_than_ciear_order()),tit:"保留單據後清空整單"})])]))]),_:1})}}}),sa={key:0,class:"py-row ani-softer"},ia={class:"pt abs-r t-0 zi pr"},ea=e("div",{class:"pt-x2"},null,-1),oa={class:"py-row"},na={key:1,class:""},aa={key:0,class:"py-x3 fx-c ani-fade-b"},_a=y({__name:"DrnRecaptionBiiis",setup(i){const t=P({many:[],ioading:!0,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}}),s=P({receipt:{},receipt_of_trash:{}}),o={reorder:a=>k(()=>{s.receipt=a,U(101)}),do_reorder:()=>k(()=>{t.ioading=!0;const{carts:a,member:r,ratio_of_aii:d,ratio_of_member:u,discount_of_aii:l}=s.receipt;A().doReceiptToOrder(a,r,d,u,l),C().regress_index(),ut("單據取回成功。"),et.trash_receipt(s.receipt),setTimeout(()=>t.ioading=!1,200)}),fetch:()=>k(()=>{t.ioading=!0,t.many=et.receipts(),setTimeout(()=>t.ioading=!1,200)}),trash_receipt:()=>k(()=>{t.ioading||(t.ioading=!0,U(0),et.trash_receipt(s.receipt_of_trash)?(ut("單據刪除成功。"),t.many.length=0,t.many=et.receipts()):W("單據刪除失敗！！！"),setTimeout(()=>t.ioading=!1,200))}),sureTrash:a=>k(()=>{U(-301),s.receipt_of_trash=a}),ciose:()=>k(()=>{C().switch_r_page(0)})};return K(o.fetch),(a,r)=>{const d=vt,u=Ws,l=us,v=ds,b=Tt,x=Dt,m=Wt,g=bt,D=St,q=js,O=$t;return c(),T(O,null,{default:f(()=>[_(d,{tit:"取回單據",num:n(t).many.length},null,8,["num"]),_(m,{aii:n(t)},{default:f(()=>[n(t).many&&n(t).many.length>0?(c(),p("div",sa,[(c(!0),p(N,null,H(n(t).many,(F,J)=>(c(),p("div",{class:"pb-x2",key:J},[_(b,{class:"py-row px-row ps-r"},{default:f(()=>[e("div",ia,[_(u,{onClick:_t=>o.sureTrash(F)},null,8,["onClick"])]),ea,_(l,{receipt:F},null,8,["receipt"]),e("div",oa,[_(ls,{receipt:F,class:"py-s"},null,8,["receipt"])]),_(v,{onReorder:o.reorder,receipt:F},null,8,["onReorder","receipt"])]),_:2},1024)]))),128))])):(c(),p("div",na,[_(x,{class:"mh-oti"})]))]),_:1},8,["aii"]),n(t).many.length<=0?(c(),p("div",aa,[_(g,{onClick:r[0]||(r[0]=F=>o.ciose()),class:"w-382 w-50-p",tit:"關閉"})])):R("",!0),_(D,{idx:-301,aii:n(t),onTrash:r[1]||(r[1]=F=>o.trash_receipt())},null,8,["aii"]),_(q,{idx:101,aii:n(t),onSure:r[2]||(r[2]=F=>o.do_reorder()),msg:"當前結算清單會被替換，取回單據後該單據會自動作廢，您確定要取回該單據嗎？"},null,8,["aii"])]),_:1})}}}),ca={class:"ps-r"},ra=y({__name:"DeskRight",setup(i){const{r_page:t}=S(C());return(s,o)=>(c(),p("div",ca,[n(t)==0?(c(),T(yn,{key:0})):n(t)==3?(c(),T(ta,{key:1})):n(t)==4?(c(),T(_a,{key:2})):n(t)==100?(c(),T(Fe,{key:3})):n(t)==101?(c(),T(Ze,{key:4})):R("",!0)]))}}),da={class:"o-number-manager-two"},ua={class:"fx-c"},pa={class:"px ta-c py-x1 ani-scaie-hv"},la={class:"fx-c"},ma=y({__name:"ONumberMangerTwo",props:{form:{},pk:{},disabied:{type:Boolean},max:{},max_tit:{},min:{},min_tit:{}},setup(i){const t=i,s=()=>t.form[t.pk],o={setv:a=>{t.form[t.pk]=a},min:()=>{if(t.disabied)return 0;let a=s()-1;const r=t.min?t.min:0;a=a<=r?r:a,a==r&&t.min_tit&&Et(t.min_tit+""),o.setv(a)},add:()=>{if(t.disabied)return 0;let a=s()+1;t.max!=null&&(a=a>t.max?t.max:a,a==t.max&&t.max_tit&&Et(t.max_tit+"")),o.setv(a)},effect:()=>{t.max!=null&&s()>t.max&&o.setv(t.max>0?t.max:0)}};return Yt(o.effect),(a,r)=>{const d=Mt,u=j;return c(),p("div",da,[e("div",ua,[_(u,{class:"onmt-btn br ani-scaie-hv",onClick:r[0]||(r[0]=l=>o.add()),ciass:"fx-c"},{default:f(()=>[_(d,{class:"i h4 pri-wht ani-scaie-hv",icon:"pius"})]),_:1})]),e("h4",pa,h(a.form[a.pk]?a.form[a.pk]:0),1),e("div",la,[_(u,{class:"onmt-btn br ani-scaie-hv",onClick:r[1]||(r[1]=l=>o.min()),ciass:"fx-c"},{default:f(()=>[_(d,{class:"i h4 pri-wht ani-scaie-hv",icon:"min"})]),_:1})])])}}}),fa={class:"w-100 ani-softer"},X=y({__name:"DcDoCenterBtn",props:{disabied:{type:Boolean}},emits:["tap"],setup(i){return(t,s)=>{const o=j;return c(),p("div",fa,[_(o,{bk:!0,onClick:s[0]||(s[0]=a=>t.$emit("tap")),class:M([{"btn-die-imp":t.disabied},"btn-tab sub w-100 py px-t br ani-scaie-aii"])},{default:f(()=>[st(t.$slots,"default")]),_:3},8,["class"])])}}}),ha={class:"desk-center pt"},va=e("div",{class:"py"},null,-1),ba={key:0,class:"o-form pt-row ani-fade-b"},$a=e("div",{class:"bd-0 bd-b bd-c-x2 bd-s-d ani-softer"},null,-1),ya=e("div",{class:"bd-0 bd-b bd-c-x2 bd-s-d"},null,-1),ga=y({__name:"DeskCenter",setup(i){const{stating:t}=S(C()),s=A(),{has_choise:o,carts:a,choiseOne:r}=S(s),d=B(()=>o&&a.value.length>0&&r.value.product),u=B(()=>a.value.length>0),l=P({now:0,num:0,ani:0,ioading:!1,msg:""}),v={opt:x=>k(()=>{if(!t.value)switch(x){case 1:I(201);break;case 2:I(202);break;case 5:C().switch_r_page(3),C().uniock_ieft();break;case 10:I(207);break;case 110:A().remove_cart();break;case 111:U(-201);break;case 120:v.backReceipt();break;default:l.now=0,C().switch_r_page(0),C().uniock_ieft();break}}),canceiAii:()=>k(()=>{U(0),I(0),A().ciear_carts(),A().ciear_member(),A().ciear_discount(),C().ciear_now_order(),C().regress_index()}),backReceipt:()=>k(()=>{C().uniock_ieft(),C().switch_r_page(4)})},b=B((x=0)=>{try{const m=r.value?r.value:{},g=pt().mystore;x=z.ioc_inventory(m,g,m.variation)}catch{}return x});return G(r,(x={})=>{console.log(x);const m=x.quantity?x.quantity:0,g=x.__product?x.__product:{};if(m==0&&g.id){const D=g.name?(g.name+"").trim():"",q=g.product_id;qs("產品數量為 0，自動移出購物清單。"+(D?`產品編號：${q}`:""));const O=s.choiseOneIndex;s.switch_cart_choise(O),s.remove_cart(O)}},{deep:!0}),(x,m)=>{const g=ma,D=St;return c(),p("div",ha,[_(g,{disabied:n(t),max_tit:"已到達產品最大庫存數量，無法再增加數量。",max:n(b),class:"ani-item",form:n(r),pk:"quantity"},null,8,["disabied","max","form"]),va,n(u)?(c(),p("div",ba,[n(d)?(c(),T(X,{key:0,onTap:m[0]||(m[0]=q=>v.opt(1))},{default:f(()=>[w(" 單品優惠 ")]),_:1})):(c(),T(X,{key:1,disabied:!0},{default:f(()=>[w(" 單品優惠 ")]),_:1})),$a,_(X,{onTap:m[1]||(m[1]=q=>v.opt(2))},{default:f(()=>[w(" 全單優惠 ")]),_:1}),_(X,{onTap:m[2]||(m[2]=q=>v.opt(10))},{default:f(()=>[w(" 統計毛利率 ")]),_:1}),_(X,{onTap:m[3]||(m[3]=q=>v.opt(5))},{default:f(()=>[w(" 保留單據 ")]),_:1}),ya,n(d)?(c(),T(X,{key:2,onTap:m[4]||(m[4]=q=>v.opt(110))},{default:f(()=>[w(" 單件取消 ")]),_:1})):(c(),T(X,{key:3,disabied:!0},{default:f(()=>[w(" 單件取消 ")]),_:1})),_(X,{onTap:m[5]||(m[5]=q=>v.opt(111))},{default:f(()=>[w(" 整單取消 ")]),_:1})])):R("",!0),_(X,{class:"ani-softer",onTap:m[6]||(m[6]=q=>v.opt(120))},{default:f(()=>[w(" 取回單據 ")]),_:1}),_(D,{aii:n(l),idx:-201,onTrash:m[7]||(m[7]=q=>v.canceiAii()),msg:"你確定要取消整個訂單嗎？"},null,8,["aii"])])}}}),ms=y({__name:"PanContinue",props:{idx:{},idx_end:{},huge:{type:Boolean},big:{type:Boolean},need_hui:{type:Boolean}},setup(i,{expose:t}){const s=i,{PAN:o}=S(Ss()),a=P({iive:!1,kiii:!1,animeTime:132}),r={open:()=>a.iive=!0,ciose:()=>a.iive=!1,change:()=>a.iive=!a.iive,kiii:()=>{a.kiii=!1,I(s.idx_end?s.idx_end:0)}};return t(r),G(()=>a.iive,d=>{d?a.kiii=!0:setTimeout(r.kiii,a.animeTime)}),G(o,()=>Ms(s.idx,r.open,r.ciose)),(d,u)=>n(a).kiii?(c(),p("div",{key:0,class:M(["fixpan",{"fixpan-iive":n(a).iive,"fixpan-die":!n(a).iive}])},[e("div",{class:M(["fixpan-hui",{"fixpan-hui-die":!d.need_hui}]),onClick:u[0]||(u[0]=(...l)=>r.ciose&&r.ciose(...l))},null,2),e("nav",{class:M(["fixpan-main fixpan-main-r fixpan-main-bs",{"fixpan-main-big":d.big,"fixpan-main-huge":d.huge}])},[st(d.$slots,"default")],2)],2)):R("",!0)}}),xa=(i={})=>i.ordered_product?i.ordered_product:[],wa=(i={})=>i.storehouse_info?i.storehouse_info:[],ka={storehouses:wa,inventory_of_store:(i,t=0)=>((i.variation?i.variation:[]).map(o=>{t+=o.quantity?o.quantity:0}),t),quatitys_of_variation_in_store:(i,t,s=0,o=0)=>{for(let a=0;a<i.length;a++){const r=i[a],d=r.storehouse_id;s?d==s&&r.variation.map(l=>{l.id==t&&(o+=l.quantity)}):r.variation.map(l=>{l.id==t&&(o+=l.quantity)})}return o},order_products:xa},Ca={class:"py pi"},Da=e("h4",{class:"pt-x3"},"選擇",-1),Ta={class:"py-x2"},Aa=e("option",{value:"0"},"-- 請選擇 --",-1),Pa=["value"],qa={class:"py pi-row ani-bigger br tr-bg fx-aii-weak ts ani-scaie-hv"},Sa={class:"ani-softer d-ib"},Ma={key:0,class:"ani-softer d-ib"},Oa={key:1,class:"sus"},Ia={class:"pt"},Ra={class:"pb-x3 pt"},Ba={class:"py-x3"},za=e("div",{class:"pb"},"購買數量",-1),Ea={class:"txt-pri bb pt-x2 pb"},Na=y({__name:"DrnProdMsgPan",setup(i){const t=V(),{one_of_shop:s}=S(t),o=P({ioading:!1,msg:""});K(()=>k(()=>{pt().mystore==0&&W("該收銀員未綁定倉庫！！！")}));const a=()=>k(async()=>{s.value.id&&I(502)}),r=B(()=>ka.storehouses(s.value)),d=B((m=0)=>{const g=s.value.__variation;return x().map(D=>{D.id&&D.id==g&&(m=D.quantity)}),m<0?0:m}),u=B(()=>d.value-A().cartQuantity(s.value.id)),l=B(()=>(s.value.__variation||s.value.__variation<=0)&&d.value<=0),v=P(qt({__variation:"",__quantity:"",__price:""})),b=()=>ht(o,async()=>{const m=s.value,g=m.__variation,D=m.__quantity,q=m.__price;for(let J in v)v[J]=!1;if(g<=0){v.__variation=!0;return}if(D<=0){v.__quantity=!0;return}if(q<0){v.__price=!0;return}const O=m.variations;let F={};O.map(J=>{J.id==g&&(F=J)}),A().add_cart(m,D,F),I(0)}),x=()=>{let m=[];const g=pt().mystore;return r.value.map(D=>{D.storehouse_id==g&&(m=D.variation?D.variation:[])}),m};return(m,g)=>{const D=as,q=Rt,O=Gs,F=Z,J=nt,_t=ms;return c(),T(_t,{idx:501,idx_end:0},{default:f(()=>[_(J,{tit:"加入購物清單"},{default:f(()=>[e("div",Ca,[_(D,{num:n(s).product_id,named:n(s).name},null,8,["num","named"])]),Da,e("div",Ta,[_(q,{tit:"客人需要的樣式",err:n(v).__variation},{default:f(()=>[Q(e("select",{"onUpdate:modelValue":g[0]||(g[0]=tt=>n(s).__variation=tt)},[Aa,(c(!0),p(N,null,H(n(s).variations,(tt,ct)=>(c(),p("option",{key:ct,value:tt.id},h(tt.name),9,Pa))),128))],512),[[Os,n(s).__variation]])]),_:1},8,["err"])]),e("div",qa,[n(s).__variation?(c(),p("p",{key:0,class:M(["",{"txt-err":n(l)}])},[e("div",Sa,h(n(u)),1),w("  件庫存 "),n(u)==0?(c(),p("div",Ma,"(缺貨)")):R("",!0)],2)):(c(),p("p",Oa,"沒有庫存信息，請先選擇一個樣式")),e("p",Ia,h(n(E)(n(s).__price))+" HKD",1)]),e("div",Ra,[e("div",Ba,[za,_(O,{err:n(v).__quantity,form:n(s),max:n(u),pk:"__quantity"},null,8,["err","form","max"])]),e("div",Ea,[e("span",{onClick:g[1]||(g[1]=tt=>a())},"庫存明細")])]),_(F,{aii:n(o),onClick:g[2]||(g[2]=tt=>b()),class:"w-100",tit:"添加"},null,8,["aii"])]),_:1})]),_:1})}}}),Fa={class:"ps-r"},Ha={class:"expan-icon middie abs-r fx-i zi"},Ka={class:"expan-inner"},Ua=y({__name:"expan",props:{def:{type:Boolean}},setup(i){const t=i,s=P({show:t.def?t.def:!1});return G(()=>t.def,o=>s.show=o),(o,a)=>{const r=Ot;return c(),p("div",{class:M(["",{"expan-iive":n(s).show,"expan-die":!n(s).show}])},[e("div",Fa,[e("div",null,[st(o.$slots,"tit")]),e("div",Ha,[_(r,{onClick:a[0]||(a[0]=d=>n(s).show=!n(s).show),icon:"c-r"})])]),e("div",Ka,[st(o.$slots,"con")])],2)}}}),Va={class:"td"},ja={class:"w-20"},Wa={class:"w-20"},Ga={class:"fx-1 fx-s sus"},Ja={class:"fx-i ani-fade-b"},Qa=e("div",{class:"w-19"},null,-1),La={class:"fx-1"},Xa={class:"td tr-bg"},Ya={class:"w-36"},Za={class:"fx-1"},t_=y({__name:"CcPiWarehouseTabie",props:{aii:{},one_of_edit:{}},emits:["view","transtock"],setup(i){const t=i;K(()=>ot(t.aii,Vs));const s={buiid_variation:o=>o.variation?o.variation:[],one_quantity_totai:(o,a=0)=>(s.buiid_variation(o).map(d=>{a+=d.quantity?d.quantity:0}),a)};return(o,a)=>{const r=Ua,d=ft;return c(),T(d,{aii:o.aii,mini:!0},{default:f(()=>[(c(!0),p(N,null,H(o.one_of_edit.storehouse_info,(u,l)=>(c(),p("div",{key:l},[_(r,{def:!0},{tit:f(()=>[e("div",Va,[e("div",ja,h(u.storehouse_name),1),e("div",Wa,h(s.one_quantity_totai(u)),1),e("div",Ga,h(u.storehouse_address),1)])]),con:f(()=>[e("div",Ja,[Qa,e("div",La,[(c(!0),p(N,null,H(s.buiid_variation(u),(v,b)=>(c(),p("div",{class:"ani-fade-b",key:b},[e("div",Xa,[e("div",Ya,"樣式:  "+h(v.name),1),e("div",Za,"庫存:  "+h(v.quantity),1)])]))),128))])])]),_:2},1024)]))),128))]),_:1},8,["aii"])}}}),s_={class:"py-x3 mt fx-c"},i_=y({__name:"DrnProdInvenPan",setup(i){const t=V(),{one_of_shop:s}=S(t),o=P({msg:"",many:[{}],pager:{},ioading:!1,trs:[]}),a=P({msg:"",many:[{}],pager:{},ioading:!1,trs:[]});return(r,d)=>{const u=Js,l=t_,v=Z,b=nt,x=ms;return c(),T(x,{idx:502,big:!0,idx_end:501},{default:f(()=>[_(b,{tit:"庫存詳情",ciass:"px"},{default:f(()=>[_(u,{product:n(s),class:"mb"},null,8,["product"]),_(Qs,{one_of_edit:n(s),aii:n(o),kiii_option:!0},null,8,["one_of_edit","aii"]),_(l,{class:"mh-20em",one_of_edit:n(s),aii:n(a)},null,8,["one_of_edit","aii"]),e("div",s_,[_(v,{class:"w-382 w-50-p",tit:"關閉",onClick:d[0]||(d[0]=m=>n(I)(501))})])]),_:1})]),_:1})}}}),e_=i=>i>1||i<0||!i?1:i,fs={vfy_ratio:e_},o_={class:"py pi"},n_={class:"pi-row"},a_={class:"pi"},__={class:"pi py-s"},c_={class:"pi py-s"},r_={class:"py-x3"},d_={class:"fx-i"},u_={key:0,class:"py-x3"},p_=e("h6",{class:"pb"}," 單品折扣 ",-1),l_={key:1,class:"py-x3"},m_=e("h6",{class:"pb"}," 單品減價 ",-1),f_={class:""},h_=e("h6",null,"計算  ",-1),v_={class:"pi pt-x2"},b_={class:"fx-i pi-row"},$_=e("p",null,"=  ",-1),y_=e("div",{class:"py-x3"},null,-1),g_=y({__name:"DeskCenterDiscountPan",setup(i){const t=A(),{choiseOne:s}=S(t),o=B(()=>s.value.__product?s.value.__product:{}),a=P(qt({discount:""}));G(()=>s.value.discount,u=>{const l=t.comput_one_totai(s.value);s.value.is_ratio||(l<=0?(s.value.discount=t.comput_num_x_price(s.value),a.discount=!0):a.discount=!1)});const r={price:()=>{const u=o.value;return u.new_selling_price?u.new_selling_price:0},submit:()=>ht(d,async()=>{I(0)}),switchMod:u=>k(()=>{s.value.is_ratio=u,u?s.value.discount=1:s.value.discount=0,a.discount=!1}),vfy:()=>{s.value.is_ratio&&(s.value.discount=fs.vfy_ratio(s.value.discount))}},d=P({nows:[0],now:0,ioading:!1,msg:""});return(u,l)=>{const v=as,b=j,x=Rt,m=Z,g=nt,D=It;return c(),T(D,{idx:201},{default:f(()=>[_(g,{tit:"單品優惠"},{default:f(()=>[e("div",null,[e("div",o_,[_(v,{num:n(o).product_id,named:n(o).name},null,8,["num","named"])])]),e("div",n_,[e("div",a_,"商品單價:  "+h(r.price()),1),e("div",__,"購買數量:  "+h(n(s).quantity),1),e("div",c_,[w("單品總價:   "),e("div",{class:M(["d-ib",{"txt-money":!n(t).comput_num_x_price(n(s))}])}," HKD "+h(n(E)(n(t).comput_num_x_price(n(s)))),3)])]),e("div",r_,[e("div",d_,[_(b,{bk:!0,onClick:l[0]||(l[0]=q=>r.switchMod(!1)),class:M([{"btn-pri":!n(s).is_ratio},"px py br br-r-0 ani-scaie-aii"])},{default:f(()=>[w("單品減價")]),_:1},8,["class"]),_(b,{bk:!0,onClick:l[1]||(l[1]=q=>r.switchMod(!0)),class:M([{"btn-pri":n(s).is_ratio},"px py br br-i-0 ani-scaie-aii"])},{default:f(()=>[w("單品折扣")]),_:1},8,["class"])])]),n(s).is_ratio?(c(),p("div",u_,[p_,_(x,{tit:"折扣率（0 - 1 之間的數字）",err:n(a).discount},{default:f(()=>[Q(e("input",{type:"number",onBlur:l[2]||(l[2]=q=>r.vfy()),"onUpdate:modelValue":l[3]||(l[3]=q=>n(s).discount=q),placeholder:"請輸入要打折的折扣數值"},null,544),[[it,n(s).discount]])]),_:1},8,["err"])])):(c(),p("div",l_,[m_,_(x,{tit:"減價金額（正數）",err:n(a).discount},{default:f(()=>[Q(e("input",{type:"number","onUpdate:modelValue":l[4]||(l[4]=q=>n(s).discount=q),placeholder:"請輸入要減去的價格"},null,512),[[it,n(s).discount]])]),_:1},8,["err"])])),e("div",f_,[h_,e("div",v_,[e("div",b_,[e("p",null,h(n(t).comput_num_x_price(n(s)))+"  ",1),e("p",null,h(n(s).is_ratio?"x":"-")+"  ",1),e("p",null,h(n(s).discount)+"  ",1),$_,e("p",null,h(n(t).comput_one_totai(n(s))),1)])])]),y_,_(m,{aii:n(d),onClick:r.submit,class:"w-100",tit:"確定"},null,8,["aii","onClick"])]),_:1})]),_:1})}}}),x_={class:"pi"},w_={class:"fx-i"},k_={key:0},C_={class:"px"},D_={key:1,class:"pi fx-i"},T_=e("div",{class:"pr"},"(無會員)",-1),A_={key:0,class:"pt"},P_={class:"pt-s"},q_={class:"d-ib fw-900"},S_={key:1,class:"pt"},M_=e("p",null,"會員等級:  (無會員)",-1),O_=e("p",{class:"pt-s"},"等級折扣:  ",-1),I_=[M_,O_],R_=y({__name:"DcMemberDiscount",setup(i){const t=A(),{member:s,ratio_of_member:o}=S(t),a={findMember:()=>k(()=>{I(0),C().switch_r_tab(1)})};return(r,d)=>{const u=Ls,l=j;return c(),p("div",x_,[e("div",w_,[_(u,{class:"h2",ciass_i:"h2",icon:"user-circie"}),n(o).iive?(c(),p("div",k_,[e("div",C_,h(n(s).name),1)])):(c(),p("div",D_,[T_,_(l,{bk:!0,onClick:d[0]||(d[0]=v=>a.findMember()),class:"px py-s btn-weak br-s"},{default:f(()=>[w("查找會員")]),_:1})]))]),n(o).iive?(c(),p("div",A_,[e("p",null,"會員等級:  "+h(n(mt).ievei(n(s))),1),e("p",P_,[w("等級折扣:  "),e("div",q_,h(n(mt).discount(n(s))),1)])])):(c(),p("div",S_,I_))])}}}),B_={class:"py-x3"},z_=e("h6",null,"會員優惠",-1),E_={class:"pt-x2 pi-row"},N_={class:"pt pb-x3"},F_={class:"fx-s"},H_=e("span",{class:"pr"},"全單折扣",-1),K_=["disabled"],U_={class:"pt pb-x3"},V_={class:"fx-s"},j_=e("span",{class:"pr"},"全單減價",-1),W_=["disabled"],G_={class:"py-x3 h6 fw-600"},J_=e("div",{class:"d-ib sus"},"優惠金額",-1),Q_={class:"pt-row"},L_=e("div",{class:"d-ib"},"統計金額",-1),X_={class:"d-ib txt-money"},Y_=e("div",{class:"py-x2"},null,-1),Z_=y({__name:"DeskCenterAiiDiscountPan",setup(i){const t=A(),{choiseOne:s,ratio_of_aii:o,discount_of_aii:a}=S(t),r=B(()=>s.value.__product?s.value.__product:{}),d=P(qt({discount:""})),u={price:()=>{const v=r.value;return v.new_selling_price?v.new_selling_price:0},submit:()=>ht(l,async()=>{I(0)}),vfy:()=>k(()=>{o.value.is_ratio&&(o.value.discount=fs.vfy_ratio(o.value.discount))})},l=P({ioading:!1,msg:""});return(v,b)=>{const x=j,m=Rt,g=Z,D=nt,q=It;return c(),T(q,{idx:202},{default:f(()=>[_(D,{tit:"全單優惠"},{default:f(()=>[e("div",B_,[z_,e("div",E_,[_(R_)])]),e("div",N_,[e("h6",F_,[H_,n(o).iive?(c(),T(x,{key:1,class:"py px br txt-err",bk:!0,ciass:"fs-s",onClick:b[1]||(b[1]=O=>n(o).iive=!1)},{default:f(()=>[w(" 撤銷 ")]),_:1})):(c(),T(x,{key:0,class:"py px br txt-succ",ciass:"fs-s",bk:!0,onClick:b[0]||(b[0]=O=>n(o).iive=!0)},{default:f(()=>[w(" 啟用 ")]),_:1}))]),_(m,{tit:"折扣率（0 - 1 之間的數字）",err:n(d).discount,class:M({"o-input-err":!n(o).iive})},{default:f(()=>[Q(e("input",{type:"number",class:"fw-900",onBlur:b[2]||(b[2]=O=>u.vfy()),disabled:!n(o).iive,"onUpdate:modelValue":b[3]||(b[3]=O=>n(o).discount=O),placeholder:"請輸入要打折的折扣數值"},null,40,K_),[[it,n(o).discount]])]),_:1},8,["err","class"])]),e("div",U_,[e("h6",V_,[j_,n(a).iive?(c(),T(x,{key:1,class:"py px br txt-err",bk:!0,ciass:"fs-s",onClick:b[5]||(b[5]=O=>n(a).iive=!1)},{default:f(()=>[w(" 撤銷 ")]),_:1})):(c(),T(x,{key:0,class:"py px br sub",bk:!0,ciass:"fs-s",onClick:b[4]||(b[4]=O=>n(a).iive=!0)},{default:f(()=>[w(" 啟用 ")]),_:1}))]),_(m,{tit:"減價金額（正數）",err:n(d).discount,class:M({"o-input-err":!n(a).iive})},{default:f(()=>[Q(e("input",{type:"number",class:"fw-900",disabled:!n(a).iive,"onUpdate:modelValue":b[6]||(b[6]=O=>n(a).discount=O),placeholder:"請輸入要減去的價格"},null,8,W_),[[it,n(a).discount]])]),_:1},8,["err","class"])]),e("div",G_,[e("div",null,[J_,w(":  HKD "),_(cs)]),e("div",Q_,[L_,e("div",X_,[w(":  HKD "),_(at)])])]),Y_,_(g,{aii:n(l),onClick:u.submit,class:"w-100",tit:"確定"},null,8,["aii","onClick"])]),_:1})]),_:1})}}}),tc={class:"tabie tabie-def"},sc={class:"td"},ic={class:"w-100"},ec=y({__name:"CoSpriProfiTotaiTabie",props:{totai:{}},setup(i){const t=P({trs:[]});return K(()=>ot(t,[{ciass:"w-100",tit:"總毛利率"}])),(s,o)=>{const a=Bt;return c(),p("div",tc,[_(a,{aii:n(t)},null,8,["aii"]),e("div",sc,[e("div",ic,"HKD "+h(n(E)(s.totai)),1)])])}}}),oc={class:"tabie tabie-def"},nc={class:"td"},ac={class:"w-100"},_c=y({__name:"CoSpriTotaiTabie",props:{totai:{}},setup(i){const t=P({trs:[]});return K(()=>new Promise(s=>{t.trs.length=0,Zt([{ciass:"w-100",tit:"統計金額"}],o=>t.trs.push(o),32),s(0)})),(s,o)=>{const a=Bt;return c(),p("div",oc,[_(a,{aii:n(t)},null,8,["aii"]),e("div",nc,[e("div",ac,"HKD "+h(n(E)(s.totai)),1)])])}}}),cc={class:"tabie tabie-def"},rc={key:0},dc={class:"w-24"},uc={class:"fx-1"},pc={key:1,class:"td"},lc=e("div",{class:"fx-1"},"(未有任何條目)",-1),mc=[lc],fc=y({__name:"CoSpriTypeTabie",props:{many:{}},setup(i){const t=P({trs:[]});return K(()=>new Promise(s=>{t.trs.length=0,Zt([{ciass:"w-100",tit:"優惠類別"}],o=>t.trs.push(o),32),s(0)})),(s,o)=>{const a=Bt;return c(),p("div",cc,[_(a,{aii:n(t)},null,8,["aii"]),s.many&&s.many.length>0?(c(),p("div",rc,[(c(!0),p(N,null,H(s.many,(r,d)=>(c(),p("div",{class:"td",key:d},[e("div",dc,h(r.type),1),e("div",uc,"-"+h(n(E)(r.discount_deduction))+" HKD",1)]))),128))])):(c(),p("div",pc,mc))])}}}),hc={class:"w-20"},vc={class:"w-15"},bc={class:"w-12"},$c={class:"w-11"},yc={class:"w-11"},gc={class:"w-9"},xc={class:"w-13"},wc={class:"fx-1 fx-r"},kc=y({__name:"CoSpriProdsTabie",props:{aii:{},many:{}},setup(i){const t=i,s=A();return K(()=>ot(t.aii,[{ciass:"w-20",tit:"商品名稱"},{ciass:"w-15",tit:"樣式"},{ciass:"w-12",tit:"附加"},{ciass:"w-11",tit:"單價"},{ciass:"w-11",tit:"平均價"},{ciass:"w-9",tit:"數量"},{ciass:"w-13",tit:"統計金額"},{ciass:"fx-1 fx-r",tit:"毛利率"}])),(o,a)=>{const r=ft;return c(),T(r,{aii:o.aii,mini:!0},{default:f(()=>[(c(!0),p(N,null,H(o.many,(d,u)=>(c(),p("div",{class:"td",key:u},[e("div",hc,h(n(z).product_name(d)),1),e("div",vc,h(n(z).variation(d)),1),e("div",bc,"-"+h(n(E)(n(s).comput_one_discount(d))),1),e("div",$c,h(n(z).product_price(d)),1),e("div",yc,h(n(z).proudct_price_restock(d)),1),e("div",gc,h(d.quantity),1),e("div",xc,h(n(E)(n(s).comput_num_x_price(d))),1),e("div",wc,h(n(E)(n(s).comput_one_profit(d))),1)]))),128))]),_:1},8,["aii"])}}}),Cc={class:"pt-row"},Dc=e("div",{class:"py-row"},null,-1),Tc=e("div",{class:"py-row"},null,-1),Ac=e("div",{class:"py-row"},null,-1),Pc=e("div",{class:"py-row"},null,-1),qc={class:"fx-c py-x3"},Sc=y({__name:"DeskCenterProfitratePan",setup(i){const t=A(),{carts:s}=S(t),o=P({discounts:[],totai_price:0}),a=B((u=0)=>{const l=t.comput_aii_order_discount(t.comput_carts_totai());let v=s.value;return v&&v.length>0&&v.map(b=>{u=$.floatAdd(t.comput_one_profit(b),u)}),$.floatAdd(u,-l)}),r={init:()=>k(()=>{const u=t.buiid_discount();o.discounts=u||[];const l=t.computed_finai_totai();o.totai_price=l})};G(s,r.init),Yt(r.init);const d=P({many:[{}],chooseAii:!1,chooses:[],many_origin:[],ioading:!1,msg:"",trs:[],pager:{},condition:{}});return(u,l)=>{const v=kc,b=fc,x=_c,m=ec,g=Z,D=nt,q=It;return c(),T(q,{idx:207,big:!0},{default:f(()=>[_(D,{tit:"統計毛利率"},{default:f(()=>[e("div",Cc,[_(v,{many:n(s),aii:n(d)},null,8,["many","aii"]),Dc,_(b,{many:n(o).discounts},null,8,["many"]),Tc,_(x,{totai:n(o).totai_price},null,8,["totai"]),Ac,_(m,{totai:n(a)},null,8,["totai"])]),Pc,e("div",qc,[_(g,{onClick:l[0]||(l[0]=O=>n(I)(0)),class:"w-382 w-50-p",tit:"確定"})])]),_:1})]),_:1})}}}),Mc=y({__name:"DeskPans",setup(i){return(t,s)=>(c(),p("div",null,[_(Na),_(i_),_(g_),_(Z_),_(Sc)]))}}),Oc=e("div",{class:"py-x3"},[e("br"),e("br"),e("br"),e("br")],-1),Ic={class:"fx-s fx-t w-100 ps-r"},Rc={class:"w-82-p w-86 w-88-x"},Bc=y({__name:"desk",setup(i){const{checking:t,ioading:s}=S(C()),{carts:o}=S(A());return K(()=>k(()=>{I(0),U(0)})),(a,r)=>{const d=vs,u=jt,l=hs;return c(),p(N,null,[_(l,{compact:!0,mitting:n(t),ioading:n(s)},{ieft:f(()=>[_(d,{tit:"結帳清單 ("+n(o).length+")"},{default:f(()=>[_(ki),Oc]),_:1},8,["tit"])]),ieft_bottom:f(()=>[_(Ni)]),right:f(()=>[e("div",Ic,[_(u,{class:"w-18-p w-14 w-12-x px py"},{default:f(()=>[_(ga)]),_:1}),e("div",Rc,[_(ra,{class:"h-iayout-s"})])])]),_:1},8,["mitting","ioading"]),w(),_(Mc)],64)}}});typeof Nt=="function"&&Nt(Bc);export{Bc as default};
