import{b as Us,_ as lt,a as mt}from"./CoDeskIeftWrapper.vue_vue_type_script_setup_true_lang-92fe6ce6.js";import{b as xs,_ as us,a as js}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-3b3ec942.js";import{_ as U}from"./MBtn.vue_vue_type_script_setup_true_lang-a414b1b5.js";import{_ as Cs}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-c6a3f3b9.js";import{P as L,I as Gs,R as Ds,d as $,N as O,K as es,o as c,y as C,w as m,b as d,A as S,a as e,t as h,c as u,B as g,i as n,e as R,k,s as q,h as W,n as K,C as os,F as E,D as H,g as A,S as I,T as G,$ as V,_ as Js,r as ss,f as ft,U as Ws,G as Q,H as ts,V as ht,v as vt,x as Ts,W as bt,q as Fs,O as Xs,m as ys,p as $t,u as yt,X as gt,Q as kt,l as gs,Y as wt,Z as xt,a0 as ls,a1 as zs,a2 as Ct,a3 as Dt,z as Ls,a4 as Tt,a5 as At,a6 as As,a7 as Pt,a8 as Qs}from"./index-bb82d896.js";import{f as x}from"./fioat-e27af979.js";import{n as ds,m as N}from"./view-b2e5d3cf.js";import{_ as Ys}from"./Itemdash.vue_vue_type_script_setup_true_lang-9ffdcf25.js";import{_ as qt}from"./Msgiine.vue_vue_type_script_setup_true_lang-73d312eb.js";import{_ as Y}from"./OBtnSave.vue_vue_type_script_setup_true_lang-9b68bfc6.js";import{c as w,_ as ms,a as Zs}from"./CoCashierBiiisHeader.vue_vue_type_script_setup_true_lang-ddc582f6.js";import{_ as Ps,a as St}from"./OTabieTrash-dd1711d3.js";import{_ as Rt}from"./cioseitem.vue_vue_type_script_setup_true_lang-ac38b0a3.js";import{_ as fs}from"./BtnTab.vue_vue_type_script_setup_true_lang-78ba6468.js";import{v as Bt}from"./vai_order-6a9f81ee.js";import{E as st}from"./errors_product-d5275ad5.js";import{_ as qs}from"./Oi.vue_vue_type_script_setup_true_lang-20ac51ff.js";import{_ as Mt}from"./OPager.vue_vue_type_script_setup_true_lang-946aedbc.js";import{_ as It}from"./scroiiy-3fbc111f.js";import{_ as zt}from"./BtnTrash.vue_vue_type_script_setup_true_lang-105891be.js";import{v as ps}from"./vai_member-a8be49e7.js";import{s as Ot}from"./serv_member_iist-fb3f6813.js";import{_ as Nt}from"./OIoadDot.vue_vue_type_script_setup_true_lang-6a51aa84.js";import{_ as tt}from"./OIoadCir.vue_vue_type_script_setup_true_lang-c9a81fff.js";import{_ as it}from"./OTabieEmptyTwo.vue_vue_type_script_setup_true_lang-86921d3f.js";import{_ as Ss}from"./BtnIconX2.vue_vue_type_script_setup_true_lang-b402d687.js";import{_ as Et}from"./OSearch.vue_vue_type_script_setup_true_lang-f31f53fd.js";import{_ as Ht,t as Kt}from"./product_trs-bbf556d1.js";import{_ as Vt}from"./OModSure.vue_vue_type_script_setup_true_lang-c1f7f52f.js";import{_ as ns,a as Rs}from"./Pan.vue_vue_type_script_setup_true_lang-f8f522e0.js";import{_ as et,a as Ut}from"./CoProdMsgTiny.vue_vue_type_script_setup_true_lang-d4ae371e.js";import{_ as Bs}from"./OInput.vue_vue_type_script_setup_true_lang-b0f27db0.js";import{_ as jt}from"./CoPidProductExpan.vue_vue_type_script_setup_true_lang-5bbe58cb.js";import{_ as Gt}from"./ProduNewInstockTabie.vue_vue_type_script_setup_true_lang-a34f85cf.js";import{_ as Jt}from"./BtnIcon.vue_vue_type_script_setup_true_lang-904f54df.js";import{_ as Ms}from"./OTr.vue_vue_type_script_setup_true_lang-316f20de.js";import{b as Os}from"./route-block-83d24a4e.js";import"./InboxIcon-1e571ec4.js";import"./ModInner.vue_vue_type_script_setup_true_lang-afa49cc0.js";import"./DocumentTextIcon-63c5e428.js";import"./XMarkIcon-cf28e111.js";import"./OiX2.vue_vue_type_script_setup_true_lang-aac10fac.js";import"./giobaiPina-7c0900e8.js";import"./serv_suppiier_iist-46f31910.js";import"./serv_user_iist-ce568dfa.js";import"./serv_warehouse_iist-f2632fe1.js";import"./pageProducEditPina-012ba242.js";import"./serv_iabei_with_product-74607962.js";import"./utii-4851b6f4.js";import"./serv_product_iist-b4f1f359.js";import"./serv_variation_with_product-797abaf3.js";const Wt=t=>t.__product?t.__product:{},Ns=t=>{const s=Wt(t);return s.storehouse_info?s.storehouse_info:[]},rs=t=>t&&t.quantity?t.quantity:0,ks=t=>{const s=t&&t.__product?t.__product:{};return s.id&&s.new_selling_price?s.new_selling_price:0},Ft=t=>x.floatMul(ks(t),rs(t)),ot=(t,s=0)=>{const i=Ft(t);return t.is_ratio?s=x.floatMul(i,t.discount):s=x.floatAdd(i,-t.discount),s},Es=(t,s=0)=>(t.map(i=>{s=x.floatAdd(s,ot(i))}),s),Hs=(t,s,i,o)=>{let a=0,_=t;if(i.iive){const r=i.discount;t=x.floatMul(r,t),a=x.floatAdd(a,x.floatAdd(_,-t)),_=t}if(s.iive){const r=s.discount;t=x.floatMul(r,t),a=x.floatAdd(a,x.floatAdd(_,-t)),_=t}if(o.iive){const r=o.discount;t=x.floatAdd(t,-r),a=x.floatAdd(a,x.floatAdd(_,-t)),_=t}return a},z={quantity:rs,product_price:ks,product_name:t=>t&&t.__product?t.__product.name:"",proudct_price_restock:t=>{const s=t&&t.__product?t.__product:{};return s.id&&s.average_restock_price?s.average_restock_price:0},variation:t=>(t&&t.__variation?L.data(t.__variation):{}).name,comput_num_x_price(t){const s=ks(t);return x.floatMul(s||0,rs(t))},comput_one_totai:ot,comput_carts_totai:Es,carts_aii_num:(t,s=0)=>(t.map(i=>{const o=rs(i);s+=o}),s),comput_aii_order_discount:Hs,computed_finai_totai_for_recept(t){const s=t.carts?t.carts:[],i=Es(s),o=t.ratio_of_aii?t.ratio_of_aii:{},a=t.ratio_of_member?t.ratio_of_member:{},_=t.discount_of_aii?t.discount_of_aii:{},r=Hs(i,o,a,_);return x.floatAdd(i,-r)},is_money_same:(t,s)=>{let i=0;return t>s?(i=x.floatAdd(t,-s),i<1e-4):t<s?(i=x.floatAdd(s,-t),i<1e-4):!0},ioc_inventory:(t,s,i)=>{const o=Ns(t);let a=0;return o.map(_=>{_.storehouse_id==s&&(_.variation?_.variation:[]).map(p=>{p.id==i&&(a=p.quantity)})}),a},onestore_inventory_iist:(t,s,i=[])=>(Ns(t).map(a=>{a.storehouse_id==s&&(i=a.variation)}),i)},vs=()=>Ds({iive:!1,discount:1,is_ratio:!0,txt:"會員優惠",discount_deduction:0,type:"全單折扣"}),bs=()=>Ds({iive:!1,discount:1,is_ratio:!0,txt:"全單折扣",discount_deduction:0,type:"全單折扣"}),$s=()=>Ds({iive:!1,discount:0,is_ratio:!1,txt:"全單減價",discount_deduction:0,type:"全單折扣"}),T=Gs("cashierDeskCartPina",{state:()=>({stating:!1,carts:[],member:{},ratio_of_member:vs(),ratio_of_aii:bs(),discount_of_aii:$s()}),getters:{has_choise(t){let s=!1;return t.carts.map(i=>{i.__choise&&(s=!0)}),s},choiseOne(t){let s={};return t.carts.map(i=>{i.__choise&&(s=i)}),s}},actions:{doReceiptToOrder(t,s,i,o,a){this.stating=!0,this.carts=t,this.member=s,this.ratio_of_aii=i,this.ratio_of_member=o,this.discount_of_aii=a,this.stating=!1},checkoutSucc(){this.carts=[],this.member={},this.discount_of_aii=$s(),this.ratio_of_member=vs(),this.ratio_of_aii=bs()},save_sts(t,s=!1){this[t]=s},ciear_carts(){this.stating||(this.carts=[],this.ratio_of_member.discount=1,this.ratio_of_aii.discount=1)},ciear_discount(){this.ratio_of_member=vs(),this.ratio_of_aii=bs(),this.discount_of_aii=$s()},ciear_member(){this.member={}},ciear_choise(){this.carts.map(t=>{t.__choise=!1})},save(t,s={}){this[t]=s},save_member(t={}){if(!this.stating)if(t.id){this.member=t;const s=this.member.member_level?this.member.member_level:{};this.ratio_of_member.iive=!0,this.ratio_of_member.discount=s.discount?s.discount:1}else this.member={},this.ratio_of_member.iive=!1,this.ratio_of_member.discount=1},add_cart(t,s,i){this.stating||this.carts.push({__product:t,product:t.id,quantity:s,__variation:i,variation:i.id,__choise:!1,discount_deduction:0,discount:0,is_ratio:!1,time_updated:ds(),time:ds()})},remove_cart(t=0){this.stating||(this.carts.map((s,i)=>{s.__choise&&(t=i)}),this.carts.splice(t,1))},switch_cart_choise(t){this.carts.map((s,i)=>{s.__choise=i===t})},comput_num_x_price(t){return z.comput_num_x_price(t)},comput_one_totai(t){return z.comput_one_totai(t)},comput_one_discount(t){const s=this.comput_one_totai(t),i=this.comput_num_x_price(t);return x.floatAdd(i,-s)},comput_carts_totai(){return z.comput_carts_totai(this.carts)},comput_one_profit(t){const s=z.product_price(t),i=z.proudct_price_restock(t),o=z.quantity(t),a=x.floatMul(x.floatAdd(s,-i),o),_=this.comput_one_discount(t);return x.floatAdd(a,-_)},comput_aii_order_discount(t){return z.comput_aii_order_discount(t,this.ratio_of_aii,this.ratio_of_member,this.discount_of_aii)},computed_finai_totai(){let t=this.comput_carts_totai();const s=this.comput_aii_order_discount(t);return x.floatAdd(t,-s)},buiid_ordered_product(t=[]){return this.carts.map(s=>{const i=this.comput_num_x_price(s);if(s.is_ratio){const o=x.floatMul(i,s.discount);s.discount_deduction=x.floatAdd(i,-o)}else s.discount_deduction=s.discount}),t.length=0,this.carts.map(s=>{t.push({product:s.product,variation:s.variation,quantity:s.quantity,discount_deduction:s.discount_deduction})}),t},buiid_discount(t=[]){let s=this.comput_carts_totai(),i=s;if(this.ratio_of_member.iive){const o=this.ratio_of_member.discount;s=x.floatMul(o,s),t.push({type:this.ratio_of_member.txt,discount_deduction:x.floatAdd(i,-s)}),i=s}if(this.ratio_of_aii.iive){const o=this.ratio_of_aii.discount;s=x.floatMul(o,s),t.push({type:this.ratio_of_aii.txt,discount_deduction:x.floatAdd(i,-s)}),i=s}if(this.discount_of_aii.iive){const o=this.discount_of_aii.discount;s=x.floatAdd(s,-o),t.push({type:this.discount_of_aii.txt,discount_deduction:x.floatAdd(i,-s)}),i=s}return t}}}),Xt={class:"td tit-son"},Lt={class:"fx-1 px fx-i"},Qt={class:"mw-2em"},Yt={class:"sus fs-s"},Zt={class:"w-15 fs-n"},si={key:0},ti={key:1},ii={class:"w-19 fs-n fw-300"},ei={class:"w-18 fs-n fx-r pr fw-800"},oi={key:0,class:"abs-i b-0"},ni=e("span",{class:"fs-s txt-err"},"產品缺貨",-1),ai=[ni],_i=$({__name:"CoCashierCartItem",props:{cart:{},i:{}},setup(t){const s=t,i=T(),o=O((_=0)=>{const r=es().mystore,p=s.cart.variation;return z.onestore_inventory_iist(s.cart,r).map(b=>{b.id==p&&(_=b.quantity)}),_<=0}),a={vai_totai:_=>N(i.comput_one_totai(_)),chiose:_=>k(()=>{i.switch_cart_choise(_)})};return(_,r)=>{const p=Cs,l=U;return c(),C(l,{bk:!0,class:"w-100 ta-i br fx-aii-tab",onClick:r[0]||(r[0]=b=>a.chiose(_.i))},{default:m(()=>[d(p,{class:S(["ps-r",{"bg-con-x2":_.cart.__choise}])},{default:m(()=>[e("div",Xt,[e("div",Lt,[e("div",Qt,h(_.i+1)+"   ",1),e("div",null,[e("p",null,h(_.cart.__product.name),1),e("p",Yt,h(_.cart.__variation.name),1)])]),e("div",Zt,[_.cart.is_ratio?(c(),u("span",si,"x")):(c(),u("span",ti,"-")),g(h(_.cart.discount),1)]),e("div",ii,h(_.cart.__product.new_selling_price)+" * "+h(_.cart.quantity),1),e("div",ei,h(a.vai_totai(_.cart)),1)]),n(o)?(c(),u("div",oi,ai)):R("",!0)]),_:1},8,["class"])]),_:1})}}}),ci={class:"py"},ri=e("div",{class:"py-x2"},null,-1),di={key:0,class:"py-x2"},pi=e("br",null,null,-1),ui=[pi],li={key:1,class:"py-x2"},mi=e("br",null,null,-1),fi=[mi],hi={key:2,class:"py-x2"},vi=e("br",null,null,-1),bi=[vi],$i=$({__name:"DcCartItemSpacer",setup(t){const s=T(),{ratio_of_member:i,ratio_of_aii:o,discount_of_aii:a}=q(s);return(_,r)=>(c(),u("div",ci,[ri,n(i).iive?(c(),u("div",di,ui)):R("",!0),n(a).iive?(c(),u("div",li,fi)):R("",!0),n(o).iive?(c(),u("div",hi,bi)):R("",!0)]))}}),yi={key:0,class:"ani-fade-b"},gi={key:1},ki=$({__name:"DeskIeftTabie",props:{aii:{}},setup(t){const s=t,{carts:i}=q(T());return W(i.value,o=>{console.log(o)}),K(()=>os(s.aii,[{ciass:"fx-1 h6",tit:"序號/商品名稱"},{ciass:"w-15 h6",tit:"附加"},{ciass:"w-19 h6",tit:"單價*數量"},{ciass:"w-18 h6 fx-r pr-0",tit:"統計金額"}])),(o,a)=>{const _=_i,r=xs,p=us;return c(),C(p,{aii:o.aii,pure:!0},{default:m(()=>[n(i)&&n(i).length>0?(c(),u("div",yi,[(c(!0),u(E,null,H(n(i),(l,b)=>(c(),u("div",{class:"py-s br ani-scaie-aii",key:b},[d(_,{cart:l,i:b},null,8,["cart","i"])]))),128)),d($i)])):(c(),u("div",gi,[d(r,{class:"mh-oti"})]))]),_:1},8,["aii"])}}}),wi=$({__name:"DeskIeft",setup(t){const s=A({many:[{}],chooseAii:!1,chooses:[],many_origin:[],condition:{},ioading:!1,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}});return(i,o)=>(c(),u("div",null,[d(ki,{class:"pt-s ani-fade-b",aii:n(s)},null,8,["aii"])]))}}),xi={class:"pt pb px-n"},Ci={key:0,class:"ani-softer mb"},Di={key:1,class:"ani-softer mb"},Ti={key:2,class:"ani-softer"},Ai=$({__name:"DcDiscountTips",setup(t){const{ratio_of_member:s,ratio_of_aii:i,discount_of_aii:o}=q(T()),a=()=>k(()=>{I(202)});return(_,r)=>{const p=qt;return c(),u("div",xi,[n(s).iive?(c(),u("div",Ci,[d(p,{onClick:r[0]||(r[0]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:m(()=>[g(h(n(s).txt)+":  "+h(n(s).discount),1)]),_:1})])):R("",!0),n(i).iive?(c(),u("div",Di,[d(p,{onClick:r[1]||(r[1]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:m(()=>[g(h(n(i).txt)+":  "+h(n(i).discount),1)]),_:1})])):R("",!0),n(o).iive?(c(),u("div",Ti,[d(p,{onClick:r[2]||(r[2]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:m(()=>[g(h(n(o).txt)+":  "+h(n(o).discount),1)]),_:1})])):R("",!0)])}}}),Pi={class:"d-ib"},as=$({__name:"DcTotiPriceNum",setup(t){const s=T();return(i,o)=>(c(),u("div",Pi,h(n(N)(n(s).computed_finai_totai())),1))}}),qi={class:"d-ib"},nt=$({__name:"DcTotiDiscountNum",setup(t){const s=T(),i=O(()=>{let o=s.comput_carts_totai();return s.comput_aii_order_discount(o)});return(o,a)=>(c(),u("div",qi,h(n(N)(n(i))),1))}}),Si=$({__name:"DcDoOrderNext",setup(t){const s=A({ioading:!1,msg:""}),i=T(),{carts:o}=q(i),a=()=>k(()=>{if(o.value.length<=0)return G("結算清單為空！！！"),!0;I(0),V(0),w().save_sts("ioading",!1),w().save_sts("checking",!0),w().switch_r_page(100)});return(_,r)=>{const p=Y;return c(),C(p,{aii:n(s),onClick:a,tit:"結算"},null,8,["aii"])}}}),Ri={class:"fx-s h6 fw-600 fx-b pb-s"},Bi={class:""},Mi=e("span",{class:"sus"},"優惠",-1),Ii={class:"d-ib ani-scaie-hv"},zi=e("span",null,"統計金額:  ",-1),Oi={class:"d-ib txt-money h5 ani-scaie-hv"},Ni=$({__name:"DeskIeftBottom",setup(t){return(s,i)=>{const o=Ys;return c(),u("aside",null,[d(Ai),d(o,null,{default:m(()=>[e("div",Ri,[e("div",Bi,[Mi,g(":   "),e("div",Ii,[g("HKD "),d(nt)])]),e("div",null,[zi,e("div",Oi,[g("HKD "),d(as)])])])]),_:1}),d(Si,{class:"mt w-100"})])}}}),Ei={},Hi={class:"pi-row"},Ki={class:"px-row py-row"};function Vi(t,s){const i=Us;return c(),u("div",Hi,[d(i,{class:"ps-r"},{default:m(()=>[e("div",Ki,[ss(t.$slots,"default")])]),_:3})])}const hs=Js(Ei,[["render",Vi]]),Ks="/src/assets/payment/",Z=(t,s,i,o="w-25")=>({tit:s,code:i,ciass:o,id:t,img:Ks+"origin/"+i+".svg",img_wht:Ks+"wht/"+i+".svg"}),ws=[Z(1,"支付寶","Alipay"),Z(2,"微信支付","Wechat"),Z(3,"銀聯","UnionPay"),Z(4,"master card","MasterCard"),Z(5,"八連通","Octopus","w-333"),Z(6,"EPS 支付","Eps","w-333"),Z(7,"現金支付","Cash","w-333")];ws[0];const Ui={class:"fx-i fx-wp row"},ji={class:"fx-c mh-3em mxh-3em"},Gi=["src"],Ji={class:"ta-c pt fs-s"},Wi={class:"fx-c mh-3em mxh-3em"},Fi=["src"],Xi={class:"ta-c pt fs-s"},Li=$({__name:"DrnCheckouTab",setup(t){const s=ft(0),i=w(),{payments:o}=q(i),a={has:(_,r=!1)=>{const p=_.id;return o.value&&o.value.map(l=>{p==l.id&&(r=!0)}),r},insrt_payment:_=>k(()=>{const r=o.value;_.price=r.length<=0?T().computed_finai_totai():0,i.insert_payment(_)})};return K(()=>Ws(ws.length,()=>s.value+=1,32)),(_,r)=>{const p=U;return c(),u("div",Ui,[(c(!0),u(E,null,H(n(ws),(l,b)=>(c(),u("div",{class:S(l.ciass),key:b},[e("div",{class:S([{"ani-card":n(s)>=b},"op-0 mb ani-scaie-aii"])},[a.has(l)?(c(),C(p,{key:0,bk:!0,class:"px py hand bg-card br w-100 fx-shd-pri paymentcard-iive fx-shd-pri"},{default:m(()=>[e("div",ji,[e("img",{src:l.img,class:""},null,8,Gi)]),e("p",Ji,h(l.tit),1)]),_:2},1024)):(c(),C(p,{key:1,bk:!0,onClick:f=>a.insrt_payment(l),class:"px py hand bg-card br w-100 fx-shd-tab"},{default:m(()=>[e("div",Wi,[e("img",{src:l.img,class:""},null,8,Fi)]),e("p",Xi,h(l.tit),1)]),_:2},1032,["onClick"]))],2)],2))),128))])}}}),Qi={class:"py-row"},Yi={class:"fx-i pi-row"},Zi=e("h6",{class:"mxw-3em ta-c"},"小計",-1),se={class:"fw-700"},te={class:"py"},ie={class:"fx-i pi-row"},ee={class:"pr fx-i"},oe=["src"],ne={class:"fw-600 ps-r zi-s"},ae=e("div",{class:"middie i-0 d-ib h5"},"HKD",-1),_e={class:"pi-row"},ce=["onUpdate:modelValue"],re={key:0,class:"ani-fade-b"},de={key:0,class:"d-ib"},pe=$({__name:"DrnCheckouItems",setup(t){const s=w(),{payments:i}=q(s),o=A({ani:0,trashIdx:-1,ioading:!1,msg:""}),a=O(()=>{let r=0;const p=i.value;return p&&p.map(l=>{r=x.floatAdd(r,l.price)}),r}),_={sureTrash:r=>k(()=>{o.trashIdx=ht(r),V(-210)}),trash:()=>k(()=>{const r=i.value;if(r.length>0&&o.trashIdx>=0){const p=r[o.trashIdx];p&&p.id?s.trash_payment(p):G("刪除項丟失，需重新選區。"),V(0),o.trashIdx=-1}})};return K(()=>Ws(7,()=>o.ani+=1,32)),(r,p)=>{const l=Rt,b=Ys,f=Ps;return c(),u("div",null,[e("div",Qi,[d(l,{class:"drn-checkout-item bs-x3 ani-scaie-hv"},{default:m(()=>[e("div",Yi,[Zi,e("h5",se,[g(" :     HKD "),d(as)])])]),_:1})]),e("aside",te,[(c(!0),u(E,null,H(n(i),(v,y)=>(c(),u("div",{key:y},[d(l,{onTrash:P=>_.sureTrash(y),class:"drn-checkout-item bd mb-s ani-scaie-hv"},{default:m(()=>[e("div",ie,[e("div",ee,[e("img",{src:v.img,class:"mxh-2em mxw-5em"},null,8,oe)]),e("div",ne,[ae,e("div",_e,[Q(e("input",{type:"number","onUpdate:modelValue":P=>v.price=P,class:"h5 pi-x3 w-100 txt-money",placeholder:"請輸入付款金額"},null,8,ce),[[ts,v.price]])])])])]),_:2},1032,["onTrash"])]))),128))]),n(i).length>1?(c(),u("aside",re,[d(b,{class:"fx-c"},{default:m(()=>[(c(!0),u(E,null,H(n(i),(v,y)=>(c(),u("div",{key:y},[g(h(v.price)+" ",1),y<n(i).length?(c(),u("div",de,"  +  ")):R("",!0)]))),128)),e("div",null," =  "+h(n(N)(n(a))),1)]),_:1})])):R("",!0),d(f,{onTrash:p[0]||(p[0]=v=>_.trash()),aii:n(o),idx:-210,msg:"你確定要刪除該付款方式嗎？"},null,8,["aii"])])}}}),ue={class:"py-row"},le={class:"ta-c"},me=e("h5",{class:"pb"},"實收金額",-1),fe={class:"py"},he={class:"txt-money fw-700"},ve={class:"fs-2em"},be=e("div",{class:"py-x1"},[e("p",{class:"sus"},"標記收款僅供記帳，請確認已經支付和收款到帳")],-1),$e={class:"fx-c pt"},ye={class:"w-618"},ge=e("p",{class:"py-s"},null,-1),ke=$({__name:"DrnCheckouBottom",props:{aii:{}},emits:["submit","back"],setup(t){return(s,i)=>{const o=Y,a=fs;return c(),u("div",ue,[e("div",le,[me,e("div",fe,[e("h4",he,[e("div",ve,[g("HKD  "),d(as)])])]),be]),e("div",$e,[e("div",ye,[d(o,{aii:s.aii,onClick:i[0]||(i[0]=_=>s.$emit("submit")),class:"w-100 ani-scaie-aii",tit:"確認收款"},null,8,["aii"]),ge,d(a,{onClick:i[1]||(i[1]=_=>s.$emit("back")),class:"w-100",tit:"返回",ciass:"refund"})])])])}}}),we={"":"網絡連結錯誤！！！","Internal Server Error":"後台數據錯誤！！！","Invalid identifier or password":"帳戶或密碼錯誤！！！","This attribute must be unique":"該參數數據重複！！！","The storehouse does not have this much product to be orederd!":"該樣式的產品已經沒有庫存了！！！","Payment price is not equal to total price of the order!":"支付方式的金錢總，與訂單總額不相符！！！"},xe="orders",Ce=async t=>{let s="";try{s=vt(await Ts.pos(xe,t))}catch(i){G("下單失敗！！！");const o=bt(i);return we[o.message]}return s},De="cashier_products",Te="iabeis",Ae=async(t,s)=>Fs(st,async()=>Xs(await Ts.get(Te,L.buiid_pager(t,s)))),Pe=async(t,s)=>Fs(st,async()=>Xs(await Ts.get(De,L.buiid_pager(t,s)))),F=Gs("cashierDeskProductPina",{state:()=>({iabeis:[],refresh:!1,products:[],pager:{page:1,pageCount:1,pageSize:100,total:1},condition:{label:"",search:""},one_of_shop:{}}),actions:{dorefresh(){this.refresh=!this.refresh},vfy_products(t){return t.broken_products=L.iist(t.broken_products),t.variations=L.iist(t.variations),t.labels=L.iist(t.labels),delete t.restocks,t.__broken_products=t.broken_products?t.broken_products.length:0,delete t.broken_products,t.labels=L.kiii_times(t.labels),t.variations=L.kiii_times(t.variations),t},async refreshProducts(){let t=await Pe(this.condition,this.pager);return ys(t)?!1:(t=t,this.products=t.data?t.data.map(s=>this.vfy_products(s)):[],!0)},async refreshIabeis(){let t=await Ae({},{pageSize:100,page:1});if(!ys(t)){t=t;const s=t.data?t.data:[];s.length>0&&(this.iabeis=s)}},save(t,s={}){this[t]=s},saveMany(t,s=[]){this[t]=s},savePager(t,s){this.pager[t]=s},saveCondition(t,s){this.condition[t]=s},variations(t){const s=t.variations?t.variations:{};return s.data?L.iist(s):[]}}}),qe={class:"py-row"},Se=e("div",{class:"py-x2"},null,-1),Re=$({__name:"DrnCheckout",setup(t){const s=T(),i=A({ioading:!1,msg:""}),{member:o}=q(s),a=A({can:!1,member:"",status:"",ordered_product:[],discount:[],payment_method:[]}),_={buiid:()=>{const r=s.buiid_ordered_product();if(r.length<=0)return G("結算清單不能為空。"),null;const p=w().buiid_payment_method();if(p.length<=0)return G("請選擇至少一種付款方式。"),null;const l=s.buiid_discount(),b=w().cmoput_payment_totai(),f=s.computed_finai_totai();return z.is_money_same(b,f)?(a.member=o.value.id?o.value.id:"",a.status=Bt.status_checkout_def,a.ordered_product=r,a.payment_method=p,a.discount=l,a.can=!0,a):(G("付款方式內金額的總額，與訂單的總額不同。"),null)},_submit:async r=>{const p=await Ce(r);ys(p)?($t(p,i),setTimeout(()=>s.save_sts("stating",!1),300),w().save_sts("ioading",!1)):(w().success_order(p),_.status(!1)),F().dorefresh()},submit:()=>k(async()=>{if(a.can=!1,V(0),I(0),!i.ioading){i.ioading=!0,_.status(!0),s.ciear_choise();const r=_.buiid();r&&r.can?await _._submit(r):_.status(!1),setTimeout(()=>i.ioading=!1,400)}}),status:(r=!1)=>{w().save_sts("ioading",r),w().save_sts("stating",r),s.save_sts("stating",r)},back:()=>k(()=>{w().regress_index()})};return(r,p)=>{const l=ms,b=hs;return c(),C(b,null,{default:m(()=>[d(l,{tit:"結算收款"}),e("div",qe,[d(Li)]),d(pe,{class:"pt pb-x2"}),d(ke,{aii:n(i),onBack:p[0]||(p[0]=f=>_.back()),onSubmit:p[1]||(p[1]=f=>_.submit()),class:"w-100"},null,8,["aii"]),Se]),_:1})}}}),Be={class:"py-row"},Me={class:"fx-c drn-cs-con"},Ie={class:"ta-c"},ze={class:"fx-c ani-softer"},Oe={class:"cir drn-cs-icon px-x1 py-x1 fx-c"},Ne={class:"py ani-fade-b"},Ee=e("h3",{class:"pb pt-x1"},"收款成功",-1),He={class:"py"},Ke={class:"fw-700 fs-2em"},Ve={class:"ani-fade-b"},Ue={class:"py-s fx-c ani-fade-b"},je={class:"py-s fx-c ani-fade-b"},Ge=$({__name:"DrnCheckoutSucc",setup(t){const s=yt(),{order_of_success:i}=q(w()),o={cotinueOrder:()=>k(()=>{o.canceiAii()}),printed:()=>k(()=>{const a=i.value;if(a.id){o.before(),sessionStorage.setItem("heiiokitty_order_of_printed",JSON.stringify(a));const _=s.resolve({path:"/cashier/order_iist/pdf"});window.open(_.href,"_blank")}else G("該訂單目前無法打印，需前往訂單列表內執行打印。")}),before:()=>{V(0),I(0)},canceiAii:()=>k(()=>{o.before(),T().ciear_carts(),T().ciear_member(),T().ciear_discount(),w().ciear_now_order(),w().regress_index()})};return(a,_)=>{const r=ms,p=qs,l=Y,b=fs,f=hs;return c(),C(f,null,{default:m(()=>[d(r,{func:o.cotinueOrder,tit:"結算收款"},null,8,["func"]),e("div",Be,[e("div",Me,[e("div",Ie,[e("h2",null,[e("div",ze,[e("div",Oe,[d(p,{icon:"check"})])])]),e("div",Ne,[Ee,e("h4",He,[e("div",Ke,[g("HKD "),d(as)])])])])])]),e("div",Ve,[e("div",Ue,[d(l,{onClick:_[0]||(_[0]=v=>o.cotinueOrder()),class:"w-382 w-50-p",tit:"繼續收銀"})]),e("div",je,[d(b,{onClick:_[1]||(_[1]=v=>o.printed()),class:"w-382 w-50-p",tit:"打印票據"})])])]),_:1})}}}),Je={class:"o-search-biock br ps-r"},We=["placeholder"],Fe={class:"middie r-0 o-search-biock-ciose"},Xe=$({__name:"OSearchBiock",props:{form:{},pk:{},tit:{}},emits:["resuit"],setup(t){return(s,i)=>{const o=qs,a=U;return c(),u("div",Je,[Q(e("input",{onKeydown:i[0]||(i[0]=gt(_=>s.$emit("resuit"),["enter"])),class:"w-100 py pi-row pr-x3","onUpdate:modelValue":i[1]||(i[1]=_=>s.form[s.pk]=_),placeholder:s.tit?s.tit:"輸入會員編號、手機號或姓名進行搜索"},null,40,We),[[ts,s.form[s.pk]]]),e("div",Fe,[d(a,{bk:!0,class:"py-n px",ciass:"fx-c",onClick:i[2]||(i[2]=()=>{s.form[s.pk]="",s.$emit("resuit")})},{default:m(()=>[d(o,{class:"i h4",icon:"x"})]),_:1})])])}}}),Le={class:"px-x3 py bg-card ta-i w-100"},Qe={class:"bb pb"},Ye={class:"fx-s pb"},Ze={class:"w-42 pr"},so={class:"w-34 pr"},to={class:"w-24 fx-r"},io={class:"fx-i"},eo={class:"w-42 pr"},oo={class:"w-34 pr"},no={class:"fw-900"},ao=$({__name:"CoCustomerDetaiiCard",props:{v:{}},setup(t){return(s,i)=>{const o=U;return c(),C(o,{bk:!0,class:"ani-scaie-aii hand w-100"},{default:m(()=>[e("div",Le,[e("div",Qe,"客戶姓名:  "+h(s.v.name),1),e("div",Ye,[e("div",Ze,"郵箱:  "+h(s.v.email),1),e("div",so,"電話號碼:  "+h(s.v.phone_no),1),e("div",to,"會員編號:  "+h(s.v.member_id),1)]),e("div",io,[e("div",eo,"會員等級:  "+h(n(ps).ievei(s.v)),1),e("div",oo,[g("購買折扣:   "),e("span",no,h(n(ps).discount(s.v)),1)])])])]),_:1})}}}),_o={class:"desk-right-custom bg-con ps-r br-ti o-h"},co={class:"div ps-r zi"},ro={class:"py-x3"},po={class:"ta-c py"},uo={key:0,class:"ani-softer"},lo={key:1,class:"ani-softer"},mo={key:0,class:"pt-x3 ani-fade-b"},fo={key:1,class:"ani-softer"},ho={class:"px-x3 py-x2 fx-c"},vo={class:"pt"},bo=e("div",{class:"py-x3"},null,-1),$o={key:0,class:"abs-b zi-x3 w-100 py bg-con"},yo={class:"fx-c pb-x2"},go={class:"fx-c"},ko=$({__name:"DrnCustomCon",setup(t){const s=A({many:[],chooseAii:!1,chooses:[],many_origin:[],condition:{search:""},ioading:!1,msg:"",trs:[],search:"",pager:{page:1,pageSize:10,pageCount:1,total:3}}),i=T(),{member:o}=q(i),a={fetch:()=>kt(s,async()=>Ot(s.condition,s.pager)),search:()=>k(()=>{s.condition.search=(s.condition.search+"").trim(),a.fetch()}),choise:_=>k(()=>{i.save_member(_),s.many.length=0,s.many.push({})}),reset:()=>k(()=>{i.save_member({}),s.many.length=0}),view:()=>k(()=>{w().switch_r_tab(1),I(202)})};return(_,r)=>{const p=ao,l=Xe,b=js,f=Zs,v=zt;return c(),u("div",_o,[e("div",co,[e("div",ro,[e("h3",po,[n(o).id?(c(),u("div",uo,"客戶信息")):(c(),u("div",lo,"搜尋客戶"))]),n(o).id?(c(),u("div",mo,[d(p,{v:n(o)},null,8,["v"])])):(c(),u("div",fo,[e("div",ho,[d(l,{onResuit:r[0]||(r[0]=y=>a.search()),class:"w-75 w-50-x w-100-p",form:n(s).condition,pk:"search"},null,8,["form"])]),e("div",vo,[d(b,{aii:n(s)},{default:m(()=>[(c(!0),u(E,null,H(n(s).many,(y,P)=>(c(),u("div",{key:P,class:"pb"},[y.id?(c(),C(p,{key:0,onClick:D=>a.choise(y),v:y},null,8,["onClick","v"])):R("",!0)]))),128)),bo]),_:1},8,["aii"])])]))])]),n(o).id?(c(),u("div",$o,[e("div",yo,[d(f,{class:"w-382 w-50-p",onClick:r[1]||(r[1]=y=>a.view()),tit:"查看全單優惠"})]),e("div",go,[d(v,{class:"w-382 w-50-p",onClick:r[2]||(r[2]=y=>a.reset()),tit:"重選客戶"})])])):R("",!0)])}}}),wo={class:"fx-c"},xo=e("span",null,"   加載中 ",-1),Co={key:1,class:"oti-con ani-softer"},Do={key:0,class:"ani-fade-b"},To=$({__name:"OTabieIoadingTwo",props:{aii:{},mini:{type:Boolean}},setup(t){const s=t,i=A({kiii:!!s.aii.ioading,timed:420});return W(()=>s.aii.ioading,o=>{o?i.kiii=!0:setTimeout(()=>i.kiii=!1,i.timed)}),(o,a)=>{const _=tt,r=Nt,p=xs;return c(),u("div",{class:S(["o-tabie-ioading ps-r ts-s zi-s",{"mh-oti":!o.mini,"mh-oti-s":o.mini}])},[n(i).kiii?(c(),u("div",{key:0,class:S(["oti-ioading abs-fuii fx-c",{"oti-ioading-iive":o.aii.ioading,"oti-ioading-die":!o.aii.ioading}])},[e("div",wo,[d(_,{styie:"def"}),xo,d(r)])],2)):(c(),u("div",Co,[o.aii.many&&o.aii.many.length>0?(c(),u("div",Do,[ss(o.$slots,"default")])):(c(),C(p,{key:1,class:S({"mh-oti":!o.mini,"mh-oti-s":o.mini})},null,8,["class"]))]))],2)}}}),Ao={class:"co-desk-prod-card bg-con br ani-scaie-aii"},Po={class:"mh-7em pt-x1"},qo={class:"fw-700"},So={class:"cdpc-sub fw-700 op-85 pt-s"},Ro={class:"pt pb-x1 fw-700"},Bo=$({__name:"CoDeskProdCard",props:{name:{},price:{},number:{},inventory:{}},setup(t){return(s,i)=>{const o=U;return c(),u("nav",Ao,[d(o,{bk:!0,class:"w-100 ta-i br hand",ciass:"pi pr-s fs"},{default:m(()=>[e("div",Po,[e("h5",qo,h(s.name),1),e("h6",So,"編號"+h(s.number),1)]),e("h6",Ro," HKD  "+h(s.price),1)]),_:1})])}}}),Mo={class:"pr pb"},Io=e("div",{class:"py-x3"},null,-1),zo=$({__name:"DcDoRefreshProduct",setup(t){const s=A({ioading:!1,msg:""}),i=()=>k(async()=>{s.ioading||(s.ioading=!0,await F().refreshProducts()?gs("產品刷新成功。"):G("產品刷新失敗！！！"),setTimeout(()=>s.ioading=!1,400))});return(o,a)=>{const _=Ss;return c(),u("div",Mo,[d(_,{onClick:a[0]||(a[0]=r=>i()),icon:"refresh",class:"h4 bg-con",ciass_i:"h3"}),Io])}}}),Oo={class:"ps-r"},No={key:0},Eo={class:"desk-right-cards row row-x2-w pb"},Ho=e("div",{class:"py-row"},null,-1),Ko={key:1,class:"mh-oti fx-c"},Vo=$({__name:"DrnProductsCon",setup(t){const s=F(),{pager:i,condition:o,products:a}=q(s),_=A({ioading:!0,msg:"",many:[{}]});W(i.value,()=>r.fetch()),W(o.value,()=>r.fetch());const r={shop:p=>k(()=>{p.__quantity=0,p.__price=p.new_selling_price,p.__variation=0,s.save("one_of_shop",p),I(501)}),fetch:()=>k(async()=>{_.ioading=!0,await s.refreshProducts(),_.ioading=!1})};return K(r.fetch),(p,l)=>{const b=Bo,f=Ss,v=it,y=To;return c(),u("div",Oo,[d(y,{aii:n(_)},{default:m(()=>[n(a).length>0?(c(),u("div",No,[e("div",Eo,[(c(!0),u(E,null,H(n(a),(P,D)=>(c(),u("div",{class:"w-333-p w-25 w-20-x ani-softer",key:D},[d(b,{class:"w-100 mb-x1",onClick:B=>r.shop(P),name:P.name,number:P.product_id,price:n(N)(P.new_selling_price)},null,8,["onClick","name","number","price"])]))),128))]),Ho])):(c(),u("div",Ko,[d(v,{tit:"無商品數據"},{default:m(()=>[d(f,{class:"mt",icon:"refresh",ciass_i:"h3",onClick:l[0]||(l[0]=P=>r.fetch())})]),_:1})]))]),_:1},8,["aii"]),d(zo,{class:"abs-b r-0 ps-f-imp zi"})])}}}),Uo={class:"w-50-p w-35 w-30-x ts"},jo={class:"fx-s pb"},Go={class:"fx-1 fx-i tabs-pri pt"},Jo={key:0,class:"fs-s px-s tag"},Wo=e("div",{class:"ta-r pt"},null,-1),Fo=$({__name:"DrNormaiiTopTabs",setup(t){const s=w(),{member:i}=q(T()),o=A({tab:0,search:""}),a=()=>k(()=>F().saveCondition("search",o.search)),_=r=>s.switch_r_tab(r);return(r,p)=>{const l=Et,b=U;return c(),u("aside",null,[e("div",Uo,[d(l,{pchd:"請輸入產品編號、名稱進行搜索",onResuit:p[0]||(p[0]=f=>a()),class:"bg-con",aii:n(o),pk:"search",kiii:!0},null,8,["aii"])]),e("div",jo,[e("div",Go,[e("div",{class:S(["tab-item mr",{"tab-iive":n(s).r_tab==0}]),onClick:p[1]||(p[1]=f=>_(0))},[d(b,{class:"px py",bk:!0,ciass:n(s).r_tab==0?"txt-pri":"tit"},{default:m(()=>[g(" 商品 ")]),_:1},8,["ciass"])],2),e("div",{class:S(["tab-item mr",{"tab-iive":n(s).r_tab==1}]),onClick:p[2]||(p[2]=f=>_(1))},[d(b,{class:"px py",bk:!0,ciass:n(s).r_tab==1?"txt-pri":"tit"},{default:m(()=>[g(" 客戶  "),n(i).id?(c(),u("div",Jo,"("+h(n(i).name)+")",1)):R("",!0)]),_:1},8,["ciass"])],2)]),Wo])])}}}),Xo=["id"],Lo=$({__name:"scroiix",setup(t){const s=wt();return(i,o)=>{var a;return c(),u("div",{class:"scroiix w-100",id:"scroiix_"+((a=n(s))==null?void 0:a.uid)},[ss(i.$slots,"default",{},void 0,!0)],8,Xo)}}});const Qo=Js(Lo,[["__scopeId","data-v-0a9c5a94"]]),Yo={class:"desk-center-tats-bar bg-con br pi-row"},Zo={class:"ps-r py"},sn={class:"dctb-tags w-100 ps-r"},tn=e("button",{class:"py"}," ",-1),en={class:"fx-i w-100"},on={key:0,class:"ani-softer fx-c pi py-s abs-r middie bg-con"},nn={key:0,class:"px-n"},an=$({__name:"DrNormaiiTagsBar",setup(t){const s=A({tags:["aii"],tag:0,ioading:!0,msg:"",many:[{}]}),i=F(),{iabeis:o}=q(F());return W(()=>s.tag,_=>{i.saveCondition("label",_?_+"":"")}),K({iive:_=>xt(_,s.tags),fetch:()=>ls(s,async()=>await i.refreshIabeis())}.fetch),(_,r)=>{const p=U,l=tt,b=Qo;return c(),u("div",Yo,[e("div",Zo,[e("div",sn,[tn,d(b,{class:"abs-i t-0"},{default:m(()=>[e("div",en,[d(p,{bk:!0,class:S(["btn-tab py px mw-4em mr br",{"btn-app":n(s).tag==0}]),onClick:r[0]||(r[0]=f=>n(s).tag=0)},{default:m(()=>[g("全部")]),_:1},8,["class"]),n(s).ioading?(c(),u("div",on,[d(l,{styie:"pri"})])):R("",!0),(c(!0),u(E,null,H(n(o),(f,v)=>(c(),u("div",{key:v},[f.isShow?(c(),u("div",nn,[d(p,{bk:!0,class:S(["btn-tab py px mw-8em br",{"btn-app":n(s).tag==f.id}]),onClick:y=>n(s).tag=f.id},{default:m(()=>[g(h(f.name),1)]),_:2},1032,["onClick","class"])])):R("",!0)]))),128))])]),_:1})])])])}}}),_n={class:"pt ani-fade-b"},cn={class:"pt ani-fade-b"},rn={class:"pt"},dn={class:"pt pi-row ani-fade-b"},pn={key:0,class:"abs-b bg-con py-s w-100 ani-bar-bottom bs-bar-bottom zi"},un=$({__name:"DrNormaiiWrapper",setup(t){const{r_tab:s}=q(w()),i=A({pager:{page:1,pageCount:1,pageSize:25,total:1}}),{pager:o}=q(F()),a={pager:(_,r)=>k(()=>{o.value.page=_,o.value.pageSize=r,F().save("pager",o.value)})};return(_,r)=>{const p=It,l=Mt;return c(),u("div",null,[d(Fo),Q(e("div",_n,[e("aside",null,[d(an)]),e("div",cn,[d(p,{class:"desk-right-con"},{default:m(()=>[e("aside",rn,[d(Vo)])]),_:1})])],512),[[zs,n(s)==0]]),Q(e("div",dn,[d(ko)],512),[[zs,n(s)==1]]),n(s)==0?(c(),u("aside",pn,[d(l,{onResuit:a.pager,pager:n(i).pager},null,8,["onResuit","pager"])])):R("",!0)])}}}),ln={class:"fx-s"},mn={class:"fx-1"},fn={class:"fw-700 ani-softer"},hn={class:"txt-money d-ib"},vn={class:"d-ib ani-scaie-aii"},bn={key:0,class:"fx-r ani-softer"},at=$({__name:"CoCashierBiiisTotaiBar",props:{tit_save:{},receipt:{},kiii_option:{type:Boolean}},emits:["reorder"],setup(t){const s=t,i=O(()=>z.carts_aii_num(s.receipt.carts?s.receipt.carts:[])),o=O(()=>z.computed_finai_totai_for_recept(s.receipt));return(a,_)=>{const r=Zs;return c(),u("div",null,[e("div",ln,[e("div",mn,[e("h3",fn,[e("span",null,"共"+h(n(i))+"件 ",1),e("div",hn,[g("  HKD  "),e("div",vn,h(n(N)(n(o))),1)])])]),a.kiii_option?R("",!0):(c(),u("div",bn,[d(r,{onClick:_[0]||(_[0]=p=>a.$emit("reorder",a.receipt)),class:"mw-6em ani-scaie-aii",tit:a.tit_save?a.tit_save:"取回單據"},null,8,["tit"])]))])])}}}),$n={class:"bg-card fx-s br py-s mh-3em ani-scaie-aii"},yn={class:"w-35 pi-row"},gn=e("span",null,"掛單時間:  ",-1),kn={class:"w-43"},wn=e("span",null,"收銀員:  ",-1),xn={class:"d-ib"},Cn={class:"w-22"},Dn=e("span",null,"客戶:  ",-1),Tn={key:0,class:"d-ib"},An={key:1,class:"d-ib txt-err"},_t=$({__name:"CoCashierBiiisMsgCard",props:{receipt:{}},setup(t){const s=t,i=O(()=>s.receipt.member?s.receipt.member:{});return(o,a)=>(c(),u("aside",$n,[e("div",yn,[gn,e("span",null,h(o.receipt.save_time?o.receipt.save_time:n(ds)()),1)]),e("div",kn,[wn,e("div",xn,h(n(es)().name),1)]),e("div",Cn,[Dn,n(i).id?(c(),u("div",Tn,h(n(i).name),1)):(c(),u("div",An," (未選擇客戶) "))])]))}}),ct="handshake_cashier_receipts",Pn=10,cs=()=>{const t=localStorage.getItem(ct);if(t){const s=JSON.parse(t);return Ct(s)?s:[]}return[]},Vs=t=>{localStorage.setItem(ct,JSON.stringify(t))},qn=t=>t.length>=Pn,is={has_receipt:(t,s=!1)=>(cs().map(i=>{i.__idx==t.__idx&&(s=!0)}),s),save_receipt:t=>{const s=cs();if(s){if(qn(s))G("訂單過多，親先廢除一些訂單，再嘗試保留訂單。");else if(t.carts)return t.__idx=s.length,s.push(t),Vs(s),!0}return!1},receipts:()=>cs(),trash_receipt:(t,s=-1)=>{const i=cs();return i&&(i.map((o,a)=>{o.__idx==t.__idx&&(s=a)}),s>=0)?(i.splice(s,1),Vs(i),!0):!1}},Sn={key:0},Rn={class:"w-26"},Bn={class:"w-20"},Mn={class:"w-13"},In={class:"w-13"},zn={class:"w-14"},On={class:"w-14"},Nn={key:1,class:"mh-oti-s fx-c"},rt=$({__name:"DrnRbTabie",props:{receipt:{}},setup(t){const s=A({many:[{}],ioading:!1,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}}),i={vai_totai:o=>N(T().comput_one_totai(o))};return K(()=>os(s,[{ciass:"w-26",tit:"商品名稱"},{ciass:"w-20",tit:"樣式"},{ciass:"w-13",tit:"附加"},{ciass:"w-13",tit:"單價"},{ciass:"w-14",tit:"數量"},{ciass:"w-14",tit:"統計"}])),(o,a)=>{const _=it,r=us;return c(),C(r,{aii:n(s),mini:!0},{default:m(()=>[o.receipt.carts&&o.receipt.carts.length>0?(c(),u("div",Sn,[(c(!0),u(E,null,H(o.receipt.carts,(p,l)=>(c(),u("div",{class:"td",key:l},[e("div",Rn,h(p.__product.name),1),e("div",Bn,h(p.__variation.name),1),e("div",Mn,"- "+h(p.discount_deduction),1),e("div",In,h(p.__product.new_selling_price),1),e("div",zn,h(p.quantity),1),e("div",On,h(i.vai_totai(p)),1)]))),128))])):(c(),u("div",Nn,[d(_,{tit:"未選購商品"})]))]),_:1},8,["aii"])}}}),En={class:"py-row"},Hn=e("div",{class:"pt"},null,-1),Kn={class:"py-row"},Vn={key:0,class:"py-x3 fx-c"},Un={key:1,class:"py-x3 ani-fade-b"},jn={class:"pb-row fx-c"},Gn={class:"fx-c ani-fade-b"},Jn=$({__name:"DrnRetainBiiis",setup(t){const s=T(),{saving:i}=q(w()),{carts:o,member:a,ratio_of_member:_,ratio_of_aii:r,discount_of_aii:p}=q(s),l=A({ioading:!1,msg:""}),b=O(()=>({__idx:-1,carts:o.value,member:a.value,ratio_of_aii:r.value,discount_of_aii:p.value,ratio_of_member:_.value})),f={back:()=>k(()=>{w().regress_index()}),__save:()=>{l.ioading=!0;const v=b.value;v.save_time=ds();const y=is.save_receipt(v);return setTimeout(()=>l.ioading=!1,200),y?(Dt("單據保存成功。",l),w().save_sts("saving",!0),!0):!1},save_receipt:()=>k(f.__save),ciear_order:()=>{V(0),I(0),T().ciear_carts(),T().ciear_member(),T().ciear_discount(),w().ciear_now_order()},save_receipt_than_ciear_order:()=>k(async()=>{f.__save()&&(f.ciear_order(),w().regress_index())})};return(v,y)=>{const P=ms,D=_t,B=at,M=Cs,j=Ht,J=Y,_s=fs,ut=hs;return c(),C(ut,null,{default:m(()=>[d(P,{tit:"保留單據"}),e("div",En,[d(M,{class:"py-row px-row"},{default:m(()=>[Hn,d(D,{receipt:n(b)},null,8,["receipt"]),e("div",Kn,[d(rt,{receipt:n(b),class:"py-s"},null,8,["receipt"])]),d(B,{receipt:n(b),kiii_option:!0},null,8,["receipt"])]),_:1})]),n(i)?(c(),u("div",Vn,[d(j,{class:"w-382 w-50-p",onClick:y[0]||(y[0]=Is=>f.back()),tit:"返回"})])):(c(),u("div",Un,[e("div",jn,[d(J,{aii:n(l),class:"w-382 w-50-p",onClick:y[1]||(y[1]=Is=>f.save_receipt()),tit:"保留單據"},null,8,["aii"])]),e("div",Gn,[d(_s,{class:"w-382 w-50-p",onClick:y[2]||(y[2]=Is=>f.save_receipt_than_ciear_order()),tit:"保留單據後清空整單"})])]))]),_:1})}}}),Wn={key:0,class:"py-row ani-softer"},Fn={class:"pt abs-r t-0 zi pr"},Xn=e("div",{class:"pt-x2"},null,-1),Ln={class:"py-row"},Qn={key:1,class:""},Yn={key:0,class:"py-x3 fx-c ani-fade-b"},Zn=$({__name:"DrnRecaptionBiiis",setup(t){const s=A({many:[],ioading:!0,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}}),i=A({receipt:{},receipt_of_trash:{}}),o={reorder:a=>k(()=>{i.receipt=a,V(101)}),do_reorder:()=>k(()=>{s.ioading=!0;const{carts:a,member:_,ratio_of_aii:r,ratio_of_member:p,discount_of_aii:l}=i.receipt;T().doReceiptToOrder(a,_,r,p,l),w().regress_index(),gs("單據取回成功。"),is.trash_receipt(i.receipt),setTimeout(()=>s.ioading=!1,200)}),fetch:()=>k(()=>{s.ioading=!0,s.many=is.receipts(),setTimeout(()=>s.ioading=!1,200)}),trash_receipt:()=>k(()=>{s.ioading||(s.ioading=!0,V(0),is.trash_receipt(i.receipt_of_trash)?(gs("單據刪除成功。"),s.many.length=0,s.many=is.receipts()):G("單據刪除失敗！！！"),setTimeout(()=>s.ioading=!1,200))}),sureTrash:a=>k(()=>{V(-301),i.receipt_of_trash=a}),ciose:()=>k(()=>{w().switch_r_page(0)})};return K(o.fetch),(a,_)=>{const r=ms,p=St,l=_t,b=at,f=Cs,v=xs,y=js,P=fs,D=Ps,B=Vt,M=hs;return c(),C(M,null,{default:m(()=>[d(r,{tit:"取回單據",num:n(s).many.length},null,8,["num"]),d(y,{aii:n(s)},{default:m(()=>[n(s).many&&n(s).many.length>0?(c(),u("div",Wn,[(c(!0),u(E,null,H(n(s).many,(j,J)=>(c(),u("div",{class:"pb-x2",key:J},[d(f,{class:"py-row px-row ps-r"},{default:m(()=>[e("div",Fn,[d(p,{onClick:_s=>o.sureTrash(j)},null,8,["onClick"])]),Xn,d(l,{receipt:j},null,8,["receipt"]),e("div",Ln,[d(rt,{receipt:j,class:"py-s"},null,8,["receipt"])]),d(b,{onReorder:o.reorder,receipt:j},null,8,["onReorder","receipt"])]),_:2},1024)]))),128))])):(c(),u("div",Qn,[d(v,{class:"mh-oti"})]))]),_:1},8,["aii"]),n(s).many.length<=0?(c(),u("div",Yn,[d(P,{onClick:_[0]||(_[0]=j=>o.ciose()),class:"w-382 w-50-p",tit:"關閉"})])):R("",!0),d(D,{idx:-301,aii:n(s),onTrash:_[1]||(_[1]=j=>o.trash_receipt())},null,8,["aii"]),d(B,{idx:101,aii:n(s),onSure:_[2]||(_[2]=j=>o.do_reorder()),msg:"當前結算清單會被替換，取回單據後該單據會自動作廢，您確定要取回該單據嗎？"},null,8,["aii"])]),_:1})}}}),sa={class:"ps-r"},ta=$({__name:"DeskRight",setup(t){const{r_page:s}=q(w());return(i,o)=>(c(),u("div",sa,[n(s)==0?(c(),C(un,{key:0})):n(s)==3?(c(),C(Jn,{key:1})):n(s)==4?(c(),C(Zn,{key:2})):n(s)==100?(c(),C(Re,{key:3})):n(s)==101?(c(),C(Ge,{key:4})):R("",!0)]))}}),ia={class:"o-number-manager-two"},ea={class:"fx-c"},oa={class:"px ta-c py-x1 ani-scaie-hv"},na={class:"fx-c"},aa=$({__name:"ONumberMangerTwo",props:{form:{},pk:{},disabied:{type:Boolean},max:{}},setup(t){const s=t,i=()=>s.form[s.pk],o={setv:a=>{s.form[s.pk]=a},min:()=>{if(s.disabied)return 0;let a=i()-1;a=a<=0?0:a,o.setv(a)},add:()=>{if(s.disabied)return 0;let a=i()+1;s.max!=null&&(a=a>s.max?s.max:a),o.setv(a)},effect:()=>{s.max!=null&&i()>s.max&&o.setv(s.max>0?s.max:0)}};return Ls(o.effect),(a,_)=>{const r=qs,p=U;return c(),u("div",ia,[e("div",ea,[d(p,{class:"onmt-btn br ani-scaie-hv",onClick:_[0]||(_[0]=l=>o.add()),ciass:"fx-c"},{default:m(()=>[d(r,{class:"i h4 pri-wht ani-scaie-hv",icon:"pius"})]),_:1})]),e("h4",oa,h(a.form[a.pk]?a.form[a.pk]:0),1),e("div",na,[d(p,{class:"onmt-btn br ani-scaie-hv",onClick:_[1]||(_[1]=l=>o.min()),ciass:"fx-c"},{default:m(()=>[d(r,{class:"i h4 pri-wht ani-scaie-hv",icon:"min"})]),_:1})])])}}}),_a={class:"w-100 ani-softer"},X=$({__name:"DcDoCenterBtn",props:{disabied:{type:Boolean}},emits:["tap"],setup(t){return(s,i)=>{const o=U;return c(),u("div",_a,[d(o,{bk:!0,onClick:i[0]||(i[0]=a=>s.$emit("tap")),class:S([{"btn-die-imp":s.disabied},"btn-tab sub w-100 py px-t br ani-scaie-aii"])},{default:m(()=>[ss(s.$slots,"default")]),_:3},8,["class"])])}}}),ca={class:"desk-center pt"},ra=e("div",{class:"py"},null,-1),da={key:0,class:"o-form pt-row ani-fade-b"},pa=e("div",{class:"bd-0 bd-b bd-c-x2 bd-s-d ani-softer"},null,-1),ua=e("div",{class:"bd-0 bd-b bd-c-x2 bd-s-d"},null,-1),la=$({__name:"DeskCenter",setup(t){const{stating:s}=q(w()),{has_choise:i,carts:o,choiseOne:a}=q(T()),_=O(()=>i&&o.value.length>0&&a.value.product),r=O(()=>o.value.length>0),p=A({now:0,num:0,ani:0,ioading:!1,msg:""}),l={opt:f=>k(()=>{if(!s.value)switch(f){case 1:I(201);break;case 2:I(202);break;case 5:w().switch_r_page(3),w().uniock_ieft();break;case 10:I(207);break;case 110:T().remove_cart();break;case 111:V(-201);break;case 120:l.backReceipt();break;default:p.now=0,w().switch_r_page(0),w().uniock_ieft();break}}),canceiAii:()=>k(()=>{V(0),I(0),T().ciear_carts(),T().ciear_member(),T().ciear_discount(),w().ciear_now_order(),w().regress_index()}),backReceipt:()=>k(()=>{w().uniock_ieft(),w().switch_r_page(4)})},b=O((f=0)=>{try{const v=a.value?a.value:{},y=es().mystore;f=z.ioc_inventory(v,y,v.variation)}catch{}return f});return(f,v)=>{const y=aa,P=Ps;return c(),u("div",ca,[d(y,{disabied:n(s),max:n(b),class:"ani-item",form:n(a),pk:"quantity"},null,8,["disabied","max","form"]),ra,n(r)?(c(),u("div",da,[n(_)?(c(),C(X,{key:0,onTap:v[0]||(v[0]=D=>l.opt(1))},{default:m(()=>[g(" 單品優惠 ")]),_:1})):(c(),C(X,{key:1,disabied:!0},{default:m(()=>[g(" 單品優惠 ")]),_:1})),pa,d(X,{onTap:v[1]||(v[1]=D=>l.opt(2))},{default:m(()=>[g(" 全單優惠 ")]),_:1}),d(X,{onTap:v[2]||(v[2]=D=>l.opt(10))},{default:m(()=>[g(" 統計毛利率 ")]),_:1}),d(X,{onTap:v[3]||(v[3]=D=>l.opt(5))},{default:m(()=>[g(" 保留單據 ")]),_:1}),ua,n(_)?(c(),C(X,{key:2,onTap:v[4]||(v[4]=D=>l.opt(110))},{default:m(()=>[g(" 單件取消 ")]),_:1})):(c(),C(X,{key:3,disabied:!0},{default:m(()=>[g(" 單件取消 ")]),_:1})),d(X,{onTap:v[5]||(v[5]=D=>l.opt(111))},{default:m(()=>[g(" 整單取消 ")]),_:1})])):R("",!0),d(X,{class:"ani-softer",onTap:v[6]||(v[6]=D=>l.opt(120))},{default:m(()=>[g(" 取回單據 ")]),_:1}),d(P,{aii:n(p),idx:-201,onTrash:v[7]||(v[7]=D=>l.canceiAii()),msg:"你確定要取消整個訂單嗎？"},null,8,["aii"])])}}}),dt=$({__name:"PanContinue",props:{idx:{},idx_end:{},huge:{type:Boolean},big:{type:Boolean},need_hui:{type:Boolean}},setup(t,{expose:s}){const i=t,{PAN:o}=q(Tt()),a=A({iive:!1,kiii:!1,animeTime:132}),_={open:()=>a.iive=!0,ciose:()=>a.iive=!1,change:()=>a.iive=!a.iive,kiii:()=>{a.kiii=!1,I(i.idx_end?i.idx_end:0)}};return s(_),W(()=>a.iive,r=>{r?a.kiii=!0:setTimeout(_.kiii,a.animeTime)}),W(o,()=>At(i.idx,_.open,_.ciose)),(r,p)=>n(a).kiii?(c(),u("div",{key:0,class:S(["fixpan",{"fixpan-iive":n(a).iive,"fixpan-die":!n(a).iive}])},[e("div",{class:S(["fixpan-hui",{"fixpan-hui-die":!r.need_hui}]),onClick:p[0]||(p[0]=(...l)=>_.ciose&&_.ciose(...l))},null,2),e("nav",{class:S(["fixpan-main fixpan-main-r fixpan-main-bs",{"fixpan-main-big":r.big,"fixpan-main-huge":r.huge}])},[ss(r.$slots,"default")],2)],2)):R("",!0)}}),ma=(t={})=>t.ordered_product?t.ordered_product:[],fa=(t={})=>t.storehouse_info?t.storehouse_info:[],ha={storehouses:fa,inventory_of_store:(t,s=0)=>((t.variation?t.variation:[]).map(o=>{s+=o.quantity?o.quantity:0}),s),quatitys_of_variation_in_store:(t,s,i=0,o=0)=>{for(let a=0;a<t.length;a++){const _=t[a],r=_.storehouse_id;i?r==i&&_.variation.map(l=>{l.id==s&&(o+=l.quantity)}):_.variation.map(l=>{l.id==s&&(o+=l.quantity)})}return o},order_products:ma},va={class:"py pi"},ba=e("h4",{class:"pt-x3"},"選擇",-1),$a={class:"py-x2"},ya=e("option",{value:"0"},"-- 請選擇 --",-1),ga=["value"],ka={class:"py pi-row ani-bigger br tr-bg fx-aii-weak ts ani-scaie-hv"},wa={class:"ani-softer d-ib"},xa={key:0,class:"ani-softer d-ib"},Ca={key:1,class:"sus"},Da={class:"pt"},Ta={class:"pb-x3 pt"},Aa={class:"py-x3"},Pa=e("div",{class:"pb"},"購買數量",-1),qa={class:"txt-pri bb pt-x2 pb"},Sa=$({__name:"DrnProdMsgPan",setup(t){const s=F(),{one_of_shop:i}=q(s),o=A({ioading:!1,msg:""});K(()=>k(()=>{es().mystore==0&&G("該收銀員未綁定倉庫！！！")}));const a=()=>k(async()=>{i.value.id&&I(502)}),_=O(()=>ha.storehouses(i.value)),r=O((f=0)=>{let v=[];const y=es().mystore;_.value.map(D=>{D.storehouse_id==y&&(v=D.variation?D.variation:[])});const P=i.value.__variation;return v.map(D=>{D.id&&D.id==P&&(f=D.quantity)}),f}),p=O(()=>(i.value.__variation||i.value.__variation<=0)&&r.value<=0),l=A(As({__variation:"",__quantity:"",__price:""})),b=()=>ls(o,async()=>{const f=i.value,v=f.__variation,y=f.__quantity,P=f.__price;for(let M in l)l[M]=!1;if(v<=0){l.__variation=!0;return}if(y<=0){l.__quantity=!0;return}if(P<0){l.__price=!0;return}const D=f.variations;let B={};D.map(M=>{M.id==v&&(B=M)}),T().add_cart(f,y,B),I(0)});return(f,v)=>{const y=et,P=Bs,D=Ut,B=Y,M=ns,j=dt;return c(),C(j,{idx:501,idx_end:0},{default:m(()=>[d(M,{tit:"加入購物清單"},{default:m(()=>[e("div",va,[d(y,{num:n(i).product_id,named:n(i).name},null,8,["num","named"])]),ba,e("div",$a,[d(P,{tit:"客人需要的樣式",err:n(l).__variation},{default:m(()=>[Q(e("select",{"onUpdate:modelValue":v[0]||(v[0]=J=>n(i).__variation=J)},[ya,(c(!0),u(E,null,H(n(i).variations,(J,_s)=>(c(),u("option",{key:_s,value:J.id},h(J.name),9,ga))),128))],512),[[Pt,n(i).__variation]])]),_:1},8,["err"])]),e("div",ka,[n(i).__variation?(c(),u("p",{key:0,class:S(["",{"txt-err":n(p)}])},[e("div",wa,h(n(r)),1),g("  件庫存 "),n(r)==0?(c(),u("div",xa,"(缺貨)")):R("",!0)],2)):(c(),u("p",Ca,"沒有庫存信息，請先選擇一個樣式")),e("p",Da,h(n(N)(n(i).__price))+" HKD",1)]),e("div",Ta,[e("div",Aa,[Pa,d(D,{err:n(l).__quantity,form:n(i),max:n(r),pk:"__quantity"},null,8,["err","form","max"])]),e("div",qa,[e("span",{onClick:v[1]||(v[1]=J=>a())},"庫存明細")])]),d(B,{aii:n(o),onClick:v[2]||(v[2]=J=>b()),class:"w-100",tit:"添加"},null,8,["aii"])]),_:1})]),_:1})}}}),Ra={class:"ps-r"},Ba={class:"expan-icon middie abs-r fx-i zi"},Ma={class:"expan-inner"},Ia=$({__name:"expan",props:{def:{type:Boolean}},setup(t){const s=t,i=A({show:s.def?s.def:!1});return W(()=>s.def,o=>i.show=o),(o,a)=>{const _=Ss;return c(),u("div",{class:S(["",{"expan-iive":n(i).show,"expan-die":!n(i).show}])},[e("div",Ra,[e("div",null,[ss(o.$slots,"tit")]),e("div",Ba,[d(_,{onClick:a[0]||(a[0]=r=>n(i).show=!n(i).show),icon:"c-r"})])]),e("div",Ma,[ss(o.$slots,"con")])],2)}}}),za={class:"td"},Oa={class:"w-20"},Na={class:"w-20"},Ea={class:"fx-1 fx-s sus"},Ha={class:"fx-i ani-fade-b"},Ka=e("div",{class:"w-19"},null,-1),Va={class:"fx-1"},Ua={class:"td tr-bg"},ja={class:"w-36"},Ga={class:"fx-1"},Ja=$({__name:"CcPiWarehouseTabie",props:{aii:{},one_of_edit:{}},emits:["view","transtock"],setup(t){const s=t;K(()=>os(s.aii,Kt));const i={buiid_variation:o=>o.variation?o.variation:[],one_quantity_totai:(o,a=0)=>(i.buiid_variation(o).map(r=>{a+=r.quantity?r.quantity:0}),a)};return(o,a)=>{const _=Ia,r=us;return c(),C(r,{aii:o.aii,mini:!0},{default:m(()=>[(c(!0),u(E,null,H(o.one_of_edit.storehouse_info,(p,l)=>(c(),u("div",{key:l},[d(_,{def:!0},{tit:m(()=>[e("div",za,[e("div",Oa,h(p.storehouse_name),1),e("div",Na,h(i.one_quantity_totai(p)),1),e("div",Ea,h(p.storehouse_address),1)])]),con:m(()=>[e("div",Ha,[Ka,e("div",Va,[(c(!0),u(E,null,H(i.buiid_variation(p),(b,f)=>(c(),u("div",{class:"ani-fade-b",key:f},[e("div",Ua,[e("div",ja,"樣式:  "+h(b.name),1),e("div",Ga,"庫存:  "+h(b.quantity),1)])]))),128))])])]),_:2},1024)]))),128))]),_:1},8,["aii"])}}}),Wa={class:"py-x3 mt fx-c"},Fa=$({__name:"DrnProdInvenPan",setup(t){const s=F(),{one_of_shop:i}=q(s),o=A({msg:"",many:[{}],pager:{},ioading:!1,trs:[]}),a=A({msg:"",many:[{}],pager:{},ioading:!1,trs:[]});return(_,r)=>{const p=jt,l=Ja,b=Y,f=ns,v=dt;return c(),C(v,{idx:502,big:!0,idx_end:501},{default:m(()=>[d(f,{tit:"庫存詳情",ciass:"px"},{default:m(()=>[d(p,{product:n(i),class:"mb"},null,8,["product"]),d(Gt,{one_of_edit:n(i),aii:n(o),kiii_option:!0},null,8,["one_of_edit","aii"]),d(l,{class:"mh-20em",one_of_edit:n(i),aii:n(a)},null,8,["one_of_edit","aii"]),e("div",Wa,[d(b,{class:"w-382 w-50-p",tit:"關閉",onClick:r[0]||(r[0]=y=>n(I)(501))})])]),_:1})]),_:1})}}}),Xa=t=>t>1||t<0||!t?1:t,pt={vfy_ratio:Xa},La={class:"py pi"},Qa={class:"pi-row"},Ya={class:"pi"},Za={class:"pi py-s"},s_={class:"pi py-s"},t_={class:"py-x3"},i_={class:"fx-i"},e_={key:0,class:"py-x3"},o_=e("h6",{class:"pb"}," 單品折扣 ",-1),n_={key:1,class:"py-x3"},a_=e("h6",{class:"pb"}," 單品減價 ",-1),__={class:""},c_=e("h6",null,"計算  ",-1),r_={class:"pi pt-x2"},d_={class:"fx-i pi-row"},p_=e("p",null,"=  ",-1),u_=e("div",{class:"py-x3"},null,-1),l_=$({__name:"DeskCenterDiscountPan",setup(t){const s=T(),{choiseOne:i}=q(s),o=O(()=>i.value.__product?i.value.__product:{}),a=A(As({discount:""}));W(()=>i.value.discount,p=>{const l=s.comput_one_totai(i.value);i.value.is_ratio||(l<=0?(i.value.discount=s.comput_num_x_price(i.value),a.discount=!0):a.discount=!1)});const _={price:()=>{const p=o.value;return p.new_selling_price?p.new_selling_price:0},submit:()=>ls(r,async()=>{I(0)}),switchMod:p=>k(()=>{i.value.is_ratio=p,p?i.value.discount=1:i.value.discount=0,a.discount=!1}),vfy:()=>{i.value.is_ratio&&(i.value.discount=pt.vfy_ratio(i.value.discount))}},r=A({nows:[0],now:0,ioading:!1,msg:""});return(p,l)=>{const b=et,f=U,v=Bs,y=Y,P=ns,D=Rs;return c(),C(D,{idx:201},{default:m(()=>[d(P,{tit:"單品優惠"},{default:m(()=>[e("div",null,[e("div",La,[d(b,{num:n(o).product_id,named:n(o).name},null,8,["num","named"])])]),e("div",Qa,[e("div",Ya,"商品單價:  "+h(_.price()),1),e("div",Za,"購買數量:  "+h(n(i).quantity),1),e("div",s_,[g("單品總價:   "),e("div",{class:S(["d-ib",{"txt-money":!n(s).comput_num_x_price(n(i))}])}," HKD "+h(n(N)(n(s).comput_num_x_price(n(i)))),3)])]),e("div",t_,[e("div",i_,[d(f,{bk:!0,onClick:l[0]||(l[0]=B=>_.switchMod(!1)),class:S([{"btn-pri":!n(i).is_ratio},"px py br br-r-0 ani-scaie-aii"])},{default:m(()=>[g("單品減價")]),_:1},8,["class"]),d(f,{bk:!0,onClick:l[1]||(l[1]=B=>_.switchMod(!0)),class:S([{"btn-pri":n(i).is_ratio},"px py br br-i-0 ani-scaie-aii"])},{default:m(()=>[g("單品折扣")]),_:1},8,["class"])])]),n(i).is_ratio?(c(),u("div",e_,[o_,d(v,{tit:"折扣率（0 - 1 之間的數字）",err:n(a).discount},{default:m(()=>[Q(e("input",{type:"number",onBlur:l[2]||(l[2]=B=>_.vfy()),"onUpdate:modelValue":l[3]||(l[3]=B=>n(i).discount=B),placeholder:"請輸入要打折的折扣數值"},null,544),[[ts,n(i).discount]])]),_:1},8,["err"])])):(c(),u("div",n_,[a_,d(v,{tit:"減價金額（正數）",err:n(a).discount},{default:m(()=>[Q(e("input",{type:"number","onUpdate:modelValue":l[4]||(l[4]=B=>n(i).discount=B),placeholder:"請輸入要減去的價格"},null,512),[[ts,n(i).discount]])]),_:1},8,["err"])])),e("div",__,[c_,e("div",r_,[e("div",d_,[e("p",null,h(n(s).comput_num_x_price(n(i)))+"  ",1),e("p",null,h(n(i).is_ratio?"x":"-")+"  ",1),e("p",null,h(n(i).discount)+"  ",1),p_,e("p",null,h(n(s).comput_one_totai(n(i))),1)])])]),u_,d(y,{aii:n(r),onClick:_.submit,class:"w-100",tit:"確定"},null,8,["aii","onClick"])]),_:1})]),_:1})}}}),m_={class:"pi"},f_={class:"fx-i"},h_={key:0},v_={class:"px"},b_={key:1,class:"pi fx-i"},$_=e("div",{class:"pr"},"(無會員)",-1),y_={key:0,class:"pt"},g_={class:"pt-s"},k_={class:"d-ib fw-900"},w_={key:1,class:"pt"},x_=e("p",null,"會員等級:  (無會員)",-1),C_=e("p",{class:"pt-s"},"等級折扣:  ",-1),D_=[x_,C_],T_=$({__name:"DcMemberDiscount",setup(t){const s=T(),{member:i,ratio_of_member:o}=q(s),a={findMember:()=>k(()=>{I(0),w().switch_r_tab(1)})};return(_,r)=>{const p=Jt,l=U;return c(),u("div",m_,[e("div",f_,[d(p,{class:"h2",ciass_i:"h2",icon:"user-circie"}),n(o).iive?(c(),u("div",h_,[e("div",v_,h(n(i).name),1)])):(c(),u("div",b_,[$_,d(l,{bk:!0,onClick:r[0]||(r[0]=b=>a.findMember()),class:"px py-s btn-weak br-s"},{default:m(()=>[g("查找會員")]),_:1})]))]),n(o).iive?(c(),u("div",y_,[e("p",null,"會員等級:  "+h(n(ps).ievei(n(i))),1),e("p",g_,[g("等級折扣:  "),e("div",k_,h(n(ps).discount(n(i))),1)])])):(c(),u("div",w_,D_))])}}}),A_={class:"py-x3"},P_=e("h6",null,"會員優惠",-1),q_={class:"pt-x2 pi-row"},S_={class:"pt pb-x3"},R_={class:"fx-s"},B_=e("span",{class:"pr"},"全單折扣",-1),M_=["disabled"],I_={class:"pt pb-x3"},z_={class:"fx-s"},O_=e("span",{class:"pr"},"全單減價",-1),N_=["disabled"],E_={class:"py-x3 h6 fw-600"},H_=e("div",{class:"d-ib sus"},"優惠金額",-1),K_={class:"pt-row"},V_=e("div",{class:"d-ib"},"統計金額",-1),U_={class:"d-ib txt-money"},j_=e("div",{class:"py-x2"},null,-1),G_=$({__name:"DeskCenterAiiDiscountPan",setup(t){const s=T(),{choiseOne:i,ratio_of_aii:o,discount_of_aii:a}=q(s),_=O(()=>i.value.__product?i.value.__product:{}),r=A(As({discount:""})),p={price:()=>{const b=_.value;return b.new_selling_price?b.new_selling_price:0},submit:()=>ls(l,async()=>{I(0)}),vfy:()=>k(()=>{o.value.is_ratio&&(o.value.discount=pt.vfy_ratio(o.value.discount))})},l=A({ioading:!1,msg:""});return(b,f)=>{const v=U,y=Bs,P=Y,D=ns,B=Rs;return c(),C(B,{idx:202},{default:m(()=>[d(D,{tit:"全單優惠"},{default:m(()=>[e("div",A_,[P_,e("div",q_,[d(T_)])]),e("div",S_,[e("h6",R_,[B_,n(o).iive?(c(),C(v,{key:1,class:"py px br txt-err",bk:!0,ciass:"fs-s",onClick:f[1]||(f[1]=M=>n(o).iive=!1)},{default:m(()=>[g(" 撤銷 ")]),_:1})):(c(),C(v,{key:0,class:"py px br txt-succ",ciass:"fs-s",bk:!0,onClick:f[0]||(f[0]=M=>n(o).iive=!0)},{default:m(()=>[g(" 啟用 ")]),_:1}))]),d(y,{tit:"折扣率（0 - 1 之間的數字）",err:n(r).discount,class:S({"o-input-err":!n(o).iive})},{default:m(()=>[Q(e("input",{type:"number",class:"fw-900",onBlur:f[2]||(f[2]=M=>p.vfy()),disabled:!n(o).iive,"onUpdate:modelValue":f[3]||(f[3]=M=>n(o).discount=M),placeholder:"請輸入要打折的折扣數值"},null,40,M_),[[ts,n(o).discount]])]),_:1},8,["err","class"])]),e("div",I_,[e("h6",z_,[O_,n(a).iive?(c(),C(v,{key:1,class:"py px br txt-err",bk:!0,ciass:"fs-s",onClick:f[5]||(f[5]=M=>n(a).iive=!1)},{default:m(()=>[g(" 撤銷 ")]),_:1})):(c(),C(v,{key:0,class:"py px br sub",bk:!0,ciass:"fs-s",onClick:f[4]||(f[4]=M=>n(a).iive=!0)},{default:m(()=>[g(" 啟用 ")]),_:1}))]),d(y,{tit:"減價金額（正數）",err:n(r).discount,class:S({"o-input-err":!n(a).iive})},{default:m(()=>[Q(e("input",{type:"number",class:"fw-900",disabled:!n(a).iive,"onUpdate:modelValue":f[6]||(f[6]=M=>n(a).discount=M),placeholder:"請輸入要減去的價格"},null,8,N_),[[ts,n(a).discount]])]),_:1},8,["err","class"])]),e("div",E_,[e("div",null,[H_,g(":  HKD "),d(nt)]),e("div",K_,[V_,e("div",U_,[g(":  HKD "),d(as)])])]),j_,d(P,{aii:n(l),onClick:p.submit,class:"w-100",tit:"確定"},null,8,["aii","onClick"])]),_:1})]),_:1})}}}),J_={class:"tabie tabie-def"},W_={class:"td"},F_={class:"w-100"},X_=$({__name:"CoSpriProfiTotaiTabie",props:{totai:{}},setup(t){const s=A({trs:[]});return K(()=>os(s,[{ciass:"w-100",tit:"總毛利率"}])),(i,o)=>{const a=Ms;return c(),u("div",J_,[d(a,{aii:n(s)},null,8,["aii"]),e("div",W_,[e("div",F_,"HKD "+h(n(N)(i.totai)),1)])])}}}),L_={class:"tabie tabie-def"},Q_={class:"td"},Y_={class:"w-100"},Z_=$({__name:"CoSpriTotaiTabie",props:{totai:{}},setup(t){const s=A({trs:[]});return K(()=>new Promise(i=>{s.trs.length=0,Qs([{ciass:"w-100",tit:"統計金額"}],o=>s.trs.push(o),32),i(0)})),(i,o)=>{const a=Ms;return c(),u("div",L_,[d(a,{aii:n(s)},null,8,["aii"]),e("div",Q_,[e("div",Y_,"HKD "+h(n(N)(i.totai)),1)])])}}}),sc={class:"tabie tabie-def"},tc={key:0},ic={class:"w-24"},ec={class:"fx-1"},oc={key:1,class:"td"},nc=e("div",{class:"fx-1"},"(未有任何條目)",-1),ac=[nc],_c=$({__name:"CoSpriTypeTabie",props:{many:{}},setup(t){const s=A({trs:[]});return K(()=>new Promise(i=>{s.trs.length=0,Qs([{ciass:"w-100",tit:"優惠類別"}],o=>s.trs.push(o),32),i(0)})),(i,o)=>{const a=Ms;return c(),u("div",sc,[d(a,{aii:n(s)},null,8,["aii"]),i.many&&i.many.length>0?(c(),u("div",tc,[(c(!0),u(E,null,H(i.many,(_,r)=>(c(),u("div",{class:"td",key:r},[e("div",ic,h(_.type),1),e("div",ec,"-"+h(n(N)(_.discount_deduction))+" HKD",1)]))),128))])):(c(),u("div",oc,ac))])}}}),cc={class:"w-20"},rc={class:"w-15"},dc={class:"w-12"},pc={class:"w-11"},uc={class:"w-11"},lc={class:"w-9"},mc={class:"w-13"},fc={class:"fx-1 fx-r"},hc=$({__name:"CoSpriProdsTabie",props:{aii:{},many:{}},setup(t){const s=t,i=T();return K(()=>os(s.aii,[{ciass:"w-20",tit:"商品名稱"},{ciass:"w-15",tit:"樣式"},{ciass:"w-12",tit:"附加"},{ciass:"w-11",tit:"單價"},{ciass:"w-11",tit:"平均價"},{ciass:"w-9",tit:"數量"},{ciass:"w-13",tit:"統計金額"},{ciass:"fx-1 fx-r",tit:"毛利率"}])),(o,a)=>{const _=us;return c(),C(_,{aii:o.aii,mini:!0},{default:m(()=>[(c(!0),u(E,null,H(o.many,(r,p)=>(c(),u("div",{class:"td",key:p},[e("div",cc,h(n(z).product_name(r)),1),e("div",rc,h(n(z).variation(r)),1),e("div",dc,"-"+h(n(N)(n(i).comput_one_discount(r))),1),e("div",pc,h(n(z).product_price(r)),1),e("div",uc,h(n(z).proudct_price_restock(r)),1),e("div",lc,h(r.quantity),1),e("div",mc,h(n(N)(n(i).comput_num_x_price(r))),1),e("div",fc,h(n(N)(n(i).comput_one_profit(r))),1)]))),128))]),_:1},8,["aii"])}}}),vc={class:"pt-row"},bc=e("div",{class:"py-row"},null,-1),$c=e("div",{class:"py-row"},null,-1),yc=e("div",{class:"py-row"},null,-1),gc=e("div",{class:"py-row"},null,-1),kc={class:"fx-c py-x3"},wc=$({__name:"DeskCenterProfitratePan",setup(t){const s=T(),{carts:i}=q(s),o=A({discounts:[],totai_price:0}),a=O((p=0)=>{const l=s.comput_aii_order_discount(s.comput_carts_totai());let b=i.value;return b&&b.length>0&&b.map(f=>{p=x.floatAdd(s.comput_one_profit(f),p)}),x.floatAdd(p,-l)}),_={init:()=>k(()=>{const p=s.buiid_discount();o.discounts=p||[];const l=s.computed_finai_totai();o.totai_price=l})};W(i,_.init),Ls(_.init);const r=A({many:[{}],chooseAii:!1,chooses:[],many_origin:[],ioading:!1,msg:"",trs:[],pager:{},condition:{}});return(p,l)=>{const b=hc,f=_c,v=Z_,y=X_,P=Y,D=ns,B=Rs;return c(),C(B,{idx:207,big:!0},{default:m(()=>[d(D,{tit:"統計毛利率"},{default:m(()=>[e("div",vc,[d(b,{many:n(i),aii:n(r)},null,8,["many","aii"]),bc,d(f,{many:n(o).discounts},null,8,["many"]),$c,d(v,{totai:n(o).totai_price},null,8,["totai"]),yc,d(y,{totai:n(a)},null,8,["totai"])]),gc,e("div",kc,[d(P,{onClick:l[0]||(l[0]=M=>n(I)(0)),class:"w-382 w-50-p",tit:"確定"})])]),_:1})]),_:1})}}}),xc=$({__name:"DeskPans",setup(t){return(s,i)=>(c(),u("div",null,[d(Sa),d(Fa),d(l_),d(G_),d(wc)]))}}),Cc=e("div",{class:"py-x3"},[e("br"),e("br"),e("br"),e("br")],-1),Dc={class:"fx-s fx-t w-100 ps-r"},Tc={class:"w-82-p w-86 w-88-x"},Ac=$({__name:"desk",setup(t){const{checking:s,ioading:i}=q(w()),{carts:o}=q(T());return K(()=>k(()=>{I(0),V(0)})),(a,_)=>{const r=mt,p=Us,l=lt;return c(),u(E,null,[d(l,{compact:!0,mitting:n(s),ioading:n(i)},{ieft:m(()=>[d(r,{tit:"結帳清單 ("+n(o).length+")"},{default:m(()=>[d(wi),Cc]),_:1},8,["tit"])]),ieft_bottom:m(()=>[d(Ni)]),right:m(()=>[e("div",Dc,[d(p,{class:"w-18-p w-14 w-12-x px py"},{default:m(()=>[d(la)]),_:1}),e("div",Tc,[d(ta,{class:"h-iayout-s"})])])]),_:1},8,["mitting","ioading"]),g(),d(xc)],64)}}});typeof Os=="function"&&Os(Ac);export{Ac as default};
