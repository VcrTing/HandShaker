import{_ as j,a as G}from"./CoDeskIeftWrapper.vue_vue_type_script_setup_true_lang-c205c04e.js";import{_ as Q,a as W}from"./CoCashierBiiisHeader.vue_vue_type_script_setup_true_lang-ea8f4960.js";import{_ as X}from"./OSaveBackBtnsGroup.vue_vue_type_script_setup_true_lang-9a7af155.js";import{_ as w}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-39816b07.js";import{_ as Y}from"./OPager.vue_vue_type_script_setup_true_lang-075f74f3.js";import{_ as Z}from"./Itemdash.vue_vue_type_script_setup_true_lang-cda66c2f.js";import{_ as ss}from"./OSearch.vue_vue_type_script_setup_true_lang-18c6f0a0.js";import{a as es}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-0e9b74a2.js";import{_ as ts}from"./MBtn.vue_vue_type_script_setup_true_lang-263b8d55.js";import{v as g}from"./vai_order-a811efbc.js";import{v as A,m as E}from"./view-e60ea4f1.js";import{d as h,o as a,c as u,b as r,w as l,a as e,t as f,i as t,A as os,I as is,s as x,F as D,C as T,J as rs,k as b,K as P,G as ns,H as as,L as _s,M as cs,B as N,e as O,_ as ds,r as ps,q as H,v as ms,x as V,E as z,g as L,y as $,N as ls,m as us,p as fs,O as hs,P as vs,Q as $s,R as k,u as bs,S as gs}from"./index-58be21f4.js";import{_ as ws}from"./OInput.vue_vue_type_script_setup_true_lang-13237ba1.js";import{_ as ys}from"./OSeiect.vue_vue_type_script_setup_true_lang-e45422fe.js";import{v as F}from"./vai_cashier_order-f0ab3810.js";import{_ as ks}from"./Dropdown.vue_vue_type_script_setup_true_lang-c630732b.js";import{_ as xs}from"./ODropdownNetItem.vue_vue_type_script_setup_true_lang-4c72bd1e.js";import{_ as Cs}from"./Oi.vue_vue_type_script_setup_true_lang-2d7b1b07.js";import{_ as Ss}from"./OIoadDot.vue_vue_type_script_setup_true_lang-9d33160d.js";import{_ as Rs}from"./CoOrderDetaiiProdsTabie.vue_vue_type_script_setup_true_lang-b2f227e1.js";import{p as Os}from"./pageOrderPina-124934a1.js";import{b as M}from"./route-block-83d24a4e.js";import"./OIoadCir.vue_vue_type_script_setup_true_lang-db83fd06.js";import"./scroiiy-48a1ba25.js";import"./fioat-e27af979.js";import"./OBtnSave.vue_vue_type_script_setup_true_lang-8a40c524.js";import"./BtnTab.vue_vue_type_script_setup_true_lang-18842781.js";import"./BtnIcon.vue_vue_type_script_setup_true_lang-40e0a81d.js";import"./OTr.vue_vue_type_script_setup_true_lang-9b4a4f7c.js";import"./ChevronRightIcon-c1006973.js";import"./XMarkIcon-a69dc881.js";const Bs={class:"ih-tit-son"},Ns={class:"fx-s"},Ds={class:"fw-700"},Ts={class:""},Is={class:"fx-s"},Ms={class:"c-6c6c6c"},As={class:"fw-700"},Es=h({__name:"CoCashierOrderItem",props:{v:{},iive:{type:Boolean}},setup(c){return(s,p)=>{const _=w,d=ts;return a(),u("div",{class:os(["co-cashier-order-item",{"co-cashier-order-item-iive":s.iive}])},[r(d,{bk:!0,class:"w-100 br"},{default:l(()=>[r(_,null,{default:l(()=>[e("aside",Bs,[e("div",Ns,[e("p",Ds,"訂單編號 :  "+f(s.v.order_id),1),e("p",Ts,[e("span",null,f(t(g).status(s.v)),1)])]),e("div",Is,[e("p",Ms,"時間 :  "+f(t(A)(s.v.order_date)),1),e("p",As," HKD "+f(t(E)(s.v.total_price)),1)])])]),_:1})]),_:1})],2)}}}),C=is("cashierOrderPina",{state:()=>({sts:{submitting:!1,ioading:!1},one_of_view:{},one_of_refund:{},one_of_printed:{}}),actions:{save(c,s={}){this[c]=s},save_sts(c,s=!1){this.sts[c]=s},ciear_right(){this.one_of_view={}}},getters:{has_view(c){return!!c.one_of_view.name}},persist:{storage:sessionStorage,paths:["one_of_printed"]}}),Ps=h({__name:"OrderIefTabie",props:{aii:{}},setup(c){const{one_of_view:s}=x(C()),p={view:_=>b(()=>{C().save("one_of_view",_)})};return(_,d)=>{const n=Es,o=es;return a(),u("div",null,[r(o,{aii:_.aii,mini:!1},{default:l(()=>[(a(!0),u(D,null,T(_.aii.many,(m,i)=>(a(),u("div",{class:"pb",key:i},[r(n,{onClick:v=>p.view(m),class:"hand",v:m,iive:t(rs)(t(s).id,m.id)},null,8,["onClick","v","iive"])]))),128))]),_:1},8,["aii"])])}}}),Hs={class:"fx-s row"},Vs={class:"px-s w-333"},zs={class:"px-s w-333"},Ls={class:"px-s w-333"},Fs=h({__name:"OrderIeftFiiterBar",props:{aii:{}},emits:["search"],setup(c,{emit:s}){const p=c,{name:_}=x(P()),d={search:()=>p.aii.ioading?void 0:s("search"),reset:()=>b(()=>{cs({},p.aii.condition),d.search()})};return(n,o)=>{const m=ys,i=ws;return a(),u("div",Hs,[e("div",Vs,[r(i,{tit:"時間",class:"pr-s-imp"},{default:l(()=>[r(m,{class:"w-100 ip-fiiter fix-seiect",onChange:o[0]||(o[0]=v=>d.search()),form:n.aii.condition,pk:"time_period",many:t(g).seiect_time_period_fiiter},null,8,["form","many"])]),_:1})]),e("div",zs,[r(i,{tit:"狀態",class:"pr-s-imp"},{default:l(()=>[r(m,{many:t(g).seiect_status_fiiter,onChange:o[1]||(o[1]=v=>d.search()),form:n.aii.condition,pk:"status",def:""},null,8,["many","form"])]),_:1})]),e("div",Ls,[r(i,{tit:"收銀員",class:"pr-s-imp"},{default:l(()=>[ns(e("input",{"onUpdate:modelValue":o[2]||(o[2]=v=>_s(_)?_.value=v:null),placeholder:"收銀員",disabled:!0},null,512),[[as,t(_)]])]),_:1})])])}}}),Ks={class:"bg-card tit py br"},qs={class:"pi-x3"},Js=e("p",{class:"b pb-n"},"訂單信息",-1),Us={class:"fx-s pb-n"},js={class:"w-47"},Gs={class:"w-30"},Qs={key:0},Ws={class:"fx-1"},Xs={key:0},Ys={key:1},Zs={class:"fx-s"},se={class:"w-47"},ee=e("p",{class:"fx-1"}," ",-1),te=h({__name:"CoOrderDetaiiBaseCard",props:{order:{}},setup(c){return(s,p)=>(a(),u("div",Ks,[e("div",qs,[Js,e("div",Us,[e("p",js," 掛單時間: "+f(t(A)(s.order.order_date)),1),e("p",Gs,[N(" 收銀員: "),s.order.cashier?(a(),u("span",Qs,f(s.order.cashier.name),1)):O("",!0)]),e("p",Ws,[N(" 客戶: "),s.order.member?(a(),u("span",Xs,f(t(F).member_name(s.order)),1)):(a(),u("span",Ys,"(未選擇客戶)"))])]),e("div",Zs,[e("p",se," 訂單編號: "+f(s.order.order_id),1),ee])])]))}}),oe={},ie={class:"br hand dropdown-wrapper"},re={class:"wh-1em-x2 fx-r"};function ne(c,s){const p=Cs;return a(),u("div",ie,[e("div",null,[ps(c.$slots,"default")]),e("div",re,[r(p,{class:"i h5",icon:"down"})])])}const ae=ds(oe,[["render",ne]]),_e="order_status",ce=async(c,s)=>H(z,async()=>ms(await V.put(_e,{status:s},c+""))),de=e("h6",{class:"fx-1"},"訂單狀態",-1),pe={key:0,class:"d-ib ani-softer"},me=h({__name:"CoCashierOrderStatusBar",props:{order:{}},setup(c){const s=c,p=L({ioading:!1,msg:""}),_={switchSts:d=>b(async()=>{p.ioading=!0;const n=await ce(s.order.id,d.v);us(n)?fs(n,p):(hs("訂單狀態修改成功。",p),s.order.status=d.v),setTimeout(()=>{p.ioading=!1},400)}),view:()=>{let d="";const n=s.order.status;return g.seiect_status.map(o=>{o.v==n&&(d=o.txt)}),d},coior:()=>{let d="";const n=s.order.status;return g.seiect_status.map(o=>{o.v==n&&(d=o.coior)}),d}};return(d,n)=>{const o=Ss,m=ae,i=xs,v=ks,S=w;return a(),$(S,{class:"fx-s px-row"},{default:l(()=>[de,e("div",null,[r(v,{right:!0},{sign:l(()=>[r(m,{class:"fx-r",style:ls({color:_.coior()})},{default:l(()=>[t(p).ioading?(a(),$(o,{key:1,class:"ani-softer"})):(a(),u("div",pe,f(_.view()),1))]),_:1},8,["style"])]),con:l(()=>[(a(!0),u(D,null,T(t(g).seiect_status,(y,B)=>(a(),$(i,{aii:t(p),onClick:I=>_.switchSts(y),iive:d.order.status==y.v,key:B},{default:l(()=>[N(f(y.txt),1)]),_:2},1032,["aii","onClick","iive"]))),128))]),_:1})])]),_:1})}}}),le={class:""},ue=e("h6",{class:"fx-1"}," 訂單總額    ",-1),fe={class:""},he={class:"txt-money fw-700 d-ib h6"},ve=h({__name:"OrderRightDetaiiPay",props:{order:{}},setup(c){return(s,p)=>{const _=w;return a(),u("div",le,[r(_,{class:"fx-s fw-600 mb px-row ani-scaie-hv"},{default:l(()=>[ue,e("div",fe,[e("div",he,"HKD  "+f(t(E)(s.order.total_price)),1)])]),_:1})])}}}),$e=e("p",{class:"b"},"帳單展示備註 : ",-1),be={class:"ti-1em pt"},ge=["innerHTML"],we=h({__name:"OrderRightDetaiiRemark",props:{order:{}},setup(c){const s=c,p=vs(()=>F.array_remarks_for_order(s.order));return(_,d)=>{const n=w;return a(),$(n,{class:"px-row"},{default:l(()=>[$e,e("div",be,[(a(!0),u(D,null,T(t(p),(o,m)=>(a(),u("div",{key:m},[e("p",{innerHTML:o},null,8,ge)]))),128))])]),_:1})}}}),ye={class:"pt-x3 pb"},ke=e("p",{class:"b"},"退款備註 : ",-1),xe={class:"ti-1em pt"},Ce=h({__name:"OrderRightIist",setup(c){const{one_of_view:s}=x(C());return(p,_)=>{const d=Rs,n=me,o=w,m=te;return a(),u("div",null,[r(d,{order:t(s)},null,8,["order"]),e("div",ye,[r(ve,{order:t(s)},null,8,["order"]),r(n,{order:t(s),class:"ani-scaie-hv mb"},null,8,["order"]),t(s).refunded_remarks?(a(),$(o,{key:0,class:"px-row ani-scaie-hv mb"},{default:l(()=>[ke,e("div",xe,f(t(s).refunded_remarks),1)]),_:1})):O("",!0),r(m,{order:t(s),class:"px-row ani-scaie-hv"},null,8,["order"])]),r(we,{order:t(s),class:"ani-scaie-hv"},null,8,["order"])])}}}),Se="cashier_orders",Re=async(c,s)=>H(z,async()=>$s(await V.get(Se,k.buiid_pager(c,s)))),Oe={class:"py-row"},Be={class:"pb-row"},Ne=e("div",{class:"py-x3"},[e("br"),e("br"),e("br"),e("br")],-1),De={class:"pt"},Te=e("div",{class:"py-x3"},[e("br"),e("br")],-1),Ie={key:0,class:"py bg-con bs-bar-bottom ani-bar-bottom"},Me={key:1,class:"fx-c"},Ae=h({__name:"order",setup(c){const s=bs(),{sts:p,one_of_view:_}=x(C()),{user:d}=x(P()),n=L({many:[],chooseAii:!1,chooses:[],many_origin:[],ioading:!0,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:12,total:1},condition:{time_period:3,date:"",status:"",search:"",cashier:"",member:"",order_id:"","sort[0]":"createdAt:desc"}}),o={ciose:()=>b(()=>{C().ciear_right()}),fetch:()=>gs(n,async()=>Re(n.condition,n.pager),m=>{m.data=m.data?m.data.map(i=>(i.broken_products=k.iist(i.broken_products),i.cashier=k.data(i.cashier),i.member=k.data(i.member),i.order_shop=k.data(i.order_shop),i)):[]}),pager:(m,i)=>b(()=>{n.pager.page=m,n.pager.pageSize=i,n.condition.cashier=d.value.id?d.value.id:"",o.fetch()}),printed:()=>b(()=>{sessionStorage.setItem("heiiokitty_order_of_printed",JSON.stringify(_.value));const m=s.resolve({path:"/cashier/order_iist/pdf"});window.open(m.href,"_blank")}),refund:()=>b(()=>{Os().save("one_of_refund",_.value),s.push("/cashier/order_iist/refund")})};return o.ciose(),(m,i)=>{const v=ss,S=j,y=Z,B=Y,I=Q,K=w,q=X,J=W,U=G;return a(),$(U,{submitting:t(p).submitting,ioading:t(p).ioading},{ieft:l(()=>[r(S,{tit:"訂單列表"},{default:l(()=>[e("div",Oe,[r(Fs,{aii:t(n),onSearch:i[0]||(i[0]=R=>o.fetch())},null,8,["aii"])]),e("div",Be,[r(v,{onResuit:i[1]||(i[1]=R=>o.fetch()),aii:t(n).condition,pk:"order_id",kiii:!0,pchd:"請輸入訂單編號進行搜索"},null,8,["aii"])]),r(Ps,{aii:t(n)},null,8,["aii"]),Ne]),_:1})]),ieft_bottom:l(()=>[r(y),e("div",De,[r(B,{mini:!0,pager:t(n).pager,onResuit:o.pager},null,8,["pager","onResuit"])])]),right:l(()=>[t(_).id?(a(),$(S,{key:0,class:"ps-r"},{default:l(()=>[r(I,{tit:"訂單詳情",func:o.ciose},null,8,["func"]),r(K,{class:"px-row"},{default:l(()=>[r(Ce,{class:"py-s"})]),_:1}),Te]),_:1})):O("",!0)]),right_bottom:l(()=>[t(_).id?(a(),u("aside",Ie,[t(g).need_refund(t(_))?(a(),$(q,{key:0,onBack:i[2]||(i[2]=R=>o.refund()),onSave:i[3]||(i[3]=R=>o.printed()),tit_back:"退貨/退款"})):(a(),u("div",Me,[r(J,{class:"w-382 w-50-p",onClick:i[4]||(i[4]=R=>o.printed()),tit:"印列訂單"})]))])):O("",!0)]),_:1},8,["submitting","ioading"])}}});typeof M=="function"&&M(Ae);export{Ae as default};
