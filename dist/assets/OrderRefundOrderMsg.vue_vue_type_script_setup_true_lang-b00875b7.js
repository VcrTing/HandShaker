import{_ as D,a as U}from"./ModInner.vue_vue_type_script_setup_true_lang-dbe6d9aa.js";import{_ as q}from"./MBtn.vue_vue_type_script_setup_true_lang-cd21dc42.js";import{_ as R}from"./OIoadCir.vue_vue_type_script_setup_true_lang-11518a24.js";import{d as y,o as c,k,w as d,b as a,a as e,t as m,c as f,g as A,i as l,l as I,m as $,p as O,e as M,h as N,n as z,q as F,v as V,x as B,F as j,s as H,f as K}from"./index-33974ecf.js";import{n as L}from"./conn-e4aee6c9.js";import{a as P,s as G}from"./net-tooi-51cb3d70.js";import{E as J}from"./errors_user-be6d0865.js";import{_ as C}from"./Itemdash.vue_vue_type_script_setup_true_lang-fc29ad0c.js";import{_ as Q}from"./BtnIcon.vue_vue_type_script_setup_true_lang-94d8aa7d.js";import{f as E,i as W,m as b}from"./credit-db2ad5c3.js";import{v}from"./vai_order-7a27cec4.js";import{_ as X}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-ea14a47c.js";import{_ as Y}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-c4165b1d.js";import{_ as Z,a as ss}from"./CoWarehouseSeiectPure.vue_vue_type_script_setup_true_lang-9ccc9a29.js";import{_ as es}from"./Oi.vue_vue_type_script_setup_true_lang-dd35cc56.js";import{_ as is}from"./OCheckOne.vue_vue_type_script_setup_true_lang-1287c841.js";import{p as S}from"./pageOrderPina-2646ee47.js";import{m as T,v as ts}from"./view-01767316.js";import{_ as os}from"./OBtnSave.vue_vue_type_script_setup_true_lang-6e760d07.js";import{f as ns}from"./fioat-e27af979.js";const as={class:"pt-x3 fx-c"},rs={key:0},_s={key:1},cs={key:0},ds={key:1},le=y({__name:"OModSure",props:{idx:{},aii:{},msg:{}},emits:["sure"],setup(h){return(s,t)=>{const o=R,i=q,r=U,n=D;return c(),k(n,{class:"mod-t",idx:s.idx?s.idx:100,stat:s.aii.ioading},{default:d(()=>[a(r,{tit:"提示",stat:s.aii.ioading},{default:d(()=>[e("p",null,m(s.msg?s.msg:"你確定嗎？"),1),e("div",as,[a(i,{class:"py-s mw-618 px-x2 btn-err-weak br",onClick:t[0]||(t[0]=_=>s.$emit("sure"))},{default:d(()=>[s.aii.ioading?(c(),f("div",rs,[a(o,{styie:"pri"})])):(c(),f("div",_s,[s.aii.msg?(c(),f("span",ds,m(s.aii.msg),1)):(c(),f("span",cs," 確定 "))]))]),_:1})])]),_:1},8,["stat"])]),_:1},8,["idx","stat"])}}}),ms="refund",fe=async(h,s)=>P(J,async()=>G(await L.put(ms,h,s+""))),us={key:0},ps={key:1,class:"__checkbox_ioading"},ls=y({__name:"OCheckAii",props:{form:{},pk:{},minus:{}},emits:["resuit"],setup(h,{emit:s}){const t=h,o=A({ioading:!1}),i=()=>E(()=>{o.ioading=!0,t.form[t.pk]=!t.form[t.pk],s("resuit",t.form[t.pk]),setTimeout(()=>o.ioading=!1,t.minus?t.minus:300)});return(r,n)=>{const _=Q,u=R;return l(o).ioading?(c(),f("div",ps,[e("div",null,[a(u)])])):(c(),f("div",us,[r.form[r.pk]?(c(),k(_,{key:0,onClick:i,class:"h6 ani-scaie-aii",ciass_i:"h4",icon:"check-circie"})):(c(),k(_,{key:1,onClick:i,class:"h6 __checkbox_empty ani-scaie-aii",ciass_i:"h3",icon:"stop"}))]))}}}),fs={class:"fx-c"},hs={key:0,class:""},vs=e("span",{class:"sus"}," / ",-1),ys=y({__name:"ONumberMnagerSmaii",props:{form:{},pk:{},deno:{},err:{type:Boolean},max:{},ciass_num:{}},setup(h){const s=h,t=()=>s.form[s.pk],o={setv:i=>{s.form[s.pk]=i},min:()=>{let i=t()-1;i=i<=0?0:i,o.setv(i)},add:()=>{let i=t()+1;s.max!=null&&(i=i>s.max?s.max:i),o.setv(i)},effect:()=>{s.max!=null&&t()>s.max&&o.setv(s.max>0?s.max:0)}};return I(o.effect),(i,r)=>{const n=es,_=q;return c(),f("div",fs,[a(_,{bk:!0,class:"fx-aii-tab bd-input-x2 py-s px-s br ani-scaie-aii",onClick:r[0]||(r[0]=u=>o.min()),ciass:"fx-c"},{default:d(()=>[a(n,{class:$(["i ani-scaie-hv",{"txt-err":i.err}]),icon:"min"},null,8,["class"])]),_:1}),e("p",{class:$(["px-s mw-2em ta-c ani-scaie-hv",i.ciass_num])},[e("span",{class:$(["txt-money",{"txt-err":i.err}])},m(i.form[i.pk]),3),i.deno?(c(),f("span",hs,[vs,O(m(i.deno),1)])):M("",!0)],2),a(_,{bk:!0,class:"fx-aii-tab bd-input-x2 py-s px-s br ani-scaie-aii",onClick:r[1]||(r[1]=u=>o.add()),ciass:"fx-c"},{default:d(()=>[a(n,{class:$(["i ani-scaie-hv",{"txt-err":i.err}]),icon:"pius"},null,8,["class"])]),_:1})])}}}),$s={class:"w-100 ta-i"},ks={class:"td fs-s"},xs={class:"w-29 fx-i fs pi-x2"},ws={class:"mw-2em pr"},gs={class:"mw-2em pr"},bs={class:"fx-1"},Cs={class:"w-11"},qs={class:"w-8"},Rs={class:"w-8"},As={class:"w-10 pr"},Os={class:"w-20 ta-c"},Ms={class:"w-13"},Ns=["onUpdate:modelValue"],Vs=y({__name:"OrderRefundIistTabie",props:{aii:{}},setup(h){const s=h,t=S();return N(s.aii.chooses,o=>{t.ciear_product_refund(),o.length>0&&s.aii.many.map(i=>{o.map(r=>{i.id==r&&t.pius_product_refund(i)})})}),z(()=>W(s.aii,[{ciass:"w-29 h6",tit:"序號/商品名稱"},{ciass:"w-11 h6",tit:"樣式"},{ciass:"w-8 h6",tit:"折扣"},{ciass:"w-8 h6",tit:"單價"},{ciass:"w-10 h6",tit:"總金額"},{ciass:"w-20 h6 fx-c",tit:"退款數量 / 數量"},{ciass:"w-13 h6 fx-c",tit:"退款金額"}])),(o,i)=>{const r=is,n=ys,_=Z,u=Y,x=X;return c(),k(x,{aii:o.aii,mini:!0,pure:!0},{default:d(()=>[(c(!0),f(j,null,F(o.aii.many,(p,w)=>(c(),f("div",{key:w,class:"py-s"},[a(u,{class:$(["ani-scaie-hv py-0",{"bg-con-x2":p.__can_refunded_quantity<=0}])},{default:d(()=>[e("div",$s,[e("div",ks,[e("div",xs,[e("div",ws,[p.__can_refunded_quantity>0?(c(),k(r,{key:0,chooses:o.aii.chooses,id:p.id,totai:o.aii.many.length,onChoosAii:i[0]||(i[0]=g=>o.aii.chooseAii=g)},null,8,["chooses","id","totai"])):M("",!0)]),e("div",gs,m(w+1),1),e("div",bs,m(l(v).order_product(p).name),1)]),e("div",Cs,m(l(v).order_product_variation(p).name),1),e("div",qs,"- "+m(p.discount_deduction),1),e("div",Rs,m(p.selling_price),1),e("div",As,m(l(T)(p.total_price)),1),e("div",Os,[a(n,{ciass_num:"fw-900",form:p,pk:"refunded_quantity",deno:p.__can_refunded_quantity,max:p.__can_refunded_quantity},null,8,["form","deno","max"])]),e("div",Ms,[a(_,{class:"w-100"},{default:d(()=>[V(e("input",{class:"txt-money fw-900 ta-c","onUpdate:modelValue":g=>p.refunded_price=g,type:"number",placeholder:"請輸入"},null,8,Ns),[[B,p.refunded_price]])]),_:2},1024)])])])]),_:2},1032,["class"])]))),128))]),_:1},8,["aii"])}}}),Bs={class:"w-38 fx-i py-s"},Es={class:"pi-x2 pr-x1 h6"},Ss=e("h6",null,"全選",-1),Ts=e("h6",{class:"fx-1 py-s"}," 退款產品列表 ",-1),he=y({__name:"OrderRefundIist",props:{order:{}},setup(h,{expose:s}){const t=A({chooseAii:!1,chooses:[],many_origin:[],pager:{page:1,pageCount:1,pageSize:25,total:1},choose:!1,many:[],ioading:!0,msg:"",trs:[],condition:{}}),o={effect:(i={})=>{const r=i.ordered_product?i.ordered_product:[];r.length>0&&(t.many.length=0,r.map(n=>{n.__can_refunded_quantity=v.can_refund_num(n),n.refunded_quantity=0,n.refunded_price=0,t.many.push(n)}),t.ioading=!1)},choosAii:i=>E(()=>{t.chooses.length=0,i&&t.many.map(r=>{t.chooses.push(r.id)})})};return s(o),(i,r)=>{const n=ls,_=C;return c(),f("div",null,[a(_,{class:"fx-s mb-s"},{default:d(()=>[e("div",Bs,[e("div",Es,[a(n,{onResuit:o.choosAii,form:l(t),pk:"chooseAii"},null,8,["onResuit","form"])]),Ss]),Ts]),_:1}),a(Vs,{aii:l(t)},null,8,["aii"])])}}}),Ds={class:"fx-s"},Us={class:"txt-money err d-ib"},Is={class:"fx-s mt"},ve=y({__name:"RefundRightBottom",props:{form:{},me:{}},emits:["submit"],setup(h,{expose:s}){const t=h,{one_of_refund:o,refund_products:i}=H(S()),r=K(0);return N(()=>i.value,n=>{let _=0;n.map(u=>{_=ns.floatAdd(u.refunded_price,_)}),r.value=_},{deep:!0}),s({buiid:(n=[])=>{t.form.refunded_remarks=o.value.refunded_remarks;const _=i.value;return _.length<=0?(b("請選擇要退款的商品！！！",t.me),null):(_.map(u=>{u.refunded_quantity>0&&u.__can_refunded_quantity>0&&n.push({refunded_price:u.refunded_price,refunded_quantity:u.refunded_quantity,product:v.order_product(u).id,variation:v.order_product_variation(u).id})}),n.length<=0?(b("請注意產品的退款數量！！！",t.me),null):(t.form.refunded_info=n,t.form.storehouse?t.form:(b("請選擇一個退貨倉庫！！！",t.me),null)))}}),(n,_)=>{const u=ss,x=C,p=os;return c(),f("div",null,[a(x,null,{default:d(()=>[e("div",Ds,[e("div",null,[a(u,{form:n.form,pk:"storehouse",tit_def:"-- 請選擇退貨倉庫 --"},null,8,["form"])]),e("h6",null,[O("退款金額:   "),e("p",Us,"HKD "+m(l(T)(l(r))),1)])])]),_:1}),e("div",Is,[a(p,{class:"w-100 ani-scaie-aii",aii:n.me,onClick:_[0]||(_[0]=w=>n.$emit("submit")),tit:"退款"},null,8,["aii"])])])}}}),zs=e("div",{class:"fw-700"},"訂單編號",-1),Fs=e("div",{class:"fw-700"},"掛單時間",-1),js=e("div",{class:"fw-700"},"訂單狀態",-1),Hs=e("div",{class:"fw-700"},"收銀員",-1),Ks=e("div",{class:"fw-700"},"客戶",-1),Ls=e("div",{class:"fw-700"},"支付方式",-1),Ps=e("div",{class:"fw-700 pr"},"退款備註",-1),Gs={class:"fx-1"},ye=y({__name:"OrderRefundOrderMsg",props:{order:{}},setup(h){return(s,t)=>{const o=C;return c(),f("aside",null,[a(o,{class:"fx-s px mt-s"},{default:d(()=>[zs,e("div",null,m(s.order.order_id),1)]),_:1}),a(o,{class:"fx-s px mt-s"},{default:d(()=>[Fs,e("div",null,m(l(ts)(s.order.order_date)),1)]),_:1}),a(o,{class:"fx-s px mt-s"},{default:d(()=>[js,e("div",null,m(l(v).status(s.order)),1)]),_:1}),a(o,{class:"fx-s px mt-s"},{default:d(()=>[Hs,e("div",null,m(l(v).cashier(s.order)),1)]),_:1}),a(o,{class:"fx-s px mt-s"},{default:d(()=>[Ks,e("div",null,m(l(v).member(s.order)),1)]),_:1}),a(o,{class:"fx-s px mt-s"},{default:d(()=>[Ls,e("div",null,m(l(v).payment(s.order)),1)]),_:1}),a(o,{class:"fx-s px mt-s"},{default:d(()=>[Ps,e("div",Gs,[V(e("input",{placeholder:"請輸入","onUpdate:modelValue":t[0]||(t[0]=i=>s.order.refunded_remarks=i),class:"ta-r w-100"},null,512),[[B,s.order.refunded_remarks]])])]),_:1})])}}});export{le as _,ye as a,he as b,ve as c,fe as s};
