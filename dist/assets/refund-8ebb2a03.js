import{_ as S,a as j,b as A,s as D}from"./OrderRefundOrderMsg.vue_vue_type_script_setup_true_lang-53af6156.js";import{_ as E,a as H}from"./CoDeskIeftWrapper.vue_vue_type_script_setup_true_lang-014b174e.js";import{_ as K}from"./OBtnBack.vue_vue_type_script_setup_true_lang-b6689502.js";import{_ as w}from"./Itemdash.vue_vue_type_script_setup_true_lang-96b77256.js";import{_ as O}from"./OSaveBackBtnsGroup.vue_vue_type_script_setup_true_lang-4b6e37fb.js";import{f as b,m as l,s as P,t as z}from"./credit-1f946479.js";import{d as B,o as q,c as R,b as e,w as _,a as s,j as G,f as h,u as I,s as J,h as g,g as $,n as L,i as u,F as M,$ as Q}from"./index-196d4fb0.js";import{v as y}from"./vai_order-e4500f19.js";import{f as U}from"./fioat-e27af979.js";import{p as v}from"./pageOrderPina-bf1aedc1.js";import{i as W}from"./iodash-8a8cb9b0.js";import{b as x}from"./route-block-83d24a4e.js";import"./ModInner.vue_vue_type_script_setup_true_lang-0ad8349d.js";import"./MBtn.vue_vue_type_script_setup_true_lang-d7872721.js";import"./OIoadCir.vue_vue_type_script_setup_true_lang-247a587c.js";import"./conn-b30cd48e.js";import"./net-tooi-07907f0e.js";import"./errors_user-be6d0865.js";import"./BtnIcon.vue_vue_type_script_setup_true_lang-d59e8373.js";import"./Oi.vue_vue_type_script_setup_true_lang-ca7b50b2.js";import"./XMarkIcon-0fae528a.js";import"./IayoutTabie.vue_vue_type_script_setup_true_lang-4ec6993a.js";import"./OIoadDot.vue_vue_type_script_setup_true_lang-30986065.js";import"./OTr.vue_vue_type_script_setup_true_lang-c2c2f047.js";import"./itembdwrapper.vue_vue_type_script_setup_true_lang-9f6be44d.js";import"./OInpuTd.vue_vue_type_script_setup_true_lang-12cd9c66.js";import"./OCheckOne.vue_vue_type_script_setup_true_lang-1698f5ac.js";import"./view-01767316.js";import"./scroiiy-4c59c1f7.js";import"./OBtnSave.vue_vue_type_script_setup_true_lang-071b6073.js";import"./BtnTab.vue_vue_type_script_setup_true_lang-ae081abe.js";const X=s("h5",{class:"fw-700"},[G(" 應退金額 :   "),s("div",{class:"d-ib txt-money"},"HKD 500.0")],-1),Y=B({__name:"RefundRightBottom",setup(N){const d={refund_and_good:()=>b(()=>{}),refund:()=>b(()=>{})};return(k,a)=>{const r=w,f=O;return q(),R("div",null,[e(r,{class:"mb"},{default:_(()=>[X]),_:1}),e(f,{class:"px-0",ciass:"w-100",onBack:a[0]||(a[0]=c=>d.refund_and_good()),onSave:a[1]||(a[1]=c=>d.refund()),tit_back:"退款並退貨入庫",tit_save:"退款"})])}}}),Z={class:"pt"},tt=s("div",{class:"py-x3"},null,-1),ot=s("div",{class:"py-x3"},[s("br"),s("br"),s("br")],-1),et={class:"py bg-con"},st=B({__name:"refund",setup(N){const d=h(),k=h(0),a=I(),{one_of_refund:r,refund_products:f}=J(v()),c=g({submitting:!1,ioading:!1});$(()=>f.value,t=>{let n=0;t.map(o=>{n=U.floatAdd(o.refunded_price,n)}),k.value=n},{deep:!0});const i=g({msg:"",many:[{}],pager:{},ioading:!1}),m=g({refunded_remarks:"",storehouse:0,refunded_info:[]}),p={buiid:(t=[])=>{m.refunded_remarks=r.value.refunded_remarks;const n=f.value;return n.length<=0?(l("請選擇要退款的商品！！！",i),null):(n.map(o=>{o.refunded_quantity>0&&o.__can_refunded_quantity>0&&t.push({refunded_price:o.refunded_price,refunded_quantity:o.refunded_quantity,product:y.order_product(o).id,variation:y.order_product_variation(o).id})}),t.length<=0?(l("請注意產品的退款數量！！！",i),null):(m.refunded_info=t,m.storehouse?m:(l("請選擇一個退貨倉庫！！！",i),null)))},submit:()=>P(i,p.buiid,async t=>{t&&Q(100)}),__submit:()=>b(async()=>{i.ioading=!0;let t=await D(m,r.value.id);W(t)?l(t,i):p.success(),i.ioading=!1}),success:()=>{z("退款成功！！！"),a.back(),v().save("one_of_refund",{}),v().ciear_product_refund()},init:()=>b(()=>{r.value.id||a.back(),d.value.effect(r.value)})};return $(r,t=>d.value.effect(t)),L(p.init),(t,n)=>{const o=E,T=w,V=K,C=H,F=A;return q(),R(M,null,[e(C,{mitting:u(c).submitting,ioading:u(c).ioading},{ieft:_(()=>[e(o,{tit:"訂單信息"},{default:_(()=>[s("div",Z,[e(S,{order:u(r)},null,8,["order"]),tt])]),_:1})]),ieft_bottom:_(()=>[s("aside",null,[e(T,{class:"mb"}),e(V,{class:"w-100"})])]),right:_(()=>[e(o,null,{default:_(()=>[e(j,{ref_key:"ori",ref:d,order:u(r)},null,8,["order"]),ot]),_:1})]),right_bottom:_(()=>[s("aside",et,[e(Y)])]),_:1},8,["mitting","ioading"]),e(F,{idx:100,aii:u(i),onSure:n[0]||(n[0]=rt=>p.__submit()),msg:"您確定要退款嗎？"},null,8,["aii"])],64)}}});typeof x=="function"&&x(st);export{st as default};
