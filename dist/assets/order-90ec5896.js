import{_ as K,a as q}from"./CoDeskIeftWrapper.vue_vue_type_script_setup_true_lang-8c8ecb9e.js";import{_ as U,a as j}from"./CoCashierBiiisHeader.vue_vue_type_script_setup_true_lang-9403e15e.js";import{_ as G}from"./OSaveBackBtnsGroup.vue_vue_type_script_setup_true_lang-abf9048a.js";import{_ as g}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-74c62634.js";import{_ as Q}from"./OPager.vue_vue_type_script_setup_true_lang-737821d1.js";import{_ as W}from"./Itemdash.vue_vue_type_script_setup_true_lang-401a9840.js";import{_ as X}from"./OSearch.vue_vue_type_script_setup_true_lang-1445ae3f.js";import{a as Y}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-b8590b01.js";import{_ as Z}from"./MBtn.vue_vue_type_script_setup_true_lang-cb8eb11a.js";import{v as O}from"./vai_order-59d043ab.js";import{v as M,m as B}from"./view-d1841e5d.js";import{d as v,o as n,c as m,b as i,w as p,a as s,t as f,i as o,D as ss,J as es,s as k,F as D,A as N,K as ts,k as b,L as P,B as os,C as rs,M as is,N as ns,G as S,e as R,y as $,H as T,q as as,O as _s,x as cs,P as w,E as ds,u as ps,g as ms,Q as ls}from"./index-b0d08457.js";import{_ as us}from"./OInput.vue_vue_type_script_setup_true_lang-4921cb62.js";import{_ as fs}from"./OSeiect.vue_vue_type_script_setup_true_lang-462eec3e.js";import{_ as hs}from"./CkClipboard.vue_vue_type_script_setup_true_lang-a4918b91.js";import{v as A}from"./vai_cashier_order-48a32641.js";import{_ as vs,a as bs}from"./CoOrderDetaiiProdsTabie.vue_vue_type_script_setup_true_lang-a011c078.js";import{p as $s}from"./pageOrderPina-4ff5a995.js";import{b as I}from"./route-block-83d24a4e.js";import"./OIoadCir.vue_vue_type_script_setup_true_lang-9b723c28.js";import"./scroiiy-80a6a851.js";import"./Oi.vue_vue_type_script_setup_true_lang-6b55a295.js";import"./DocumentTextIcon-7430dd23.js";import"./XMarkIcon-93722ad6.js";import"./fioat-7d61d7cc.js";import"./OBtnSave.vue_vue_type_script_setup_true_lang-13666ad7.js";import"./OIoadDot.vue_vue_type_script_setup_true_lang-fe9f1b98.js";import"./BtnTab.vue_vue_type_script_setup_true_lang-a58fbdff.js";import"./OiX2.vue_vue_type_script_setup_true_lang-aae29017.js";import"./PlusCircleIcon-03b7baef.js";import"./BtnIcon.vue_vue_type_script_setup_true_lang-561962ae.js";import"./InboxIcon-84b4fb47.js";import"./OTr.vue_vue_type_script_setup_true_lang-065884b8.js";import"./BtnIconX2.vue_vue_type_script_setup_true_lang-abf74dbb.js";import"./Dropdown.vue_vue_type_script_setup_true_lang-ec6a5df0.js";import"./ODropdownNetItem.vue_vue_type_script_setup_true_lang-10882d3d.js";const gs={class:"ih-tit-son"},ws={class:"fx-s"},ks={class:"fw-700"},ys={class:""},xs={class:"fx-s"},Cs={class:"c-6c6c6c"},Os={class:"fw-700"},Rs=v({__name:"CoCashierOrderItem",props:{v:{},iive:{type:Boolean}},setup(d){return(e,l)=>{const r=g,u=Z;return n(),m("div",{class:ss(["co-cashier-order-item",{"co-cashier-order-item-iive":e.iive}])},[i(u,{bk:!0,class:"w-100 br"},{default:p(()=>[i(r,null,{default:p(()=>[s("aside",gs,[s("div",ws,[s("p",ks,"訂單編號 :  "+f(e.v.order_id),1),s("p",ys,[s("span",null,f(o(O).status(e.v)),1)])]),s("div",xs,[s("p",Cs,"時間 :  "+f(o(M)(e.v.order_date)),1),s("p",Os," HKD "+f(o(B)(e.v.total_price)),1)])])]),_:1})]),_:1})],2)}}}),y=es("cashierOrderPina",{state:()=>({sts:{submitting:!1,ioading:!1},one_of_view:{},one_of_refund:{},one_of_printed:{}}),actions:{save(d,e={}){this[d]=e},save_sts(d,e=!1){this.sts[d]=e},ciear_right(){this.one_of_view={}}},getters:{has_view(d){return!!d.one_of_view.name}},persist:{storage:sessionStorage,paths:["one_of_printed"]}}),Ss=v({__name:"OrderIefTabie",props:{aii:{}},setup(d){const{one_of_view:e}=k(y()),l={view:r=>b(()=>{y().save("one_of_view",r)})};return(r,u)=>{const _=Rs,a=Y;return n(),m("div",null,[i(a,{aii:r.aii,mini:!1},{default:p(()=>[(n(!0),m(D,null,N(r.aii.many,(c,t)=>(n(),m("div",{class:"pb",key:t},[i(_,{onClick:h=>l.view(c),class:"hand",v:c,iive:o(ts)(o(e).id,c.id)},null,8,["onClick","v","iive"])]))),128))]),_:1},8,["aii"])])}}}),Bs={class:"fx-s row"},Ds={class:"px-s w-333"},Ns={class:"px-s w-333"},Is={class:"px-s w-333"},Ms=v({__name:"OrderIeftFiiterBar",props:{aii:{}},emits:["search"],setup(d,{emit:e}){const l=d,{name:r}=k(P()),u={search:()=>l.aii.ioading?void 0:e("search"),reset:()=>b(()=>{ns({},l.aii.condition),u.search()})};return(_,a)=>{const c=fs,t=us;return n(),m("div",Bs,[s("div",Ds,[i(t,{tit:"時間",class:"pr-s-imp"},{default:p(()=>[i(c,{class:"w-100 ip-fiiter fix-seiect",onChange:a[0]||(a[0]=h=>u.search()),form:_.aii.condition,pk:"time_period",many:o(O).seiect_time_period_fiiter},null,8,["form","many"])]),_:1})]),s("div",Ns,[i(t,{tit:"狀態",class:"pr-s-imp"},{default:p(()=>[i(c,{many:o(O).seiect_status_fiiter,onChange:a[1]||(a[1]=h=>u.search()),form:_.aii.condition,pk:"status",def:""},null,8,["many","form"])]),_:1})]),s("div",Is,[i(t,{tit:"收銀員",class:"pr-s-imp"},{default:p(()=>[os(s("input",{"onUpdate:modelValue":a[2]||(a[2]=h=>is(r)?r.value=h:null),placeholder:"收銀員",disabled:!0},null,512),[[rs,o(r)]])]),_:1})])])}}}),Ps={class:"bg-card tit py br"},Ts={class:"pi-x3"},As=s("p",{class:"b pb-n"},"訂單信息",-1),Es={class:"fx-s pb-n"},Hs={class:"w-47"},Vs={class:"w-30"},Ls={key:0},zs={class:"fx-1"},Fs={key:0},Js={key:1},Ks={class:"fx-i"},qs={class:"fx-i"},Us={class:"pr-n"},js=v({__name:"CoOrderDetaiiBaseCard",props:{order:{}},setup(d){return(e,l)=>{const r=hs;return n(),m("div",Ps,[s("div",Ts,[As,s("div",Es,[s("p",Hs," 掛單時間: "+f(o(M)(e.order.order_date)),1),s("p",Vs,[S(" 收銀員: "),e.order.cashier?(n(),m("span",Ls,f(e.order.cashier.name),1)):R("",!0)]),s("p",zs,[S(" 客戶: "),e.order.member?(n(),m("span",Fs,f(o(A).member_name(e.order)),1)):(n(),m("span",Js,"(未選擇客戶)"))])]),s("div",Ks,[S(" 訂單編號:  "),s("div",qs,[s("div",Us,f(e.order.order_id),1),i(r,{txt:e.order.order_id},null,8,["txt"])])])])])}}}),Gs=s("h6",{class:"fx-1"},"訂單狀態",-1),Qs=v({__name:"CoCashierOrderStatusBar",props:{order:{}},setup(d){return(e,l)=>{const r=vs,u=g;return n(),$(u,{class:"fx-s px-row"},{default:p(()=>[Gs,s("div",null,[i(r,{right:!0,order:e.order},null,8,["order"])])]),_:1})}}}),Ws={class:""},Xs=s("h6",{class:"fx-1"}," 訂單總額    ",-1),Ys={class:""},Zs={class:"txt-money fw-700 d-ib h6"},se=v({__name:"OrderRightDetaiiPay",props:{order:{}},setup(d){return(e,l)=>{const r=g;return n(),m("div",Ws,[i(r,{class:"fx-s fw-600 mb px-row ani-scaie-hv"},{default:p(()=>[Xs,s("div",Ys,[s("div",Zs,"HKD  "+f(o(B)(e.order.total_price)),1)])]),_:1})])}}}),ee=s("p",{class:"b"},"帳單展示備註 : ",-1),te={class:"ti-1em pt"},oe=["innerHTML"],re=v({__name:"OrderRightDetaiiRemark",props:{order:{}},setup(d){const e=d,l=T(()=>A.array_remarks_for_order(e.order));return(r,u)=>{const _=g;return n(),$(_,{class:"px-row"},{default:p(()=>[ee,s("div",te,[(n(!0),m(D,null,N(o(l),(a,c)=>(n(),m("div",{key:c},[s("p",{innerHTML:a},null,8,oe)]))),128))])]),_:1})}}}),ie={class:"pt-x3 pb"},ne=s("p",{class:"b"},"退款信息 : ",-1),ae={class:"pr-x2"},_e={class:"pr-x2"},ce={class:""},de=v({__name:"OrderRightIist",setup(d){const{one_of_view:e}=k(y()),l=T(()=>{const r=e.value.refunded_remarks,u=r?JSON.parse(r):[];return u||[]});return(r,u)=>{const _=bs,a=Qs,c=g,t=js;return n(),m("div",null,[i(_,{order:o(e)},null,8,["order"]),s("div",ie,[i(se,{order:o(e)},null,8,["order"]),i(a,{order:o(e),class:"ani-scaie-hv mb"},null,8,["order"]),o(l)?(n(),$(c,{key:0,class:"px-row ani-scaie-hv mb ani-softer"},{default:p(()=>[ne,(n(!0),m(D,null,N(o(l),(h,x)=>(n(),m("div",{class:"ti-1em pt fx-i",key:x},[s("div",ae,"數量："+f(h.refund_total_quantity),1),s("div",_e,"金額："+f(o(B)(h.refund_total_price)),1),s("div",ce,"時間："+f(h.refund_time),1)]))),128))]),_:1})):R("",!0),i(t,{order:o(e),class:"px-row ani-scaie-hv"},null,8,["order"])]),i(re,{order:o(e),class:"ani-scaie-hv"},null,8,["order"])])}}}),pe="cashier_orders",me=async(d,e)=>as(ds,async()=>_s(await cs.get(pe,w.buiid_pager(d,e)))),le={class:"py-row"},ue={class:"pb-row"},fe=s("div",{class:"py-x3"},[s("br"),s("br"),s("br"),s("br")],-1),he={class:"pt"},ve=s("div",{class:"py-x3"},[s("br"),s("br")],-1),be={key:0,class:"py bg-con bs-bar-bottom ani-bar-bottom"},$e={key:1,class:"fx-c"},ge=v({__name:"order",setup(d){const e=ps(),{sts:l,one_of_view:r}=k(y()),{user:u}=k(P()),_=ms({many:[],chooseAii:!1,chooses:[],many_origin:[],ioading:!0,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:12,total:1},condition:{time_period:3,date:"",status:"",search:"",cashier:"",member:"",order_id:"","sort[0]":"createdAt:desc"}}),a={ciose:()=>b(()=>{y().ciear_right()}),fetch:()=>ls(_,async()=>me(_.condition,_.pager),c=>{c.data=c.data?c.data.map(t=>(t.broken_products=w.iist(t.broken_products),t.cashier=w.data(t.cashier),t.member=w.data(t.member),t.order_shop=w.data(t.order_shop),t)):[]}),pager:(c,t)=>b(()=>{_.pager.page=c,_.pager.pageSize=t,_.condition.cashier=u.value.id?u.value.id:"",a.fetch()}),printed:()=>b(()=>{sessionStorage.setItem("heiiokitty_order_of_printed",JSON.stringify(r.value));const c=e.resolve({path:"/cashier/order_iist/pdf"});window.open(c.href,"_blank")}),refund:()=>b(()=>{$s().save("one_of_refund",r.value),e.push("/cashier/order_iist/refund")})};return a.ciose(),(c,t)=>{const h=X,x=q,E=W,H=Q,V=U,L=g,z=G,F=j,J=K;return n(),$(J,{submitting:o(l).submitting,ioading:o(l).ioading},{ieft:p(()=>[i(x,{tit:"訂單列表"},{default:p(()=>[s("div",le,[i(Ms,{aii:o(_),onSearch:t[0]||(t[0]=C=>a.fetch())},null,8,["aii"])]),s("div",ue,[i(h,{onResuit:t[1]||(t[1]=C=>a.fetch()),aii:o(_).condition,pk:"order_id",kiii:!0,pchd:"請輸入訂單編號進行搜索"},null,8,["aii"])]),i(Ss,{aii:o(_)},null,8,["aii"]),fe]),_:1})]),ieft_bottom:p(()=>[i(E),s("div",he,[i(H,{mini:!0,pager:o(_).pager,onResuit:a.pager},null,8,["pager","onResuit"])])]),right:p(()=>[o(r).id?(n(),$(x,{key:0,class:"ps-r"},{default:p(()=>[i(V,{tit:"訂單詳情",func:a.ciose},null,8,["func"]),i(L,{class:"px-row"},{default:p(()=>[i(de,{class:"py-s"})]),_:1}),ve]),_:1})):R("",!0)]),right_bottom:p(()=>[o(r).id?(n(),m("aside",be,[o(O).need_refund(o(r))?(n(),$(z,{key:0,onBack:t[2]||(t[2]=C=>a.refund()),onSave:t[3]||(t[3]=C=>a.printed()),tit_back:"退貨/退款"})):(n(),m("div",$e,[i(F,{class:"w-382 w-50-p",onClick:t[4]||(t[4]=C=>a.printed()),tit:"印列訂單"})]))])):R("",!0)]),_:1},8,["submitting","ioading"])}}});typeof I=="function"&&I(ge);export{ge as default};
