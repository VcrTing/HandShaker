import{_ as O}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-20d822ee.js";import{t as as,c as rs,d as _s}from"./product_trs-9c94e8a4.js";import{d as $,o as _,c,t as h,am as R,n as I,C as D,y as M,w as m,F as T,D as P,a as e,i as d,b as a,N as z,P as E,k as C,S as cs,q as W,v as K,x as L,g as x,an as H,r as J,a6 as Q,h as b,ae as g,G as V,H as q,al as X,s as Y,T as ls,e as S,a7 as us,R as Z,M as ps,$ as j,a0 as ds,A as U,p as ms,U as fs}from"./index-5f0df7b6.js";import{g as A}from"./giobaiPina-3cb52f62.js";import{_ as hs}from"./OTrPure.vue_vue_type_script_setup_true_lang-33e0ec1e.js";import{m as vs,v as ks,c as ss,a as $s,d as ys,e as ws}from"./view-19823675.js";import{pageProductInstockPina as bs}from"./pageProductInstockPina-7402e1f2.js";import{E as is}from"./errors_product-d5275ad5.js";import{_ as gs}from"./BtnTab.vue_vue_type_script_setup_true_lang-be8f1187.js";import{_ as Cs}from"./IayoutForm.vue_vue_type_script_setup_true_lang-3b425237.js";import{pageProducEditPina as ts}from"./pageProducEditPina-b678055c.js";import{_ as os}from"./OInput.vue_vue_type_script_setup_true_lang-3f5d5e02.js";import{_ as xs}from"./CoSuppiierSeiect.vue_vue_type_script_setup_true_lang-1cdc158f.js";import{_ as Ts}from"./Dropdown.vue_vue_type_script_setup_true_lang-a28ab5e3.js";import{_ as Ps}from"./OInputI.vue_vue_type_script_setup_true_lang-f8c23b93.js";import{_ as Vs}from"./OTime.vue_vue_type_script_setup_true_lang-8c9b595b.js";import{_ as qs}from"./OModTrash.vue_vue_type_script_setup_true_lang-7e838754.js";import{_ as Is}from"./BtnIcon.vue_vue_type_script_setup_true_lang-43f5ffd7.js";import{_ as Ns,a as Bs}from"./CoWarehouseSeiectPure.vue_vue_type_script_setup_true_lang-0e584f2a.js";import{_ as Es}from"./OTabieTrash-cea5e18a.js";import{_ as Us}from"./OTabieEdit.vue_vue_type_script_setup_true_lang-ac6def49.js";const Ss={class:"d-ib hand txt-pri ani-scaie-aii-x2 fs-n ani-softer"},F=$({__name:"OTabieOpera",props:{tit:{}},setup(l){return(s,r)=>(_(),c("div",Ss,h(s.tit),1))}}),N=A().seiect_iabeis,Os=R(N),Rs=[{txt:"標籤",v:"",ciass:"o-fiiter-reset"},...N],es=A().seiect_supiiers,Ds=R(es),Ms=[{txt:"供應商",v:"",ciass:"o-fiiter-reset"},...N],As={seiect_tag:N,seiect_tag_def:Os,seiect_tag_fiiter:Rs,seiect_supplier:es,seiect_supplier_def:Ds,seiect_supplier_fiiter:Ms,comput_store_quantity:(l,s=0)=>((l.variation?l.variation:[]).map(o=>{s+=o.quantity?o.quantity:0}),s)},Fs={class:"w-20"},Gs={class:"w-20"},Hs={class:"fx-1 fx-s"},js={class:"d-ib pr"},zs={key:0,class:"fx-r"},Ws={key:1},mt=$({__name:"CoPidWarehouseTabie",props:{aii:{},one_of_edit:{},kiii_option:{type:Boolean}},emits:["view","transtock"],setup(l){const s=l;return I(()=>D(s.aii,as)),(r,o)=>{const i=F,t=O;return _(),M(t,{aii:r.aii,mini:!0},{default:m(()=>[(_(!0),c(T,null,P(r.one_of_edit.storehouse_info,(n,p)=>(_(),c("div",{class:"td",key:p},[e("div",Fs,h(n.storehouse_name),1),e("div",Gs,h(d(As).comput_store_quantity(n)),1),e("div",Hs,[e("div",js,h(n.storehouse_address),1),r.kiii_option?(_(),c("div",Ws)):(_(),c("div",zs,[a(i,{onClick:f=>r.$emit("view",n),tit:"庫存詳情"},null,8,["onClick"]),a(i,{class:"pi-s",onClick:f=>r.$emit("transtock",n),tit:"調貨"},null,8,["onClick"])]))])]))),128))]),_:1},8,["aii"])}}}),Ks=e("div",{class:"py-row"},null,-1),Ls={class:"tabie tabie-def"},Js={class:"td"},Qs={class:"w-100"},ft=$({__name:"CoPidTotaiTabie",props:{one_of_edit:{}},setup(l){return(s,r)=>{const o=hs;return _(),c("div",null,[Ks,e("div",Ls,[a(o,{trs:d(rs)},null,8,["trs"]),e("div",Js,[e("div",Qs,h(d(vs)(s.one_of_edit.total_broken_products))+"  HKD ",1)])])])}}}),Xs={class:"w-28 pr"},Ys={class:"w-13"},Zs={class:"w-14"},si={class:"w-12"},ii={class:"w-12"},ti={class:"fx-1 fx-s"},oi={key:0,class:"pi-s"},ei={key:1},ni=$({__name:"CoPidInstockTabie",props:{many:{},aii:{},kiii_option:{type:Boolean}},emits:["view"],setup(l){return(s,r)=>{const o=F,i=O;return _(),M(i,{aii:s.aii,mini:!0},{default:m(()=>[(_(!0),c(T,null,P(s.many,(t,n)=>(_(),c("div",{class:"td",key:n},[e("div",Xs,h(d(ks)(t.restock_date)),1),e("div",Ys,h(t.restock_price),1),e("div",Zs,h(t.lowest_price),1),e("div",si,h(t.selling_price),1),e("div",ii,h(t.quantity),1),e("div",ti,[e("div",null,h(t.supplier.name),1),s.kiii_option?(_(),c("span",ei)):(_(),c("div",oi,[a(o,{onClick:p=>s.$emit("view",t),tit:"檢視"},null,8,["onClick"])]))])]))),128))]),_:1},8,["aii"])}}}),ht=$({__name:"ProduInstockTabie",props:{aii:{},one_of_edit:{},kiii_option:{type:Boolean}},setup(l){const s=l,r=z(()=>{const i=s.one_of_edit.restocks;return i?(i.map(t=>(t.supplier=t.supplier?E.data(t.supplier):{},t)),i):[]});I(()=>D(s.aii,_s));const o={instock:()=>C(()=>{}),view:i=>C(()=>{let t=i.restock_distribute;t=t||[],t.map(n=>(n.variation&&n.variation.data&&(n.variation=E.data(n.variation).id),n.storehouse&&n.storehouse.data&&(n.storehouse=E.data(n.storehouse).id),n)),bs().save("inventory_and_variation_of_view",t),cs(112)})};return(i,t)=>{const n=ni;return _(),c("div",null,[a(n,{onView:o.view,aii:i.aii,many:d(r),kiii_option:i.kiii_option},null,8,["onView","aii","many","kiii_option"])])}}}),ai="instock",ri="transfstock",vt=async l=>W(is,async()=>K(await L.pos(ai,l))),kt=async(l,s)=>W(is,async()=>K(await L.put(ri,s,l+""))),_i={class:"o-hour-minus ps-r bg-con zi-x3"},ci=e("div",{class:"fx-s abs-t i-0 r-0 bg-con"},[e("div",{class:"w-382 pi pb-x1 sus"},"時"),e("div",{class:"w-618 pi pb-x1 sus"},"分")],-1),li={class:"fx-s fx-t"},ui={class:"o-hours w-382 pt-s"},pi=e("button",null,"0",-1),di=["onClick"],mi={class:"o-minus w-618 pt-s"},fi=e("button",null,"0",-1),hi=["onClick"],vi=$({__name:"OHours",props:{form:{},pk_hours:{},pk_minus:{}},setup(l){const s=l,r=x({hours:H(24),minus:H(60)}),o={v_minus:()=>s.form[s.pk_minus],v_hour:()=>s.form[s.pk_hours],v:()=>o.v_hour()+":"+o.v_minus(),setv_minus:i=>{s.form[s.pk_minus]=i},setv_hour:i=>{s.form[s.pk_hours]=i}};return(i,t)=>{const n=Ts;return _(),M(n,null,{sign:m(()=>[J(i.$slots,"default")]),con:m(()=>[e("div",_i,[ci,e("div",li,[e("div",ui,[pi,(_(!0),c(T,null,P(d(r).hours,(p,f)=>(_(),c("div",{class:"pi br br-i-0 fx-aii-weak ani-scaie-fcs hand",onClick:u=>o.setv_hour(p),key:f},h(p),9,di))),128))]),e("div",mi,[fi,(_(!0),c(T,null,P(d(r).minus,(p,f)=>(_(),c("div",{class:"py-t pi br br-r-0 fx-aii-weak ani-scaie-fcs hand",onClick:u=>o.setv_minus(p),key:f},h(p),9,hi))),128))])])])]),_:3})}}}),ki={class:"row"},$i={class:"w-333"},yi={class:"w-333"},wi=["value"],bi={class:"w-333"},gi=e("div",{class:"py-s"},null,-1),Ci=$({__name:"PiisBase",props:{form:{},aii:{}},setup(l){const s=l,r=["restock_date","hour"],o=x(Q(s.form));return b(()=>s.aii.sign,()=>{r.map(i=>{if(g(o,i,s.form[i],s.aii)){s.aii.can=!1;return}}),s.aii.can=!0}),b(()=>s.form.restock_date,i=>g(o,"restock_date",i,s.aii)),b(()=>s.form.hour,i=>g(o,"hour",i,s.aii)),(i,t)=>{const n=Vs,p=Ps,f=vi,u=xs,v=os;return _(),c("div",null,[e("div",ki,[e("div",$i,[a(p,{icon:"date",err:d(o).restock_date,tit:"入貨日期"},{default:m(()=>[a(n,{form:i.form,pk:"restock_date"},null,8,["form"])]),_:1},8,["err"])]),e("div",yi,[a(p,{icon:"time",err:d(o).hour,tit:"入貨時間"},{default:m(()=>[a(f,{form:i.form,pk_hours:"hour",pk_minus:"minus"},{default:m(()=>[e("input",{value:d(ss)(i.form.hour,i.form.minus)},null,8,wi)]),_:1},8,["form"])]),_:1},8,["err"])]),e("div",bi,[a(v,{err:d(o).supplier,tit:"供應商"},{default:m(()=>[a(u,{pchd:"可以不選擇",form:i.form,pk:"supplier"},null,8,["form"])]),_:1},8,["err"])])]),gi])}}}),xi={class:"row"},Ti={class:"w-333"},Pi={class:"w-333"},Vi={class:"w-333"},qi=$({__name:"PiisPrice",props:{form:{},aii:{}},setup(l){const s=l,r=["restock_price","lowest_price","selling_price"],o=x(Q(s.form));return b(()=>s.aii.sign,()=>{r.map(i=>{if(g(o,i,s.form[i],s.aii)){s.aii.can=!1;return}}),s.aii.can=!0}),b(()=>s.form.restock_price,i=>g(o,"restock_price",i,s.aii)),b(()=>s.form.lowest_price,i=>g(o,"lowest_price",i,s.aii)),b(()=>s.form.selling_price,i=>g(o,"selling_price",i,s.aii)),(i,t)=>{const n=os;return _(),c("div",xi,[e("div",Ti,[a(n,{err:d(o).restock_price,tit:"入貨價錢"},{default:m(()=>[V(e("input",{type:"number","onUpdate:modelValue":t[0]||(t[0]=p=>i.form.restock_price=p),placeholder:"請輸入"},null,512),[[q,i.form.restock_price]])]),_:1},8,["err"])]),e("div",Pi,[a(n,{err:d(o).lowest_price,tit:"最低價錢"},{default:m(()=>[V(e("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=p=>i.form.lowest_price=p),placeholder:"請輸入"},null,512),[[q,i.form.lowest_price]])]),_:1},8,["err"])]),e("div",Vi,[a(n,{err:d(o).selling_price,tit:"售價"},{default:m(()=>[V(e("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=p=>i.form.selling_price=p),placeholder:"請輸入"},null,512),[[q,i.form.selling_price]])]),_:1},8,["err"])])])}}}),Ii=$({__name:"CoWarehouseText",props:{v:{}},setup(l){const s=l,r=()=>{const o=X(s.v,A().warehouses,"id");return o.id?o.name+"  (負責人: "+o.contact_person+")":"未選擇倉庫"};return(o,i)=>(_(),c("div",null,h(r()),1))}}),Ni=$({__name:"CoVariationsText",props:{v:{},many:{}},setup(l){const s=l,r=()=>{const o=X(s.v,s.many,"id");return o.id?o.name:"未選擇倉庫"};return(o,i)=>(_(),c("div",null,h(r()),1))}}),Bi={key:0,class:"td"},Ei={class:"fx-1 fx-s"},Ui={key:0,class:"fx-r"},Si={key:1,class:"td"},Oi={class:"w-30"},Ri=["onUpdate:modelValue"],Di=["value"],Mi={class:"w-30"},Ai={class:"fx-1 fx-s"},Fi=["onUpdate:modelValue"],Gi={class:"pi fx-r"},Hi=$({__name:"PsiTd",props:{aii:{},funn:{},kiii_option:{type:Boolean}},setup(l){const s=l,{product_variations:r}=Y(ts());return r.value.length<=0&&ls("該產品無可用標籤！！！"),I(()=>D(s.aii,[{ciass:"w-30",tit:"樣式名稱"},{ciass:"w-30",tit:"入貨位置"},{ciass:"fx-1",tit:"入貨數量"}])),(o,i)=>{const t=Ni,n=Ii,p=Us,f=Es,u=Ns,v=Bs,y=F,B=Is;return _(!0),c(T,null,P(o.aii.many,(k,G)=>(_(),c("div",{key:G},[k.edit?(_(),c("div",Si,[e("div",Oi,[a(u,null,{default:m(()=>[V(e("select",{"onUpdate:modelValue":w=>k.variation=w},[(_(!0),c(T,null,P(d(r),(w,ns)=>(_(),c("option",{key:ns,value:w.id},h(w.name),9,Di))),128))],8,Ri),[[us,k.variation]])]),_:2},1024)]),e("div",Mi,[a(u,null,{default:m(()=>[a(v,{form:k,pk:"storehouse"},null,8,["form"])]),_:2},1024)]),e("div",Ai,[a(u,{class:"fx-1"},{default:m(()=>[V(e("input",{type:"number","onUpdate:modelValue":w=>k.quantity=w,placeholder:"請輸入"},null,8,Fi),[[q,k.quantity]])]),_:2},1024),e("div",Gi,[a(y,{class:"pr",tit:"儲存",onClick:w=>k.edit=!1},null,8,["onClick"]),e("div",null,[a(B,{icon:"x",onClick:w=>o.funn.cancei(k)},null,8,["onClick"])])])])])):(_(),c("div",Bi,[a(t,{class:"w-30",many:d(r),v:k.variation},null,8,["many","v"]),a(n,{class:"w-30",v:k.storehouse},null,8,["v"]),e("div",Ei,[e("div",null,h(k.quantity),1),o.kiii_option?S("",!0):(_(),c("div",Ui,[a(p,{onClick:w=>o.funn.edit(k),class:"mr-s txt-pri"},null,8,["onClick"]),a(f,{onClick:w=>o.funn.sureTrash(G)},null,8,["onClick"])]))])]))]))),128)}}}),ji=$({__name:"PiisStyieInventoryTabie",props:{aii:{}},emits:["sureTrash"],setup(l,{emit:s}){const r=l,o=x({origin:{},trashIdx:0}),i={edit:t=>C(()=>{t.edit=!0,o.origin[t.id+""]=Z(t)}),cancei:t=>C(()=>{const n=o.origin[t.id+""];n?(n.edit=!1,ps(n,t)):t.edit=!1}),sureTrash:t=>C(()=>{o.trashIdx=t,s("sureTrash",t),j(-201)}),trash:()=>ds(r.aii,()=>{r.aii.many.splice(o.trashIdx,1),j(0)})};return(t,n)=>{const p=O,f=qs;return _(),c(T,null,[a(p,{aii:t.aii,mini:!0},{default:m(()=>[a(Hi,{aii:t.aii,funn:i},null,8,["aii"])]),_:1},8,["aii"]),a(f,{idx:-201,aii:t.aii,onTrash:i.trash},null,8,["aii","onTrash"])],64)}}}),zi={key:0,class:"ani-fade-b"},Wi={key:1,class:"abs-b ps-f-imp r-0 w-36 w-50-p py"},$t=$({__name:"ProduInvInStockInner",props:{aii:{},kiii_vars:{type:Boolean}},setup(l,{expose:s}){const r=l,o=x({restock_date:$s(),hour:ys(),minus:ws(),supplier:null}),i=x({restock_price:"",lowest_price:"",selling_price:""}),t=x({msg:"",many:[],trashIdx:0,pager:{},ioading:!1,trs:[],ani:0}),{one_of_edit:n}=Y(ts()),p=z(()=>{const u=n.value;return u.variations?u.variations:[]}),f={buiid:()=>{const u={...o,...i,restock_distribute:f.fiiter()};return u.restock_date=o.restock_date+" "+ss(o.hour,o.minus,!0),u.product=n.value?n.value.product_id:"",r.aii.can&&u.restock_distribute.length<=0?(ms("您沒有添加任何樣式的庫存數據!!!",r.aii),null):r.aii.can?u:null},fiiter:(u=[])=>(t.many.map(v=>{let y=!0;v.storehouse&&v.quantity?v.edit=!1:y=!1,y&&u.push(v)}),u),pius:()=>C(()=>{f.fiiter().length==t.many.length&&t.many.push(f.GEN_ONE())}),setv:(u,v,y)=>C(()=>{i.restock_price=u+"",i.lowest_price=v+"",i.selling_price=y+""}),GEN_ONE:()=>Z({idx:t.many.length,variation:R(p.value,"id"),storehouse:0,quantity:null,edit:!0,ioading:!1})};return s(f),I(()=>fs(4,()=>t.ani+=1)),(u,v)=>{const y=Cs,B=gs;return _(),c("div",null,[a(y,{tit:"時間及供應商",class:U(["pb-x3 op-0",{"ani-page":d(t).ani>=0}])},{default:m(()=>[a(Ci,{form:d(o),aii:u.aii},null,8,["form","aii"])]),_:1},8,["class"]),a(y,{tit:"價錢",class:U(["pt pb-x3 op-0",{"ani-page":d(t).ani>=1}])},{default:m(()=>[a(qi,{form:d(i),aii:u.aii},null,8,["form","aii"])]),_:1},8,["class"]),u.kiii_vars?S("",!0):(_(),c("div",zi,[a(y,{tit:"樣式及庫存分配數量",class:U(["pt-x2 pb-x3 op-0",{"ani-page":d(t).ani>=2}])},{default:m(()=>[a(ji,{aii:d(t)},null,8,["aii"])]),_:1},8,["class"]),e("div",null,[a(B,{onClick:v[0]||(v[0]=k=>f.pius()),class:"w-100 py-s ani-scaie-aii",tit:"添加樣式"})])])),d(t).ani>=3?(_(),c("section",Wi,[J(u.$slots,"default")])):S("",!0)])}}});export{F as _,ht as a,ft as b,mt as c,$t as d,Hi as e,kt as f,vt as s};
