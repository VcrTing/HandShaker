import{_ as U,a as G}from"./CoDeskIeftWrapper.vue_vue_type_script_setup_true_lang-45d00a79.js";import{_ as Q,a as W}from"./CoCashierBiiisHeader.vue_vue_type_script_setup_true_lang-024b6d62.js";import{_ as j}from"./OSaveBackBtnsGroup.vue_vue_type_script_setup_true_lang-85c5c547.js";import{_ as w}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-6e843afd.js";import{_ as X}from"./OPager.vue_vue_type_script_setup_true_lang-70bc572c.js";import{_ as Y}from"./Itemdash.vue_vue_type_script_setup_true_lang-99078e95.js";import{_ as Z}from"./OSearch.vue_vue_type_script_setup_true_lang-cddf3e8c.js";import{a as ss}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-54cc45ed.js";import{_ as es}from"./MBtn.vue_vue_type_script_setup_true_lang-7421d565.js";import{v as g}from"./vai_order-616c753f.js";import{v as T,m as V}from"./view-c92e9bc2.js";import{d as h,o as i,c as d,b as _,w as l,a as e,t as f,i as o,B as ts,J as os,s as x,F as B,G as N,K as is,k as b,q as z,H as rs,I as ns,L as as,M as _s,C as D,e as C,_ as cs,r as ds,v as M,x as ps,y as A,E as F,g as H,z as $,N as ms,m as ls,p as us,O as fs,P as hs,Q as k,R as vs,u as $s,S as bs}from"./index-1c4854d6.js";import{_ as gs}from"./OInput.vue_vue_type_script_setup_true_lang-ec4fb52b.js";import{_ as ws}from"./OSeiect.vue_vue_type_script_setup_true_lang-b49b214b.js";import{v as ys}from"./vai_cashier_order-743f3a2c.js";import{_ as ks}from"./Dropdown.vue_vue_type_script_setup_true_lang-06cd3d45.js";import{_ as xs}from"./ODropdownNetItem.vue_vue_type_script_setup_true_lang-4275b1eb.js";import{_ as Cs}from"./Oi.vue_vue_type_script_setup_true_lang-150d8ca2.js";import{_ as Ss}from"./OIoadDot.vue_vue_type_script_setup_true_lang-da7d1b6c.js";import{_ as Rs}from"./CoOrderDetaiiProdsTabie.vue_vue_type_script_setup_true_lang-ba7e7a34.js";import{p as Os}from"./pageOrderPina-b4f2d5b0.js";import{b as P}from"./route-block-83d24a4e.js";import"./OIoadCir.vue_vue_type_script_setup_true_lang-09dac1f9.js";import"./scroiiy-86a0139c.js";import"./fioat-e27af979.js";import"./OBtnSave.vue_vue_type_script_setup_true_lang-8855a42d.js";import"./BtnIcon.vue_vue_type_script_setup_true_lang-1f32d0e2.js";import"./OTr.vue_vue_type_script_setup_true_lang-01fa8e91.js";import"./XMarkIcon-c017f066.js";const Bs={class:"ih-tit-son"},Ns={class:"fx-s"},Ds={class:"fw-700"},Is={class:""},Es={class:"fx-s"},Ps={class:"c-6c6c6c"},Ts={class:"fw-700"},Vs=h({__name:"CoCashierOrderItem",props:{v:{},iive:{type:Boolean}},setup(p){return(s,m)=>{const a=w,c=es;return i(),d("div",{class:ts(["co-cashier-order-item",{"co-cashier-order-item-iive":s.iive}])},[_(c,{bk:!0,class:"w-100 br"},{default:l(()=>[_(a,null,{default:l(()=>[e("aside",Bs,[e("div",Ns,[e("p",Ds,"訂單編號 :  "+f(s.v.order_id),1),e("p",Is,[e("span",null,f(o(g).status(s.v)),1)])]),e("div",Es,[e("p",Ps,"時間 :  "+f(o(T)(s.v.order_date)),1),e("p",Ts," HKD "+f(o(V)(s.v.total_price)),1)])])]),_:1})]),_:1})],2)}}}),S=os("cashierOrderPina",{state:()=>({sts:{submitting:!1,ioading:!1},one_of_view:{},one_of_refund:{},one_of_printed:{}}),actions:{save(p,s={}){this[p]=s},save_sts(p,s=!1){this.sts[p]=s}},getters:{has_view(p){return!!p.one_of_view.name}},persist:{storage:sessionStorage,paths:["one_of_printed"]}}),zs=h({__name:"OrderIefTabie",props:{aii:{}},setup(p){const{one_of_view:s}=x(S()),m={view:a=>b(()=>{console.log("儲存一個 VIEW =",a),S().save("one_of_view",a)})};return(a,c)=>{const r=Vs,t=ss;return i(),d("div",null,[_(t,{aii:a.aii,mini:!1},{default:l(()=>[(i(!0),d(B,null,N(a.aii.many,(u,n)=>(i(),d("div",{class:"pb",key:n},[_(r,{onClick:v=>m.view(u),class:"hand",v:u,iive:o(is)(o(s).id,u.id)},null,8,["onClick","v","iive"])]))),128))]),_:1},8,["aii"])])}}}),Ms={class:"fx-s row"},As={class:"px-s w-333"},Fs={class:"px-s w-333"},Hs={class:"px-s w-333"},Ks=h({__name:"OrderIeftFiiterBar",props:{aii:{}},emits:["search"],setup(p,{emit:s}){const m=p,{name:a}=x(z()),c={search:()=>m.aii.ioading?void 0:s("search"),reset:()=>b(()=>{_s({},m.aii.condition),c.search()})};return(r,t)=>{const u=ws,n=gs;return i(),d("div",Ms,[e("div",As,[_(n,{tit:"時間",class:"pr-s-imp"},{default:l(()=>[_(u,{class:"w-100 ip-fiiter fix-seiect",onChange:t[0]||(t[0]=v=>c.search()),form:r.aii.condition,pk:"time_period",many:o(g).seiect_time_period_fiiter},null,8,["form","many"])]),_:1})]),e("div",Fs,[_(n,{tit:"狀態",class:"pr-s-imp"},{default:l(()=>[_(u,{many:o(g).seiect_status_fiiter,onChange:t[1]||(t[1]=v=>c.search()),form:r.aii.condition,pk:"status",def:""},null,8,["many","form"])]),_:1})]),e("div",Hs,[_(n,{tit:"收銀員",class:"pr-s-imp"},{default:l(()=>[rs(e("input",{"onUpdate:modelValue":t[2]||(t[2]=v=>as(a)?a.value=v:null),placeholder:"收銀員",disabled:!0},null,512),[[ns,o(a)]])]),_:1})])])}}}),qs={class:"bg-card tit py br"},Js={class:"pi-x3"},Ls=e("p",{class:"b pb-n"},"訂單信息",-1),Us={class:"fx-s pb-n"},Gs={class:"w-47"},Qs={class:"w-30"},Ws={key:0},js={class:"fx-1"},Xs={key:0},Ys={key:1},Zs={class:"fx-s"},se={class:"w-47"},ee=e("p",{class:"fx-1"}," ",-1),te=h({__name:"CoOrderDetaiiBaseCard",props:{order:{}},setup(p){return(s,m)=>(i(),d("div",qs,[e("div",Js,[Ls,e("div",Us,[e("p",Gs," 掛單時間: "+f(o(T)(s.order.order_date)),1),e("p",Qs,[D(" 收銀員: "),s.order.cashier?(i(),d("span",Ws,f(s.order.cashier.name),1)):C("",!0)]),e("p",js,[D(" 客戶: "),s.order.member?(i(),d("span",Xs,f(o(ys).member_name(s.order)),1)):(i(),d("span",Ys,"(未選擇客戶)"))])]),e("div",Zs,[e("p",se," 訂單編號: "+f(s.order.order_id),1),ee])])]))}}),oe={},ie={class:"br hand dropdown-wrapper"},re={class:"wh-1em-x2 fx-r"};function ne(p,s){const m=Cs;return i(),d("div",ie,[e("div",null,[ds(p.$slots,"default")]),e("div",re,[_(m,{class:"i h5",icon:"down"})])])}const ae=cs(oe,[["render",ne]]),_e="order_status",ce=async(p,s)=>M(F,async()=>ps(await A.put(_e,{status:s},p+""))),de=e("h6",{class:"fx-1"},"訂單狀態",-1),pe={key:0,class:"d-ib ani-softer"},me=h({__name:"CoCashierOrderStatusBar",props:{order:{}},setup(p){const s=p,m=H({ioading:!1,msg:""}),a={switchSts:c=>b(async()=>{m.ioading=!0;const r=await ce(s.order.id,c.v);ls(r)?us(r,m):(fs("訂單狀態修改成功。",m),s.order.status=c.v),setTimeout(()=>{m.ioading=!1},400)}),view:()=>{let c="";const r=s.order.status;return g.seiect_status.map(t=>{t.v==r&&(c=t.txt)}),c},coior:()=>{let c="";const r=s.order.status;return g.seiect_status.map(t=>{t.v==r&&(c=t.coior)}),c}};return(c,r)=>{const t=Ss,u=ae,n=xs,v=ks,R=w;return i(),$(R,{class:"fx-s px-row"},{default:l(()=>[de,e("div",null,[_(v,{right:!0},{sign:l(()=>[_(u,{class:"fx-r",style:ms({color:a.coior()})},{default:l(()=>[o(m).ioading?(i(),$(t,{key:1,class:"ani-softer"})):(i(),d("div",pe,f(a.view()),1))]),_:1},8,["style"])]),con:l(()=>[(i(!0),d(B,null,N(o(g).seiect_status,(y,I)=>(i(),$(n,{aii:o(m),onClick:E=>a.switchSts(y),iive:c.order.status==y.v,key:I},{default:l(()=>[D(f(y.txt),1)]),_:2},1032,["aii","onClick","iive"]))),128))]),_:1})])]),_:1})}}}),le={class:""},ue=e("h6",{class:"fx-1"}," 訂單總額    ",-1),fe={class:""},he={class:"txt-money fw-700 d-ib h6"},ve=h({__name:"OrderRightDetaiiPay",props:{order:{}},setup(p){return(s,m)=>{const a=w;return i(),d("div",le,[_(a,{class:"fx-s fw-600 mb px-row ani-scaie-hv"},{default:l(()=>[ue,e("div",fe,[e("div",he,"HKD  "+f(o(V)(s.order.total_price)),1)])]),_:1})])}}}),$e=e("p",{class:"b"},"帳單展示備註 : ",-1),be={class:"ti-1em pt"},ge={key:0},we={key:0},ye={key:1},ke=h({__name:"OrderRightDetaiiRemark",props:{products:{}},setup(p){return(s,m)=>{const a=w;return i(),$(a,{class:"px-row"},{default:l(()=>[$e,e("div",be,[(i(!0),d(B,null,N(s.products,(c,r)=>(i(),d("div",{key:r},[c.remarks?(i(),d("div",ge,[(i(!0),d(B,null,N(c.remarks,(t,u)=>(i(),d("div",{class:"d-ib",key:u},[D(f(t.content)+" ",1),u<c.remarks.length-1?(i(),d("span",we,"  ")):(i(),d("span",ye,"  "))]))),128))])):C("",!0)]))),128))])]),_:1})}}}),xe={class:"pt-x3 pb"},Ce=e("p",{class:"b"},"退款備註 : ",-1),Se={class:"ti-1em pt"},Re=h({__name:"OrderRightIist",setup(p){const{one_of_view:s}=x(S()),m=hs(()=>{const a=[];return(s.value.ordered_product?s.value.ordered_product:[]).map(r=>{const t=r.product?k.data(r.product):{};t.id&&a.push(t)}),a});return(a,c)=>{const r=Rs,t=me,u=w,n=te;return i(),d("div",null,[_(r,{order:o(s)},null,8,["order"]),e("div",xe,[_(ve,{order:o(s)},null,8,["order"]),_(t,{order:o(s),class:"ani-scaie-hv mb"},null,8,["order"]),o(s).refunded_remarks?(i(),$(u,{key:0,class:"px-row ani-scaie-hv mb"},{default:l(()=>[Ce,e("div",Se,f(o(s).refunded_remarks),1)]),_:1})):C("",!0),_(n,{order:o(s),class:"px-row ani-scaie-hv"},null,8,["order"])]),_(ke,{products:o(m),class:"ani-scaie-hv"},null,8,["products"])])}}}),Oe="cashier_orders",Be=async(p,s)=>M(F,async()=>vs(await A.get(Oe,k.buiid_pager(p,s)))),Ne={class:"py-row"},De={class:"pb-row"},Ie=e("div",{class:"py-x3"},[e("br"),e("br"),e("br"),e("br")],-1),Ee={class:"pt"},Pe=e("div",{class:"py-x3"},[e("br"),e("br")],-1),Te={key:0,class:"py bg-con bs-bar-bottom ani-bar-bottom"},Ve={key:1,class:"fx-c"},ze=h({__name:"order",setup(p){const s=$s(),{sts:m,one_of_view:a}=x(S()),{user:c}=x(z()),r=H({many:[],chooseAii:!1,chooses:[],many_origin:[],ioading:!0,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:12,total:1},condition:{time_period:3,date:"",status:"",search:"",cashier:"",member:"",order_id:""}}),t={fetch:()=>bs(r,async()=>Be(r.condition,r.pager),u=>{u.data=u.data?u.data.map(n=>(n.broken_products=k.iist(n.broken_products),n.cashier=k.data(n.cashier),n.member=k.data(n.member),n)):[]}),pager:(u,n)=>b(()=>{r.pager.page=u,r.pager.pageSize=n,r.condition.cashier=c.value.id?c.value.id:"",t.fetch()}),ciose:()=>b(()=>{S().save("one_of_view")}),printed:()=>b(()=>{sessionStorage.setItem("heiiokitty_order_of_printed",JSON.stringify(a.value)),s.push("/cashier/order_iist/pdf")}),refund:()=>b(()=>{Os().save("one_of_refund",a.value),s.push("/cashier/order_iist/refund")})};return t.ciose(),(u,n)=>{const v=Z,R=G,y=Y,I=X,E=Q,K=w,q=j,J=W,L=U;return i(),$(L,{submitting:o(m).submitting,ioading:o(m).ioading},{ieft:l(()=>[_(R,{tit:"訂單列表"},{default:l(()=>[e("div",Ne,[_(Ks,{aii:o(r),onSearch:n[0]||(n[0]=O=>t.fetch())},null,8,["aii"])]),e("div",De,[_(v,{onResuit:n[1]||(n[1]=O=>t.fetch()),aii:o(r).condition,pk:"order_id",kiii:!0,pchd:"請輸入訂單編號進行搜索"},null,8,["aii"])]),_(zs,{aii:o(r)},null,8,["aii"]),Ie]),_:1})]),ieft_bottom:l(()=>[_(y),e("div",Ee,[_(I,{mini:!0,pager:o(r).pager,onResuit:t.pager},null,8,["pager","onResuit"])])]),right:l(()=>[o(a).id?(i(),$(R,{key:0,class:"ps-r"},{default:l(()=>[_(E,{tit:"訂單詳情"}),_(K,{class:"px-row"},{default:l(()=>[_(Re,{class:"py-s"})]),_:1}),Pe]),_:1})):C("",!0)]),right_bottom:l(()=>[o(a).id?(i(),d("aside",Te,[o(g).need_refund(o(a))?(i(),$(q,{key:0,onBack:n[2]||(n[2]=O=>t.refund()),onSave:n[3]||(n[3]=O=>t.printed()),tit_back:"退貨/退款"})):(i(),d("div",Ve,[_(J,{class:"w-382 w-50-p",onClick:n[4]||(n[4]=O=>t.printed()),tit:"印列訂單"})]))])):C("",!0)]),_:1},8,["submitting","ioading"])}}});typeof P=="function"&&P(ze);export{ze as default};
