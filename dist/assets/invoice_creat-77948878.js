import{_ as Z}from"./IayoutPan.vue_vue_type_script_setup_true_lang-1a587636.js";import{_ as J}from"./ModInner.vue_vue_type_script_setup_true_lang-74820c1b.js";import{d as C,o as n,y as V,w as m,r as Q,c as u,a as o,i as d,b as a,N as F,t as H,g as O,a6 as G,h as B,G as g,H as $,ae as D,u as R,X as z,F as x,D as U,A as N,a7 as P,e as b,k,m as X,s as K,n as L,C as W,R as ss,M as ts,$ as T,q as is,v as es,x as os,j as as,a0 as ns,p as rs,l as _s}from"./index-d70d8c7f.js";import{_ as j}from"./OBtnSave.vue_vue_type_script_setup_true_lang-23565353.js";import{f as E}from"./fioat-e27af979.js";import{_ as q}from"./IayoutForm.vue_vue_type_script_setup_true_lang-8e5172a2.js";import{a as cs,_ as ds}from"./CoWarehouseSeiectPure.vue_vue_type_script_setup_true_lang-58312131.js";import{_ as ls}from"./OInput.vue_vue_type_script_setup_true_lang-4873cbdf.js";import{_ as us}from"./CoSuppiierSeiect.vue_vue_type_script_setup_true_lang-cc4090e7.js";import{_ as ms}from"./OInputI.vue_vue_type_script_setup_true_lang-22b5b7c8.js";import{_ as ps}from"./OTime.vue_vue_type_script_setup_true_lang-a0e9100e.js";import{_ as fs}from"./OModTrash.vue_vue_type_script_setup_true_lang-5976dc4b.js";import{b as vs,_ as hs}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-a0330491.js";import{_ as ys}from"./BtnTab.vue_vue_type_script_setup_true_lang-895b09b8.js";import{_ as Y}from"./BtnIcon.vue_vue_type_script_setup_true_lang-0184e3ad.js";import{_ as ws}from"./BtnIconX2.vue_vue_type_script_setup_true_lang-b87a4458.js";import{_ as As}from"./MBtn.vue_vue_type_script_setup_true_lang-6b8b253f.js";import{_ as bs}from"./OIoadCir.vue_vue_type_script_setup_true_lang-4da0897d.js";import{_ as gs}from"./Oi.vue_vue_type_script_setup_true_lang-40f83607.js";import{invoiceCreatPina as I}from"./invoiceCreatPina-4b9c626d.js";import{E as $s}from"./errors_product-d5275ad5.js";import{b as S}from"./route-block-83d24a4e.js";import"./OIoadDot.vue_vue_type_script_setup_true_lang-2dd1b368.js";import"./giobaiPina-fe26a8db.js";import"./serv_suppiier_iist-c0c8a6bd.js";import"./serv_user_iist-b50e689f.js";import"./serv_warehouse_iist-8aae149f.js";import"./Dropdown.vue_vue_type_script_setup_true_lang-a9318c7a.js";import"./OTabieEmptyTwo.vue_vue_type_script_setup_true_lang-ab6c0427.js";import"./InboxIcon-3ce72c36.js";import"./ODropdownNetItem.vue_vue_type_script_setup_true_lang-55a0f705.js";import"./datepicker.esm-cd618bfe.js";import"./OTr.vue_vue_type_script_setup_true_lang-a26f0019.js";import"./OiX2.vue_vue_type_script_setup_true_lang-eabbb5fd.js";import"./DocumentTextIcon-90c95568.js";import"./PlusCircleIcon-96359f44.js";import"./XMarkIcon-bb061af1.js";import"./serv_product_iist-1de6728a.js";const ks=C({__name:"OModPure",props:{idx:{},aii:{},msg:{}},emits:["sure"],setup(h){return(e,p)=>{const _=J;return n(),V(_,{class:"mod-s",idx:e.idx?e.idx:100,stat:e.aii.ioading,pure:!0},{default:m(()=>[Q(e.$slots,"default")]),_:3},8,["idx","stat"])}}}),Cs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALeSURBVHgB7ZtBctMwFIb/5zRdQSdHMDuGKSU3aHKCdkGgO5ITlJ6AcgLICUi2FGZygyQnaIYybMkRyhawH89OFikOiV3JT6XWN5NkImtk6bf0JD09Ax6Px1NhCI7gp52u/Bymf4gm9OXjEA5QF4DD4wYe1Mdy5yZu1mSG4FebZqNrKBJAm73dN5nGJ7Ck/d55DWX0BWA+/uc1olMooy8AEG641oAyLgS4U6gYwdTwPawnXT+x+t3NuWkktRppzQqlCpA2fG/3VMZ9YtyKdu+52IQBgp/9MmeG0gTg/ectacAHbB7zeZiLgD36+mmCEijFBvDBC5nqaAzzxiMtQ8pKyywB6z0grSjzOcqA6Fxsw1tYxKoAfPBSxnv8HmVCdCYiWLuHNQH48UmIevQd5XONCG36djGDBezZgHo0hg4N1PAOlrAiwHJnF0KPltiaV7CArR5QioXeCHMXFjC2Afyk05QueYliDOQz/aukllSn2FNlbpuuD3ZgCqUVRyEiTMWIDVaTZBglPwUFSLfVExhgPgQCOoIrAmrBEHMBiNW3sCs8gyHmAjA14Q5j8f93f0DlBTDGC4CK4wVAxfECoOKY7wVuQw2Hy7X/CrfYU1jAjQCLs4HuzSQ3B9XeBsAVzBP57smDTw5N5nCEmyHAPBNHRnslpS82IfEptqCMmx7AWHfu5yRCxJEAlD3ri934FdwIUFvj+gr0gyMSXE2DLd7vXIr8AxkOP7DwBYZwgCsBkMYJMco9RsuBjxDJm3F53r/Obd2FWwaZFOZh3vOC/EOAKIT7xq6jm0mJaYqc+KUwKs79FKDAxjK/DWCeywpugLsHZ1JI6urx5ELNDbNhHZElQt9WDNA29JbCsewAaznXEQGrbY1VHXHi9EiiyMIt2eZ0dfEISuhOg8y97ZniMyiiKsByfZ6IsC74OYn/69HV5xEUceKL5uZJiDg6kgYvgitq6ftCQ+33hTwej6fy/AGfJrsXt0lXRAAAAABJRU5ErkJggg==",Bs={class:"ta-c"},Vs={class:"w-100 fx-c pt"},Ds={class:"w-30 cms-warning-icon cir fx-c ani-scaie-aii"},xs=["src"],Is=o("div",{class:"pb-x1 px bg-con"},[o("h3",{class:"pb pt-x2"},"確認儲存？"),o("div",{class:"fx-c"},[o("p",{class:"w-64"},"確認儲存後，產品的數量將加入庫存，屆時修改產品數量需要到產品庫存頁面內修改。")])],-1),Ms={class:"py px"},Us=C({__name:"CoInvoiceModSure",props:{aii:{}},emits:["save"],setup(h){return(e,p)=>{const _=j;return n(),u("div",Bs,[o("div",Vs,[o("div",Ds,[o("img",{class:"w-50 ani-scaie-aii",src:d(Cs)},null,8,xs)])]),Is,o("div",Ms,[a(_,{aii:e.aii,tit:"確認",class:"btn-warning w-100 py ani-fade-b ani-scaie-aii",onClick:p[0]||(p[0]=i=>e.$emit("save"))},null,8,["aii"])])])}}}),Es={class:"row"},Os={class:"w-50"},Fs=o("div",null," 合計數量 ",-1),Hs={class:"pt-s"},Ts={class:"w-50"},Ns=o("div",null," 合計金額 ",-1),Ss={class:"pt-s"},Qs=C({__name:"OrderInTotai",props:{many:{}},setup(h){const e=h,p=F(()=>{let i=0;return e.many.map(r=>{const s=r.data_of_vars;s&&s.map(t=>{t.quantity&&(i+=t.quantity)})}),i}),_=F(()=>{let i=0;return e.many.map(r=>{const s=r.total_amount;return i=E.floatAdd(i,s),r}),i});return(i,r)=>(n(),u("div",Es,[o("div",Os,[Fs,o("div",Hs,[o("h4",null,H(d(p)),1)])]),o("div",Ts,[Ns,o("div",Ss,[o("h4",null,H(d(_)),1)])])]))}}),Rs={class:"row"},Xs={class:"w-333"},Ks={class:"w-333"},js={class:"w-333"},qs={class:"row pt"},Ys={class:"w-333"},Zs={class:"w-333"},Js={class:"w-333"},Gs=C({__name:"OrderInCreatBase",props:{form:{},aii:{}},setup(h){const e=h,p=["supplier","storehouse","date","invoice_id","invoice_address","delivery_address"],_=O(G(e.form));return B(()=>e.aii.sign,()=>{p.map(i=>{if(D(_,i,e.form[i],e.aii)){e.aii.can=!1;return}}),e.aii.can=!0}),B(()=>e.form.date,i=>D(_,"date",i,e.aii)),B(()=>e.form.supplier,i=>D(_,"supplier",i,e.aii)),B(()=>e.form.storehouse,i=>D(_,"storehouse",i,e.aii)),B(()=>e.form.invoice_id,i=>D(_,"invoice_id",i,e.aii)),B(()=>e.form.invoice_address,i=>D(_,"invoice_address",i,e.aii)),(i,r)=>{const s=ps,t=ms,l=us,f=ls,A=cs,w=q;return n(),V(w,{tit:"基本信息",class:"pb-x3 mb"},{default:m(()=>[o("div",Rs,[o("div",Xs,[a(t,{tit:"發票日期",err:d(_).date,icon:"date"},{default:m(()=>[a(s,{form:i.form,pk:"date"},null,8,["form"])]),_:1},8,["err"])]),o("div",Ks,[a(f,{tit:"供應商名稱",err:d(_).supplier},{default:m(()=>[a(l,{form:i.form,pk:"supplier"},null,8,["form"])]),_:1},8,["err"])]),o("div",js,[a(f,{tit:"入貨倉庫",err:d(_).storehouse},{default:m(()=>[a(A,{form:i.form,pk:"storehouse"},null,8,["form"])]),_:1},8,["err"])])]),o("div",qs,[o("div",Ys,[a(f,{tit:"訂單號碼",err:d(_).invoice_id},{default:m(()=>[g(o("input",{"onUpdate:modelValue":r[0]||(r[0]=c=>i.form.invoice_id=c),placeholder:"請輸入"},null,512),[[$,i.form.invoice_id]])]),_:1},8,["err"])]),o("div",Zs,[a(f,{tit:"帳單地址",err:d(_).invoice_address},{default:m(()=>[g(o("input",{"onUpdate:modelValue":r[1]||(r[1]=c=>i.form.invoice_address=c),placeholder:"請輸入"},null,512),[[$,i.form.invoice_address]])]),_:1},8,["err"])]),o("div",Js,[a(f,{tit:"送貨地址",err:d(_).delivery_address},{default:m(()=>[g(o("input",{"onUpdate:modelValue":r[2]||(r[2]=c=>i.form.delivery_address=c),placeholder:"請輸入"},null,512),[[$,i.form.delivery_address]])]),_:1},8,["err"])])])]),_:1})}}}),zs={key:0,class:"ani-softer fx-s"},Ps={key:1,class:"mxh-1em ani-softer"},Ls=C({__name:"OBtnSearchMini",props:{ioad:{type:Boolean}},setup(h){return(e,p)=>{const _=gs,i=bs,r=As;return n(),V(r,{class:"btn-pri hand br mw-4em",ciass:"fx-c"},{default:m(()=>[e.ioad?(n(),u("div",Ps,[a(i,{class:"h5",styie:"wht"})])):(n(),u("div",zs,[a(_,{icon:"search",class:"i h4"})]))]),_:1})}}}),Ws={class:"ai-fs-imp"},st={class:"w-11"},tt={class:"w-15"},it={key:0,class:"w-15 ani-softer"},et=["onUpdate:modelValue"],ot=["value"],at={key:0,class:"d-ib pr pi-s"},nt={key:1,class:"d-ib pr pi-s"},rt={key:1,class:"w-8 ani-softer"},_t=["onUpdate:modelValue"],ct={key:2,class:"w-9 ani-softer"},dt={key:3,class:"w-8 ani-softer"},lt={key:4,class:"w-10 ani-softer pi"},ut=["value"],mt={key:5,class:"w-7 ani-softer"},pt=["value"],ft={key:6,class:"w-8 ani-softer"},vt=["value"],ht={key:7,class:"w-6 ani-softer"},yt=["value"],wt={class:"fx-1 pi fx-r"},At=C({__name:"OciiTd",props:{v:{}},setup(h){const e=h,p=R(),_=I(),i=F(()=>{const s=e.v.__product;return s&&s.id}),r={pro:()=>i.value?e.v.__product:null,search:()=>k(async()=>{const s=e.v;if(s.__ioad)return;const t=s.number?s.number.trim():void 0;if(t){s.__ioad=!0;let l=await _.searchPro(t);if(!X(l))l=l,l&&l.id&&r.insert_pro(l,s);else{const f=p.resolve({path:"/admin/product_inventory_iist/creat"});window.open(f.href,"_blank")}setTimeout(()=>s.__ioad=!1,200)}}),insert_pro:(s,t)=>{t.product=s.id,t.__product=s,t.number=s.product_id,t.name=s.name,t.selling_price=s.new_selling_price,t.net_price=s.new_restock_price,t.lowest_price=s.new_lowest_price,t.data_of_vars||(t.data_of_vars=[]),t.data_of_vars.length<=0&&r.piusDFV()},proVariations:()=>{const s=r.pro();return s?s.variations:[]},piusDFV:()=>k(()=>{const s=_.genDFV(e.v);e.v.data_of_vars.push(s)}),trashDFV:s=>k(()=>{try{e.v.data_of_vars.splice(s,1)}catch{}})};return(s,t)=>{const l=ds,f=Ls,A=ws,w=Y;return n(),u("div",Ws,[o("div",st,[a(l,null,{default:m(()=>[g(o("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>s.v.number=c),onKeydown:t[1]||(t[1]=z(c=>r.search(),["enter"])),placeholder:"請輸入後按回車"},null,544),[[$,s.v.number]])]),_:1})]),o("div",tt,[d(i)?(n(),V(l,{key:0,class:"ani-softer"},{default:m(()=>[g(o("input",{"onUpdate:modelValue":t[2]||(t[2]=c=>s.v.name=c),placeholder:"請輸入"},null,512),[[$,s.v.name]])]),_:1})):(n(),V(f,{key:1,onClick:t[3]||(t[3]=c=>r.search()),class:"py-s",ioad:s.v.__ioad},null,8,["ioad"]))]),d(i)?(n(),u("div",it,[(n(!0),u(x,null,U(s.v.data_of_vars,(c,y)=>(n(),u("div",{class:N(["w-100 fx-s ani-softer",{"pt-s":y>0}]),key:y},[a(l,{class:"fx-1"},{default:m(()=>[g(o("select",{"onUpdate:modelValue":v=>c.variation=v},[(n(!0),u(x,null,U(r.proVariations(),(v,M)=>(n(),u("option",{key:M,value:v.id},H(v.name),9,ot))),128))],8,et),[[P,c.variation]])]),_:2},1024),y==0?(n(),u("div",at,[a(A,{icon:"pius-c",ciass_i:"sub",onClick:t[4]||(t[4]=v=>r.piusDFV())})])):(n(),u("div",nt,[a(w,{ciass_i:"",icon:"x",onClick:v=>r.trashDFV(y)},null,8,["onClick"])]))],2))),128))])):b("",!0),d(i)?(n(),u("div",rt,[(n(!0),u(x,null,U(s.v.data_of_vars,(c,y)=>(n(),u("div",{class:N(["w-100 ani-softer",{"pt-s":y>0}]),key:y},[a(l,null,{default:m(()=>[g(o("input",{type:"number","onUpdate:modelValue":v=>c.quantity=v,placeholder:"請輸入"},null,8,_t),[[$,c.quantity]])]),_:2},1024)],2))),128))])):b("",!0),d(i)?(n(),u("div",ct,[a(l,null,{default:m(()=>[g(o("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=c=>s.v.price=c),placeholder:"請輸入"},null,512),[[$,s.v.price]])]),_:1})])):b("",!0),d(i)?(n(),u("div",dt,[a(l,null,{default:m(()=>[g(o("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=c=>s.v.discount=c),placeholder:"請輸入"},null,512),[[$,s.v.discount]])]),_:1})])):b("",!0),d(i)?(n(),u("div",lt,[a(l,{class:"bd-c-t-imp"},{default:m(()=>[o("input",{value:s.v.new_stock_price,disabled:!0},null,8,ut)]),_:1})])):b("",!0),d(i)?(n(),u("div",mt,[a(l,{class:"bd-c-t-imp"},{default:m(()=>[o("input",{value:s.v.total_amount,disabled:!0},null,8,pt)]),_:1})])):b("",!0),d(i)?(n(),u("div",ft,[a(l,{class:"bd-c-t-imp bg-card"},{default:m(()=>[o("input",{value:s.v.lowest_price,disabled:!0},null,8,vt)]),_:1})])):b("",!0),d(i)?(n(),u("div",ht,[a(l,{class:"bd-c-t-imp bg-card"},{default:m(()=>[o("input",{value:s.v.selling_price,disabled:!0},null,8,yt)]),_:1})])):b("",!0),o("div",wt,[Q(s.$slots,"default")])])}}}),bt={key:0,class:"pb-x2 ani-softer"},gt={class:"mh-input-s py-n"},$t={key:1,class:"oti-con ani-softer"},kt={class:"ani-fade-b"},Ct=C({__name:"OrderInCreatInIist",emits:["sureTrash"],setup(h,{emit:e}){const p=O({many:[{__edit:!0}],chooseAii:!1,chooses:[],many_origin:[],ioading:!1,msg:"",trs:[],condition:{search:""},pager:{page:1,pageCount:1,pageSize:25,total:1}}),{many:_}=K(I()),i=O({origin:{},trashIdx:0});L(()=>W(p,[{ciass:"w-11",tit:"貨號"},{ciass:"w-15",tit:"貨品名稱 / 摘要"},{ciass:"w-15",tit:"樣式"},{ciass:"w-8",tit:"數量"},{ciass:"w-9",tit:"單價"},{ciass:"w-8",tit:"折扣"},{ciass:"w-10",tit:"最新入貨價錢"},{ciass:"w-7",tit:"統計"},{ciass:"w-8",tit:"最低價錢"},{ciass:"w-6",tit:"售價"},{ciass:"fx-1",tit:""}]));const r={pius:()=>k(()=>{I().pius()}),edit:s=>k(()=>{s.__edit=!0,i.origin[s.id+""]=ss(s)}),cancei:s=>k(()=>{const t=i.origin[s.id+""];t?(t.__edit=!1,ts(t,s)):s.edit=!1}),sureTrash:s=>k(()=>{i.trashIdx=s,e("sureTrash",s),T(-201)}),trash:()=>k(()=>{_.value.splice(i.trashIdx,1),T(0)})};return(s,t)=>{const l=Y,f=vs,A=ys,w=hs,c=q,y=fs;return n(),u(x,null,[a(c,{tit:"產品入單列表",class:"pb-x3 mb"},{default:m(()=>[a(w,{aii:d(p),mini:!0},{default:m(()=>[d(_).length>0?(n(),u("div",bt,[(n(!0),u(x,null,U(d(_),(v,M)=>(n(),u("div",{key:M,class:"ani-softer"},[v.__edit?(n(),V(At,{key:0,class:"td",v},{default:m(()=>[o("div",gt,[a(l,{icon:"trash",ciass_i:"txt-err",onClick:Mt=>r.sureTrash(M)},null,8,["onClick"])])]),_:2},1032,["v"])):b("",!0)]))),128))])):(n(),u("div",$t,[a(f,{class:"mh-oti-s"})])),o("div",kt,[a(A,{onClick:t[0]||(t[0]=v=>r.pius()),class:"w-100 py-s ani-scaie-aii",tit:"添加樣式"})])]),_:1},8,["aii"])]),_:1}),a(y,{idx:-201,aii:d(p),onTrash:r.trash},null,8,["aii","onTrash"])],64)}}}),Bt="invoices",Vt=async h=>is($s,async()=>es(await os.pos(Bt,h))),Dt={class:"fx-r"},xt=o("div",{class:"py-x3"},null,-1),It=C({__name:"invoice_creat",setup(h){const e=O({ioading:!1,msg:"",can:!1,sign:0}),{form:p,many:_}=K(I()),i=R();B(_,s=>{s.map(t=>{if(t.product){const l=t.data_of_vars;if(l&&l.length>0){const f=t.price,A=t.discount,w=E.floatAdd(f,-A);let c=0;l.map(y=>{if(y){const v=E.floatMul(w,y.quantity);c=E.floatAdd(v,c)}}),t.total_amount=c,t.new_stock_price=w}}})},{immediate:!0,deep:!0});const r={buiid:()=>({...p.value,restocks:_.value.map(s=>(s.variations=s.data_of_vars,s))}),submit:()=>as(e,r.buiid,async s=>{s&&T(300)}),__submit:()=>ns(e,async()=>{const s=r.buiid(),t=await Vt(s);X(t)?rs(t,e):(_s("產品入單成功！！！"),i.back(),I().ciear())})};return(s,t)=>{const l=j,f=Us,A=ks,w=Z;return n(),V(w,{tit:"入單發票",ciass:"w-100"},{default:m(()=>[o("div",Dt,[a(l,{class:"mw-10em",aii:d(e),tit:"儲存",onClick:t[0]||(t[0]=c=>r.submit())},null,8,["aii"])]),a(Gs,{aii:d(e),form:d(p)},null,8,["aii","form"]),a(Ct),a(Qs,{many:d(_)},null,8,["many"]),xt,a(A,{aii:d(e),idx:300},{default:m(()=>[a(f,{aii:d(e),onSave:t[1]||(t[1]=c=>r.__submit())},null,8,["aii"])]),_:1},8,["aii"])]),_:1})}}});typeof S=="function"&&S(It);export{It as default};
