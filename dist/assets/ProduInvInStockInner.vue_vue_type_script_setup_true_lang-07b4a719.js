import{_ as O}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-1fb412d9.js";import{t as ci,c as li,d as pi}from"./product_trs-1b6faecf.js";import{d as k,o as _,c as l,t as h,am as R,n as S,C as D,y as q,w as m,F as T,D as I,a as e,i as d,b as r,N as L,P as U,k as b,S as ui,q as X,v as J,x as Q,s as M,g as C,h as g,V as G,z as di,X as mi,al as A,an as K,r as Y,a6 as Z,ae as x,G as P,H as V,T as fi,e as H,a7 as hi,R as ii,M as vi,$ as j,a0 as ki,A as W,p as $i,U as wi}from"./index-239f2dbd.js";import{g as N}from"./giobaiPina-4c6e7aab.js";import{_ as yi}from"./OTrPure.vue_vue_type_script_setup_true_lang-38e01f04.js";import{m as bi,v as gi,c as si,a as Ci,d as Ti,e as xi}from"./view-a1c4ebd4.js";import{pageProductInstockPina as Ii}from"./pageProductInstockPina-21646221.js";import{E as ti}from"./errors_product-d5275ad5.js";import{_ as Pi}from"./BtnTab.vue_vue_type_script_setup_true_lang-102ee90d.js";import{_ as Vi}from"./IayoutForm.vue_vue_type_script_setup_true_lang-8ea93414.js";import{pageProducEditPina as oi}from"./pageProducEditPina-6396c90b.js";import{_ as ei}from"./OInput.vue_vue_type_script_setup_true_lang-b2657ef1.js";import{_ as ni}from"./Dropdown.vue_vue_type_script_setup_true_lang-f4c6f7eb.js";import{_ as Si}from"./ODropdownNetItem.vue_vue_type_script_setup_true_lang-4ab9377a.js";import{_ as qi}from"./Oi.vue_vue_type_script_setup_true_lang-51a929c9.js";import{_ as ai}from"./BtnIcon.vue_vue_type_script_setup_true_lang-c9d4b464.js";import{_ as Ni}from"./OInputI.vue_vue_type_script_setup_true_lang-eec13b46.js";import{_ as Ei}from"./OTime.vue_vue_type_script_setup_true_lang-b1c4f2ad.js";import{a as Bi,_ as Ui}from"./OTabieTrash-09b4487c.js";import{_ as Wi,a as Hi}from"./CoWarehouseSeiectPure.vue_vue_type_script_setup_true_lang-e526527e.js";import{_ as Oi}from"./OTabieEdit.vue_vue_type_script_setup_true_lang-60706c8e.js";const Ri={class:"d-ib hand txt-pri ani-scaie-aii-x2 fs-n ani-softer"},z=k({__name:"OTabieOpera",props:{tit:{}},setup(c){return(s,a)=>(_(),l("div",Ri,h(s.tit),1))}}),E=N().seiect_iabeis,Di=R(E),Mi=[{txt:"標籤",v:"",ciass:"o-fiiter-reset"},...E],ri=N().seiect_supiiers,Ai=R(ri),zi=[{txt:"供應商",v:"",ciass:"o-fiiter-reset"},...E],Fi={seiect_tag:E,seiect_tag_def:Di,seiect_tag_fiiter:Mi,seiect_supplier:ri,seiect_supplier_def:Ai,seiect_supplier_fiiter:zi,comput_store_quantity:(c,s=0)=>((c.variation?c.variation:[]).map(o=>{s+=o.quantity?o.quantity:0}),s)},Gi={class:"w-20"},Ki={class:"w-20"},ji={class:"fx-1 fx-s"},Li={class:"d-ib pr"},Xi={key:0,class:"fx-r"},Ji={key:1},Tt=k({__name:"CoPidWarehouseTabie",props:{aii:{},one_of_edit:{},kiii_option:{type:Boolean}},emits:["view","transtock"],setup(c){const s=c;return S(()=>D(s.aii,ci)),(a,o)=>{const t=z,i=O;return _(),q(i,{aii:a.aii,mini:!0},{default:m(()=>[(_(!0),l(T,null,I(a.one_of_edit.storehouse_info,(n,u)=>(_(),l("div",{class:"td",key:u},[e("div",Gi,h(n.storehouse_name),1),e("div",Ki,h(d(Fi).comput_store_quantity(n)),1),e("div",ji,[e("div",Li,h(n.storehouse_address),1),a.kiii_option?(_(),l("div",Ji)):(_(),l("div",Xi,[r(t,{onClick:f=>a.$emit("view",n),tit:"庫存詳情"},null,8,["onClick"]),r(t,{class:"pi-s",onClick:f=>a.$emit("transtock",n),tit:"調貨"},null,8,["onClick"])]))])]))),128))]),_:1},8,["aii"])}}}),Qi=e("div",{class:"py-row"},null,-1),Yi={class:"tabie tabie-def"},Zi={class:"td"},is={class:"w-100"},xt=k({__name:"CoPidTotaiTabie",props:{one_of_edit:{}},setup(c){return(s,a)=>{const o=yi;return _(),l("div",null,[Qi,e("div",Yi,[r(o,{trs:d(li)},null,8,["trs"]),e("div",Zi,[e("div",is,h(d(bi)(s.one_of_edit.total_broken_products))+"  HKD ",1)])])])}}}),ss={class:"w-28 pr"},ts={class:"w-13"},os={class:"w-14"},es={class:"w-12"},ns={class:"w-12"},as={class:"fx-1 fx-s"},rs={key:0,class:"pi-s"},_s={key:1},cs=k({__name:"CoPidInstockTabie",props:{many:{},aii:{},kiii_option:{type:Boolean}},emits:["view"],setup(c){return(s,a)=>{const o=z,t=O;return _(),q(t,{aii:s.aii,mini:!0},{default:m(()=>[(_(!0),l(T,null,I(s.many,(i,n)=>(_(),l("div",{class:"td",key:n},[e("div",ss,h(d(gi)(i.restock_date)),1),e("div",ts,h(i.restock_price),1),e("div",os,h(i.lowest_price),1),e("div",es,h(i.selling_price),1),e("div",ns,h(i.quantity),1),e("div",as,[e("div",null,h(i.supplier.name),1),s.kiii_option?(_(),l("span",_s)):(_(),l("div",rs,[r(o,{onClick:u=>s.$emit("view",i),tit:"檢視"},null,8,["onClick"])]))])]))),128))]),_:1},8,["aii"])}}}),It=k({__name:"ProduInstockTabie",props:{aii:{},one_of_edit:{},kiii_option:{type:Boolean}},setup(c){const s=c,a=L(()=>{const t=s.one_of_edit.restocks;return t?(t.map(i=>(i.supplier=i.supplier?U.data(i.supplier):{},i)),t):[]});S(()=>D(s.aii,pi));const o={instock:()=>b(()=>{}),view:t=>b(()=>{let i=t.restock_distribute;i=i||[],i.map(n=>(n.variation&&n.variation.data&&(n.variation=U.data(n.variation).id),n.storehouse&&n.storehouse.data&&(n.storehouse=U.data(n.storehouse).id),n)),Ii().save("inventory_and_variation_of_view",i),ui(112)})};return(t,i)=>{const n=cs;return _(),l("div",null,[r(n,{onView:o.view,aii:t.aii,many:d(a),kiii_option:t.kiii_option},null,8,["onView","aii","many","kiii_option"])])}}}),ls="instock",ps="transfstock",Pt=async c=>X(ti,async()=>J(await Q.pos(ls,c))),Vt=async(c,s)=>X(ti,async()=>J(await Q.put(ps,s,c+""))),us={class:"mw-4em"},ds={class:"pi-s"},ms=k({__name:"CoSsItem",props:{many:{},aii:{},pk:{}},emits:["switchWH"],setup(c){return(s,a)=>{const o=qi,t=Si;return _(!0),l(T,null,I(s.many,(i,n)=>(_(),q(t,{onClick:u=>s.$emit("switchWH",i),iive:s.aii.pk==i.id,class:"fx-i",aii:s.aii,key:n},{default:m(()=>[r(o,{class:"i h5 mr-s",icon:"ioc"}),e("div",us,h(i.name),1),e("div",ds,"(負責人: "+h(i.contact_person)+")",1)]),_:2},1032,["onClick","iive","aii"]))),128)}}}),fs={class:"ps-r"},hs=["value","placeholder"],vs={class:"middie r-0 pr-row pi-s ani-softer"},ks=k({__name:"CoSuppiierSeiect",props:{form:{},pk:{},pchd:{}},setup(c){const s=c,{suppiiers:a}=M(N()),o=C({search:"",ioading:!1,nowId:0}),t={many:()=>a.value,v:()=>{if(s.pk&&s.form)return s.form[s.pk]},setV:i=>{s.pk&&s.form&&(s.form[s.pk]=i)},search:()=>b(()=>{}),view:()=>{const i=A(o.nowId,a.value,"id");return i.id?i.name+"  (負責人: "+i.contact_person+")":""},switchWh:i=>b(()=>{o.ioading=!0,o.nowId=i.id,t.setV(i.id),setTimeout(()=>{o.ioading=!1},400)})};return g(t.v,i=>{i&&i!==o.nowId&&(o.nowId=G(i))}),di(()=>{let i=t.v();const n=G(i);n&&n!=o.nowId&&(o.nowId=n)}),(i,n)=>{const u=ai,f=ms,p=ni;return _(),l("div",null,[r(p,{class:"w-100",fuii:!0},{sign:m(()=>[e("div",fs,[e("input",{class:"w-100",onKeydown:n[0]||(n[0]=mi(v=>t.search(),["enter"])),value:t.view(),placeholder:i.pchd?i.pchd:"請選擇"},null,40,hs),e("div",vs,[r(u,{class:"ani-scaie-aii",onClick:n[1]||(n[1]=v=>t.search()),icon:"down"})])])]),con:m(()=>[r(f,{aii:d(o),pk:"nowId",many:d(a),onSwitchWH:t.switchWh},null,8,["aii","many","onSwitchWH"])]),_:1})])}}}),$s={class:"o-hour-minus ps-r bg-con zi-x3"},ws=e("div",{class:"fx-s abs-t i-0 r-0 bg-con"},[e("div",{class:"w-382 pi pb-x1 sus"},"時"),e("div",{class:"w-618 pi pb-x1 sus"},"分")],-1),ys={class:"fx-s fx-t"},bs={class:"o-hours w-382 pt-s"},gs=e("button",null,"0",-1),Cs=["onClick"],Ts={class:"o-minus w-618 pt-s"},xs=e("button",null,"0",-1),Is=["onClick"],Ps=k({__name:"OHours",props:{form:{},pk_hours:{},pk_minus:{}},setup(c){const s=c,a=C({hours:K(24),minus:K(60)}),o={v_minus:()=>s.form[s.pk_minus],v_hour:()=>s.form[s.pk_hours],v:()=>o.v_hour()+":"+o.v_minus(),setv_minus:t=>{s.form[s.pk_minus]=t},setv_hour:t=>{s.form[s.pk_hours]=t}};return(t,i)=>{const n=ni;return _(),q(n,null,{sign:m(()=>[Y(t.$slots,"default")]),con:m(()=>[e("div",$s,[ws,e("div",ys,[e("div",bs,[gs,(_(!0),l(T,null,I(d(a).hours,(u,f)=>(_(),l("div",{class:"pi br br-i-0 fx-aii-weak ani-scaie-fcs hand",onClick:p=>o.setv_hour(u),key:f},h(u),9,Cs))),128))]),e("div",Ts,[xs,(_(!0),l(T,null,I(d(a).minus,(u,f)=>(_(),l("div",{class:"py-t pi br br-r-0 fx-aii-weak ani-scaie-fcs hand",onClick:p=>o.setv_minus(u),key:f},h(u),9,Is))),128))])])])]),_:3})}}}),Vs={class:"row"},Ss={class:"w-333"},qs={class:"w-333"},Ns=["value"],Es={class:"w-333"},Bs=e("div",{class:"py-s"},null,-1),Us=k({__name:"PiisBase",props:{form:{},aii:{}},setup(c){const s=c,a=["restock_date","hour"],o=C(Z(s.form));return g(()=>s.aii.sign,()=>{a.map(t=>{if(x(o,t,s.form[t],s.aii)){s.aii.can=!1;return}}),s.aii.can=!0}),g(()=>s.form.restock_date,t=>x(o,"restock_date",t,s.aii)),g(()=>s.form.hour,t=>x(o,"hour",t,s.aii)),(t,i)=>{const n=Ei,u=Ni,f=Ps,p=ks,v=ei;return _(),l("div",null,[e("div",Vs,[e("div",Ss,[r(u,{icon:"date",err:d(o).restock_date,tit:"入貨日期"},{default:m(()=>[r(n,{form:t.form,pk:"restock_date"},null,8,["form"])]),_:1},8,["err"])]),e("div",qs,[r(u,{icon:"time",err:d(o).hour,tit:"入貨時間"},{default:m(()=>[r(f,{form:t.form,pk_hours:"hour",pk_minus:"minus"},{default:m(()=>[e("input",{value:d(si)(t.form.hour,t.form.minus)},null,8,Ns)]),_:1},8,["form"])]),_:1},8,["err"])]),e("div",Es,[r(v,{err:d(o).supplier,tit:"供應商"},{default:m(()=>[r(p,{pchd:"可以不選擇",form:t.form,pk:"supplier"},null,8,["form"])]),_:1},8,["err"])])]),Bs])}}}),Ws={class:"row"},Hs={class:"w-333"},Os={class:"w-333"},Rs={class:"w-333"},Ds=k({__name:"PiisPrice",props:{form:{},aii:{}},setup(c){const s=c,a=["restock_price","lowest_price","selling_price"],o=C(Z(s.form));return g(()=>s.aii.sign,()=>{a.map(t=>{if(x(o,t,s.form[t],s.aii)){s.aii.can=!1;return}}),s.aii.can=!0}),g(()=>s.form.restock_price,t=>x(o,"restock_price",t,s.aii)),g(()=>s.form.lowest_price,t=>x(o,"lowest_price",t,s.aii)),g(()=>s.form.selling_price,t=>x(o,"selling_price",t,s.aii)),(t,i)=>{const n=ei;return _(),l("div",Ws,[e("div",Hs,[r(n,{err:d(o).restock_price,tit:"入貨價錢"},{default:m(()=>[P(e("input",{type:"number","onUpdate:modelValue":i[0]||(i[0]=u=>t.form.restock_price=u),placeholder:"請輸入"},null,512),[[V,t.form.restock_price]])]),_:1},8,["err"])]),e("div",Os,[r(n,{err:d(o).lowest_price,tit:"最低價錢"},{default:m(()=>[P(e("input",{type:"number","onUpdate:modelValue":i[1]||(i[1]=u=>t.form.lowest_price=u),placeholder:"請輸入"},null,512),[[V,t.form.lowest_price]])]),_:1},8,["err"])]),e("div",Rs,[r(n,{err:d(o).selling_price,tit:"售價"},{default:m(()=>[P(e("input",{type:"number","onUpdate:modelValue":i[2]||(i[2]=u=>t.form.selling_price=u),placeholder:"請輸入"},null,512),[[V,t.form.selling_price]])]),_:1},8,["err"])])])}}}),Ms=k({__name:"CoWarehouseText",props:{v:{}},setup(c){const s=c,a=()=>{const o=A(s.v,N().warehouses,"id");return o.id?o.name+"  (負責人: "+o.contact_person+")":"未選擇倉庫"};return(o,t)=>(_(),l("div",null,h(a()),1))}}),As=k({__name:"CoVariationsText",props:{v:{},many:{}},setup(c){const s=c,a=()=>{const o=A(s.v,s.many,"id");return o.id?o.name:"未選擇倉庫"};return(o,t)=>(_(),l("div",null,h(a()),1))}}),zs={key:0,class:"td"},Fs={class:"fx-1 fx-s"},Gs={key:0,class:"fx-r"},Ks={key:1,class:"td"},js={class:"w-30"},Ls=["onUpdate:modelValue"],Xs=["value"],Js={class:"w-30"},Qs={class:"fx-1 fx-s"},Ys=["onUpdate:modelValue"],Zs={class:"pi fx-r"},it=k({__name:"PsiTd",props:{aii:{},funn:{},kiii_option:{type:Boolean}},setup(c){const s=c,{product_variations:a}=M(oi());return a.value.length<=0&&fi("該產品無可用標籤！！！"),S(()=>D(s.aii,[{ciass:"w-30",tit:"樣式名稱"},{ciass:"w-30",tit:"入貨位置"},{ciass:"fx-1",tit:"入貨數量"}])),(o,t)=>{const i=As,n=Ms,u=Oi,f=Bi,p=Wi,v=Hi,w=z,B=ai;return _(!0),l(T,null,I(o.aii.many,($,F)=>(_(),l("div",{key:F},[$.edit?(_(),l("div",Ks,[e("div",js,[r(p,null,{default:m(()=>[P(e("select",{"onUpdate:modelValue":y=>$.variation=y},[(_(!0),l(T,null,I(d(a),(y,_i)=>(_(),l("option",{key:_i,value:y.id},h(y.name),9,Xs))),128))],8,Ls),[[hi,$.variation]])]),_:2},1024)]),e("div",Js,[r(p,null,{default:m(()=>[r(v,{form:$,pk:"storehouse"},null,8,["form"])]),_:2},1024)]),e("div",Qs,[r(p,{class:"fx-1"},{default:m(()=>[P(e("input",{type:"number","onUpdate:modelValue":y=>$.quantity=y,placeholder:"請輸入"},null,8,Ys),[[V,$.quantity]])]),_:2},1024),e("div",Zs,[r(w,{class:"pr",tit:"儲存",onClick:y=>$.edit=!1},null,8,["onClick"]),e("div",null,[r(B,{icon:"x",onClick:y=>o.funn.cancei($)},null,8,["onClick"])])])])])):(_(),l("div",zs,[r(i,{class:"w-30",many:d(a),v:$.variation},null,8,["many","v"]),r(n,{class:"w-30",v:$.storehouse},null,8,["v"]),e("div",Fs,[e("div",null,h($.quantity),1),o.kiii_option?H("",!0):(_(),l("div",Gs,[r(u,{onClick:y=>o.funn.edit($),class:"mr-s txt-pri"},null,8,["onClick"]),r(f,{onClick:y=>o.funn.sureTrash(F)},null,8,["onClick"])]))])]))]))),128)}}}),st=k({__name:"PiisStyieInventoryTabie",props:{aii:{}},emits:["sureTrash"],setup(c,{emit:s}){const a=c,o=C({origin:{},trashIdx:0}),t={edit:i=>b(()=>{i.edit=!0,o.origin[i.id+""]=ii(i)}),cancei:i=>b(()=>{const n=o.origin[i.id+""];n?(n.edit=!1,vi(n,i)):i.edit=!1}),sureTrash:i=>b(()=>{o.trashIdx=i,s("sureTrash",i),j(-201)}),trash:()=>ki(a.aii,()=>{a.aii.many.splice(o.trashIdx,1),j(0)})};return(i,n)=>{const u=O,f=Ui;return _(),l(T,null,[r(u,{aii:i.aii,mini:!0},{default:m(()=>[r(it,{aii:i.aii,funn:t},null,8,["aii"])]),_:1},8,["aii"]),r(f,{idx:-201,aii:i.aii,onTrash:t.trash},null,8,["aii","onTrash"])],64)}}}),tt={key:0,class:"ani-fade-b"},ot={key:1,class:"abs-b ps-f-imp r-0 w-36 w-50-p py"},St=k({__name:"ProduInvInStockInner",props:{aii:{},kiii_vars:{type:Boolean}},setup(c,{expose:s}){const a=c,o=C({restock_date:Ci(),hour:Ti(),minus:xi(),supplier:null}),t=C({restock_price:"",lowest_price:"",selling_price:""}),i=C({msg:"",many:[],trashIdx:0,pager:{},ioading:!1,trs:[],ani:0}),{one_of_edit:n}=M(oi()),u=L(()=>{const p=n.value;return p.variations?p.variations:[]}),f={buiid:()=>{const p={...o,...t,restock_distribute:f.fiiter()};return p.restock_date=o.restock_date+" "+si(o.hour,o.minus,!0),p.product=n.value?n.value.product_id:"",a.aii.can&&p.restock_distribute.length<=0?($i("您沒有添加任何樣式的庫存數據!!!",a.aii),null):a.aii.can?p:null},fiiter:(p=[])=>(i.many.map(v=>{let w=!0;v.storehouse&&v.quantity?v.edit=!1:w=!1,w&&p.push(v)}),p),pius:()=>b(()=>{f.fiiter().length==i.many.length&&i.many.push(f.GEN_ONE())}),setv:(p,v,w)=>b(()=>{t.restock_price=p+"",t.lowest_price=v+"",t.selling_price=w+""}),GEN_ONE:()=>ii({idx:i.many.length,variation:R(u.value,"id"),storehouse:0,quantity:null,edit:!0,ioading:!1})};return s(f),S(()=>wi(4,()=>i.ani+=1)),(p,v)=>{const w=Vi,B=Pi;return _(),l("div",null,[r(w,{tit:"時間及供應商",class:W(["pb-x3 op-0",{"ani-page":d(i).ani>=0}])},{default:m(()=>[r(Us,{form:d(o),aii:p.aii},null,8,["form","aii"])]),_:1},8,["class"]),r(w,{tit:"價錢",class:W(["pt pb-x3 op-0",{"ani-page":d(i).ani>=1}])},{default:m(()=>[r(Ds,{form:d(t),aii:p.aii},null,8,["form","aii"])]),_:1},8,["class"]),p.kiii_vars?H("",!0):(_(),l("div",tt,[r(w,{tit:"樣式及庫存分配數量",class:W(["pt-x2 pb-x3 op-0",{"ani-page":d(i).ani>=2}])},{default:m(()=>[r(st,{aii:d(i)},null,8,["aii"])]),_:1},8,["class"]),e("div",null,[r(B,{onClick:v[0]||(v[0]=$=>f.pius()),class:"w-100 py-s ani-scaie-aii",tit:"添加樣式"})])])),d(i).ani>=3?(_(),l("section",ot,[Y(p.$slots,"default")])):H("",!0)])}}});export{z as _,It as a,xt as b,Tt as c,St as d,it as e,Vt as f,Pt as s};
