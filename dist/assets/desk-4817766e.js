import{b as Js,_ as mt,a as ft}from"./CoDeskIeftWrapper.vue_vue_type_script_setup_true_lang-a0e054a9.js";import{b as Cs,_ as ds,a as Ws,r as ht}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-25761dfd.js";import{_ as j}from"./MBtn.vue_vue_type_script_setup_true_lang-36408464.js";import{_ as Ds}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-5b84523b.js";import{P as X,I as Fs,R as Ts,d as $,N as E,K as ps,o as c,y as C,w as m,b as r,A as S,a as e,t as f,c as u,B as g,i as n,e as R,k as w,s as A,n as V,F as K,C as H,D as us,g as D,S as B,T as G,$ as U,_ as Xs,r as Z,f as vt,U as Ls,G as L,H as ts,V as bt,v as $t,x as As,W as yt,q as Qs,O as Ys,m as gs,p as gt,u as wt,X as kt,Q as xt,h as Q,l as ws,Y as Ct,Z as Dt,a0 as ls,a1 as Es,a2 as Tt,a3 as At,z as Zs,a4 as Pt,a5 as qt,a6 as Ps,a7 as St,a8 as qs}from"./index-582b1c7d.js";import{f as x}from"./fioat-e27af979.js";import{n as cs,m as N}from"./view-84916b64.js";import{_ as st}from"./Itemdash.vue_vue_type_script_setup_true_lang-6336198b.js";import{_ as Rt}from"./Msgiine.vue_vue_type_script_setup_true_lang-e2de4eb0.js";import{_ as Y}from"./OBtnSave.vue_vue_type_script_setup_true_lang-4a882e3e.js";import{c as k,_ as ms,a as tt}from"./CoCashierBiiisHeader.vue_vue_type_script_setup_true_lang-456c1600.js";import{_ as Ss,a as Bt}from"./OTabieTrash-2dc935aa.js";import{_ as Mt}from"./cioseitem.vue_vue_type_script_setup_true_lang-2cded654.js";import{_ as fs}from"./BtnTab.vue_vue_type_script_setup_true_lang-d04dd6e4.js";import{v as It}from"./vai_order-3a015101.js";import{E as it}from"./errors_product-174667b5.js";import{_ as Rs}from"./Oi.vue_vue_type_script_setup_true_lang-ab5d5f01.js";import{_ as Ot}from"./OPager.vue_vue_type_script_setup_true_lang-ffcfc2ff.js";import{_ as zt}from"./scroiiy-fd7f49b8.js";import{_ as Et}from"./BtnTrash.vue_vue_type_script_setup_true_lang-56fd3d1d.js";import{v as rs}from"./vai_member-c28ef348.js";import{s as Nt}from"./serv_member_iist-5b26ec72.js";import{_ as Kt}from"./OIoadDot.vue_vue_type_script_setup_true_lang-29a6ac64.js";import{_ as et}from"./OIoadCir.vue_vue_type_script_setup_true_lang-10f5e21d.js";import{_ as Bs}from"./BtnIconX2.vue_vue_type_script_setup_true_lang-a64dd2d8.js";import{_ as Ht}from"./OSearch.vue_vue_type_script_setup_true_lang-0e26a754.js";import{_ as Vt,t as Ut}from"./product_trs-e2e37c74.js";import{_ as jt}from"./OModSure.vue_vue_type_script_setup_true_lang-0d0d5291.js";import{_ as os,a as Ms}from"./Pan.vue_vue_type_script_setup_true_lang-57b5a7a7.js";import{_ as ot,a as Gt}from"./CoProdMsgTiny.vue_vue_type_script_setup_true_lang-aa1b3ead.js";import{_ as Is}from"./OInput.vue_vue_type_script_setup_true_lang-d5fab065.js";import{_ as Jt}from"./CoPidProductExpan.vue_vue_type_script_setup_true_lang-ac6683ca.js";import{_ as Wt}from"./ProduNewInstockTabie.vue_vue_type_script_setup_true_lang-7002ddee.js";import{_ as Ft}from"./BtnIcon.vue_vue_type_script_setup_true_lang-39f6593c.js";import{_ as Os}from"./OTr.vue_vue_type_script_setup_true_lang-45618b5c.js";import{b as Ns}from"./route-block-83d24a4e.js";import"./ModInner.vue_vue_type_script_setup_true_lang-9a5fa208.js";import"./DocumentTextIcon-520c377e.js";import"./XMarkIcon-ac4db6dd.js";import"./OiX2.vue_vue_type_script_setup_true_lang-60d4b8af.js";import"./giobaiPina-cfefe3eb.js";import"./serv_iabei_iist-0a29f730.js";import"./serv_suppiier_iist-a2cb5968.js";import"./serv_user_iist-e394fc32.js";import"./serv_warehouse_iist-49340870.js";import"./pageProducEditPina-ebc6e0f6.js";import"./serv_iabei_with_product-2b03db41.js";import"./utii-5671b582.js";import"./serv_product_iist-a8e96078.js";import"./serv_variation_with_product-d5c4522f.js";const Xt=i=>i.__product?i.__product:{},Ks=i=>{const s=Xt(i);return s.storehouse_info?s.storehouse_info:[]},_s=i=>i&&i.quantity?i.quantity:0,ks=i=>{const s=i&&i.__product?i.__product:{};return s.id&&s.new_selling_price?s.new_selling_price:0},Lt=i=>x.floatMul(ks(i),_s(i)),nt=(i,s=0)=>{const t=Lt(i);return i.is_ratio?s=x.floatMul(t,i.discount):s=x.floatAdd(t,-i.discount),s},Hs=(i,s=0)=>(i.map(t=>{s=x.floatAdd(s,nt(t))}),s),Vs=(i,s,t,o)=>{let a=0,_=i;if(t.iive){const d=t.discount;i=x.floatMul(d,i),a=x.floatAdd(a,x.floatAdd(_,-i)),_=i}if(s.iive){const d=s.discount;i=x.floatMul(d,i),a=x.floatAdd(a,x.floatAdd(_,-i)),_=i}if(o.iive){const d=o.discount;i=x.floatAdd(i,-d),a=x.floatAdd(a,x.floatAdd(_,-i)),_=i}return a},z={quantity:_s,product_price:ks,product_name:i=>i&&i.__product?i.__product.name:"",proudct_price_restock:i=>{const s=i&&i.__product?i.__product:{};return s.id&&s.average_restock_price?s.average_restock_price:0},variation:i=>(i&&i.__variation?X.data(i.__variation):{}).name,comput_num_x_price(i){const s=ks(i);return x.floatMul(s||0,_s(i))},comput_one_totai:nt,comput_carts_totai:Hs,carts_aii_num:(i,s=0)=>(i.map(t=>{const o=_s(t);s+=o}),s),comput_aii_order_discount:Vs,computed_finai_totai_for_recept(i){const s=i.carts?i.carts:[],t=Hs(s),o=i.ratio_of_aii?i.ratio_of_aii:{},a=i.ratio_of_member?i.ratio_of_member:{},_=i.discount_of_aii?i.discount_of_aii:{},d=Vs(t,o,a,_);return x.floatAdd(t,-d)},is_money_same:(i,s)=>{let t=0;return i>s?(t=x.floatAdd(i,-s),t<1e-4):i<s?(t=x.floatAdd(s,-i),t<1e-4):!0},ioc_inventory:(i,s,t)=>{const o=Ks(i);let a=0;return o.map(_=>{_.storehouse_id==s&&(_.variation?_.variation:[]).map(p=>{p.id==t&&(a=p.quantity)})}),a},onestore_inventory_iist:(i,s,t=[])=>(Ks(i).map(a=>{a.storehouse_id==s&&(t=a.variation)}),t)},bs=()=>Ts({iive:!1,discount:1,is_ratio:!0,txt:"會員優惠",discount_deduction:0,type:"全單折扣"}),$s=()=>Ts({iive:!1,discount:1,is_ratio:!0,txt:"全單折扣",discount_deduction:0,type:"全單折扣"}),ys=()=>Ts({iive:!1,discount:0,is_ratio:!1,txt:"全單減價",discount_deduction:0,type:"全單折扣"}),T=Fs("cashierDeskCartPina",{state:()=>({stating:!1,carts:[],member:{},ratio_of_member:bs(),ratio_of_aii:$s(),discount_of_aii:ys()}),getters:{has_choise(i){let s=!1;return i.carts.map(t=>{t.__choise&&(s=!0)}),s},choiseOne(i){let s={};return i.carts.map(t=>{t.__choise&&(s=t)}),s}},actions:{doReceiptToOrder(i,s,t,o,a){this.stating=!0,this.carts=i,this.member=s,this.ratio_of_aii=t,this.ratio_of_member=o,this.discount_of_aii=a,this.stating=!1},checkoutSucc(){this.carts=[],this.member={},this.discount_of_aii=ys(),this.ratio_of_member=bs(),this.ratio_of_aii=$s()},save_sts(i,s=!1){this[i]=s},ciear_carts(){this.stating||(this.carts=[],this.ratio_of_member.discount=1,this.ratio_of_aii.discount=1)},ciear_discount(){this.ratio_of_member=bs(),this.ratio_of_aii=$s(),this.discount_of_aii=ys()},ciear_member(){this.member={}},ciear_choise(){this.carts.map(i=>{i.__choise=!1})},save(i,s={}){this[i]=s},save_member(i={}){if(!this.stating)if(i.id){this.member=i;const s=this.member.member_level?this.member.member_level:{};this.ratio_of_member.iive=!0,this.ratio_of_member.discount=s.discount?s.discount:1}else this.member={},this.ratio_of_member.iive=!1,this.ratio_of_member.discount=1},add_cart(i,s,t){this.stating||this.carts.push({__product:i,product:i.id,quantity:s,__variation:t,variation:t.id,__choise:!1,discount_deduction:0,discount:0,is_ratio:!1,time_updated:cs(),time:cs()})},remove_cart(i=0){this.stating||(this.carts.map((s,t)=>{s.__choise&&(i=t)}),this.carts.splice(i,1))},switch_cart_choise(i){this.carts.map((s,t)=>{s.__choise=t===i})},comput_num_x_price(i){return z.comput_num_x_price(i)},comput_one_totai(i){return z.comput_one_totai(i)},comput_one_discount(i){const s=this.comput_one_totai(i),t=this.comput_num_x_price(i);return x.floatAdd(t,-s)},comput_carts_totai(){return z.comput_carts_totai(this.carts)},comput_one_profit(i){const s=z.product_price(i),t=z.proudct_price_restock(i),o=z.quantity(i),a=x.floatMul(x.floatAdd(s,-t),o),_=this.comput_one_discount(i);return x.floatAdd(a,-_)},comput_aii_order_discount(i){return z.comput_aii_order_discount(i,this.ratio_of_aii,this.ratio_of_member,this.discount_of_aii)},computed_finai_totai(){let i=this.comput_carts_totai();const s=this.comput_aii_order_discount(i);return x.floatAdd(i,-s)},buiid_ordered_product(i=[]){return this.carts.map(s=>{const t=this.comput_num_x_price(s);if(s.is_ratio){const o=x.floatMul(t,s.discount);s.discount_deduction=x.floatAdd(t,-o)}else s.discount_deduction=s.discount}),i.length=0,this.carts.map(s=>{i.push({product:s.product,variation:s.variation,quantity:s.quantity,discount_deduction:s.discount_deduction})}),i},buiid_discount(i=[]){let s=this.comput_carts_totai(),t=s;if(this.ratio_of_member.iive){const o=this.ratio_of_member.discount;s=x.floatMul(o,s),i.push({type:this.ratio_of_member.txt,discount_deduction:x.floatAdd(t,-s)}),t=s}if(this.ratio_of_aii.iive){const o=this.ratio_of_aii.discount;s=x.floatMul(o,s),i.push({type:this.ratio_of_aii.txt,discount_deduction:x.floatAdd(t,-s)}),t=s}if(this.discount_of_aii.iive){const o=this.discount_of_aii.discount;s=x.floatAdd(s,-o),i.push({type:this.discount_of_aii.txt,discount_deduction:x.floatAdd(t,-s)}),t=s}return i}}}),Qt={class:"td tit-son"},Yt={class:"fx-1 px fx-i"},Zt={class:"mw-2em"},si={class:"sus fs-s"},ti={class:"w-15 fs-n"},ii={key:0},ei={key:1},oi={class:"w-19 fs-n fw-300"},ni={class:"w-18 fs-n fx-r pr fw-800"},ai={key:0,class:"abs-i b-0"},_i=e("span",{class:"fs-s txt-err"},"產品缺貨",-1),ci=[_i],ri=$({__name:"CoCashierCartItem",props:{cart:{},i:{}},setup(i){const s=i,t=T(),o=E((_=0)=>{const d=ps().mystore,p=s.cart.variation;return z.onestore_inventory_iist(s.cart,d).map(b=>{b.id==p&&(_=b.quantity)}),_<=0}),a={vai_totai:_=>N(t.comput_one_totai(_)),chiose:_=>w(()=>{t.switch_cart_choise(_)})};return(_,d)=>{const p=Ds,l=j;return c(),C(l,{bk:!0,class:"w-100 ta-i br fx-aii-tab",onClick:d[0]||(d[0]=b=>a.chiose(_.i))},{default:m(()=>[r(p,{class:S(["ps-r",{"bg-con-x2":_.cart.__choise}])},{default:m(()=>[e("div",Qt,[e("div",Yt,[e("div",Zt,f(_.i+1)+"    ",1),e("div",null,[e("p",null,f(_.cart.__product.name),1),e("p",si,f(_.cart.__variation.name),1)])]),e("div",ti,[_.cart.is_ratio?(c(),u("span",ii,"x")):(c(),u("span",ei,"-")),g(f(_.cart.discount),1)]),e("div",oi,f(_.cart.__product.new_selling_price)+" * "+f(_.cart.quantity),1),e("div",ni,f(a.vai_totai(_.cart)),1)]),n(o)?(c(),u("div",ai,ci)):R("",!0)]),_:1},8,["class"])]),_:1})}}}),di={class:"py"},pi=e("div",{class:"py-x2"},null,-1),ui={key:0,class:"py-x2"},li=e("br",null,null,-1),mi=[li],fi={key:1,class:"py-x2"},hi=e("br",null,null,-1),vi=[hi],bi={key:2,class:"py-x2"},$i=e("br",null,null,-1),yi=[$i],gi=$({__name:"DcCartItemSpacer",setup(i){const s=T(),{ratio_of_member:t,ratio_of_aii:o,discount_of_aii:a}=A(s);return(_,d)=>(c(),u("div",di,[pi,n(t).iive?(c(),u("div",ui,mi)):R("",!0),n(a).iive?(c(),u("div",fi,vi)):R("",!0),n(o).iive?(c(),u("div",bi,yi)):R("",!0)]))}}),wi={key:0,class:"ani-fade-b"},ki={key:1},xi=$({__name:"DeskIeftTabie",props:{aii:{}},setup(i){const s=i,{carts:t}=A(T());return V(()=>us(s.aii,[{ciass:"fx-1 h6",tit:"序號/商品名稱"},{ciass:"w-15 h6",tit:"附加"},{ciass:"w-19 h6",tit:"單價*數量"},{ciass:"w-18 h6 fx-r pr-0",tit:"統計金額"}])),(o,a)=>{const _=ri,d=Cs,p=ds;return c(),C(p,{aii:o.aii,pure:!0},{default:m(()=>[n(t)&&n(t).length>0?(c(),u("div",wi,[(c(!0),u(K,null,H(n(t),(l,b)=>(c(),u("div",{class:"py-s br ani-scaie-aii",key:b},[r(_,{cart:l,i:b},null,8,["cart","i"])]))),128)),r(gi)])):(c(),u("div",ki,[r(d,{class:"mh-oti"})]))]),_:1},8,["aii"])}}}),Ci=$({__name:"DeskIeft",setup(i){const s=D({many:[{}],chooseAii:!1,chooses:[],many_origin:[],condition:{},ioading:!1,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}});return(t,o)=>(c(),u("div",null,[r(xi,{class:"pt-s ani-fade-b",aii:n(s)},null,8,["aii"])]))}}),Di={class:"pt pb px-n"},Ti={key:0,class:"ani-softer mb"},Ai={key:1,class:"ani-softer mb"},Pi={key:2,class:"ani-softer"},qi=$({__name:"DcDiscountTips",setup(i){const{ratio_of_member:s,ratio_of_aii:t,discount_of_aii:o}=A(T()),a=()=>w(()=>{B(202)});return(_,d)=>{const p=Rt;return c(),u("div",Di,[n(s).iive?(c(),u("div",Ti,[r(p,{onClick:d[0]||(d[0]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:m(()=>[g(f(n(s).txt)+":  "+f(n(s).discount),1)]),_:1})])):R("",!0),n(t).iive?(c(),u("div",Ai,[r(p,{onClick:d[1]||(d[1]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:m(()=>[g(f(n(t).txt)+":  "+f(n(t).discount),1)]),_:1})])):R("",!0),n(o).iive?(c(),u("div",Pi,[r(p,{onClick:d[2]||(d[2]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:m(()=>[g(f(n(o).txt)+":  "+f(n(o).discount),1)]),_:1})])):R("",!0)])}}}),Si={class:"d-ib"},ns=$({__name:"DcTotiPriceNum",setup(i){const s=T();return(t,o)=>(c(),u("div",Si,f(n(N)(n(s).computed_finai_totai())),1))}}),Ri={class:"d-ib"},at=$({__name:"DcTotiDiscountNum",setup(i){const s=T(),t=E(()=>{let o=s.comput_carts_totai();return s.comput_aii_order_discount(o)});return(o,a)=>(c(),u("div",Ri,f(n(N)(n(t))),1))}}),Bi=$({__name:"DcDoOrderNext",setup(i){const s=D({ioading:!1,msg:""}),t=T(),{carts:o}=A(t),a=()=>w(()=>{if(o.value.length<=0)return G("結算清單為空！！！"),!0;B(0),U(0),k().save_sts("ioading",!1),k().save_sts("checking",!0),k().switch_r_page(100)});return(_,d)=>{const p=Y;return c(),C(p,{aii:n(s),onClick:a,tit:"結算"},null,8,["aii"])}}}),Mi={class:"fx-s h6 fw-600 fx-b pb-s"},Ii={class:""},Oi=e("span",{class:"sus"},"優惠",-1),zi={class:"d-ib ani-scaie-hv"},Ei=e("span",null,"統計金額:  ",-1),Ni={class:"d-ib txt-money h5 ani-scaie-hv"},Ki=$({__name:"DeskIeftBottom",setup(i){return(s,t)=>{const o=st;return c(),u("aside",null,[r(qi),r(o,null,{default:m(()=>[e("div",Mi,[e("div",Ii,[Oi,g(":   "),e("div",zi,[g("HKD "),r(at)])]),e("div",null,[Ei,e("div",Ni,[g("HKD "),r(ns)])])])]),_:1}),r(Bi,{class:"mt w-100"})])}}}),Hi={},Vi={class:"pi-row"},Ui={class:"px-row py-row"};function ji(i,s){const t=Js;return c(),u("div",Vi,[r(t,{class:"ps-r"},{default:m(()=>[e("div",Ui,[Z(i.$slots,"default")])]),_:3})])}const hs=Xs(Hi,[["render",ji]]),Us="/src/assets/payment/",ss=(i,s,t,o="w-25")=>({tit:s,code:t,ciass:o,id:i,img:Us+"origin/"+t+".svg",img_wht:Us+"wht/"+t+".svg"}),xs=[ss(1,"支付寶","Alipay"),ss(2,"微信支付","Wechat"),ss(3,"銀聯","UnionPay"),ss(4,"master card","MasterCard"),ss(5,"八連通","Octopus","w-333"),ss(6,"EPS 支付","Eps","w-333"),ss(7,"現金支付","Cash","w-333")];xs[0];const Gi={class:"fx-i fx-wp row"},Ji={class:"fx-c mh-3em mxh-3em"},Wi=["src"],Fi={class:"ta-c pt fs-s"},Xi={class:"fx-c mh-3em mxh-3em"},Li=["src"],Qi={class:"ta-c pt fs-s"},Yi=$({__name:"DrnCheckouTab",setup(i){const s=vt(0),t=k(),{payments:o}=A(t),a={has:(_,d=!1)=>{const p=_.id;return o.value&&o.value.map(l=>{p==l.id&&(d=!0)}),d},insrt_payment:_=>w(()=>{t.insert_payment(_)})};return V(()=>Ls(xs.length,()=>s.value+=1,32)),(_,d)=>{const p=j;return c(),u("div",Gi,[(c(!0),u(K,null,H(n(xs),(l,b)=>(c(),u("div",{class:S(l.ciass),key:b},[e("div",{class:S([{"ani-card":n(s)>=b},"op-0 mb ani-scaie-aii"])},[a.has(l)?(c(),C(p,{key:0,class:"px py hand bg-card br w-100 fx-shd-pri paymentcard-iive fx-shd-pri"},{default:m(()=>[e("div",Ji,[e("img",{src:l.img_wht,class:"mxw-100"},null,8,Wi)]),e("p",Fi,f(l.tit),1)]),_:2},1024)):(c(),C(p,{key:1,bk:!0,onClick:h=>a.insrt_payment(l),class:"px py hand bg-card br w-100 fx-shd-tab"},{default:m(()=>[e("div",Xi,[e("img",{src:l.img,class:""},null,8,Li)]),e("p",Qi,f(l.tit),1)]),_:2},1032,["onClick"]))],2)],2))),128))])}}}),Zi={class:"py-row"},se={class:"fx-i pi-row"},te=e("h6",{class:"mxw-3em ta-c"},"小計",-1),ie={class:"fw-700"},ee={class:"py"},oe={class:"fx-i pi-row"},ne={class:"pr fx-i"},ae=["src"],_e={class:"fw-600 ps-r zi-s"},ce=e("div",{class:"middie i-0 d-ib h5"},"HKD",-1),re={class:"pi-row"},de=["onUpdate:modelValue"],pe={key:0,class:"ani-fade-b"},ue={key:0,class:"d-ib"},le=$({__name:"DrnCheckouItems",setup(i){const s=k(),{payments:t}=A(s),o=D({ani:0,trashIdx:-1,ioading:!1,msg:""}),a=E(()=>{let d=0;const p=t.value;return p&&p.map(l=>{d=x.floatAdd(d,l.price)}),d}),_={sureTrash:d=>w(()=>{o.trashIdx=bt(d),U(-210)}),trash:()=>w(()=>{const d=t.value;if(d.length>0&&o.trashIdx>=0){const p=d[o.trashIdx];p&&p.id?s.trash_payment(p):G("刪除項丟失，需重新選區。"),U(0),o.trashIdx=-1}})};return V(()=>Ls(7,()=>o.ani+=1,32)),(d,p)=>{const l=Mt,b=st,h=Ss;return c(),u("div",null,[e("div",Zi,[r(l,{class:"drn-checkout-item bs-x3 ani-scaie-hv"},{default:m(()=>[e("div",se,[te,e("h5",ie,[g(" :     HKD "),r(ns)])])]),_:1})]),e("aside",ee,[(c(!0),u(K,null,H(n(t),(v,y)=>(c(),u("div",{key:y},[r(l,{onTrash:P=>_.sureTrash(y),class:"drn-checkout-item bd mb-s ani-scaie-hv"},{default:m(()=>[e("div",oe,[e("div",ne,[e("img",{src:v.img,class:"mxh-2em mxw-5em"},null,8,ae)]),e("div",_e,[ce,e("div",re,[L(e("input",{type:"number","onUpdate:modelValue":P=>v.price=P,class:"h5 pi-x3 w-100 txt-money",placeholder:"請輸入付款金額"},null,8,de),[[ts,v.price]])])])])]),_:2},1032,["onTrash"])]))),128))]),n(t).length>1?(c(),u("aside",pe,[r(b,{class:"fx-c"},{default:m(()=>[(c(!0),u(K,null,H(n(t),(v,y)=>(c(),u("div",{key:y},[g(f(v.price)+" ",1),y<n(t).length?(c(),u("div",ue,"  +  ")):R("",!0)]))),128)),e("div",null," =  "+f(n(N)(n(a))),1)]),_:1})])):R("",!0),r(h,{onTrash:p[0]||(p[0]=v=>_.trash()),aii:n(o),idx:-210,msg:"你確定要刪除該付款方式嗎？"},null,8,["aii"])])}}}),me={class:"py-row"},fe={class:"ta-c"},he=e("h5",{class:"pb"},"實收金額",-1),ve={class:"py"},be={class:"txt-money fw-700"},$e={class:"fs-2em"},ye=e("div",{class:"py-x1"},[e("p",{class:"sus"},"標記收款僅供記帳，請確認已經支付和收款到帳")],-1),ge={class:"fx-c pt"},we={class:"w-618"},ke=e("p",{class:"py-s"},null,-1),xe=$({__name:"DrnCheckouBottom",props:{aii:{}},emits:["submit","back"],setup(i){return(s,t)=>{const o=Y,a=fs;return c(),u("div",me,[e("div",fe,[he,e("div",ve,[e("h4",be,[e("div",$e,[g("HKD  "),r(ns)])])]),ye]),e("div",ge,[e("div",we,[r(o,{aii:s.aii,onClick:t[0]||(t[0]=_=>s.$emit("submit")),class:"w-100 ani-scaie-aii",tit:"確認收款"},null,8,["aii"]),ke,r(a,{onClick:t[1]||(t[1]=_=>s.$emit("back")),class:"w-100",tit:"返回",ciass:"refund"})])])])}}}),Ce={"":"網絡連結錯誤！！！","Internal Server Error":"後台數據錯誤！！！","Invalid identifier or password":"帳戶或密碼錯誤！！！","This attribute must be unique":"該參數數據重複！！！","The storehouse does not have this much product to be orederd!":"該樣式的產品已經沒有庫存了！！！","Payment price is not equal to total price of the order!":"支付方式的金錢總，與訂單總額不相符！！！"},De="orders",Te=async i=>{let s="";try{s=$t(await As.pos(De,i))}catch(t){G("下單失敗！！！");const o=yt(t);return Ce[o.message]}return s},Ae="cashier_products",Pe="iabeis",qe=async(i,s)=>Qs(it,async()=>Ys(await As.get(Pe,X.buiid_pager(i,s)))),Se=async(i,s)=>Qs(it,async()=>Ys(await As.get(Ae,X.buiid_pager(i,s)))),J=Fs("cashierDeskProductPina",{state:()=>({iabeis:[],refresh:!1,products:[],pager:{page:1,pageCount:1,pageSize:100,total:1},condition:{label:"",search:""},one_of_shop:{}}),actions:{dorefresh(){this.refresh=!this.refresh},vfy_products(i){return i.broken_products=X.iist(i.broken_products),i.variations=X.iist(i.variations),i.labels=X.iist(i.labels),delete i.restocks,i.__broken_products=i.broken_products?i.broken_products.length:0,delete i.broken_products,i.labels=X.kiii_times(i.labels),i.variations=X.kiii_times(i.variations),i},async refreshProducts(){let i=await Se(this.condition,this.pager);return gs(i)?!1:(i=i,this.products=i.data?i.data.map(s=>this.vfy_products(s)):[],!0)},async refreshIabeis(){let i=await qe({},{pageSize:100,page:1});if(!gs(i)){i=i;const s=i.data?i.data:[];s.length>0&&(this.iabeis=s)}},save(i,s={}){this[i]=s},saveMany(i,s=[]){this[i]=s},savePager(i,s){this.pager[i]=s},saveCondition(i,s){this.condition[i]=s},variations(i){const s=i.variations?i.variations:{};return s.data?X.iist(s):[]}}}),Re={class:"py-row"},Be=e("div",{class:"py-x2"},null,-1),Me=$({__name:"DrnCheckout",setup(i){const s=T(),t=D({ioading:!1,msg:""}),{member:o}=A(s),a=D({can:!1,member:"",status:"",ordered_product:[],discount:[],payment_method:[]}),_={buiid:()=>{const d=s.buiid_ordered_product();if(d.length<=0)return G("結算清單不能為空。"),null;const p=k().buiid_payment_method();if(p.length<=0)return G("請選擇至少一種付款方式。"),null;const l=s.buiid_discount(),b=k().cmoput_payment_totai(),h=s.computed_finai_totai();return z.is_money_same(b,h)?(a.member=o.value.id?o.value.id:"",a.status=It.status_checkout_def,a.ordered_product=d,a.payment_method=p,a.discount=l,a.can=!0,a):(G("付款方式內金額的總額，與訂單的總額不同。"),null)},_submit:async d=>{const p=await Te(d);gs(p)?(gt(p,t),setTimeout(()=>s.save_sts("stating",!1),300),k().save_sts("ioading",!1)):(k().success_order(p),_.status(!1)),J().dorefresh()},submit:()=>w(async()=>{if(a.can=!1,U(0),B(0),!t.ioading){t.ioading=!0,_.status(!0),s.ciear_choise();const d=_.buiid();d&&d.can?await _._submit(d):_.status(!1),setTimeout(()=>t.ioading=!1,400)}}),status:(d=!1)=>{k().save_sts("ioading",d),k().save_sts("stating",d),s.save_sts("stating",d)},back:()=>w(()=>{k().regress_index()})};return(d,p)=>{const l=ms,b=hs;return c(),C(b,null,{default:m(()=>[r(l,{tit:"結算收款"}),e("div",Re,[r(Yi)]),r(le,{class:"pt pb-x2"}),r(xe,{aii:n(t),onBack:p[0]||(p[0]=h=>_.back()),onSubmit:p[1]||(p[1]=h=>_.submit()),class:"w-100"},null,8,["aii"]),Be]),_:1})}}}),Ie={class:"py-row"},Oe={class:"fx-c drn-cs-con"},ze={class:"ta-c"},Ee={class:"fx-c ani-softer"},Ne={class:"cir drn-cs-icon px-x1 py-x1 fx-c"},Ke={class:"py ani-fade-b"},He=e("h3",{class:"pb pt-x1"},"收款成功",-1),Ve={class:"py"},Ue={class:"fw-700 fs-2em"},je={class:"ani-fade-b"},Ge={class:"py-s fx-c ani-fade-b"},Je={class:"py-s fx-c ani-fade-b"},We=$({__name:"DrnCheckoutSucc",setup(i){const s=wt(),{order_of_success:t}=A(k()),o={cotinueOrder:()=>w(()=>{o.canceiAii()}),printed:()=>w(()=>{const a=t.value;if(a.id){o.before(),sessionStorage.setItem("heiiokitty_order_of_printed",JSON.stringify(a));const _=s.resolve({path:"/cashier/order_iist/pdf"});window.open(_.href,"_blank")}else G("該訂單目前無法打印，需前往訂單列表內執行打印。")}),before:()=>{U(0),B(0)},canceiAii:()=>w(()=>{o.before(),T().ciear_carts(),T().ciear_member(),T().ciear_discount(),k().ciear_now_order(),k().regress_index()})};return(a,_)=>{const d=ms,p=Rs,l=Y,b=fs,h=hs;return c(),C(h,null,{default:m(()=>[r(d,{func:o.cotinueOrder,tit:"結算收款"},null,8,["func"]),e("div",Ie,[e("div",Oe,[e("div",ze,[e("h2",null,[e("div",Ee,[e("div",Ne,[r(p,{icon:"check"})])])]),e("div",Ke,[He,e("h4",Ve,[e("div",Ue,[g("HKD "),r(ns)])])])])])]),e("div",je,[e("div",Ge,[r(l,{onClick:_[0]||(_[0]=v=>o.cotinueOrder()),class:"w-382 w-50-p",tit:"繼續收銀"})]),e("div",Je,[r(b,{onClick:_[1]||(_[1]=v=>o.printed()),class:"w-382 w-50-p",tit:"打印票據"})])])]),_:1})}}}),Fe={class:"o-search-biock br ps-r"},Xe=["placeholder"],Le={class:"middie r-0 o-search-biock-ciose"},Qe=$({__name:"OSearchBiock",props:{form:{},pk:{},tit:{}},emits:["resuit"],setup(i){return(s,t)=>{const o=Rs,a=j;return c(),u("div",Fe,[L(e("input",{onKeydown:t[0]||(t[0]=kt(_=>s.$emit("resuit"),["enter"])),class:"w-100 py pi-row pr-x3","onUpdate:modelValue":t[1]||(t[1]=_=>s.form[s.pk]=_),placeholder:s.tit?s.tit:"輸入會員編號、手機號或姓名進行搜索"},null,40,Xe),[[ts,s.form[s.pk]]]),e("div",Le,[r(a,{bk:!0,class:"py-n px",ciass:"fx-c",onClick:t[2]||(t[2]=()=>{s.form[s.pk]="",s.$emit("resuit")})},{default:m(()=>[r(o,{class:"i h4",icon:"x"})]),_:1})])])}}}),Ye={class:"px-x3 py bg-card ta-i w-100"},Ze={class:"bb pb"},so={class:"fx-s pb"},to={class:"w-42 pr"},io={class:"w-34 pr"},eo={class:"w-24 fx-r"},oo={class:"fx-i"},no={class:"w-42 pr"},ao={class:"w-34 pr"},_o={class:"fw-900"},co=$({__name:"CoCustomerDetaiiCard",props:{v:{}},setup(i){return(s,t)=>{const o=j;return c(),C(o,{bk:!0,class:"ani-scaie-aii hand w-100"},{default:m(()=>[e("div",Ye,[e("div",Ze,"客戶姓名:  "+f(s.v.name),1),e("div",so,[e("div",to,"郵箱:  "+f(s.v.email),1),e("div",io,"電話號碼:  "+f(s.v.phone_no),1),e("div",eo,"會員編號:  "+f(s.v.member_id),1)]),e("div",oo,[e("div",no,"會員等級:  "+f(n(rs).ievei(s.v)),1),e("div",ao,[g("購買折扣:   "),e("span",_o,f(n(rs).discount(s.v)),1)])])])]),_:1})}}}),ro={class:"desk-right-custom bg-con ps-r br-ti o-h"},po={class:"div ps-r zi"},uo={class:"py-x3"},lo={class:"ta-c py"},mo={key:0,class:"ani-softer"},fo={key:1,class:"ani-softer"},ho={key:0,class:"pt-x3 ani-fade-b"},vo={key:1,class:"ani-softer"},bo={class:"px-x3 py-x2 fx-c"},$o={class:"pt"},yo=e("div",{class:"py-x3"},null,-1),go={key:0,class:"abs-b zi-x3 w-100 py bg-con"},wo={class:"fx-c pb-x2"},ko={class:"fx-c"},xo=$({__name:"DrnCustomCon",setup(i){const s=D({many:[],chooseAii:!1,chooses:[],many_origin:[],condition:{search:""},ioading:!1,msg:"",trs:[],search:"",pager:{page:1,pageSize:10,pageCount:1,total:3}}),t=T(),{member:o}=A(t),a={fetch:()=>xt(s,async()=>Nt(s.condition,s.pager)),search:()=>w(()=>{s.condition.search=(s.condition.search+"").trim(),a.fetch()}),choise:_=>w(()=>{t.save_member(_),s.many.length=0,s.many.push({})}),reset:()=>w(()=>{t.save_member({}),s.many.length=0}),view:()=>w(()=>{k().switch_r_tab(1),B(202)})};return(_,d)=>{const p=co,l=Qe,b=Ws,h=tt,v=Et;return c(),u("div",ro,[e("div",po,[e("div",uo,[e("h3",lo,[n(o).id?(c(),u("div",mo,"客戶信息")):(c(),u("div",fo,"搜尋客戶"))]),n(o).id?(c(),u("div",ho,[r(p,{v:n(o)},null,8,["v"])])):(c(),u("div",vo,[e("div",bo,[r(l,{onResuit:d[0]||(d[0]=y=>a.search()),class:"w-75 w-50-x w-100-p",form:n(s).condition,pk:"search"},null,8,["form"])]),e("div",$o,[r(b,{aii:n(s)},{default:m(()=>[(c(!0),u(K,null,H(n(s).many,(y,P)=>(c(),u("div",{key:P,class:"pb"},[y.id?(c(),C(p,{key:0,onClick:q=>a.choise(y),v:y},null,8,["onClick","v"])):R("",!0)]))),128)),yo]),_:1},8,["aii"])])]))])]),n(o).id?(c(),u("div",go,[e("div",wo,[r(h,{class:"w-382 w-50-p",onClick:d[1]||(d[1]=y=>a.view()),tit:"查看全單優惠"})]),e("div",ko,[r(v,{class:"w-382 w-50-p",onClick:d[2]||(d[2]=y=>a.reset()),tit:"重選客戶"})])])):R("",!0)])}}}),Co={class:"fx-c"},Do=e("span",null,"   加載中 ",-1),To={key:1,class:"oti-con ani-softer"},Ao={key:0,class:"ani-fade-b"},Po=$({__name:"OTabieIoadingTwo",props:{aii:{},mini:{type:Boolean}},setup(i){const s=i,t=D({kiii:!!s.aii.ioading,timed:420});return Q(()=>s.aii.ioading,o=>{o?t.kiii=!0:setTimeout(()=>t.kiii=!1,t.timed)}),(o,a)=>{const _=et,d=Kt,p=Cs;return c(),u("div",{class:S(["o-tabie-ioading ps-r ts-s zi-s",{"mh-oti":!o.mini,"mh-oti-s":o.mini}])},[n(t).kiii?(c(),u("div",{key:0,class:S(["oti-ioading abs-fuii fx-c",{"oti-ioading-iive":o.aii.ioading,"oti-ioading-die":!o.aii.ioading}])},[e("div",Co,[r(_,{styie:"def"}),Do,r(d)])],2)):(c(),u("div",To,[o.aii.many&&o.aii.many.length>0?(c(),u("div",Ao,[Z(o.$slots,"default")])):(c(),C(p,{key:1,class:S({"mh-oti":!o.mini,"mh-oti-s":o.mini})},null,8,["class"]))]))],2)}}}),qo={class:"ani-softer fx-c fx-wp"},So={class:"fx-c w-100"},Ro={class:"d-ib h2 pt-s"},Bo={class:"fx-c w-100"},_t=$({__name:"OTabieEmptyTwo",props:{tit:{}},setup(i){return(s,t)=>(c(),u("div",qo,[e("div",So,[e("div",Ro,[r(n(ht),{class:"w-1em"})]),e("span",null,"   "+f(s.tit?s.tit:"空數據。")+" ",1)]),e("div",Bo,[Z(s.$slots,"default")])]))}}),Mo={class:"co-desk-prod-card bg-con br ani-scaie-aii"},Io={class:"mh-7em pt-x1"},Oo={class:"fw-700"},zo={class:"cdpc-sub fw-700 op-85 pt-s"},Eo={class:"pt pb-x1 fw-700"},No=$({__name:"CoDeskProdCard",props:{name:{},price:{},number:{},inventory:{}},setup(i){return(s,t)=>{const o=j;return c(),u("nav",Mo,[r(o,{bk:!0,class:"w-100 ta-i br hand",ciass:"pi pr-s fs"},{default:m(()=>[e("div",Io,[e("h5",Oo,f(s.name),1),e("h6",zo,"編號"+f(s.number),1)]),e("h6",Eo," HKD  "+f(s.price),1)]),_:1})])}}}),Ko={class:"pr pb"},Ho=e("div",{class:"py-x3"},null,-1),Vo=$({__name:"DcDoRefreshProduct",setup(i){const s=D({ioading:!1,msg:""}),t=()=>w(async()=>{s.ioading||(s.ioading=!0,await J().refreshProducts()?ws("產品刷新成功。"):G("產品刷新失敗！！！"),setTimeout(()=>s.ioading=!1,400))});return(o,a)=>{const _=Bs;return c(),u("div",Ko,[r(_,{onClick:a[0]||(a[0]=d=>t()),icon:"refresh",class:"h4 bg-con",ciass_i:"h3"}),Ho])}}}),Uo={class:"ps-r"},jo={key:0},Go={class:"desk-right-cards row row-x2-w pb"},Jo=e("div",{class:"py-row"},null,-1),Wo={key:1,class:"mh-oti fx-c"},Fo=$({__name:"DrnProductsCon",setup(i){const s=J(),{pager:t,condition:o,products:a}=A(s),_=D({ioading:!0,msg:"",many:[{}]});Q(t.value,()=>d.fetch()),Q(o.value,()=>d.fetch());const d={shop:p=>w(()=>{p.__quantity=0,p.__price=p.new_selling_price,p.__variation=0,s.save("one_of_shop",p),B(501)}),fetch:()=>w(async()=>{_.ioading=!0,await s.refreshProducts(),_.ioading=!1})};return V(d.fetch),(p,l)=>{const b=No,h=Bs,v=_t,y=Po;return c(),u("div",Uo,[r(y,{aii:n(_)},{default:m(()=>[n(a).length>0?(c(),u("div",jo,[e("div",Go,[(c(!0),u(K,null,H(n(a),(P,q)=>(c(),u("div",{class:"w-333-p w-25 w-20-x ani-softer",key:q},[r(b,{class:"w-100 mb-x1",onClick:M=>d.shop(P),name:P.name,number:P.product_id,price:n(N)(P.new_selling_price)},null,8,["onClick","name","number","price"])]))),128))]),Jo])):(c(),u("div",Wo,[r(v,{tit:"無商品數據"},{default:m(()=>[r(h,{class:"mt",icon:"refresh",ciass_i:"h3",onClick:l[0]||(l[0]=P=>d.fetch())})]),_:1})]))]),_:1},8,["aii"]),r(Vo,{class:"abs-b r-0 ps-f-imp zi"})])}}}),Xo={class:"w-50-p w-35 w-30-x ts"},Lo={class:"fx-s pb"},Qo={class:"fx-1 fx-i tabs-pri pt"},Yo={key:0,class:"fs-s px-s tag"},Zo=e("div",{class:"ta-r pt"},null,-1),sn=$({__name:"DrNormaiiTopTabs",setup(i){const s=k(),{member:t}=A(T()),o=D({tab:0,search:""}),a=()=>w(()=>J().saveCondition("search",o.search)),_=d=>s.switch_r_tab(d);return(d,p)=>{const l=Ht,b=j;return c(),u("aside",null,[e("div",Xo,[r(l,{pchd:"請輸入產品編號、名稱進行搜索",onResuit:p[0]||(p[0]=h=>a()),class:"bg-con",aii:n(o),pk:"search",kiii:!0},null,8,["aii"])]),e("div",Lo,[e("div",Qo,[e("div",{class:S(["tab-item mr",{"tab-iive":n(s).r_tab==0}]),onClick:p[1]||(p[1]=h=>_(0))},[r(b,{class:"px py",bk:!0,ciass:n(s).r_tab==0?"txt-pri":"tit"},{default:m(()=>[g(" 商品 ")]),_:1},8,["ciass"])],2),e("div",{class:S(["tab-item mr",{"tab-iive":n(s).r_tab==1}]),onClick:p[2]||(p[2]=h=>_(1))},[r(b,{class:"px py",bk:!0,ciass:n(s).r_tab==1?"txt-pri":"tit"},{default:m(()=>[g(" 客戶  "),n(t).id?(c(),u("div",Yo,"("+f(n(t).name)+")",1)):R("",!0)]),_:1},8,["ciass"])],2)]),Zo])])}}}),tn=["id"],en=$({__name:"scroiix",setup(i){const s=Ct();return(t,o)=>{var a;return c(),u("div",{class:"scroiix w-100",id:"scroiix_"+((a=n(s))==null?void 0:a.uid)},[Z(t.$slots,"default",{},void 0,!0)],8,tn)}}});const on=Xs(en,[["__scopeId","data-v-0a9c5a94"]]),nn={class:"desk-center-tats-bar bg-con br pi-row"},an={class:"ps-r py"},_n={class:"dctb-tags w-100 ps-r"},cn=e("button",{class:"py"}," ",-1),rn={class:"fx-i w-100"},dn={key:0,class:"ani-softer fx-c pi py-s abs-r middie bg-con"},pn={key:0,class:"px-n"},un=$({__name:"DrNormaiiTagsBar",setup(i){const s=D({tags:["aii"],tag:0,ioading:!0,msg:"",many:[{}]}),t=J(),{iabeis:o}=A(J());return Q(()=>s.tag,_=>{t.saveCondition("label",_?_+"":"")}),V({iive:_=>Dt(_,s.tags),fetch:()=>ls(s,async()=>await t.refreshIabeis())}.fetch),(_,d)=>{const p=j,l=et,b=on;return c(),u("div",nn,[e("div",an,[e("div",_n,[cn,r(b,{class:"abs-i t-0"},{default:m(()=>[e("div",rn,[r(p,{bk:!0,class:S(["btn-tab py px mw-4em mr br",{"btn-app":n(s).tag==0}]),onClick:d[0]||(d[0]=h=>n(s).tag=0)},{default:m(()=>[g("全部")]),_:1},8,["class"]),n(s).ioading?(c(),u("div",dn,[r(l,{styie:"pri"})])):R("",!0),(c(!0),u(K,null,H(n(o),(h,v)=>(c(),u("div",{key:v},[h.isShow?(c(),u("div",pn,[r(p,{bk:!0,class:S(["btn-tab py px mw-8em br",{"btn-app":n(s).tag==h.id}]),onClick:y=>n(s).tag=h.id},{default:m(()=>[g(f(h.name),1)]),_:2},1032,["onClick","class"])])):R("",!0)]))),128))])]),_:1})])])])}}}),ln={class:"pt ani-fade-b"},mn={class:"pt ani-fade-b"},fn={class:"pt"},hn={class:"pt pi-row ani-fade-b"},vn={key:0,class:"abs-b bg-con py-s w-100 ani-bar-bottom bs-bar-bottom zi"},bn=$({__name:"DrNormaiiWrapper",setup(i){const{r_tab:s}=A(k()),t=D({pager:{page:1,pageCount:1,pageSize:25,total:1}}),{pager:o}=A(J()),a={pager:(_,d)=>w(()=>{o.value.page=_,o.value.pageSize=d,J().save("pager",o.value)})};return(_,d)=>{const p=zt,l=Ot;return c(),u("div",null,[r(sn),L(e("div",ln,[e("aside",null,[r(un)]),e("div",mn,[r(p,{class:"desk-right-con"},{default:m(()=>[e("aside",fn,[r(Fo)])]),_:1})])],512),[[Es,n(s)==0]]),L(e("div",hn,[r(xo)],512),[[Es,n(s)==1]]),n(s)==0?(c(),u("aside",vn,[r(l,{onResuit:a.pager,pager:n(t).pager},null,8,["onResuit","pager"])])):R("",!0)])}}}),$n={class:"fx-s"},yn={class:"fx-1"},gn={class:"fw-700 ani-softer"},wn={class:"txt-money d-ib"},kn={class:"d-ib ani-scaie-aii"},xn={key:0,class:"fx-r ani-softer"},ct=$({__name:"CoCashierBiiisTotaiBar",props:{tit_save:{},receipt:{},kiii_option:{type:Boolean}},emits:["reorder"],setup(i){const s=i,t=E(()=>z.carts_aii_num(s.receipt.carts?s.receipt.carts:[])),o=E(()=>z.computed_finai_totai_for_recept(s.receipt));return(a,_)=>{const d=tt;return c(),u("div",null,[e("div",$n,[e("div",yn,[e("h3",gn,[e("span",null,"共"+f(n(t))+"件 ",1),e("div",wn,[g("  HKD  "),e("div",kn,f(n(N)(n(o))),1)])])]),a.kiii_option?R("",!0):(c(),u("div",xn,[r(d,{onClick:_[0]||(_[0]=p=>a.$emit("reorder",a.receipt)),class:"mw-6em ani-scaie-aii",tit:a.tit_save?a.tit_save:"取回單據"},null,8,["tit"])]))])])}}}),Cn={class:"bg-card fx-s br py-s mh-3em ani-scaie-aii"},Dn={class:"w-35 pi-row"},Tn=e("span",null,"掛單時間:  ",-1),An={class:"w-43"},Pn=e("span",null,"收銀員:  ",-1),qn={class:"d-ib"},Sn={class:"w-22"},Rn=e("span",null,"客戶:  ",-1),Bn={key:0,class:"d-ib"},Mn={key:1,class:"d-ib txt-err"},rt=$({__name:"CoCashierBiiisMsgCard",props:{receipt:{}},setup(i){const s=i,t=E(()=>s.receipt.member?s.receipt.member:{});return(o,a)=>(c(),u("aside",Cn,[e("div",Dn,[Tn,e("span",null,f(o.receipt.save_time?o.receipt.save_time:n(cs)()),1)]),e("div",An,[Pn,e("div",qn,f(n(ps)().name),1)]),e("div",Sn,[Rn,n(t).id?(c(),u("div",Bn,f(n(t).name),1)):(c(),u("div",Mn," (未選擇客戶) "))])]))}}),dt="handshake_cashier_receipts",In=10,as=()=>{const i=localStorage.getItem(dt);if(i){const s=JSON.parse(i);return Tt(s)?s:[]}return[]},js=i=>{localStorage.setItem(dt,JSON.stringify(i))},On=i=>i.length>=In,es={has_receipt:(i,s=!1)=>(as().map(t=>{t.__idx==i.__idx&&(s=!0)}),s),save_receipt:i=>{const s=as();if(s){if(On(s))G("訂單過多，親先廢除一些訂單，再嘗試保留訂單。");else if(i.carts)return i.__idx=s.length,s.push(i),js(s),!0}return!1},receipts:()=>as(),trash_receipt:(i,s=-1)=>{const t=as();return t&&(t.map((o,a)=>{o.__idx==i.__idx&&(s=a)}),s>=0)?(t.splice(s,1),js(t),!0):!1}},zn={key:0},En={class:"w-26"},Nn={class:"w-20"},Kn={class:"w-13"},Hn={class:"w-13"},Vn={class:"w-14"},Un={class:"w-14"},jn={key:1,class:"mh-oti-s fx-c"},pt=$({__name:"DrnRbTabie",props:{receipt:{}},setup(i){const s=D({many:[{}],ioading:!1,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}}),t={vai_totai:o=>N(T().comput_one_totai(o))};return V(()=>us(s,[{ciass:"w-26",tit:"商品名稱"},{ciass:"w-20",tit:"樣式"},{ciass:"w-13",tit:"附加"},{ciass:"w-13",tit:"單價"},{ciass:"w-14",tit:"數量"},{ciass:"w-14",tit:"統計"}])),(o,a)=>{const _=_t,d=ds;return c(),C(d,{aii:n(s),mini:!0},{default:m(()=>[o.receipt.carts&&o.receipt.carts.length>0?(c(),u("div",zn,[(c(!0),u(K,null,H(o.receipt.carts,(p,l)=>(c(),u("div",{class:"td",key:l},[e("div",En,f(p.__product.name),1),e("div",Nn,f(p.__variation.name),1),e("div",Kn,"- "+f(p.discount_deduction),1),e("div",Hn,f(p.__product.new_selling_price),1),e("div",Vn,f(p.quantity),1),e("div",Un,f(t.vai_totai(p)),1)]))),128))])):(c(),u("div",jn,[r(_,{tit:"未選購商品"})]))]),_:1},8,["aii"])}}}),Gn={class:"py-row"},Jn=e("div",{class:"pt"},null,-1),Wn={class:"py-row"},Fn={key:0,class:"py-x3 fx-c"},Xn={key:1,class:"py-x3 ani-fade-b"},Ln={class:"pb-row fx-c"},Qn={class:"fx-c ani-fade-b"},Yn=$({__name:"DrnRetainBiiis",setup(i){const s=T(),{saving:t}=A(k()),{carts:o,member:a,ratio_of_member:_,ratio_of_aii:d,discount_of_aii:p}=A(s),l=D({ioading:!1,msg:""}),b=E(()=>({__idx:-1,carts:o.value,member:a.value,ratio_of_aii:d.value,discount_of_aii:p.value,ratio_of_member:_.value})),h={back:()=>w(()=>{k().regress_index()}),__save:()=>{l.ioading=!0;const v=b.value;v.save_time=cs();const y=es.save_receipt(v);return setTimeout(()=>l.ioading=!1,200),y?(At("單據保存成功。",l),k().save_sts("saving",!0),!0):!1},save_receipt:()=>w(h.__save),ciear_order:()=>{U(0),B(0),T().ciear_carts(),T().ciear_member(),T().ciear_discount(),k().ciear_now_order()},save_receipt_than_ciear_order:()=>w(async()=>{h.__save()&&(h.ciear_order(),k().regress_index())})};return(v,y)=>{const P=ms,q=rt,M=ct,I=Ds,O=Vt,is=Y,W=fs,vs=hs;return c(),C(vs,null,{default:m(()=>[r(P,{tit:"保留單據"}),e("div",Gn,[r(I,{class:"py-row px-row"},{default:m(()=>[Jn,r(q,{receipt:n(b)},null,8,["receipt"]),e("div",Wn,[r(pt,{receipt:n(b),class:"py-s"},null,8,["receipt"])]),r(M,{receipt:n(b),kiii_option:!0},null,8,["receipt"])]),_:1})]),n(t)?(c(),u("div",Fn,[r(O,{class:"w-382 w-50-p",onClick:y[0]||(y[0]=zs=>h.back()),tit:"返回"})])):(c(),u("div",Xn,[e("div",Ln,[r(is,{aii:n(l),class:"w-382 w-50-p",onClick:y[1]||(y[1]=zs=>h.save_receipt()),tit:"保留單據"},null,8,["aii"])]),e("div",Qn,[r(W,{class:"w-382 w-50-p",onClick:y[2]||(y[2]=zs=>h.save_receipt_than_ciear_order()),tit:"保留單據後清空整單"})])]))]),_:1})}}}),Zn={key:0,class:"py-row ani-softer"},sa={class:"pt abs-r t-0 zi pr"},ta=e("div",{class:"pt-x2"},null,-1),ia={class:"py-row"},ea={key:1,class:""},oa={key:0,class:"py-x3 fx-c ani-fade-b"},na=$({__name:"DrnRecaptionBiiis",setup(i){const s=D({many:[],ioading:!0,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}}),t=D({receipt:{},receipt_of_trash:{}}),o={reorder:a=>w(()=>{t.receipt=a,U(101)}),do_reorder:()=>w(()=>{s.ioading=!0;const{carts:a,member:_,ratio_of_aii:d,ratio_of_member:p,discount_of_aii:l}=t.receipt;T().doReceiptToOrder(a,_,d,p,l),k().regress_index(),ws("單據取回成功。"),es.trash_receipt(t.receipt),setTimeout(()=>s.ioading=!1,200)}),fetch:()=>w(()=>{s.ioading=!0,s.many=es.receipts(),setTimeout(()=>s.ioading=!1,200)}),trash_receipt:()=>w(()=>{s.ioading||(s.ioading=!0,U(0),es.trash_receipt(t.receipt_of_trash)?(ws("單據刪除成功。"),s.many.length=0,s.many=es.receipts()):G("單據刪除失敗！！！"),setTimeout(()=>s.ioading=!1,200))}),sureTrash:a=>w(()=>{U(-301),t.receipt_of_trash=a}),ciose:()=>w(()=>{k().switch_r_page(0)})};return V(o.fetch),(a,_)=>{const d=ms,p=Bt,l=rt,b=ct,h=Ds,v=Cs,y=Ws,P=fs,q=Ss,M=jt,I=hs;return c(),C(I,null,{default:m(()=>[r(d,{tit:"取回單據",num:n(s).many.length},null,8,["num"]),r(y,{aii:n(s)},{default:m(()=>[n(s).many&&n(s).many.length>0?(c(),u("div",Zn,[(c(!0),u(K,null,H(n(s).many,(O,is)=>(c(),u("div",{class:"pb-x2",key:is},[r(h,{class:"py-row px-row ps-r"},{default:m(()=>[e("div",sa,[r(p,{onClick:W=>o.sureTrash(O)},null,8,["onClick"])]),ta,r(l,{receipt:O},null,8,["receipt"]),e("div",ia,[r(pt,{receipt:O,class:"py-s"},null,8,["receipt"])]),r(b,{onReorder:o.reorder,receipt:O},null,8,["onReorder","receipt"])]),_:2},1024)]))),128))])):(c(),u("div",ea,[r(v,{class:"mh-oti"})]))]),_:1},8,["aii"]),n(s).many.length<=0?(c(),u("div",oa,[r(P,{onClick:_[0]||(_[0]=O=>o.ciose()),class:"w-382 w-50-p",tit:"關閉"})])):R("",!0),r(q,{idx:-301,aii:n(s),onTrash:_[1]||(_[1]=O=>o.trash_receipt())},null,8,["aii"]),r(M,{idx:101,aii:n(s),onSure:_[2]||(_[2]=O=>o.do_reorder()),msg:"當前結算清單會被替換，取回單據後該單據會自動作廢，您確定要取回該單據嗎？"},null,8,["aii"])]),_:1})}}}),aa={class:"ps-r"},_a=$({__name:"DeskRight",setup(i){const{r_page:s}=A(k());return(t,o)=>(c(),u("div",aa,[n(s)==0?(c(),C(bn,{key:0})):n(s)==3?(c(),C(Yn,{key:1})):n(s)==4?(c(),C(na,{key:2})):n(s)==100?(c(),C(Me,{key:3})):n(s)==101?(c(),C(We,{key:4})):R("",!0)]))}}),ca={class:"o-number-manager-two"},ra={class:"fx-c"},da={class:"px ta-c py-x1 ani-scaie-hv"},pa={class:"fx-c"},ua=$({__name:"ONumberMangerTwo",props:{form:{},pk:{},disabied:{type:Boolean},max:{}},setup(i){const s=i,t=()=>s.form[s.pk],o={setv:a=>{s.form[s.pk]=a},min:()=>{if(s.disabied)return 0;let a=t()-1;a=a<=0?0:a,o.setv(a)},add:()=>{if(s.disabied)return 0;let a=t()+1;s.max!=null&&(a=a>s.max?s.max:a),o.setv(a)},effect:()=>{s.max!=null&&t()>s.max&&o.setv(s.max>0?s.max:0)}};return Zs(o.effect),(a,_)=>{const d=Rs,p=j;return c(),u("div",ca,[e("div",ra,[r(p,{class:"onmt-btn br ani-scaie-hv",onClick:_[0]||(_[0]=l=>o.add()),ciass:"fx-c"},{default:m(()=>[r(d,{class:"i h4 pri-wht ani-scaie-hv",icon:"pius"})]),_:1})]),e("h4",da,f(a.form[a.pk]?a.form[a.pk]:0),1),e("div",pa,[r(p,{class:"onmt-btn br ani-scaie-hv",onClick:_[1]||(_[1]=l=>o.min()),ciass:"fx-c"},{default:m(()=>[r(d,{class:"i h4 pri-wht ani-scaie-hv",icon:"min"})]),_:1})])])}}}),la={class:"w-100 ani-softer"},F=$({__name:"DcDoCenterBtn",props:{disabied:{type:Boolean}},emits:["tap"],setup(i){return(s,t)=>{const o=j;return c(),u("div",la,[r(o,{bk:!0,onClick:t[0]||(t[0]=a=>s.$emit("tap")),class:S([{"btn-die-imp":s.disabied},"btn-tab sub w-100 py px-t br ani-scaie-aii"])},{default:m(()=>[Z(s.$slots,"default")]),_:3},8,["class"])])}}}),ma={class:"desk-center pt"},fa=e("div",{class:"py"},null,-1),ha={key:0,class:"o-form pt-row ani-fade-b"},va=e("div",{class:"bd-0 bd-b bd-c-x2 bd-s-d ani-softer"},null,-1),ba=e("div",{class:"bd-0 bd-b bd-c-x2 bd-s-d"},null,-1),$a=$({__name:"DeskCenter",setup(i){const{stating:s}=A(k()),{has_choise:t,carts:o,choiseOne:a}=A(T()),_=E(()=>t&&o.value.length>0&&a.value.product),d=E(()=>o.value.length>0),p=D({now:0,num:0,ani:0,ioading:!1,msg:""}),l={opt:h=>w(()=>{if(!s.value)switch(h){case 1:B(201);break;case 2:B(202);break;case 5:k().switch_r_page(3),k().uniock_ieft();break;case 10:B(207);break;case 110:T().remove_cart();break;case 111:U(-201);break;case 120:l.backReceipt();break;default:p.now=0,k().switch_r_page(0),k().uniock_ieft();break}}),canceiAii:()=>w(()=>{U(0),B(0),T().ciear_carts(),T().ciear_discount(),k().ciear_now_order(),k().regress_index()}),backReceipt:()=>w(()=>{k().uniock_ieft(),k().switch_r_page(4)})},b=E((h=0)=>{try{const v=a.value?a.value:{},y=ps().mystore;h=z.ioc_inventory(v,y,v.variation)}catch{}return h});return(h,v)=>{const y=ua,P=Ss;return c(),u("div",ma,[r(y,{disabied:n(s),max:n(b),class:"ani-item",form:n(a),pk:"quantity"},null,8,["disabied","max","form"]),fa,n(d)?(c(),u("div",ha,[n(_)?(c(),C(F,{key:0,onTap:v[0]||(v[0]=q=>l.opt(1))},{default:m(()=>[g(" 單品優惠 ")]),_:1})):(c(),C(F,{key:1,disabied:!0},{default:m(()=>[g(" 單品優惠 ")]),_:1})),va,r(F,{onTap:v[1]||(v[1]=q=>l.opt(2))},{default:m(()=>[g(" 全單優惠 ")]),_:1}),r(F,{onTap:v[2]||(v[2]=q=>l.opt(10))},{default:m(()=>[g(" 統計毛利率 ")]),_:1}),r(F,{onTap:v[3]||(v[3]=q=>l.opt(5))},{default:m(()=>[g(" 保留單據 ")]),_:1}),ba,n(_)?(c(),C(F,{key:2,onTap:v[4]||(v[4]=q=>l.opt(110))},{default:m(()=>[g(" 單件取消 ")]),_:1})):(c(),C(F,{key:3,disabied:!0},{default:m(()=>[g(" 單件取消 ")]),_:1})),r(F,{onTap:v[5]||(v[5]=q=>l.opt(111))},{default:m(()=>[g(" 整單取消 ")]),_:1})])):R("",!0),r(F,{class:"ani-softer",onTap:v[6]||(v[6]=q=>l.opt(120))},{default:m(()=>[g(" 取回單據 ")]),_:1}),r(P,{aii:n(p),idx:-201,onTrash:v[7]||(v[7]=q=>l.canceiAii()),msg:"你確定要取消整個訂單嗎？"},null,8,["aii"])])}}}),ut=$({__name:"PanContinue",props:{idx:{},idx_end:{},huge:{type:Boolean},big:{type:Boolean},need_hui:{type:Boolean}},setup(i,{expose:s}){const t=i,{PAN:o}=A(Pt()),a=D({iive:!1,kiii:!1,animeTime:132}),_={open:()=>a.iive=!0,ciose:()=>a.iive=!1,change:()=>a.iive=!a.iive,kiii:()=>{a.kiii=!1,B(t.idx_end?t.idx_end:0)}};return s(_),Q(()=>a.iive,d=>{d?a.kiii=!0:setTimeout(_.kiii,a.animeTime)}),Q(o,()=>qt(t.idx,_.open,_.ciose)),(d,p)=>n(a).kiii?(c(),u("div",{key:0,class:S(["fixpan",{"fixpan-iive":n(a).iive,"fixpan-die":!n(a).iive}])},[e("div",{class:S(["fixpan-hui",{"fixpan-hui-die":!d.need_hui}]),onClick:p[0]||(p[0]=(...l)=>_.ciose&&_.ciose(...l))},null,2),e("nav",{class:S(["fixpan-main fixpan-main-r fixpan-main-bs",{"fixpan-main-big":d.big,"fixpan-main-huge":d.huge}])},[Z(d.$slots,"default")],2)],2)):R("",!0)}}),ya=(i={})=>i.ordered_product?i.ordered_product:[],ga=(i={})=>i.storehouse_info?i.storehouse_info:[],Gs={storehouses:ga,inventory_of_store:(i,s=0)=>(i.variation.map(o=>{s+=o.quantity}),s),quatitys_of_variation_in_store:(i,s,t=0,o=0)=>{for(let a=0;a<i.length;a++){const _=i[a],d=_.storehouse_id;t?d==t&&_.variation.map(l=>{l.id==s&&(o+=l.quantity)}):_.variation.map(l=>{l.id==s&&(o+=l.quantity)})}return o},order_products:ya},wa={class:"py pi"},ka=e("h4",{class:"pt-x3"},"選擇",-1),xa={class:"py-x2"},Ca=e("option",{value:"0"},"-- 請選擇 --",-1),Da=["value"],Ta={class:"py pi-row ani-bigger br tr-bg fx-aii-weak ts ani-scaie-hv"},Aa={class:"ani-softer d-ib"},Pa={key:0,class:"ani-softer d-ib"},qa={key:1,class:"sus"},Sa={class:"pt"},Ra={class:"pb-x3 pt"},Ba={class:"py-x3"},Ma=e("div",{class:"pb"},"購買數量",-1),Ia={class:"txt-pri bb pt-x2 pb"},Oa=$({__name:"DrnProdMsgPan",setup(i){const s=J(),{one_of_shop:t}=A(s),{mystore:o}=A(ps()),a=D({ioading:!1,msg:""}),_=()=>w(async()=>{t.value.id&&B(502)}),d=E(()=>Gs.storehouses(t.value)),p=E(()=>{const v=o.value?o.value:0;return Gs.quatitys_of_variation_in_store(d.value,t.value.__variation,v)}),l=E(()=>(t.value.__variation||t.value.__variation<=0)&&p.value<=0),b=D(Ps({__variation:"",__quantity:"",__price:""})),h=()=>ls(a,async()=>{const v=t.value,y=v.__variation,P=v.__quantity,q=v.__price;for(let O in b)b[O]=!1;if(y<=0){b.__variation=!0;return}if(P<=0){b.__quantity=!0;return}if(q<0){b.__price=!0;return}const M=v.variations;let I={};M.map(O=>{O.id==y&&(I=O)}),T().add_cart(v,P,I),B(0)});return(v,y)=>{const P=ot,q=Is,M=Gt,I=Y,O=os,is=ut;return c(),C(is,{idx:501,idx_end:0},{default:m(()=>[r(O,{tit:"加入購物清單"},{default:m(()=>[e("div",wa,[r(P,{num:n(t).product_id,named:n(t).name},null,8,["num","named"])]),ka,e("div",xa,[r(q,{tit:"客人需要的樣式",err:n(b).__variation},{default:m(()=>[L(e("select",{"onUpdate:modelValue":y[0]||(y[0]=W=>n(t).__variation=W)},[Ca,(c(!0),u(K,null,H(n(t).variations,(W,vs)=>(c(),u("option",{key:vs,value:W.id},f(W.name),9,Da))),128))],512),[[St,n(t).__variation]])]),_:1},8,["err"])]),e("div",Ta,[n(t).__variation?(c(),u("p",{key:0,class:S(["",{"txt-err":n(l)}])},[e("div",Aa,f(n(p)),1),g("  件庫存 "),n(p)==0?(c(),u("div",Pa,"(缺貨)")):R("",!0)],2)):(c(),u("p",qa,"沒有庫存信息，請先選擇一個樣式")),e("p",Sa,f(n(N)(n(t).__price))+" HKD",1)]),e("div",Ra,[e("div",Ba,[Ma,r(M,{err:n(b).__quantity,form:n(t),max:n(p),pk:"__quantity"},null,8,["err","form","max"])]),e("div",Ia,[e("span",{onClick:y[1]||(y[1]=W=>_())},"庫存明細")])]),r(I,{aii:n(a),onClick:y[2]||(y[2]=W=>h()),class:"w-100",tit:"添加"},null,8,["aii"])]),_:1})]),_:1})}}}),za={class:"ps-r"},Ea={class:"expan-icon middie abs-r fx-i zi"},Na={class:"expan-inner"},Ka=$({__name:"expan",props:{def:{type:Boolean}},setup(i){const s=i,t=D({show:s.def?s.def:!1});return Q(()=>s.def,o=>t.show=o),(o,a)=>{const _=Bs;return c(),u("div",{class:S(["",{"expan-iive":n(t).show,"expan-die":!n(t).show}])},[e("div",za,[e("div",null,[Z(o.$slots,"tit")]),e("div",Ea,[r(_,{onClick:a[0]||(a[0]=d=>n(t).show=!n(t).show),icon:"c-r"})])]),e("div",Na,[Z(o.$slots,"con")])],2)}}}),Ha={class:"td"},Va={class:"w-20"},Ua={class:"w-20"},ja={class:"fx-1 fx-s sus"},Ga={class:"fx-i ani-fade-b"},Ja=e("div",{class:"w-19"},null,-1),Wa={class:"fx-1"},Fa={class:"td tr-bg"},Xa={class:"w-36"},La={class:"fx-1"},Qa=$({__name:"CcPiWarehouseTabie",props:{aii:{},one_of_edit:{}},emits:["view","transtock"],setup(i){const s=i;V(()=>us(s.aii,Ut));const t={buiid_variation:o=>o.variation?o.variation:[],one_quantity_totai:(o,a=0)=>(t.buiid_variation(o).map(d=>{a+=d.quantity?d.quantity:0}),a)};return(o,a)=>{const _=Ka,d=ds;return c(),C(d,{aii:o.aii,mini:!0},{default:m(()=>[(c(!0),u(K,null,H(o.one_of_edit.storehouse_info,(p,l)=>(c(),u("div",{key:l},[r(_,{def:!0},{tit:m(()=>[e("div",Ha,[e("div",Va,f(p.storehouse_name),1),e("div",Ua,f(t.one_quantity_totai(p)),1),e("div",ja,f(p.storehouse_address),1)])]),con:m(()=>[e("div",Ga,[Ja,e("div",Wa,[(c(!0),u(K,null,H(t.buiid_variation(p),(b,h)=>(c(),u("div",{class:"ani-fade-b",key:h},[e("div",Fa,[e("div",Xa,"樣式:  "+f(b.name),1),e("div",La,"庫存:  "+f(b.quantity),1)])]))),128))])])]),_:2},1024)]))),128))]),_:1},8,["aii"])}}}),Ya={class:"py-x3 mt fx-c"},Za=$({__name:"DrnProdInvenPan",setup(i){const s=J(),{one_of_shop:t}=A(s),o=D({msg:"",many:[{}],pager:{},ioading:!1,trs:[]}),a=D({msg:"",many:[{}],pager:{},ioading:!1,trs:[]});return(_,d)=>{const p=Jt,l=Qa,b=Y,h=os,v=ut;return c(),C(v,{idx:502,big:!0,idx_end:501},{default:m(()=>[r(h,{tit:"庫存詳情",ciass:"px"},{default:m(()=>[r(p,{product:n(t),class:"mb"},null,8,["product"]),r(Wt,{one_of_edit:n(t),aii:n(o),kiii_option:!0},null,8,["one_of_edit","aii"]),r(l,{class:"mh-20em",one_of_edit:n(t),aii:n(a)},null,8,["one_of_edit","aii"]),e("div",Ya,[r(b,{class:"w-382 w-50-p",tit:"關閉",onClick:d[0]||(d[0]=y=>n(B)(501))})])]),_:1})]),_:1})}}}),s_=i=>i>1||i<0||!i?1:i,lt={vfy_ratio:s_},t_={class:"py pi"},i_={class:"pi-row"},e_={class:"pi"},o_={class:"pi py-s"},n_={class:"pi py-s"},a_={class:"py-x3"},__={class:"fx-i"},c_={key:0,class:"py-x3"},r_=e("h6",{class:"pb"}," 單品折扣 ",-1),d_={key:1,class:"py-x3"},p_=e("h6",{class:"pb"}," 單品減價 ",-1),u_={class:""},l_=e("h6",null,"計算  ",-1),m_={class:"pi pt-x2"},f_={class:"fx-i pi-row"},h_=e("p",null,"=  ",-1),v_=e("div",{class:"py-x3"},null,-1),b_=$({__name:"DeskCenterDiscountPan",setup(i){const s=T(),{choiseOne:t}=A(s),o=E(()=>t.value.__product?t.value.__product:{}),a=D(Ps({discount:""}));Q(()=>t.value.discount,p=>{const l=s.comput_one_totai(t.value);t.value.is_ratio||(l<=0?(t.value.discount=s.comput_num_x_price(t.value),a.discount=!0):a.discount=!1)});const _={price:()=>{const p=o.value;return p.new_selling_price?p.new_selling_price:0},submit:()=>ls(d,async()=>{B(0)}),switchMod:p=>w(()=>{t.value.is_ratio=p,p?t.value.discount=1:t.value.discount=0,a.discount=!1}),vfy:()=>{t.value.is_ratio&&(t.value.discount=lt.vfy_ratio(t.value.discount))}},d=D({nows:[0],now:0,ioading:!1,msg:""});return(p,l)=>{const b=ot,h=j,v=Is,y=Y,P=os,q=Ms;return c(),C(q,{idx:201},{default:m(()=>[r(P,{tit:"單品優惠"},{default:m(()=>[e("div",null,[e("div",t_,[r(b,{num:n(o).product_id,named:n(o).name},null,8,["num","named"])])]),e("div",i_,[e("div",e_,"商品單價:  "+f(_.price()),1),e("div",o_,"購買數量:  "+f(n(t).quantity),1),e("div",n_,[g("單品總價:   "),e("div",{class:S(["d-ib",{"txt-money":!n(s).comput_num_x_price(n(t))}])}," HKD "+f(n(N)(n(s).comput_num_x_price(n(t)))),3)])]),e("div",a_,[e("div",__,[r(h,{bk:!0,onClick:l[0]||(l[0]=M=>_.switchMod(!1)),class:S([{"btn-pri":!n(t).is_ratio},"px py br br-r-0 ani-scaie-aii"])},{default:m(()=>[g("單品減價")]),_:1},8,["class"]),r(h,{bk:!0,onClick:l[1]||(l[1]=M=>_.switchMod(!0)),class:S([{"btn-pri":n(t).is_ratio},"px py br br-i-0 ani-scaie-aii"])},{default:m(()=>[g("單品折扣")]),_:1},8,["class"])])]),n(t).is_ratio?(c(),u("div",c_,[r_,r(v,{tit:"折扣率（0 - 1 之間的數字）",err:n(a).discount},{default:m(()=>[L(e("input",{type:"number",onBlur:l[2]||(l[2]=M=>_.vfy()),"onUpdate:modelValue":l[3]||(l[3]=M=>n(t).discount=M),placeholder:"請輸入要打折的折扣數值"},null,544),[[ts,n(t).discount]])]),_:1},8,["err"])])):(c(),u("div",d_,[p_,r(v,{tit:"減價金額（正數）",err:n(a).discount},{default:m(()=>[L(e("input",{type:"number","onUpdate:modelValue":l[4]||(l[4]=M=>n(t).discount=M),placeholder:"請輸入要減去的價格"},null,512),[[ts,n(t).discount]])]),_:1},8,["err"])])),e("div",u_,[l_,e("div",m_,[e("div",f_,[e("p",null,f(n(s).comput_num_x_price(n(t)))+"  ",1),e("p",null,f(n(t).is_ratio?"x":"-")+"  ",1),e("p",null,f(n(t).discount)+"  ",1),h_,e("p",null,f(n(s).comput_one_totai(n(t))),1)])])]),v_,r(y,{aii:n(d),onClick:_.submit,class:"w-100",tit:"確定"},null,8,["aii","onClick"])]),_:1})]),_:1})}}}),$_={class:"pi"},y_={class:"fx-i"},g_={key:0},w_={class:"px"},k_={key:1,class:"pi fx-i"},x_=e("div",{class:"pr"},"(無會員)",-1),C_={key:0,class:"pt"},D_={class:"pt-s"},T_={class:"d-ib fw-900"},A_={key:1,class:"pt"},P_=e("p",null,"會員等級:  (無會員)",-1),q_=e("p",{class:"pt-s"},"等級折扣:  ",-1),S_=[P_,q_],R_=$({__name:"DcMemberDiscount",setup(i){const s=T(),{member:t,ratio_of_member:o}=A(s),a={findMember:()=>w(()=>{B(0),k().switch_r_tab(1)})};return(_,d)=>{const p=Ft,l=j;return c(),u("div",$_,[e("div",y_,[r(p,{class:"h2",ciass_i:"h2",icon:"user-circie"}),n(o).iive?(c(),u("div",g_,[e("div",w_,f(n(t).name),1)])):(c(),u("div",k_,[x_,r(l,{bk:!0,onClick:d[0]||(d[0]=b=>a.findMember()),class:"px py-s btn-weak br-s"},{default:m(()=>[g("查找會員")]),_:1})]))]),n(o).iive?(c(),u("div",C_,[e("p",null,"會員等級:  "+f(n(rs).ievei(n(t))),1),e("p",D_,[g("等級折扣:  "),e("div",T_,f(n(rs).discount(n(t))),1)])])):(c(),u("div",A_,S_))])}}}),B_={class:"py-x3"},M_=e("h6",null,"會員優惠",-1),I_={class:"pt-x2 pi-row"},O_={class:"pt pb-x3"},z_={class:"fx-s"},E_=e("span",{class:"pr"},"全單折扣",-1),N_=["disabled"],K_={class:"pt pb-x3"},H_={class:"fx-s"},V_=e("span",{class:"pr"},"全單減價",-1),U_=["disabled"],j_={class:"py-x3 h6 fw-600"},G_=e("div",{class:"d-ib sus"},"優惠金額",-1),J_={class:"pt-row"},W_=e("div",{class:"d-ib"},"統計金額",-1),F_={class:"d-ib txt-money"},X_=e("div",{class:"py-x2"},null,-1),L_=$({__name:"DeskCenterAiiDiscountPan",setup(i){const s=T(),{choiseOne:t,ratio_of_aii:o,discount_of_aii:a}=A(s),_=E(()=>t.value.__product?t.value.__product:{}),d=D(Ps({discount:""})),p={price:()=>{const b=_.value;return b.new_selling_price?b.new_selling_price:0},submit:()=>ls(l,async()=>{B(0)}),vfy:()=>w(()=>{o.value.is_ratio&&(o.value.discount=lt.vfy_ratio(o.value.discount))})},l=D({ioading:!1,msg:""});return(b,h)=>{const v=j,y=Is,P=Y,q=os,M=Ms;return c(),C(M,{idx:202},{default:m(()=>[r(q,{tit:"全單優惠"},{default:m(()=>[e("div",B_,[M_,e("div",I_,[r(R_)])]),e("div",O_,[e("h6",z_,[E_,n(o).iive?(c(),C(v,{key:1,class:"py px br txt-err",bk:!0,ciass:"fs-s",onClick:h[1]||(h[1]=I=>n(o).iive=!1)},{default:m(()=>[g(" 撤銷 ")]),_:1})):(c(),C(v,{key:0,class:"py px br txt-succ",ciass:"fs-s",bk:!0,onClick:h[0]||(h[0]=I=>n(o).iive=!0)},{default:m(()=>[g(" 啟用 ")]),_:1}))]),r(y,{tit:"折扣率（0 - 1 之間的數字）",err:n(d).discount,class:S({"o-input-err":!n(o).iive})},{default:m(()=>[L(e("input",{type:"number",class:"fw-900",onBlur:h[2]||(h[2]=I=>p.vfy()),disabled:!n(o).iive,"onUpdate:modelValue":h[3]||(h[3]=I=>n(o).discount=I),placeholder:"請輸入要打折的折扣數值"},null,40,N_),[[ts,n(o).discount]])]),_:1},8,["err","class"])]),e("div",K_,[e("h6",H_,[V_,n(a).iive?(c(),C(v,{key:1,class:"py px br txt-err",bk:!0,ciass:"fs-s",onClick:h[5]||(h[5]=I=>n(a).iive=!1)},{default:m(()=>[g(" 撤銷 ")]),_:1})):(c(),C(v,{key:0,class:"py px br sub",bk:!0,ciass:"fs-s",onClick:h[4]||(h[4]=I=>n(a).iive=!0)},{default:m(()=>[g(" 啟用 ")]),_:1}))]),r(y,{tit:"減價金額（正數）",err:n(d).discount,class:S({"o-input-err":!n(a).iive})},{default:m(()=>[L(e("input",{type:"number",class:"fw-900",disabled:!n(a).iive,"onUpdate:modelValue":h[6]||(h[6]=I=>n(a).discount=I),placeholder:"請輸入要減去的價格"},null,8,U_),[[ts,n(a).discount]])]),_:1},8,["err","class"])]),e("div",j_,[e("div",null,[G_,g(":  HKD "),r(at)]),e("div",J_,[W_,e("div",F_,[g(":  HKD "),r(ns)])])]),X_,r(P,{aii:n(l),onClick:p.submit,class:"w-100",tit:"確定"},null,8,["aii","onClick"])]),_:1})]),_:1})}}}),Q_={class:"tabie tabie-def"},Y_={class:"td"},Z_={class:"w-100"},sc=$({__name:"CoSpriProfiTotaiTabie",props:{totai:{}},setup(i){const s=D({trs:[]});return V(()=>new Promise(t=>{s.trs.length=0,qs([{ciass:"w-100",tit:"總毛利率"}],o=>s.trs.push(o),32),t(0)})),(t,o)=>{const a=Os;return c(),u("div",Q_,[r(a,{aii:n(s)},null,8,["aii"]),e("div",Y_,[e("div",Z_,"HKD  "+f(n(N)(t.totai)),1)])])}}}),tc={class:"tabie tabie-def"},ic={class:"td"},ec={class:"w-100"},oc=$({__name:"CoSpriTotaiTabie",props:{totai:{}},setup(i){const s=D({trs:[]});return V(()=>new Promise(t=>{s.trs.length=0,qs([{ciass:"w-100",tit:"統計金額"}],o=>s.trs.push(o),32),t(0)})),(t,o)=>{const a=Os;return c(),u("div",tc,[r(a,{aii:n(s)},null,8,["aii"]),e("div",ic,[e("div",ec,"HKD "+f(n(N)(t.totai)),1)])])}}}),nc={class:"tabie tabie-def"},ac={key:0},_c={class:"w-24"},cc={class:"fx-1"},rc={key:1,class:"td"},dc=e("div",{class:"fx-1"},"(未有任何條目)",-1),pc=[dc],uc=$({__name:"CoSpriTypeTabie",props:{many:{}},setup(i){const s=D({trs:[]});return V(()=>new Promise(t=>{s.trs.length=0,qs([{ciass:"w-100",tit:"優惠類別"}],o=>s.trs.push(o),32),t(0)})),(t,o)=>{const a=Os;return c(),u("div",nc,[r(a,{aii:n(s)},null,8,["aii"]),t.many&&t.many.length>0?(c(),u("div",ac,[(c(!0),u(K,null,H(t.many,(_,d)=>(c(),u("div",{class:"td",key:d},[e("div",_c,f(_.type),1),e("div",cc,"-"+f(n(N)(_.discount_deduction))+" HKD",1)]))),128))])):(c(),u("div",rc,pc))])}}}),lc={class:"w-20"},mc={class:"w-15"},fc={class:"w-12"},hc={class:"w-11"},vc={class:"w-11"},bc={class:"w-9"},$c={class:"w-13"},yc={class:"fx-1 fx-r"},gc=$({__name:"CoSpriProdsTabie",props:{aii:{},many:{}},setup(i){const s=i,t=T();return V(()=>us(s.aii,[{ciass:"w-20",tit:"商品名稱"},{ciass:"w-15",tit:"樣式"},{ciass:"w-12",tit:"附加"},{ciass:"w-11",tit:"單價"},{ciass:"w-11",tit:"平均價"},{ciass:"w-9",tit:"數量"},{ciass:"w-13",tit:"統計金額"},{ciass:"fx-1 fx-r",tit:"毛利率"}])),(o,a)=>{const _=ds;return c(),C(_,{aii:o.aii,mini:!0},{default:m(()=>[(c(!0),u(K,null,H(o.many,(d,p)=>(c(),u("div",{class:"td",key:p},[e("div",lc,f(n(z).product_name(d)),1),e("div",mc,f(n(z).variation(d)),1),e("div",fc,"-"+f(n(N)(n(t).comput_one_discount(d))),1),e("div",hc,f(n(z).product_price(d)),1),e("div",vc,f(n(z).proudct_price_restock(d)),1),e("div",bc,f(d.quantity),1),e("div",$c,f(n(N)(n(t).comput_num_x_price(d))),1),e("div",yc,f(n(N)(n(t).comput_one_profit(d))),1)]))),128))]),_:1},8,["aii"])}}}),wc={class:"pt-row"},kc=e("div",{class:"py-row"},null,-1),xc=e("div",{class:"py-row"},null,-1),Cc=e("div",{class:"py-row"},null,-1),Dc=e("div",{class:"py-row"},null,-1),Tc={class:"fx-c py-x3"},Ac=$({__name:"DeskCenterProfitratePan",setup(i){const s=T(),{carts:t}=A(s),o=D({discounts:[],totai_price:0}),a=E((p=0)=>{const l=s.comput_aii_order_discount(s.comput_carts_totai());let b=t.value;return b&&b.length>0&&b.map(h=>{p=x.floatAdd(s.comput_one_profit(h),p)}),x.floatAdd(p,-l)}),_={init:()=>w(()=>{const p=s.buiid_discount();o.discounts=p||[];const l=s.computed_finai_totai();o.totai_price=l})};Q(t,_.init),Zs(_.init);const d=D({many:[{}],chooseAii:!1,chooses:[],many_origin:[],ioading:!1,msg:"",trs:[],pager:{},condition:{}});return(p,l)=>{const b=gc,h=uc,v=oc,y=sc,P=Y,q=os,M=Ms;return c(),C(M,{idx:207,big:!0},{default:m(()=>[r(q,{tit:"統計毛利率"},{default:m(()=>[e("div",wc,[r(b,{many:n(t),aii:n(d)},null,8,["many","aii"]),kc,r(h,{many:n(o).discounts},null,8,["many"]),xc,r(v,{totai:n(o).totai_price},null,8,["totai"]),Cc,r(y,{totai:n(a)},null,8,["totai"])]),Dc,e("div",Tc,[r(P,{onClick:l[0]||(l[0]=I=>n(B)(0)),class:"w-382 w-50-p",tit:"確定"})])]),_:1})]),_:1})}}}),Pc=$({__name:"DeskPans",setup(i){return(s,t)=>(c(),u("div",null,[r(Oa),r(Za),r(b_),r(L_),r(Ac)]))}}),qc=e("div",{class:"py-x3"},[e("br"),e("br"),e("br"),e("br")],-1),Sc={class:"fx-s fx-t w-100 ps-r"},Rc={class:"w-82-p w-86 w-88-x"},Bc=$({__name:"desk",setup(i){const{checking:s,ioading:t}=A(k()),{carts:o}=A(T());return V(()=>w(()=>{B(0),U(0)})),(a,_)=>{const d=mt,p=Js,l=ft;return c(),u(K,null,[r(l,{compact:!0,mitting:n(s),ioading:n(t)},{ieft:m(()=>[r(d,{tit:"結帳清單 ("+n(o).length+")"},{default:m(()=>[r(Ci),qc]),_:1},8,["tit"])]),ieft_bottom:m(()=>[r(Ki)]),right:m(()=>[e("div",Sc,[r(p,{class:"w-18-p w-14 w-12-x px py"},{default:m(()=>[r($a)]),_:1}),e("div",Rc,[r(_a,{class:"h-iayout-s"})])])]),_:1},8,["mitting","ioading"]),g(),r(Pc)],64)}}});typeof Ns=="function"&&Ns(Bc);export{Bc as default};
