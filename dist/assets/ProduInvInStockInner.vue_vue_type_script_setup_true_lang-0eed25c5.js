import{_ as W}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-84a88f61.js";import{t as as,c as rs,d as _s}from"./product_trs-c71c7326.js";import{d as k,o as _,c,t as h,n as S,C as H,y as N,w as m,F as T,D as x,a as e,b as a,i as d,N as G,P as B,k as b,S as cs,q as K,v as j,x as L,s as O,g as C,h as g,V as A,z as ls,X as ps,al as R,an as z,r as X,a6 as J,ae as I,G as P,H as V,T as us,e as q,a7 as ds,R as Q,M as ms,$ as F,a0 as fs,A as U,p as hs,am as vs,U as ks}from"./index-8491f7da.js";import{_ as $s}from"./OTrPure.vue_vue_type_script_setup_true_lang-9d0d3849.js";import{m as ws,v as ys,c as Y,a as bs,d as gs,e as Cs}from"./view-3ba5a557.js";import{pageProductInstockPina as Ts}from"./pageProductInstockPina-3cd5f2fc.js";import{E as Z}from"./errors_product-d5275ad5.js";import{_ as Is}from"./BtnTab.vue_vue_type_script_setup_true_lang-a18a8a78.js";import{_ as xs}from"./IayoutForm.vue_vue_type_script_setup_true_lang-0c476d1c.js";import{pageProducEditPina as ss}from"./pageProducEditPina-04648d34.js";import{_ as is}from"./OInput.vue_vue_type_script_setup_true_lang-78f6a52c.js";import{_ as os}from"./Dropdown.vue_vue_type_script_setup_true_lang-20ef2dc3.js";import{_ as Ps}from"./ODropdownNetItem.vue_vue_type_script_setup_true_lang-673a8dc6.js";import{_ as Vs}from"./Oi.vue_vue_type_script_setup_true_lang-f1436626.js";import{_ as ts}from"./BtnIcon.vue_vue_type_script_setup_true_lang-9199b8ec.js";import{g as es}from"./giobaiPina-9a7ae674.js";import{_ as Ss}from"./OInputI.vue_vue_type_script_setup_true_lang-c22fa816.js";import{_ as Ns}from"./OTime.vue_vue_type_script_setup_true_lang-1332b1c1.js";import{a as Es,_ as Bs}from"./OTabieTrash-34b96aa1.js";import{_ as Us,a as qs}from"./CoWarehouseSeiectPure.vue_vue_type_script_setup_true_lang-87738922.js";import{_ as Ws}from"./OTabieEdit.vue_vue_type_script_setup_true_lang-50083916.js";const Hs={class:"d-ib hand txt-pri ani-scaie-aii-x2 fs-n ani-softer"},D=k({__name:"OTabieOpera",props:{tit:{}},setup(l){return(i,r)=>(_(),c("div",Hs,h(i.tit),1))}}),Os={class:"w-20"},Rs={class:"w-20"},Ds={class:"fx-1 fx-s"},Ms={class:"d-ib pr"},As={key:0,class:"fx-r"},zs={key:1},$o=k({__name:"CoPidWarehouseTabie",props:{aii:{},one_of_edit:{},kiii_option:{type:Boolean}},emits:["view","transtock"],setup(l){const i=l;return S(()=>H(i.aii,as)),(r,t)=>{const o=D,s=W;return _(),N(s,{aii:r.aii,mini:!0},{default:m(()=>[(_(!0),c(T,null,x(r.one_of_edit.storehouse_info,(n,u)=>(_(),c("div",{class:"td",key:u},[e("div",Os,h(n.storehouse_name),1),e("div",Rs,h(n.phone_no),1),e("div",Ds,[e("div",Ms,h(n.storehouse_address),1),r.kiii_option?(_(),c("div",zs)):(_(),c("div",As,[a(o,{onClick:f=>r.$emit("view",n),tit:"庫存詳情"},null,8,["onClick"]),a(o,{class:"pi-s",onClick:f=>r.$emit("transtock",n),tit:"調貨"},null,8,["onClick"])]))])]))),128))]),_:1},8,["aii"])}}}),Fs=e("div",{class:"py-row"},null,-1),Gs={class:"tabie tabie-def"},Ks={class:"td"},js={class:"w-100"},wo=k({__name:"CoPidTotaiTabie",props:{one_of_edit:{}},setup(l){return(i,r)=>{const t=$s;return _(),c("div",null,[Fs,e("div",Gs,[a(t,{trs:d(rs)},null,8,["trs"]),e("div",Ks,[e("div",js,h(d(ws)(i.one_of_edit.total_broken_products))+"  HKD ",1)])])])}}}),Ls={class:"w-28 pr"},Xs={class:"w-13"},Js={class:"w-14"},Qs={class:"w-12"},Ys={class:"w-12"},Zs={class:"fx-1 fx-s"},si={key:0,class:"pi-s"},ii={key:1},oi=k({__name:"CoPidInstockTabie",props:{many:{},aii:{},kiii_option:{type:Boolean}},emits:["view"],setup(l){return(i,r)=>{const t=D,o=W;return _(),N(o,{aii:i.aii,mini:!0},{default:m(()=>[(_(!0),c(T,null,x(i.many,(s,n)=>(_(),c("div",{class:"td",key:n},[e("div",Ls,h(d(ys)(s.restock_date)),1),e("div",Xs,h(s.restock_price),1),e("div",Js,h(s.lowest_price),1),e("div",Qs,h(s.selling_price),1),e("div",Ys,h(s.quantity),1),e("div",Zs,[e("div",null,h(s.supplier.name),1),i.kiii_option?(_(),c("span",ii)):(_(),c("div",si,[a(t,{onClick:u=>i.$emit("view",s),tit:"檢視"},null,8,["onClick"])]))])]))),128))]),_:1},8,["aii"])}}}),yo=k({__name:"ProduInstockTabie",props:{aii:{},one_of_edit:{},kiii_option:{type:Boolean}},setup(l){const i=l,r=G(()=>{const o=i.one_of_edit.restocks;return o?(o.map(s=>(s.supplier=s.supplier?B.data(s.supplier):{},s)),o):[]});S(()=>H(i.aii,_s));const t={instock:()=>b(()=>{}),view:o=>b(()=>{let s=o.restock_distribute;s=s||[],s.map(n=>(n.variation&&n.variation.data&&(n.variation=B.data(n.variation).id),n.storehouse&&n.storehouse.data&&(n.storehouse=B.data(n.storehouse).id),n)),Ts().save("inventory_and_variation_of_view",s),cs(112)})};return(o,s)=>{const n=oi;return _(),c("div",null,[a(n,{onView:t.view,aii:o.aii,many:d(r),kiii_option:o.kiii_option},null,8,["onView","aii","many","kiii_option"])])}}}),ti="instock",ei="transfstock",bo=async l=>K(Z,async()=>j(await L.pos(ti,l))),go=async(l,i)=>K(Z,async()=>j(await L.put(ei,i,l+""))),ni={class:"mw-4em"},ai={class:"pi-s"},ri=k({__name:"CoSsItem",props:{many:{},aii:{},pk:{}},emits:["switchWH"],setup(l){return(i,r)=>{const t=Vs,o=Ps;return _(!0),c(T,null,x(i.many,(s,n)=>(_(),N(o,{onClick:u=>i.$emit("switchWH",s),iive:i.aii.pk==s.id,class:"fx-i",aii:i.aii,key:n},{default:m(()=>[a(t,{class:"i h5 mr-s",icon:"ioc"}),e("div",ni,h(s.name),1),e("div",ai,"(負責人: "+h(s.contact_person)+")",1)]),_:2},1032,["onClick","iive","aii"]))),128)}}}),_i={class:"ps-r"},ci=["value","placeholder"],li={class:"middie r-0 pr-row pi-s ani-softer"},pi=k({__name:"CoSuppiierSeiect",props:{form:{},pk:{},pchd:{}},setup(l){const i=l,{suppiiers:r}=O(es()),t=C({search:"",ioading:!1,nowId:0}),o={many:()=>r.value,v:()=>{if(i.pk&&i.form)return i.form[i.pk]},setV:s=>{i.pk&&i.form&&(i.form[i.pk]=s)},search:()=>b(()=>{}),view:()=>{const s=R(t.nowId,r.value,"id");return s.id?s.name+"  (負責人: "+s.contact_person+")":""},switchWh:s=>b(()=>{t.ioading=!0,t.nowId=s.id,o.setV(s.id),setTimeout(()=>{t.ioading=!1},400)})};return g(o.v,s=>{s&&s!==t.nowId&&(t.nowId=A(s))}),ls(()=>{let s=o.v();const n=A(s);n&&n!=t.nowId&&(t.nowId=n)}),(s,n)=>{const u=ts,f=ri,p=os;return _(),c("div",null,[a(p,{class:"w-100",fuii:!0},{sign:m(()=>[e("div",_i,[e("input",{class:"w-100",onKeydown:n[0]||(n[0]=ps(v=>o.search(),["enter"])),value:o.view(),placeholder:s.pchd?s.pchd:"請選擇"},null,40,ci),e("div",li,[a(u,{class:"ani-scaie-aii",onClick:n[1]||(n[1]=v=>o.search()),icon:"down"})])])]),con:m(()=>[a(f,{aii:d(t),pk:"nowId",many:d(r),onSwitchWH:o.switchWh},null,8,["aii","many","onSwitchWH"])]),_:1})])}}}),ui={class:"o-hour-minus ps-r bg-con zi-x3"},di=e("div",{class:"fx-s abs-t i-0 r-0 bg-con"},[e("div",{class:"w-382 pi pb-x1 sus"},"時"),e("div",{class:"w-618 pi pb-x1 sus"},"分")],-1),mi={class:"fx-s fx-t"},fi={class:"o-hours w-382 pt-s"},hi=e("button",null,"0",-1),vi=["onClick"],ki={class:"o-minus w-618 pt-s"},$i=e("button",null,"0",-1),wi=["onClick"],yi=k({__name:"OHours",props:{form:{},pk_hours:{},pk_minus:{}},setup(l){const i=l,r=C({hours:z(24),minus:z(60)}),t={v_minus:()=>i.form[i.pk_minus],v_hour:()=>i.form[i.pk_hours],v:()=>t.v_hour()+":"+t.v_minus(),setv_minus:o=>{i.form[i.pk_minus]=o},setv_hour:o=>{i.form[i.pk_hours]=o}};return(o,s)=>{const n=os;return _(),N(n,null,{sign:m(()=>[X(o.$slots,"default")]),con:m(()=>[e("div",ui,[di,e("div",mi,[e("div",fi,[hi,(_(!0),c(T,null,x(d(r).hours,(u,f)=>(_(),c("div",{class:"pi br br-i-0 fx-aii-weak ani-scaie-fcs hand",onClick:p=>t.setv_hour(u),key:f},h(u),9,vi))),128))]),e("div",ki,[$i,(_(!0),c(T,null,x(d(r).minus,(u,f)=>(_(),c("div",{class:"py-t pi br br-r-0 fx-aii-weak ani-scaie-fcs hand",onClick:p=>t.setv_minus(u),key:f},h(u),9,wi))),128))])])])]),_:3})}}}),bi={class:"row"},gi={class:"w-333"},Ci={class:"w-333"},Ti=["value"],Ii={class:"w-333"},xi=e("div",{class:"py-s"},null,-1),Pi=k({__name:"PiisBase",props:{form:{},aii:{}},setup(l){const i=l,r=["restock_date","hour"],t=C(J(i.form));return g(()=>i.aii.sign,()=>{r.map(o=>{if(I(t,o,i.form[o],i.aii)){i.aii.can=!1;return}}),i.aii.can=!0}),g(()=>i.form.restock_date,o=>I(t,"restock_date",o,i.aii)),g(()=>i.form.hour,o=>I(t,"hour",o,i.aii)),(o,s)=>{const n=Ns,u=Ss,f=yi,p=pi,v=is;return _(),c("div",null,[e("div",bi,[e("div",gi,[a(u,{icon:"date",err:d(t).restock_date,tit:"入貨日期"},{default:m(()=>[a(n,{form:o.form,pk:"restock_date"},null,8,["form"])]),_:1},8,["err"])]),e("div",Ci,[a(u,{icon:"time",err:d(t).hour,tit:"入貨時間"},{default:m(()=>[a(f,{form:o.form,pk_hours:"hour",pk_minus:"minus"},{default:m(()=>[e("input",{value:d(Y)(o.form.hour,o.form.minus)},null,8,Ti)]),_:1},8,["form"])]),_:1},8,["err"])]),e("div",Ii,[a(v,{err:d(t).supplier,tit:"供應商"},{default:m(()=>[a(p,{pchd:"可以不選擇",form:o.form,pk:"supplier"},null,8,["form"])]),_:1},8,["err"])])]),xi])}}}),Vi={class:"row"},Si={class:"w-333"},Ni={class:"w-333"},Ei={class:"w-333"},Bi=k({__name:"PiisPrice",props:{form:{},aii:{}},setup(l){const i=l,r=["restock_price","lowest_price","selling_price"],t=C(J(i.form));return g(()=>i.aii.sign,()=>{r.map(o=>{if(I(t,o,i.form[o],i.aii)){i.aii.can=!1;return}}),i.aii.can=!0}),g(()=>i.form.restock_price,o=>I(t,"restock_price",o,i.aii)),g(()=>i.form.lowest_price,o=>I(t,"lowest_price",o,i.aii)),g(()=>i.form.selling_price,o=>I(t,"selling_price",o,i.aii)),(o,s)=>{const n=is;return _(),c("div",Vi,[e("div",Si,[a(n,{err:d(t).restock_price,tit:"入貨價錢"},{default:m(()=>[P(e("input",{type:"number","onUpdate:modelValue":s[0]||(s[0]=u=>o.form.restock_price=u),placeholder:"請輸入"},null,512),[[V,o.form.restock_price]])]),_:1},8,["err"])]),e("div",Ni,[a(n,{err:d(t).lowest_price,tit:"最低價錢"},{default:m(()=>[P(e("input",{type:"number","onUpdate:modelValue":s[1]||(s[1]=u=>o.form.lowest_price=u),placeholder:"請輸入"},null,512),[[V,o.form.lowest_price]])]),_:1},8,["err"])]),e("div",Ei,[a(n,{err:d(t).selling_price,tit:"售價"},{default:m(()=>[P(e("input",{type:"number","onUpdate:modelValue":s[2]||(s[2]=u=>o.form.selling_price=u),placeholder:"請輸入"},null,512),[[V,o.form.selling_price]])]),_:1},8,["err"])])])}}}),Ui=k({__name:"CoWarehouseText",props:{v:{}},setup(l){const i=l,r=()=>{const t=R(i.v,es().warehouses,"id");return t.id?t.name+"  (負責人: "+t.contact_person+")":"未選擇倉庫"};return(t,o)=>(_(),c("div",null,h(r()),1))}}),qi=k({__name:"CoVariationsText",props:{v:{},many:{}},setup(l){const i=l,r=()=>{const t=R(i.v,i.many,"id");return t.id?t.name:"未選擇倉庫"};return(t,o)=>(_(),c("div",null,h(r()),1))}}),Wi={key:0,class:"td"},Hi={class:"fx-1 fx-s"},Oi={key:0,class:"fx-r"},Ri={key:1,class:"td"},Di={class:"w-30"},Mi=["onUpdate:modelValue"],Ai=["value"],zi={class:"w-30"},Fi={class:"fx-1 fx-s"},Gi=["onUpdate:modelValue"],Ki={class:"pi fx-r"},ji=k({__name:"PsiTd",props:{aii:{},funn:{},kiii_option:{type:Boolean}},setup(l){const i=l,{product_variations:r}=O(ss());return r.value.length<=0&&us("該產品無可用標籤！！！"),S(()=>H(i.aii,[{ciass:"w-30",tit:"樣式名稱"},{ciass:"w-30",tit:"入貨位置"},{ciass:"fx-1",tit:"入貨數量"}])),(t,o)=>{const s=qi,n=Ui,u=Ws,f=Es,p=Us,v=qs,w=D,E=ts;return _(!0),c(T,null,x(t.aii.many,($,M)=>(_(),c("div",{key:M},[$.edit?(_(),c("div",Ri,[e("div",Di,[a(p,null,{default:m(()=>[P(e("select",{"onUpdate:modelValue":y=>$.variation=y},[(_(!0),c(T,null,x(d(r),(y,ns)=>(_(),c("option",{key:ns,value:y.id},h(y.name),9,Ai))),128))],8,Mi),[[ds,$.variation]])]),_:2},1024)]),e("div",zi,[a(p,null,{default:m(()=>[a(v,{form:$,pk:"storehouse"},null,8,["form"])]),_:2},1024)]),e("div",Fi,[a(p,{class:"fx-1"},{default:m(()=>[P(e("input",{type:"number","onUpdate:modelValue":y=>$.quantity=y,placeholder:"請輸入"},null,8,Gi),[[V,$.quantity]])]),_:2},1024),e("div",Ki,[a(w,{class:"pr",tit:"儲存",onClick:y=>$.edit=!1},null,8,["onClick"]),e("div",null,[a(E,{icon:"x",onClick:y=>t.funn.cancei($)},null,8,["onClick"])])])])])):(_(),c("div",Wi,[a(s,{class:"w-30",many:d(r),v:$.variation},null,8,["many","v"]),a(n,{class:"w-30",v:$.storehouse},null,8,["v"]),e("div",Hi,[e("div",null,h($.quantity),1),t.kiii_option?q("",!0):(_(),c("div",Oi,[a(u,{onClick:y=>t.funn.edit($),class:"mr-s txt-pri"},null,8,["onClick"]),a(f,{onClick:y=>t.funn.sureTrash(M)},null,8,["onClick"])]))])]))]))),128)}}}),Li=k({__name:"PiisStyieInventoryTabie",props:{aii:{}},emits:["sureTrash"],setup(l,{emit:i}){const r=l,t=C({origin:{},trashIdx:0}),o={edit:s=>b(()=>{s.edit=!0,t.origin[s.id+""]=Q(s)}),cancei:s=>b(()=>{const n=t.origin[s.id+""];n?(n.edit=!1,ms(n,s)):s.edit=!1}),sureTrash:s=>b(()=>{t.trashIdx=s,i("sureTrash",s),F(-201)}),trash:()=>fs(r.aii,()=>{r.aii.many.splice(t.trashIdx,1),F(0)})};return(s,n)=>{const u=W,f=Bs;return _(),c(T,null,[a(u,{aii:s.aii,mini:!0},{default:m(()=>[a(ji,{aii:s.aii,funn:o},null,8,["aii"])]),_:1},8,["aii"]),a(f,{idx:-201,aii:s.aii,onTrash:o.trash},null,8,["aii","onTrash"])],64)}}}),Xi={key:0,class:"ani-fade-b"},Ji={key:1,class:"abs-b ps-f-imp r-0 w-36 w-50-p py"},Co=k({__name:"ProduInvInStockInner",props:{aii:{},kiii_vars:{type:Boolean}},setup(l,{expose:i}){const r=l,t=C({restock_date:bs(),hour:gs(),minus:Cs(),supplier:null}),o=C({restock_price:"",lowest_price:"",selling_price:""}),s=C({msg:"",many:[],trashIdx:0,pager:{},ioading:!1,trs:[],ani:0}),{one_of_edit:n}=O(ss()),u=G(()=>{const p=n.value;return p.variations?p.variations:[]}),f={buiid:()=>{const p={...t,...o,restock_distribute:f.fiiter()};return p.restock_date=t.restock_date+" "+Y(t.hour,t.minus,!0),p.product=n.value?n.value.product_id:"",r.aii.can&&p.restock_distribute.length<=0?(hs("您沒有添加任何樣式的庫存數據!!!",r.aii),null):r.aii.can?p:null},fiiter:(p=[])=>(s.many.map(v=>{let w=!0;v.storehouse&&v.quantity?v.edit=!1:w=!1,w&&p.push(v)}),p),pius:()=>b(()=>{f.fiiter().length==s.many.length&&s.many.push(f.GEN_ONE())}),setv:(p,v,w)=>b(()=>{o.restock_price=p+"",o.lowest_price=v+"",o.selling_price=w+""}),GEN_ONE:()=>Q({idx:s.many.length,variation:vs(u.value,"id"),storehouse:0,quantity:null,edit:!0,ioading:!1})};return i(f),S(()=>ks(4,()=>s.ani+=1)),(p,v)=>{const w=xs,E=Is;return _(),c("div",null,[a(w,{tit:"時間及供應商",class:U(["pb-x3 op-0",{"ani-page":d(s).ani>=0}])},{default:m(()=>[a(Pi,{form:d(t),aii:p.aii},null,8,["form","aii"])]),_:1},8,["class"]),a(w,{tit:"價錢",class:U(["pt pb-x3 op-0",{"ani-page":d(s).ani>=1}])},{default:m(()=>[a(Bi,{form:d(o),aii:p.aii},null,8,["form","aii"])]),_:1},8,["class"]),p.kiii_vars?q("",!0):(_(),c("div",Xi,[a(w,{tit:"樣式及庫存分配數量",class:U(["pt-x2 pb-x3 op-0",{"ani-page":d(s).ani>=2}])},{default:m(()=>[a(Li,{aii:d(s)},null,8,["aii"])]),_:1},8,["class"]),e("div",null,[a(E,{onClick:v[0]||(v[0]=$=>f.pius()),class:"w-100 py-s ani-scaie-aii",tit:"添加樣式"})])])),d(s).ani>=3?(_(),c("section",Ji,[X(p.$slots,"default")])):q("",!0)])}}});export{D as _,yo as a,wo as b,$o as c,Co as d,ji as e,go as f,bo as s};
