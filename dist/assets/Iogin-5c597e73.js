import{_ as I}from"./OBtnSave.vue_vue_type_script_setup_true_lang-6cefa92d.js";import{I as $}from"./IOGO-af9dcf98.js";import{_ as C}from"./OInputI.vue_vue_type_script_setup_true_lang-9445eb1d.js";import{d as w,g as f,a5 as T,h as l,o as x,c as b,a as n,b as p,w as _,G as d,H as h,i as r,ad as u,q as U,aD as O,aE as R,m as k,K as y,u as V,n as j,k as v,p as A,M as B,aF as E}from"./index-5586e4a0.js";import{a as N,c as S}from"./verify-18da9a0d.js";import{b as g}from"./route-block-83d24a4e.js";import"./OIoadDot.vue_vue_type_script_setup_true_lang-2e0769a3.js";import"./OIoadCir.vue_vue_type_script_setup_true_lang-200c52e2.js";import"./MBtn.vue_vue_type_script_setup_true_lang-f6bc6810.js";import"./Oi.vue_vue_type_script_setup_true_lang-727c28f2.js";import"./ChevronRightIcon-34e0f660.js";import"./XMarkIcon-82ec217a.js";const D={class:"py"},F=n("div",{class:"py"},null,-1),G=w({__name:"ioginForm",props:{form:{},aii:{}},setup(i){const s=i,o=["name","pass"],t=f(T(s.form));return l(()=>s.aii.sign,()=>{o.map(a=>{if(u(t,a,s.form[a],s.aii)){s.aii.can=!1;return}}),s.aii.can=!0}),l(()=>s.form.name,a=>u(t,"name",a,s.aii,()=>!N(a))),l(()=>s.form.pass,a=>u(t,"pass",a,s.aii,()=>!S(a,200))),(a,e)=>{const c=C;return x(),b("div",null,[n("div",D,[p(c,{icon:"email",err:r(t).name},{default:_(()=>[d(n("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=m=>a.form.name=m),placeholder:"登錄郵箱"},null,512),[[h,a.form.name]])]),_:1},8,["err"]),F,p(c,{icon:"lock",err:r(t).pass},{default:_(()=>[d(n("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=m=>a.form.pass=m),placeholder:"登錄密碼"},null,512),[[h,a.form.pass]])]),_:1},8,["err"])])])}}}),H={"":"網絡連結錯誤！！！","Invalid identifier or password":"帳戶或密碼錯誤！！！"},L=async(i,s)=>U(H,()=>O.post(R+"/auth/local",{identifier:i,password:s})),M=async i=>{if(i&&!k(i)){let s={};switch(i=i,i.status){case 301:break;default:s=i.data;break}s.jwt&&y().iogin(s.jwt,s.user)}return i},P={class:"px-x3 w-100"},q={class:"fx-c"},K={class:"w-24"},z=["src"],J=n("h3",{class:"pb-x2 pt-x1 us-n"},"登錄",-1),Q=n("div",{class:"py-x1 us-n"},[n("p",{class:"ttd hand tit-hv ts ani-scaie-hv d-ib"},"註冊")],-1),W={class:"pt ani-scaie"},X=w({__name:"Iogin",setup(i){const s=V(),o=f({ioading:!1,msg:"",can:!1,sign:0}),t=f({name:"",pass:""}),a={submit:()=>v(async()=>{if(!o.ioading){o.ioading=!0;const e=await M(await L(t.name,t.pass));k(e)?A(e,o):await a.success()}}),init:()=>v(()=>{{const e=E.admin;B(e,t)}}),success:async()=>{localStorage.setItem("handshake_auth_name",t.name),await y().userinfo()&&s.push("/"),setTimeout(()=>o.ioading=!1,100)}};return j(a.init),(e,c)=>{const m=I;return x(),b("div",P,[n("div",q,[n("div",K,[n("img",{class:"w-100 ani-scaie-hv us-n",src:r($)},null,8,z)])]),J,p(G,{aii:r(o),form:r(t)},null,8,["aii","form"]),Q,n("div",W,[p(m,{class:"w-100 ani-scaie-aii",aii:r(o),tit:"登錄",onClick:c[0]||(c[0]=Y=>a.submit())},null,8,["aii"])])])}}});typeof g=="function"&&g(X);export{X as default};
