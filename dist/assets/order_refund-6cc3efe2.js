import{_ as H,a as K}from"./ModInner.vue_vue_type_script_setup_true_lang-ff4abfed.js";import{_ as E}from"./MBtn.vue_vue_type_script_setup_true_lang-ec77d985.js";import{_ as M}from"./OIoadCir.vue_vue_type_script_setup_true_lang-6e1141ce.js";import{d as w,o as d,c as b,w as _,a as n,b as s,t as m,e as p,f as R,r as k,g as C,u,h as L,n as g,s as N,i as T,j as B,k as G,F as V,l as J,v as Q,m as W,p as X,q as O,$ as Y}from"./index-0966950c.js";import{_ as Z}from"./scroiiy-8c64f1f8.js";import{_ as ss}from"./OBtn.vue_vue_type_script_setup_true_lang-a305392e.js";import{_ as os}from"./CoWarehouseSeiectPure.vue_vue_type_script_setup_true_lang-bd00b42e.js";import{_ as ts}from"./OBtnBack.vue_vue_type_script_setup_true_lang-55f80801.js";import{_ as A}from"./Itemdash.vue_vue_type_script_setup_true_lang-98195b51.js";import{v as $}from"./vai_order-6e6c470c.js";import{n as is}from"./conn-369e3065.js";import{a as es,s as ns}from"./net-tooi-bf75ccf4.js";import{E as as}from"./errors_user-be6d0865.js";import{f as q,i as rs,m as x,s as _s}from"./credit-00db13f3.js";import{i as cs}from"./judge-13dfac2e.js";import{v as ds,m as ms}from"./view-8e3be13d.js";import{_ as ls}from"./BtnIcon.vue_vue_type_script_setup_true_lang-7b7446f5.js";import{_ as us}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-fed73808.js";import{_ as ps}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-ac8b87bc.js";import{_ as fs}from"./Oi.vue_vue_type_script_setup_true_lang-14d130be.js";import{_ as hs}from"./OCheckOne.vue_vue_type_script_setup_true_lang-7882ce2e.js";import{p as D}from"./pageOrderPina-0553b9fe.js";import{b as S}from"./route-block-83d24a4e.js";import"./giobaiPina-f1245c69.js";import"./serv_suppiier_iist-dd478df5.js";import"./serv_warehouse_iist-0aa7e148.js";import"./iodash-d5f9a50e.js";import"./dayjs.min-668a802a.js";import"./OTabieIoading.vue_vue_type_script_setup_true_lang-4b74b130.js";import"./OIoadDot.vue_vue_type_script_setup_true_lang-c1dafded.js";import"./OTr.vue_vue_type_script_setup_true_lang-a1d279fb.js";import"./TrangieGroup.vue_vue_type_script_setup_true_lang-12150f09.js";import"./XMarkIcon-838afdc9.js";const vs={class:"pt-x3 fx-c"},ys={key:0},$s={key:1},ws={key:0},ks={key:1},gs=w({__name:"OModSure",props:{idx:{},aii:{},msg:{}},emits:["sure"],setup(f){return(o,e)=>{const t=M,i=E,c=H,r=K;return d(),b(r,{class:"mod-t",idx:o.idx?o.idx:100},{default:_(()=>[n(c,{tit:"提示"},{default:_(()=>[s("p",null,m(o.msg?o.msg:"你確定嗎？"),1),s("div",vs,[n(i,{class:"py-s mw-618 px-x2 btn-err-weak br",onClick:e[0]||(e[0]=l=>o.$emit("sure"))},{default:_(()=>[o.aii.ioading?(d(),p("div",ys,[n(t,{styie:"pri"})])):(d(),p("div",$s,[o.aii.msg?(d(),p("span",ks,m(o.aii.msg),1)):(d(),p("span",ws," 確定 "))]))]),_:1})])]),_:1})]),_:1},8,["idx"])}}}),bs={class:"iayout-pan-two bg-con h-iayout ps-r"},xs={class:"fx-s fx-t ani-softer"},Cs={class:"pi-row pr-s"},qs=s("div",{class:"py-row"},null,-1),Rs={key:0,class:"pb"},As=s("div",{class:"py-x3"},null,-1),Os=s("div",{class:"w-1"},null,-1),Ss=s("div",{class:"py-row"},null,-1),Es={key:0,class:"pb"},Ms=s("div",{class:"py-x3"},null,-1),Ns={class:"iayout-pan-two-bottom fx-s fx-b py-row bg-con"},Ts={class:"w-32 w-37-p pi-row pr-s"},Bs=s("div",{class:"w-1"},null,-1),Vs={class:"w-67 w-62-p"},Ds=w({__name:"IayoutPanTwo",props:{ciass:{},tit:{}},setup(f){return(o,e)=>{const t=Z;return d(),p("div",bs,[s("div",xs,[n(t,{class:"w-32 w-37-p ps-r iayout-pan-scroii h-iayout-max"},{default:_(()=>[s("div",Cs,[qs,o.tit?(d(),p("h3",Rs,m(o.tit),1)):R("",!0),k(o.$slots,"ieft"),As])]),_:3}),Os,n(t,{class:"w-67 w-62-p h-iayout-max"},{default:_(()=>[s("section",null,[Ss,o.tit?(d(),p("h3",Es," ")):R("",!0),k(o.$slots,"right"),Ms])]),_:3})]),s("div",Ns,[s("div",Ts,[k(o.$slots,"bottom_ieft")]),Bs,s("aside",Vs,[k(o.$slots,"bottom_right")])]),k(o.$slots,"extra")])}}}),Is="refund",js=async(f,o)=>es(as,async()=>ns(await is.put(Is,f,o+""))),zs={key:0},Fs={key:1,class:"__checkbox_ioading"},Ps=w({__name:"OCheckAii",props:{form:{},pk:{},minus:{}},emits:["resuit"],setup(f,{emit:o}){const e=f,t=C({ioading:!1}),i=()=>q(()=>{t.ioading=!0,e.form[e.pk]=!e.form[e.pk],o("resuit",e.form[e.pk]),setTimeout(()=>t.ioading=!1,e.minus?e.minus:800)});return(c,r)=>{const l=ls,h=M;return u(t).ioading?(d(),p("div",Fs,[s("div",null,[n(h)])])):(d(),p("div",zs,[c.form[c.pk]?(d(),b(l,{key:0,onClick:i,class:"h6 ani-scaie-aii",ciass_i:"h4",icon:"check-circie"})):(d(),b(l,{key:1,onClick:i,class:"h6 __checkbox_empty ani-scaie-aii",ciass_i:"h3",icon:"stop"}))]))}}}),Us={class:"fx-c"},Hs=w({__name:"ONumberMnagerSmaii",props:{form:{},pk:{},err:{type:Boolean},max:{},ciass_num:{}},setup(f){const o=f,e=()=>o.form[o.pk],t={setv:i=>{o.form[o.pk]=i},min:()=>{let i=e()-1;i=i<=0?0:i,t.setv(i)},add:()=>{let i=e()+1;o.max!=null&&(i=i>o.max?o.max:i),t.setv(i)},effect:()=>{o.max!=null&&e()>o.max&&t.setv(o.max>0?o.max:0)}};return L(t.effect),(i,c)=>{const r=fs,l=E;return d(),p("div",Us,[n(l,{bk:!0,class:"fx-aii-tab bd-input-x2 py-s px-s br ani-scaie-aii",onClick:c[0]||(c[0]=h=>t.min()),ciass:"fx-c"},{default:_(()=>[n(r,{class:g(["i ani-scaie-hv",{"txt-err":i.err}]),icon:"min"},null,8,["class"])]),_:1}),s("p",{class:g(["px mw-2em ta-c ani-scaie-hv",i.ciass_num])},[s("span",{class:g({"txt-err":i.err})},m(i.form[i.pk]),3)],2),n(l,{bk:!0,class:"fx-aii-tab bd-input-x2 py-s px-s br ani-scaie-aii",onClick:c[1]||(c[1]=h=>t.add()),ciass:"fx-c"},{default:_(()=>[n(r,{class:g(["i ani-scaie-hv",{"txt-err":i.err}]),icon:"pius"},null,8,["class"])]),_:1})])}}}),Ks={class:"w-100 ta-i"},Ls={class:"td fs-s"},Gs={class:"w-29 fx-i fs pi-x2"},Js={class:"mw-2em pr"},Qs={class:"mw-2em pr"},Ws={class:"fx-1"},Xs={class:"w-14"},Ys={class:"w-8"},Zs={class:"w-9"},so={class:"w-11 pr"},oo={class:"w-13 fw-900"},to={class:"w-16 ta-c"},io=w({__name:"OrderRefundIistTabie",props:{aii:{}},setup(f){const o=f,{refund_products:e}=N(D());return T(o.aii.chooses,t=>{e.value.length=0,t.length>0&&o.aii.many.map(i=>{t.map(c=>{i.id==c&&e.value.push(i)})})}),B(()=>rs(o.aii,[{ciass:"w-29 h6",tit:"序號/商品名稱"},{ciass:"w-14 h6",tit:"樣式"},{ciass:"w-8 h6",tit:"折扣"},{ciass:"w-9 h6",tit:"單價"},{ciass:"w-11 h6",tit:"總金額"},{ciass:"w-13 h6",tit:"可退數量"},{ciass:"w-16 h6 fx-c",tit:"退款數量"}])),(t,i)=>{const c=hs,r=Hs,l=ps,h=us;return d(),b(h,{aii:t.aii,mini:!0,pure:!0},{default:_(()=>[(d(!0),p(V,null,G(t.aii.many,(a,v)=>(d(),p("div",{key:v,class:"py-s"},[n(l,{class:g(["ani-scaie-aii py-0",{"bg-con-x2":a.__can_refunded_quantity<=0}])},{default:_(()=>[s("div",Ks,[s("div",Ls,[s("div",Gs,[s("div",Js,[a.__can_refunded_quantity>0?(d(),b(c,{key:0,chooses:t.aii.chooses,id:a.id,totai:t.aii.many.length,onChoosAii:i[0]||(i[0]=y=>t.aii.chooseAii=y)},null,8,["chooses","id","totai"])):R("",!0)]),s("div",Qs,m(v+1),1),s("div",Ws,m(u($).order_product(a).name),1)]),s("div",Xs,m(u($).order_product_variation(a).name),1),s("div",Ys,"- "+m(a.discount_deduction),1),s("div",Zs,m(a.selling_price),1),s("div",so,m(a.total_price),1),s("div",oo,m(a.__can_refunded_quantity),1),s("div",to,[n(r,{ciass_num:"fw-900 txt-money",form:a,pk:"refunded_quantity",max:a.__can_refunded_quantity},null,8,["form","max"])])])])]),_:2},1032,["class"])]))),128))]),_:1},8,["aii"])}}}),eo={class:"w-38 fx-i pb"},no={class:"pi-x2 pr-x1 h6"},ao=s("h6",null,"全選",-1),ro=s("h6",{class:"fx-1 pb"}," 退款產品列表 ",-1),_o=w({__name:"OrderRefundIist",props:{order:{}},setup(f,{expose:o}){const e=C({chooseAii:!1,chooses:[],many_origin:[],pager:{page:1,pageCount:1,pageSize:25,total:1},choose:!1,many:[],ioading:!0,msg:"",trs:[],condition:{}}),t={effect:(i={})=>{const c=i.ordered_product?i.ordered_product:[];c.length>0&&(e.many.length=0,c.map(r=>{r.__can_refunded_quantity=$.can_refund_num(r),r.refunded_quantity=0,e.many.push(r)}),e.ioading=!1)},choosAii:i=>q(()=>{e.chooses.length=0,i&&e.many.map(c=>{e.chooses.push(c.id)})})};return o(t),(i,c)=>{const r=Ps,l=A;return d(),p("div",null,[n(l,{class:"fx-s mb-s"},{default:_(()=>[s("div",eo,[s("div",no,[n(r,{onResuit:t.choosAii,form:u(e),pk:"chooseAii"},null,8,["onResuit","form"])]),ao]),ro]),_:1}),n(io,{aii:u(e)},null,8,["aii"])])}}}),co=s("div",{class:"fw-700"},"訂單編號",-1),mo=s("div",{class:"fw-700"},"掛單時間",-1),lo=s("div",{class:"fw-700"},"訂單狀態",-1),uo=s("div",{class:"fw-700"},"收銀員",-1),po=s("div",{class:"fw-700"},"客戶",-1),fo=s("div",{class:"fw-700"},"支付方式",-1),ho=s("div",{class:"fw-700 pr"},"退款備註",-1),vo={class:"fx-1"},yo=w({__name:"OrderRefundOrderMsg",props:{order:{}},setup(f){return(o,e)=>{const t=A;return d(),p("aside",null,[n(t,{class:"fx-s px mt-s"},{default:_(()=>[co,s("div",null,m(o.order.order_id),1)]),_:1}),n(t,{class:"fx-s px mt-s"},{default:_(()=>[mo,s("div",null,m(u(ds)(o.order.order_date)),1)]),_:1}),n(t,{class:"fx-s px mt-s"},{default:_(()=>[lo,s("div",null,m(u($).status(o.order)),1)]),_:1}),n(t,{class:"fx-s px mt-s"},{default:_(()=>[uo,s("div",null,m(u($).cashier(o.order)),1)]),_:1}),n(t,{class:"fx-s px mt-s"},{default:_(()=>[po,s("div",null,m(u($).member(o.order)),1)]),_:1}),n(t,{class:"fx-s px mt-s"},{default:_(()=>[fo,s("div",null,m(u($).payment(o.order)),1)]),_:1}),n(t,{class:"fx-s px mt-s"},{default:_(()=>[ho,s("div",vo,[J(s("input",{placeholder:"請輸入","onUpdate:modelValue":e[0]||(e[0]=i=>o.order.refunded_remarks=i),class:"ta-r w-100"},null,512),[[Q,o.order.refunded_remarks]])])]),_:1})])}}}),$o={class:"fx-s"},wo={class:"txt-money err d-ib"},ko={class:"fx-s mt"},go=w({__name:"order_refund",setup(f){const o=W(),e=X(),{one_of_refund:t,refund_price:i,refund_products:c}=N(D()),r=C({msg:"",many:[{}],pager:{},ioading:!1}),l=C({refunded_remarks:"",storehouse:0,refunded_info:[]}),h={buiid:(a=[])=>{l.refunded_remarks=t.value.refunded_remarks;const v=c.value;return v.length<=0?(x("請選擇要退款的商品！！！",r),null):(v.map(y=>{y.refunded_quantity>0&&y.__can_refunded_quantity>0&&a.push({refunded_quantity:y.refunded_quantity,product:$.order_product(y).id,variation:$.order_product_variation(y).id})}),a.length<=0?(x("請注意產品的退款數量！！！",r),null):(l.refunded_info=a,l.storehouse?(console.log("退款 =",l),null):(x("請選擇一個退貨倉庫！！！",r),null)))},submit:()=>_s(r,h.buiid,async a=>{a&&Y(100)}),__submit:()=>q(async()=>{r.ioading=!0;let a=await js(l,t.value.id);cs(a)?x(a,r):h.success(a),r.ioading=!1}),success:a=>{console.log("結果 RES =",a),e.back()},init:()=>q(()=>{t.value.id||e.back(),o.value.effect(t.value)})};return T(t,a=>o.value.effect(a)),B(h.init),(a,v)=>{const y=A,I=ts,j=os,z=ss,F=Ds,P=gs;return d(),p(V,null,[n(F,{tit:"退貨 / 退款"},{ieft:_(()=>[n(yo,{order:u(t)},null,8,["order"])]),right:_(()=>[n(_o,{ref_key:"ori",ref:o,order:u(t)},null,8,["order"])]),bottom_ieft:_(()=>[n(y),n(I,{class:"w-100 mt refund"})]),bottom_right:_(()=>[n(y,null,{default:_(()=>[s("div",$o,[s("div",null,[n(j,{form:u(l),pk:"storehouse",tit_def:"-- 請選擇退貨倉庫 --"},null,8,["form"])]),s("h6",null,[O("退款金額:   "),s("p",wo,"HKD "+m(u(ms)(u(i))),1)])])]),_:1}),s("div",ko,[n(z,{aii:u(r),onClick:v[0]||(v[0]=U=>h.submit()),class:"btn-pri fx-1 py refund"},{default:_(()=>[O("退款")]),_:1},8,["aii"])])]),_:1}),n(P,{idx:100,aii:u(r),onSure:v[1]||(v[1]=U=>h.__submit()),msg:"您確定要退款嗎？"},null,8,["aii"])],64)}}});typeof S=="function"&&S(go);export{go as default};
