import{_ as j,a as A,b as E,s as H}from"./OrderRefundOrderMsg.vue_vue_type_script_setup_true_lang-53af6156.js";import{_ as I}from"./scroiiy-4c59c1f7.js";import{d as N,o as l,c as h,a as t,b as r,w as c,t as T,e as w,r as p,f as g,u as K,s as O,g as $,h as k,n as z,i as _,j as G,F as J,$ as L}from"./index-196d4fb0.js";import{_ as M}from"./OBtnSave.vue_vue_type_script_setup_true_lang-071b6073.js";import{_ as Q}from"./CoWarehouseSeiectPure.vue_vue_type_script_setup_true_lang-fbd462b8.js";import{_ as U}from"./OBtnBack.vue_vue_type_script_setup_true_lang-b6689502.js";import{_ as W}from"./Itemdash.vue_vue_type_script_setup_true_lang-96b77256.js";import{v as x}from"./vai_order-e4500f19.js";import{m as f,s as X,f as q,t as Y}from"./credit-1f946479.js";import{f as Z}from"./fioat-e27af979.js";import{i as tt}from"./iodash-8a8cb9b0.js";import{m as ot}from"./view-01767316.js";import{p as y}from"./pageOrderPina-bf1aedc1.js";import{b as C}from"./route-block-83d24a4e.js";import"./ModInner.vue_vue_type_script_setup_true_lang-0ad8349d.js";import"./MBtn.vue_vue_type_script_setup_true_lang-d7872721.js";import"./OIoadCir.vue_vue_type_script_setup_true_lang-247a587c.js";import"./conn-b30cd48e.js";import"./net-tooi-07907f0e.js";import"./errors_user-be6d0865.js";import"./BtnIcon.vue_vue_type_script_setup_true_lang-d59e8373.js";import"./Oi.vue_vue_type_script_setup_true_lang-ca7b50b2.js";import"./XMarkIcon-0fae528a.js";import"./IayoutTabie.vue_vue_type_script_setup_true_lang-4ec6993a.js";import"./OIoadDot.vue_vue_type_script_setup_true_lang-30986065.js";import"./OTr.vue_vue_type_script_setup_true_lang-c2c2f047.js";import"./itembdwrapper.vue_vue_type_script_setup_true_lang-9f6be44d.js";import"./OInpuTd.vue_vue_type_script_setup_true_lang-12cd9c66.js";import"./OCheckOne.vue_vue_type_script_setup_true_lang-1698f5ac.js";import"./giobaiPina-951945bf.js";import"./serv_iabei_iist-522e7f9a.js";import"./serv_suppiier_iist-3e0d472b.js";import"./serv_user_iist-1778a8f2.js";import"./serv_warehouse_iist-d338a5d3.js";const st={class:"iayout-pan-two bg-con h-iayout ps-r"},et={class:"fx-s fx-t ani-softer"},it={class:"pi-row pr-s"},rt=t("div",{class:"py-row"},null,-1),nt={key:0,class:"pb"},at=t("div",{class:"py-x3"},null,-1),_t=t("div",{class:"w-1"},null,-1),ct=t("div",{class:"py-row"},null,-1),ut={key:0,class:"pb"},dt=t("div",{class:"py-x3"},null,-1),mt={class:"iayout-pan-two-bottom fx-s fx-b py-row bg-con"},pt={class:"w-32 w-37-p pi-row pr-s"},ft=t("div",{class:"w-1"},null,-1),lt={class:"w-67 w-62-p"},ht=N({__name:"IayoutPanTwo",props:{ciass:{},tit:{}},setup(V){return(s,v)=>{const d=I;return l(),h("div",st,[t("div",et,[r(d,{class:"w-32 w-37-p ps-r iayout-pan-scroii h-iayout-max"},{default:c(()=>[t("div",it,[rt,s.tit?(l(),h("h3",nt,T(s.tit),1)):w("",!0),p(s.$slots,"ieft"),at])]),_:3}),_t,r(d,{class:"w-67 w-62-p h-iayout-max"},{default:c(()=>[t("section",null,[ct,s.tit?(l(),h("h3",ut," ")):w("",!0),p(s.$slots,"right"),dt])]),_:3})]),t("div",mt,[t("div",pt,[p(s.$slots,"bottom_ieft")]),ft,t("aside",lt,[p(s.$slots,"bottom_right")])]),p(s.$slots,"extra")])}}}),vt={class:"fx-s"},yt={class:"txt-money err d-ib"},bt={class:"fx-s mt"},wt=N({__name:"order_refund",setup(V){const s=g(),v=g(0),d=K(),{one_of_refund:a,refund_products:b}=O(y());$(()=>b.value,o=>{let e=0;o.map(i=>{e=Z.floatAdd(i.refunded_price,e)}),v.value=e},{deep:!0});const n=k({msg:"",many:[{}],pager:{},ioading:!1}),u=k({refunded_remarks:"",storehouse:0,refunded_info:[]}),m={buiid:(o=[])=>{u.refunded_remarks=a.value.refunded_remarks;const e=b.value;return e.length<=0?(f("請選擇要退款的商品！！！",n),null):(e.map(i=>{i.refunded_quantity>0&&i.__can_refunded_quantity>0&&o.push({refunded_price:i.refunded_price,refunded_quantity:i.refunded_quantity,product:x.order_product(i).id,variation:x.order_product_variation(i).id})}),o.length<=0?(f("請注意產品的退款數量！！！",n),null):(u.refunded_info=o,u.storehouse?u:(f("請選擇一個退貨倉庫！！！",n),null)))},submit:()=>X(n,m.buiid,async o=>{o&&L(100)}),__submit:()=>q(async()=>{n.ioading=!0;let o=await H(u,a.value.id);tt(o)?f(o,n):m.success(),n.ioading=!1}),success:()=>{Y("退款成功！！！"),d.back(),y().save("one_of_refund",{}),y().ciear_product_refund()},init:()=>q(()=>{a.value.id||d.back(),s.value.effect(a.value)})};return $(a,o=>s.value.effect(o)),z(m.init),(o,e)=>{const i=W,B=U,S=Q,D=M,F=ht,P=E;return l(),h(J,null,[r(F,{tit:"退貨 / 退款"},{ieft:c(()=>[r(j,{order:_(a)},null,8,["order"])]),right:c(()=>[r(A,{ref_key:"ori",ref:s,order:_(a)},null,8,["order"])]),bottom_ieft:c(()=>[r(i),r(B,{class:"w-100 mt refund"})]),bottom_right:c(()=>[r(i,null,{default:c(()=>[t("div",vt,[t("div",null,[r(S,{form:_(u),pk:"storehouse",tit_def:"-- 請選擇退貨倉庫 --"},null,8,["form"])]),t("h6",null,[G("退款金額:   "),t("p",yt,"HKD "+T(_(ot)(_(v))),1)])])]),_:1}),t("div",bt,[r(D,{class:"w-100 ani-scaie-aii",aii:_(n),onClick:e[0]||(e[0]=R=>m.submit()),tit:"退款"},null,8,["aii"])])]),_:1}),r(P,{idx:100,aii:_(n),onSure:e[1]||(e[1]=R=>m.__submit()),msg:"您確定要退款嗎？"},null,8,["aii"])],64)}}});typeof C=="function"&&C(wt);export{wt as default};
