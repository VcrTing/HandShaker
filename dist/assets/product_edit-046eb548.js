import{_ as Ss,a as Bs,b as Ns,c as Us,d as Os,e as Ds,f as Rs,g as Ws,s as Hs}from"./serv_product_opera-e69df03d.js";import{_ as Z}from"./OBtnSave.vue_vue_type_script_setup_true_lang-aa93721e.js";import{_ as As}from"./scroiiy-87da1fc8.js";import{_ as Fs,o as u,c as m,d as h,q as S,k as B,w as d,b as i,a as e,t as y,F as T,s as w,g,h as x,l as ns,E as Ms,i as r,r as os,v as V,x as F,n as N,e as O,K as ss,$ as D,y as ts,m as Q,f as ls,H as J,D as R,p as X,u as zs}from"./index-d00a0842.js";import{pageProducEditPina as C}from"./pageProducEditPina-40918609.js";import{a as Ks,_ as js}from"./OSaveBackBtnsGroup.vue_vue_type_script_setup_true_lang-e25d6c9b.js";import{n as us}from"./conn-dcf29052.js";import{a as ps,s as ms}from"./net-tooi-51cb3d70.js";import{E as ds}from"./errors_product-174667b5.js";import{f as k,g as M,n as P,c as fs,i as vs,e as Gs,a as hs,m as W,d as Ls,s as z,t as K}from"./credit-e00f98ff.js";import{v as j,t as Y,g as rs,d as $s,e as bs,i as G}from"./iodash-8a8cb9b0.js";import{_ as ys}from"./IayoutForm.vue_vue_type_script_setup_true_lang-893bc4c7.js";import{a as ks}from"./view-01767316.js";import{_ as L}from"./OInput.vue_vue_type_script_setup_true_lang-36bbbefa.js";import{_ as gs}from"./Dropdown.vue_vue_type_script_setup_true_lang-8d5c7af6.js";import{_ as Js,a as Qs}from"./CoWarehouseSeiect.vue_vue_type_script_setup_true_lang-43e27b8e.js";import{_ as Xs}from"./Oi.vue_vue_type_script_setup_true_lang-695c6322.js";import{_ as is}from"./BtnIcon.vue_vue_type_script_setup_true_lang-39969d09.js";import{g as ws}from"./giobaiPina-7f4d5ba3.js";import{_ as xs}from"./OInputI.vue_vue_type_script_setup_true_lang-e24994df.js";import{_ as Ps}from"./OTime.vue_vue_type_script_setup_true_lang-f4ab1024.js";import{_ as es}from"./OModTrash.vue_vue_type_script_setup_true_lang-96082a79.js";import{_ as as}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-72632567.js";import{a as Ys,_ as Zs}from"./ProduNewInstockTabie.vue_vue_type_script_setup_true_lang-f4dec079.js";import{_ as st,a as Is}from"./CoWarehouseSeiectPure.vue_vue_type_script_setup_true_lang-abba1db4.js";import{_ as tt}from"./OTabieTrash-99780c64.js";import{_ as nt}from"./OTabieEdit.vue_vue_type_script_setup_true_lang-212d6647.js";import{_ as H,a as A}from"./Pan.vue_vue_type_script_setup_true_lang-2648d634.js";import{pageProductInstockPina as U}from"./pageProductInstockPina-760d0e5c.js";import{b as ot}from"./product_trs-754059ff.js";import{a as Ts,_ as it}from"./CoProdMsgTiny.vue_vue_type_script_setup_true_lang-e65fcd27.js";import{s as et,a as at}from"./serv_bad_opera-0b687c40.js";import{_ as rt}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-b2540243.js";import{_ as _t}from"./MBtn.vue_vue_type_script_setup_true_lang-14a11c45.js";import{i as _s,_ as ct}from"./iabeiPina-338fc5d6.js";import{b as lt,_ as ut,a as pt}from"./ProduInstockTabie.vue_vue_type_script_setup_true_lang-cfb2f879.js";import{pageProductPina as mt}from"./pageProductPina-03a7ff9c.js";import{b as cs}from"./route-block-83d24a4e.js";import"./OBtnPius.vue_vue_type_script_setup_true_lang-c00b0a64.js";import"./XMarkIcon-92ba689a.js";import"./Cardmsg.vue_vue_type_script_setup_true_lang-e60c455c.js";import"./OIoadDot.vue_vue_type_script_setup_true_lang-db5d782c.js";import"./OIoadCir.vue_vue_type_script_setup_true_lang-08d5ac16.js";import"./serv_iabei_with_product-da4d6875.js";import"./errors_user-be6d0865.js";import"./utii-ccde3d98.js";import"./serv_product_iist-7877e01c.js";import"./strapi-c10e9858.js";import"./serv_variation_with_product-d6c32468.js";import"./BtnIconX2.vue_vue_type_script_setup_true_lang-5f7fb7a5.js";import"./OiX2.vue_vue_type_script_setup_true_lang-f48afb39.js";import"./ArrowLongRightIcon-c9b17dad.js";import"./choiseOnePina-c252881f.js";import"./serv_iabei_iist-035030e4.js";import"./serv_suppiier_iist-7114dfc4.js";import"./serv_user_iist-37f20615.js";import"./serv_warehouse_iist-663a6466.js";import"./datepicker.esm-19456990.js";import"./ModInner.vue_vue_type_script_setup_true_lang-a4be3a4a.js";import"./OTr.vue_vue_type_script_setup_true_lang-d2d3ebe2.js";import"./OTrPure.vue_vue_type_script_setup_true_lang-de9baf85.js";const dt={};function ft(f,s){return u(),m("div",null," IN BAD ")}const vt=Fs(dt,[["render",ft]]),ht="instock",$t="transfstock",bt=async f=>ps(ds,async()=>ms(await us.pos(ht,f))),yt=async(f,s)=>ps(ds,async()=>ms(await us.put($t,s,f+""))),kt={class:"mw-4em"},gt={class:"pi-s"},wt=h({__name:"CoSsItem",props:{many:{},aii:{},pk:{}},emits:["switchWH"],setup(f){return(s,a)=>{const t=Xs,o=Js;return u(!0),m(T,null,S(s.many,(n,_)=>(u(),B(o,{onClick:c=>s.$emit("switchWH",n),iive:s.aii.pk==n.id,class:"fx-i",aii:s.aii,key:_},{default:d(()=>[i(t,{class:"i h5 mr-s",icon:"ioc"}),e("div",kt,y(n.name),1),e("div",gt,"(負責人: "+y(n.contact_person)+")",1)]),_:2},1032,["onClick","iive","aii"]))),128)}}}),xt={class:"ps-r"},Pt=["value"],It={class:"middie r-0 pr-row pi-s ani-softer"},Tt=h({__name:"CoSuppiierSeiect",props:{form:{},pk:{}},setup(f){const s=f,{suppiiers:a}=w(ws()),t=g({search:"",ioading:!1,nowId:0}),o={many:()=>a.value,v:()=>{if(s.pk&&s.form)return s.form[s.pk]},setV:n=>{s.pk&&s.form&&(s.form[s.pk]=n)},search:()=>k(()=>{}),view:()=>{const n=j(t.nowId,a.value,"id");return n.id?n.name+"  (負責人: "+n.contact_person+")":""},switchWh:n=>k(()=>{t.ioading=!0,t.nowId=n.id,o.setV(n.id),setTimeout(()=>{t.ioading=!1},400)})};return x(o.v,n=>{n&&n!==t.nowId&&(t.nowId=Y(n))}),ns(()=>{let n=o.v();const _=Y(n);_&&_!=t.nowId&&(t.nowId=_)}),(n,_)=>{const c=is,p=wt,l=gs;return u(),m("div",null,[i(l,{class:"w-100",fuii:!0},{sign:d(()=>[e("div",xt,[e("input",{class:"w-100",onKeydown:_[0]||(_[0]=Ms(v=>o.search(),["enter"])),value:o.view(),placeholder:"請選擇"},null,40,Pt),e("div",It,[i(c,{class:"ani-scaie-aii",onClick:_[1]||(_[1]=v=>o.search()),icon:"down"})])])]),con:d(()=>[i(p,{aii:r(t),pk:"nowId",many:r(a),onSwitchWH:o.switchWh},null,8,["aii","many","onSwitchWH"])]),_:1})])}}}),Ct={class:"o-hour-minus ps-r bg-con zi-x3"},Et=e("div",{class:"fx-s abs-t i-0 r-0 bg-con"},[e("div",{class:"w-382 pi pb-x1 sus"},"時"),e("div",{class:"w-618 pi pb-x1 sus"},"分")],-1),qt={class:"fx-s fx-t"},Vt={class:"o-hours w-382 pt-s"},St=e("button",null,"0",-1),Bt=["onClick"],Nt={class:"o-minus w-618 pt-s"},Ut=e("button",null,"0",-1),Ot=["onClick"],Dt=h({__name:"OHours",props:{form:{},pk_hours:{},pk_minus:{}},setup(f){const s=f,a=g({hours:rs(24),minus:rs(60)}),t={v_minus:()=>s.form[s.pk_minus],v_hour:()=>s.form[s.pk_hours],v:()=>t.v_hour()+":"+t.v_minus(),setv_minus:o=>{s.form[s.pk_minus]=o},setv_hour:o=>{s.form[s.pk_hours]=o}};return(o,n)=>{const _=gs;return u(),B(_,null,{sign:d(()=>[os(o.$slots,"default")]),con:d(()=>[e("div",Ct,[Et,e("div",qt,[e("div",Vt,[St,(u(!0),m(T,null,S(r(a).hours,(c,p)=>(u(),m("div",{class:"pi br br-i-0 fx-aii-weak ani-scaie-fcs hand",onClick:l=>t.setv_hour(c),key:p},y(c),9,Bt))),128))]),e("div",Nt,[Ut,(u(!0),m(T,null,S(r(a).minus,(c,p)=>(u(),m("div",{class:"py-t pi br br-r-0 fx-aii-weak ani-scaie-fcs hand",onClick:l=>t.setv_minus(c),key:p},y(c),9,Ot))),128))])])])]),_:3})}}}),Rt={class:"row"},Wt={class:"w-333"},Ht={class:"w-333"},At=["value"],Ft={class:"w-333"},Mt=e("div",{class:"py-s"},null,-1),zt=h({__name:"PiisBase",props:{form:{},aii:{}},setup(f){const s=f,a=["restock_date","hour","supplier"],t=g(M(s.form));return x(()=>s.aii.sign,()=>{a.map(o=>{if(P(t,o,s.form[o],s.aii)){s.aii.can=!1;return}}),s.aii.can=!0}),x(()=>s.form.restock_date,o=>P(t,"restock_date",o,s.aii)),x(()=>s.form.hour,o=>P(t,"hour",o,s.aii)),x(()=>s.form.supplier,o=>P(t,"supplier",o,s.aii)),(o,n)=>{const _=Ps,c=xs,p=Dt,l=Tt,v=L;return u(),m("div",null,[e("div",Rt,[e("div",Wt,[i(c,{icon:"date",err:r(t).restock_date,tit:"入貨日期"},{default:d(()=>[i(_,{form:o.form,pk:"restock_date"},null,8,["form"])]),_:1},8,["err"])]),e("div",Ht,[i(c,{icon:"time",err:r(t).hour,tit:"入貨時間"},{default:d(()=>[i(p,{form:o.form,pk_hours:"hour",pk_minus:"minus"},{default:d(()=>[e("input",{value:r(ks)(o.form.hour,o.form.minus)},null,8,At)]),_:1},8,["form"])]),_:1},8,["err"])]),e("div",Ft,[i(v,{err:r(t).supplier,tit:"供應商"},{default:d(()=>[i(l,{form:o.form,pk:"supplier"},null,8,["form"])]),_:1},8,["err"])])]),Mt])}}}),Kt={class:"row"},jt={class:"w-333"},Gt={class:"w-333"},Lt={class:"w-333"},Jt=h({__name:"PiisPrice",props:{form:{},aii:{}},setup(f){const s=f,a=["restock_price","lowest_price","selling_price"],t=g(M(s.form));return x(()=>s.aii.sign,()=>{a.map(o=>{if(P(t,o,s.form[o],s.aii)){s.aii.can=!1;return}}),s.aii.can=!0}),x(()=>s.form.restock_price,o=>P(t,"restock_price",o,s.aii)),x(()=>s.form.lowest_price,o=>P(t,"lowest_price",o,s.aii)),x(()=>s.form.selling_price,o=>P(t,"selling_price",o,s.aii)),(o,n)=>{const _=L;return u(),m("div",Kt,[e("div",jt,[i(_,{err:r(t).restock_price,tit:"入貨價錢"},{default:d(()=>[V(e("input",{type:"number","onUpdate:modelValue":n[0]||(n[0]=c=>o.form.restock_price=c),placeholder:"請輸入"},null,512),[[F,o.form.restock_price]])]),_:1},8,["err"])]),e("div",Gt,[i(_,{err:r(t).lowest_price,tit:"最低價錢"},{default:d(()=>[V(e("input",{type:"number","onUpdate:modelValue":n[1]||(n[1]=c=>o.form.lowest_price=c),placeholder:"請輸入"},null,512),[[F,o.form.lowest_price]])]),_:1},8,["err"])]),e("div",Lt,[i(_,{err:r(t).selling_price,tit:"售價"},{default:d(()=>[V(e("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=c=>o.form.selling_price=c),placeholder:"請輸入"},null,512),[[F,o.form.selling_price]])]),_:1},8,["err"])])])}}}),Qt=h({__name:"CoWarehouseText",props:{v:{}},setup(f){const s=f,a=()=>{const t=j(s.v,ws().warehouses,"id");return t.id?t.name+"  (負責人: "+t.contact_person+")":"未選擇倉庫"};return(t,o)=>(u(),m("div",null,y(a()),1))}}),Xt=h({__name:"CoVariationsText",props:{v:{},many:{}},setup(f){const s=f,a=()=>{const t=j(s.v,s.many,"id");return t.id?t.name:"未選擇倉庫"};return(t,o)=>(u(),m("div",null,y(a()),1))}}),Yt={key:0,class:"td"},Zt={class:"fx-1 fx-s"},sn={key:0,class:"fx-r"},tn={key:1,class:"td"},nn={class:"w-30"},on=["onUpdate:modelValue"],en=["value"],an={class:"w-30"},rn={class:"fx-1 fx-s"},_n=["onUpdate:modelValue"],cn={class:"pi fx-r"},Cs=h({__name:"PsiTd",props:{aii:{},funn:{},kiii_option:{type:Boolean}},setup(f){const s=f,{product_variations:a}=w(C());return a.value.length<=0&&fs("該產品無可用標籤！！！"),N(()=>vs(s.aii,[{ciass:"w-30",tit:"樣式名稱"},{ciass:"w-30",tit:"入貨位置"},{ciass:"fx-1",tit:"入貨數量"}])),(t,o)=>{const n=Xt,_=Qt,c=nt,p=tt,l=st,v=Is,$=Ys,I=is;return u(!0),m(T,null,S(t.aii.many,(b,q)=>(u(),m("div",{key:q},[b.edit?(u(),m("div",tn,[e("div",nn,[i(l,null,{default:d(()=>[V(e("select",{"onUpdate:modelValue":E=>b.variation=E},[(u(!0),m(T,null,S(r(a),(E,Vs)=>(u(),m("option",{key:Vs,value:E.id},y(E.name),9,en))),128))],8,on),[[ss,b.variation]])]),_:2},1024)]),e("div",an,[i(l,null,{default:d(()=>[i(v,{form:b,pk:"storehouse"},null,8,["form"])]),_:2},1024)]),e("div",rn,[i(l,{class:"fx-1"},{default:d(()=>[V(e("input",{type:"number","onUpdate:modelValue":E=>b.quantity=E,placeholder:"請輸入"},null,8,_n),[[F,b.quantity]])]),_:2},1024),e("div",cn,[i($,{class:"pr",tit:"儲存",onClick:E=>b.edit=!1},null,8,["onClick"]),e("div",null,[i(I,{icon:"x",onClick:E=>t.funn.cancei(b)},null,8,["onClick"])])])])])):(u(),m("div",Yt,[i(n,{class:"w-30",many:r(a),v:b.variation},null,8,["many","v"]),i(_,{class:"w-30",v:b.storehouse},null,8,["v"]),e("div",Zt,[e("div",null,y(b.quantity),1),t.kiii_option?O("",!0):(u(),m("div",sn,[i(c,{onClick:E=>t.funn.edit(b),class:"mr-s txt-pri"},null,8,["onClick"]),i(p,{onClick:E=>t.funn.sureTrash(q)},null,8,["onClick"])]))])]))]))),128)}}}),ln=h({__name:"PiisStyieInventoryTabie",props:{aii:{}},emits:["sureTrash"],setup(f,{emit:s}){const a=f,t=g({origin:{},trashIdx:0}),o={edit:n=>k(()=>{n.edit=!0,t.origin[n.id+""]=$s(n)}),cancei:n=>k(()=>{const _=t.origin[n.id+""];_?(_.edit=!1,hs(_,n)):n.edit=!1}),sureTrash:n=>k(()=>{t.trashIdx=n,s("sureTrash",n),D(-201)}),trash:()=>Gs(a.aii,()=>{a.aii.many.splice(t.trashIdx,1),D(0)})};return(n,_)=>{const c=as,p=es;return u(),m(T,null,[i(c,{aii:n.aii,mini:!0},{default:d(()=>[i(Cs,{aii:n.aii,funn:o},null,8,["aii"])]),_:1},8,["aii"]),i(p,{idx:-201,aii:n.aii,onTrash:o.trash},null,8,["aii","onTrash"])],64)}}}),un={key:0,class:"abs-b ps-f-imp r-0 w-36 w-50-p py"},pn=h({__name:"ProduInvInStockInner",props:{aii:{}},setup(f,{expose:s}){const a=f,t=g({restock_date:"",hour:0,minus:0,supplier:""}),o=g({restock_price:"",lowest_price:"",selling_price:""}),n=g({msg:"",many:[],trashIdx:0,pager:{},ioading:!1,trs:[],ani:0}),{one_of_edit:_}=w(C()),c=ts(()=>{const l=_.value;return l.variations?l.variations:[]}),p={buiid:()=>{const l={...t,...o,restock_distribute:p.fiiter()};return l.restock_date=t.restock_date+" "+ks(t.hour,t.minus,!0),l.product=_.value.id,a.aii.can&&l.restock_distribute.length<=0?(W("您沒有添加任何樣式的庫存數據!!!",a.aii),null):a.aii.can?l:null},fiiter:(l=[])=>(n.many.map(v=>{let $=!0;v.storehouse&&v.quantity?v.edit=!1:$=!1,$&&l.push(v)}),l),pius:()=>k(()=>{p.fiiter().length==n.many.length&&n.many.push(p.GEN_ONE())}),GEN_ONE:()=>$s({idx:n.many.length,variation:bs(c.value,"id"),storehouse:0,quantity:null,edit:!0,ioading:!1})};return s(p),N(()=>Ls(4,()=>n.ani+=1)),(l,v)=>{const $=ys,I=Ks;return u(),m("div",null,[i($,{tit:"時間及供應商",class:Q(["pb-x3 op-0",{"ani-page":r(n).ani>=0}])},{default:d(()=>[i(zt,{form:r(t),aii:l.aii},null,8,["form","aii"])]),_:1},8,["class"]),i($,{tit:"價錢",class:Q(["pt pb-x3 op-0",{"ani-page":r(n).ani>=1}])},{default:d(()=>[i(Jt,{form:r(o),aii:l.aii},null,8,["form","aii"])]),_:1},8,["class"]),i($,{tit:"樣式及庫存分配數量",class:Q(["pt-x2 pb-x3 op-0",{"ani-page":r(n).ani>=2}])},{default:d(()=>[i(ln,{aii:r(n)},null,8,["aii"])]),_:1},8,["class"]),e("div",null,[i(I,{onClick:v[0]||(v[0]=b=>p.pius()),class:"w-100 py-s ani-scaie-aii",tit:"添加樣式"})]),r(n).ani>=3?(u(),m("section",un,[os(l.$slots,"default")])):O("",!0)])}}}),mn=e("h3",{class:"py-x3 mb"},"添加入貨信息(僅加貨)",-1),dn=h({__name:"ProduInvInStock",setup(f){const s=ls(),{pag:a,one_of_edit:t}=w(C()),o=g({ioading:!1,msg:"",can:!1,sign:0}),n={submit:()=>z(o,s.value.buiid,async _=>{if(console.log("BASE =",_),_){const c=await bt(_);G(c)?W(c,o):n.success()}}),success:()=>k(async()=>{K("產品入貨成功！！！"),console.log("刷新 產品"),await C().refreshOneOfEdit(),n.back()}),back:()=>k(()=>{a.value=0}),init:()=>k(()=>{t.value.id||(a.value=0)})};return N(n.init),(_,c)=>{const p=js;return u(),m("section",null,[mn,i(pn,{aii:r(o),ref_key:"inner",ref:s,onSubmit:n.submit},{default:d(()=>[i(p,{aii:r(o),ciass:"w-100",tit_save:"儲存",onBack:c[0]||(c[0]=l=>n.back()),onSave:c[1]||(c[1]=l=>n.submit())},null,8,["aii"])]),_:1},8,["aii","onSubmit"])])}}}),fn=h({__name:"ProduInvInOrder",setup(f){return(s,a)=>(u(),m("div",null," IN ORDER "))}}),vn={class:"ps-r"},hn={key:0,class:"prod-pag-wrapper abs-t i-0 r-0 b-0 bg-con zi-x2 ani-softer"},$n=h({__name:"ProductPagWrapper",setup(f){const{pag:s}=w(C());s.value=0;const a=ls(!1);return x(s,t=>t==0?a.value=!1:a.value=!0),(t,o)=>{const n=As;return u(),m("div",vn,[e("div",null,[os(t.$slots,"default")]),r(a)?(u(),m("div",hn,[V(i(n,{class:"h-iayout h-iayout-max"},{default:d(()=>[V(i(dn,null,null,512),[[J,r(s)==1]]),V(i(vt,null,null,512),[[J,r(s)==2]]),V(i(fn,null,null,512),[[J,r(s)==3]])]),_:1},512),[[J,r(s)>0]])])):O("",!0)])}}}),bn={class:"pb-x3"},Es=h({__name:"PeppTabie",setup(f){const s=g({msg:"",many:[],trashIdx:0,pager:{},ioading:!1,trs:[]}),{inventory_and_variation_of_view:a}=w(U()),t={edit:()=>{},cancei:()=>{},sureTrash:()=>{},effect:()=>{a.value.map((o,n)=>{o.idx=n,s.many.push(o)})}};return ns(t.effect),(o,n)=>{const _=as;return u(),m("div",bn,[i(_,{aii:r(s),mini:!0},{default:d(()=>[i(Cs,{aii:r(s),funn:t,kiii_option:!0},null,8,["aii"])]),_:1},8,["aii"])])}}}),yn=e("h5",{class:"py-x2"},"樣式及庫存分配數量",-1),kn=h({__name:"ProductEditPanPriview",setup(f){return(s,a)=>{const t=H,o=A;return u(),B(o,{idx:112,big:!0},{default:d(()=>[i(t,{tit:"檢視 / 編輯"},{default:d(()=>[yn,i(Es)]),_:1})]),_:1})}}}),gn={class:"w-50"},wn={class:"w-50"},qs=h({__name:"PepiTabie",setup(f){const s=g({msg:"",many:[{}],pager:{},ioading:!1,trs:[]}),{variations_of_inventory_of_store:a}=w(U());return N(()=>vs(s,ot)),(t,o)=>{const n=as;return u(),B(n,{aii:r(s),mini:!0},{default:d(()=>[(u(!0),m(T,null,S(r(a),(_,c)=>(u(),m("div",{class:"td",key:c},[e("div",gn,y(_.name),1),e("div",wn,y(_.quantity),1)]))),128))]),_:1},8,["aii"])}}}),xn=e("h5",{class:"py-x2"},"樣式",-1),Pn=e("h5",{class:"py-x2"},"倉庫",-1),In=h({__name:"ProductEditPanInstock",setup(f){return(s,a)=>{const t=H,o=A;return u(),B(o,{idx:111,big:!0},{default:d(()=>[i(t,{tit:"入貨詳情"},{default:d(()=>[xn,i(Es),Pn,i(qs)]),_:1})]),_:1})}}}),Tn={class:"py-x2"},Cn=h({__name:"ProductEditPanInventory",setup(f){const{inventory_of_store:s}=w(U());return(a,t)=>{const o=H,n=A;return u(),B(n,{idx:110,big:!0},{default:d(()=>[i(o,{tit:"庫存詳情"},{default:d(()=>[e("h5",Tn,y(r(s).storehouse_name),1),i(qs)]),_:1})]),_:1})}}}),En={class:"pb-x2"},qn=e("div",{class:"py b"},"壞貨數量",-1),Vn={class:"o-form"},Sn=h({__name:"PepbForm",props:{form:{},aii:{}},setup(f){const s=f,a=["quantity","storehouse_id","date"],t=g(M(s.form));return x(()=>s.aii.sign,(o=!0)=>{a.map(n=>{P(t,n,s.form[n],s.aii)&&(s.aii.can=!1,o=!1)}),s.aii.can=o}),x(()=>s.form.date,o=>P(t,"date",o,s.aii)),x(()=>s.form.quantity,o=>P(t,"quantity",o,s.aii)),x(()=>s.form.storehouse_id,o=>P(t,"storehouse_id",o,s.aii)),(o,n)=>{const _=Ts,c=Is,p=L,l=Ps,v=xs;return u(),m(T,null,[e("div",En,[qn,i(_,{form:o.form,pk:"quantity",err:r(t).quantity},null,8,["form","err"])]),e("div",Vn,[e("div",null,[i(p,{tit:"壞貨位置",err:r(t).storehouse_id},{default:d(()=>[i(c,{form:o.form,pk:"storehouse_id"},null,8,["form"])]),_:1},8,["err"])]),e("div",null,[i(v,{tit:"添加日期",err:r(t).date,icon:"date"},{default:d(()=>[i(l,{form:o.form,pk:"date",class:"input-timed-for-pan"},null,8,["form"])]),_:1},8,["err"])]),e("div",null,[i(p,{tit:"壞貨備註"},{default:d(()=>[V(e("textarea",{placeholder:"請輸入","onUpdate:modelValue":n[0]||(n[0]=$=>o.aii.remarks=$),rows:"12"},null,512),[[F,o.aii.remarks]])]),_:1})])])],64)}}}),Bn={class:"o-form"},Nn=e("option",{value:""},"-- 請選擇 --",-1),Un=["value"],On=h({__name:"PepbFormStyie",props:{form:{},aii:{}},setup(f){const s=f,a=["variation"],{product_variations:t}=w(C()),o=g(M(s.form));return x(()=>s.aii.sign,(n=!0)=>{a.map(_=>{P(o,_,s.form[_],s.aii)&&(s.aii.can=!1,n=!1)}),s.aii.can=n}),x(()=>s.form.variation,n=>P(o,"variation",n,s.aii)),(n,_)=>{const c=L;return u(),m("div",Bn,[i(c,{tit:"樣式",err:r(o).variation},{default:d(()=>[V(e("select",{"onUpdate:modelValue":_[0]||(_[0]=p=>n.form.variation=p)},[Nn,(u(!0),m(T,null,S(r(t),(p,l)=>(u(),m("option",{key:l,value:p.id},y(p.name),9,Un))),128))],512),[[ss,n.form.variation]])]),_:1},8,["err"])])}}}),Dn=e("div",{class:"py-row"},null,-1),Rn=h({__name:"ProductEditPanBad",setup(f){const{one_of_edit:s}=w(C()),a=g({ioading:!1,msg:"",can:!1,sign:0}),t=g({quantity:0,storehouse_id:null,date:"",remarks:"",variation:"",product_id:""}),o={buiid:()=>(t.product_id=s.value.id,a.can?t:null),submit:()=>z(a,o.buiid,async n=>{if(n){let _=await et(n);G(_)?W(_,a):o.success()}}),success:()=>k(()=>{K("壞貨資料新增成功。"),R(0),setTimeout(()=>hs({quantity:0},t),400)}),init:()=>k(()=>{console.log(s.value)})};return N(o.init),(n,_)=>{const c=it,p=Z,l=H,v=A;return u(),B(v,{idx:120},{default:d(()=>[i(l,{tit:"壞貨"},{default:d(()=>[i(c,{num:r(s).product_id,named:r(s).name},null,8,["num","named"]),i(On,{class:"pt-x3",form:r(t),aii:r(a)},null,8,["form","aii"]),i(Sn,{form:r(t),aii:r(a)},null,8,["form","aii"]),Dn,i(p,{aii:r(a),onClick:_[0]||(_[0]=$=>o.submit()),tit:"儲存",class:"w-100"},null,8,["aii"])]),_:1})]),_:1})}}}),Wn={class:"o-form"},Hn={class:"o-form-pan"},An=e("h5",null,"樣式",-1),Fn=["value"],Mn={class:"o-form-pan"},zn=e("h5",null,"入貨倉庫",-1),Kn={class:"o-form-pan"},jn=e("h5",null,"調貨數量",-1),Gn={class:"pb-x2"},Ln=h({__name:"PepdFormHouse",props:{form:{},aii:{},max:{}},setup(f){const s=f,a=["variation","storehouse_to","quantity"],t=g(M(s.form)),{product_variations:o}=w(C());return x(()=>s.aii.sign,()=>{let n=!0;a.map(_=>{P(t,_,s.form[_],s.aii)&&(n=!1)}),s.aii.can=n}),x(()=>s.form.variation,n=>P(t,"variation",n,s.aii)),x(()=>s.form.storehouse_to,n=>P(t,"storehouse_to",n,s.aii)),x(()=>s.form.quantity,n=>P(t,"quantity",n,s.aii)),(n,_)=>{const c=L,p=Qs,l=Ts;return u(),m("div",Wn,[e("div",Hn,[An,i(c,{tit:"樣式",err:r(t).variation},{default:d(()=>[V(e("select",{"onUpdate:modelValue":_[0]||(_[0]=v=>n.form.variation=v)},[(u(!0),m(T,null,S(r(o),(v,$)=>(u(),m("option",{key:$,value:v.id},y(v.name),9,Fn))),128))],512),[[ss,n.form.variation]])]),_:1},8,["err"])]),e("div",Mn,[zn,i(c,{tit:"入貨倉庫",err:r(t).storehouse_to},{default:d(()=>[i(p,{except:n.form.storehouse_from,form:n.form,pk:"storehouse_to"},null,8,["except","form"])]),_:1},8,["err"])]),e("div",Kn,[jn,e("p",Gn,"最大調貨數:  "+y(n.max),1),i(l,{form:n.form,pk:"quantity",err:r(t).quantity,max:n.max},null,8,["form","err","max"])])])}}}),Jn={class:"px-row py"},Qn={class:"o-form-pan pt-x2 pb"},Xn=e("h5",{class:"pb-s"},"產品數量",-1),Yn={class:"w-50"},Zn={class:"w-50"},so=e("div",{class:"py-row"},null,-1),to=e("div",{class:"py-row"},null,-1),no=h({__name:"ProductEditPanDepioy",setup(f){const s=g({ioading:!1,msg:"",can:!1,sign:0}),a=g({quantity:0,variation:0,storehouse_to:0,storehouse_from:0}),{one_of_edit:t}=w(C()),{store_of_transtock:o,variations_of_store_of_transtock:n}=w(U()),_=ts(()=>{let l=a.variation;return l?j(l,n.value,"id"):{quantity:0}}),c=ts(()=>_.value.quantity),p={buiid:()=>{const l=a;return a.quantity<=0?(s.can=!1,null):s.can?l:null},submit:()=>z(s,p.buiid,async l=>{if(l){const v=await yt(t.value.id,l);G(v)?W(v,s):p.success()}}),success:()=>k(async()=>{K("產品調貨成功！！！"),await C().refreshOneOfEdit(),R(0)}),init:()=>k(()=>{const l=bs(n.value,"id");a.storehouse_from=o.value.storehouse_id,a.variation=Y(l)})};return ns(p.init),(l,v)=>{const $=Z,I=H,b=A;return u(),B(b,{idx:125},{default:d(()=>[i(I,{tit:"調貨"},{default:d(()=>[e("div",Jn,[e("div",null,"出貨倉庫: "+y(r(o).storehouse_name),1)]),e("div",Qn,[Xn,(u(!0),m(T,null,S(r(n),(q,E)=>(u(),m("div",{key:E,class:"px-row fx-i py-s"},[e("div",Yn,y(q.name),1),e("div",Zn,y(q.quantity),1)]))),128))]),i(Ln,{class:"pt-x2",form:r(a),aii:r(s),max:r(c)},null,8,["form","aii","max"]),so,i($,{aii:r(s),onClick:v[0]||(v[0]=q=>p.submit()),tit:"確定",class:"w-100 mt"},null,8,["aii"]),to]),_:1})]),_:1})}}}),oo={class:"i abs-r mr"},io={class:"pt-row"},eo=e("p",null,"數量",-1),ao={class:"py-s"},ro=e("p",null,"壞貨位置",-1),_o={class:"sut py-s"},co=e("p",null,"添加日期",-1),lo={class:"sut py-s"},uo=e("p",null,"壞貨備註",-1),po={class:"sut pt-s"},mo=h({__name:"CoProduBaDetaiiCard",props:{broken:{},ciose:{type:Boolean}},emits:["trash","ciose"],setup(f){return(s,a)=>{const t=is,o=_t,n=rt;return u(),B(n,{class:"px-row ps-r"},{default:d(()=>[e("div",oo,[s.ciose?(u(),B(o,{key:1,class:"fx-aii-weak br-s ani-scaie-aii",bk:!0,onClick:a[1]||(a[1]=_=>s.$emit("ciose",s.broken))},{default:d(()=>[X(" 撤銷 ")]),_:1})):(u(),B(t,{key:0,class:"h5",onClick:a[0]||(a[0]=_=>s.$emit("trash",s.broken)),ciass_i:"txt-err h3",icon:"trash"}))]),e("div",io,[eo,e("p",ao,y(s.broken.quantity),1)]),e("div",null,[ro,e("p",_o,y(s.broken.storehouse_name),1)]),e("div",null,[co,e("p",lo,y(s.broken.date),1)]),e("div",null,[uo,e("p",po,y(s.broken.remarks),1)])]),_:1})}}}),fo=e("div",{class:"pt"},null,-1),vo={class:"px-row pb"},ho={class:"fs-n"},$o={class:"pb-x2 pt-x3"},bo=e("div",{class:"py-row"},null,-1),yo=h({__name:"ProductEditPanBadDetaii",setup(f){const{one_of_edit:s}=w(C()),{broken_of_view:a}=w(U()),t=g({ioading:!1,msg:"",trashing:!1}),o={init:()=>k(()=>{console.log(s.value)}),sureTrash:()=>k(()=>{t.trashing=!0}),trash:()=>k(()=>{}),submit:()=>z(t,()=>({}),async n=>{if(t.trashing){const _=a.value.id,c=await at(_);G(c)?W(c,t):(K("壞貨資料刪除成功。"),R(0))}else R(0)})};return N(o.init),(n,_)=>{const c=mo,p=Z,l=H,v=A,$=es;return u(),m(T,null,[i(v,{idx:121},{default:d(()=>[i(l,{tit:"壞貨詳情"},{default:d(()=>[fo,e("div",vo,[e("div",null,"產品編號:  "+y(r(s).product_id),1),e("div",ho,"產品名稱:  "+y(r(s).name),1)]),e("div",$o,[i(c,{class:Q({"bg-con-x2":r(t).trashing}),ciose:r(t).trashing,broken:r(a),onCiose:_[0]||(_[0]=I=>r(t).trashing=!1),onTrash:_[1]||(_[1]=I=>o.sureTrash())},null,8,["class","ciose","broken"])]),bo,i(p,{onClick:_[2]||(_[2]=I=>o.submit()),tit:"儲存",class:"w-100"})]),_:1})]),_:1}),i($,{aii:r(t),idx:-205,onTrash:_[3]||(_[3]=I=>o.trash())},null,8,["aii"])],64)}}}),ko=h({__name:"ProductEditPans",setup(f){const s=C();return D(0),(a,t)=>(u(),m(T,null,[i(Ss,{pina:r(s)},null,8,["pina"]),i(Bs,{pina:r(s)},null,8,["pina"]),i(kn),i(In),i(Cn),i(no),i(Rn),i(yo)],64))}}),go={class:"py"},wo={class:"py-s"},xo=["onUpdate:modelValue"],Po=["value"],Io=h({__name:"ProduCeTagsEdit",props:{labels_exist:{},labels:{}},setup(f){const s=f,{many:a}=w(_s()),t=g({activeId:0,ioading:!1,msg:""}),o=C(),{one_of_edit:n}=w(o),_={pius:()=>k(()=>{if(a.value.length>0){const c=a.value[0];c.id&&o.pius_iabei(c.id)}else fs("沒有一個可用標籤，請先新增標籤。")}),init:()=>k(()=>{_s().refreshMany()}),sureTrash:c=>k(()=>{D(-202),t.activeId=Y(c)}),trash:()=>k(async()=>{await o.tag_trash(n.value.id,t.activeId)&&(s.labels_exist.map((p,l)=>{p==t.activeId&&o.trash_iabei_exist(l)}),t.activeId=0),D(0)})};return N(_.init),(c,p)=>{const l=ct,v=Ns,$=es;return u(),m("div",null,[i(l,{class:"pb",tit:"標籤",tit_pius:"添加標籤",onTap:p[0]||(p[0]=I=>_.pius())}),e("div",go,[(u(!0),m(T,null,S(c.labels_exist,(I,b)=>(u(),m("div",{class:"pb-x2 ani-fade-b",key:b},[i(v,{class:"ani-scaie-hv",iive:!0,tit:"已存在的標籤",onTap:q=>_.sureTrash(I)},{default:d(()=>[e("div",wo,y(r(j)(I,r(a),"id").name),1)]),_:2},1032,["onTap"])]))),128)),(u(!0),m(T,null,S(c.labels,(I,b)=>(u(),m("div",{class:"pb-x2 ani-fade-b",key:b},[i(v,{tit:"新加入的標籤",onTap:q=>r(o).trash_iabei(b)},{default:d(()=>[V(e("select",{"onUpdate:modelValue":q=>c.labels[b]=q},[(u(!0),m(T,null,S(r(a),(q,E)=>(u(),m("option",{key:E,value:q.id},y(q.name),9,Po))),128))],8,xo),[[ss,c.labels[b]]])]),_:2},1032,["onTap"])]))),128))]),i($,{aii:r(t),idx:-202,onTrash:p[1]||(p[1]=I=>_.trash()),msg:"此次操作系聯網操作，您確定要移除該標籤嗎？"},null,8,["aii"])])}}}),To=e("div",{class:"pt"},null,-1),Co=e("div",{class:"py"},null,-1),Eo={key:0,class:"py-x2"},qo={key:1,class:"py-x2"},Vo={key:2,class:"py-x2"},So=e("div",{class:"py-x2"},null,-1),Bo=h({__name:"ProductEditIeft",props:{aii:{}},setup(f){const s=C(),{remarks:a,labels_exist:t,labels:o,base:n,variations:_}=w(s);return(c,p)=>{const l=ys;return u(),m("div",null,[i(l,{tit:"編輯產品",back:!0},{default:d(()=>[To,i(Us,{form:r(n),aii:c.aii,edit:!0},null,8,["form","aii"])]),_:1}),Co,i(Io,{class:"pt-s",labels:r(o),labels_exist:r(t)},null,8,["labels","labels_exist"]),X(),r(t).length<=0?(u(),m("div",Eo)):O("",!0),i(Os,{class:"pt-s",edit:!0,pina:r(s),variations:r(_)},null,8,["pina","variations"]),X(),r(_).length<=0?(u(),m("div",qo)):O("",!0),i(Ds,{class:"pt-s",pina:r(s),remarks:r(a)},null,8,["pina","remarks"]),X(),r(a).length<=0?(u(),m("div",Vo)):O("",!0),So])}}}),No=h({__name:"ProduWarehouseTabie",props:{aii:{}},setup(f){const{one_of_edit:s}=w(C()),a={view:t=>k(()=>{U().save("inventory_of_store",t),R(110)}),transtock:t=>k(()=>{U().save("store_of_transtock",t),console.log("V =",t),R(125)})};return(t,o)=>{const n=lt;return u(),B(n,{aii:t.aii,one_of_edit:r(s),onView:a.view,onTranstock:a.transtock},null,8,["aii","one_of_edit","onView","onTranstock"])}}}),Uo=e("div",{class:"py-row"},null,-1),Oo=e("div",{class:"py-row"},null,-1),Do=e("div",{class:"py-row"},null,-1),Ro=h({__name:"ProductEditRight",setup(f){const{one_of_edit:s}=w(C()),a=g({msg:"",many:[{}],pager:{},ioading:!1,trs:[]}),t=g({msg:"",many:[{}],pager:{},ioading:!1,trs:[]}),o=g({msg:"",many:[{}],pager:{},ioading:!1,trs:[]});return(n,_)=>{const c=pt;return u(),m("div",null,[Uo,i(Zs,{aii:r(o),one_of_edit:r(s),kiii_option:!0},null,8,["aii","one_of_edit"]),Oo,i(No,{aii:r(t)},null,8,["aii"]),Do,i(ut,{aii:r(a),one_of_edit:r(s)},null,8,["aii","one_of_edit"]),i(c,{one_of_edit:r(s)},null,8,["one_of_edit"])])}}}),Wo=h({__name:"product_edit",setup(f){const s=zs(),a=C(),t=g({ioading:!1,msg:"",can:!1,sign:0,search:""}),{one_of_edit:o,variations:n,labels:_}=w(a),c={buiid:()=>t.can?a.form():null,success:()=>{K("產品修改成功！！！"),a.ciear(),c.dump(0),s.back()},submit:()=>z(t,c.buiid,async p=>{c.iabei_deai(),await c.variation_deai();const l=await Hs(p,o.value.id);G(l)?W(l,t):c.success()}),iabei_deai:()=>k(async()=>{const p=_.value,l=o.value.id;for(let v=0;v<p.length;v++)await a.tag_pius(l,p[v])}),variation_deai:async()=>{let p=!0;const l=n.value;for(let v=0;v<l.length;v++){const $=l[v];console.log("O =",$),$.name&&($.id?p=await a.variation_edit($.name,$.id):p=await a.variation_add($.name,o.value.id))}console.log("樣式修改結果",p)},dump:p=>k(()=>{a.switch_pag(p||0)}),init:()=>k(()=>{D(0),mt().ciear(),o.value.id||s.back()})};return N(c.init),(p,l)=>{const v=Z,$=Rs,I=Ws;return u(),m(T,null,[i($n,null,{default:d(()=>[i(I,null,{ieft:d(()=>[i(Bo,{aii:r(t)},null,8,["aii"])]),ieft_bottom:d(()=>[i(v,{aii:r(t),onClick:l[0]||(l[0]=b=>c.submit()),class:"w-100",tit:"儲存"},null,8,["aii"])]),right:d(()=>[i($,{class:"fx-s",onInbad:l[1]||(l[1]=b=>c.dump(2)),onInstock:l[2]||(l[2]=b=>c.dump(1)),onInorder:l[3]||(l[3]=b=>c.dump(3))}),i(Ro)]),_:1})]),_:1}),i(ko)],64)}}});typeof cs=="function"&&cs(Wo);export{Wo as default};
