import{_ as Z}from"./IayoutPan.vue_vue_type_script_setup_true_lang-d2d31d18.js";import{_ as J}from"./ModInner.vue_vue_type_script_setup_true_lang-a4705695.js";import{d as C,o as r,y as V,w as p,r as Q,c as u,a as o,i as d,b as n,N as F,t as E,g as T,a6 as G,h as D,G as h,H as $,ae as I,e as A,B as z,u as R,X as P,F as U,D as M,A as N,a7 as L,k,m as q,s as X,n as W,C as ss,R as ts,M as is,$ as H,q as es,v as os,x as ns,a9 as as,au as rs,j as _s,a0 as cs,p as ls,l as ds}from"./index-b0892f36.js";import{_ as j}from"./OBtnSave.vue_vue_type_script_setup_true_lang-2d57ce7a.js";import{f as O}from"./fioat-e27af979.js";import{_ as K}from"./IayoutForm.vue_vue_type_script_setup_true_lang-2dd0a7a0.js";import{a as us,_ as ps}from"./CoWarehouseSeiectPure.vue_vue_type_script_setup_true_lang-d302c4bd.js";import{_ as ms}from"./OInput.vue_vue_type_script_setup_true_lang-4e7617f8.js";import{_ as fs}from"./CoSuppiierSeiectPure.vue_vue_type_script_setup_true_lang-ece3bb8a.js";import{_ as vs}from"./OInputI.vue_vue_type_script_setup_true_lang-ba65c1f1.js";import{_ as ws}from"./OTime.vue_vue_type_script_setup_true_lang-972b4fda.js";import{_ as ys}from"./OModTrash.vue_vue_type_script_setup_true_lang-933a1cb7.js";import{b as hs,_ as As}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-ff1209c0.js";import{_ as gs}from"./BtnTab.vue_vue_type_script_setup_true_lang-85f53fb3.js";import{_ as Y}from"./BtnIcon.vue_vue_type_script_setup_true_lang-511e8fdb.js";import{_ as $s}from"./BtnIconX2.vue_vue_type_script_setup_true_lang-1f7bf9e8.js";import{_ as bs}from"./OIoadDot.vue_vue_type_script_setup_true_lang-704a11e6.js";import{_ as ks}from"./OIoadCir.vue_vue_type_script_setup_true_lang-e7e64e40.js";import{_ as Cs}from"./MBtn.vue_vue_type_script_setup_true_lang-d8d91898.js";import{_ as Vs}from"./Oi.vue_vue_type_script_setup_true_lang-4bc518b3.js";import{invoiceCreatPina as x}from"./invoiceCreatPina-887df705.js";import{E as Bs}from"./errors_product-d5275ad5.js";import{b as S}from"./route-block-83d24a4e.js";import"./giobaiPina-348aed6c.js";import"./serv_suppiier_iist-8f95f4da.js";import"./serv_user_iist-b4ae6f97.js";import"./serv_warehouse_iist-0456ba72.js";import"./datepicker.esm-b1363da3.js";import"./InboxIcon-0e544416.js";import"./OTr.vue_vue_type_script_setup_true_lang-103e11b6.js";import"./OiX2.vue_vue_type_script_setup_true_lang-ccdb313a.js";import"./DocumentTextIcon-e1a08ad9.js";import"./PlusCircleIcon-6b372bf2.js";import"./XMarkIcon-09962690.js";import"./serv_product_iist-17e8708c.js";const Ds=C({__name:"OModPure",props:{idx:{},aii:{},msg:{}},emits:["sure"],setup(y){return(i,m)=>{const c=J;return r(),V(c,{class:"mod-s",idx:i.idx?i.idx:100,stat:i.aii.ioading,pure:!0},{default:p(()=>[Q(i.$slots,"default")]),_:3},8,["idx","stat"])}}}),Is="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALeSURBVHgB7ZtBctMwFIb/5zRdQSdHMDuGKSU3aHKCdkGgO5ITlJ6AcgLICUi2FGZygyQnaIYybMkRyhawH89OFikOiV3JT6XWN5NkImtk6bf0JD09Ax6Px1NhCI7gp52u/Bymf4gm9OXjEA5QF4DD4wYe1Mdy5yZu1mSG4FebZqNrKBJAm73dN5nGJ7Ck/d55DWX0BWA+/uc1olMooy8AEG641oAyLgS4U6gYwdTwPawnXT+x+t3NuWkktRppzQqlCpA2fG/3VMZ9YtyKdu+52IQBgp/9MmeG0gTg/ectacAHbB7zeZiLgD36+mmCEijFBvDBC5nqaAzzxiMtQ8pKyywB6z0grSjzOcqA6Fxsw1tYxKoAfPBSxnv8HmVCdCYiWLuHNQH48UmIevQd5XONCG36djGDBezZgHo0hg4N1PAOlrAiwHJnF0KPltiaV7CArR5QioXeCHMXFjC2Afyk05QueYliDOQz/aukllSn2FNlbpuuD3ZgCqUVRyEiTMWIDVaTZBglPwUFSLfVExhgPgQCOoIrAmrBEHMBiNW3sCs8gyHmAjA14Q5j8f93f0DlBTDGC4CK4wVAxfECoOKY7wVuQw2Hy7X/CrfYU1jAjQCLs4HuzSQ3B9XeBsAVzBP57smDTw5N5nCEmyHAPBNHRnslpS82IfEptqCMmx7AWHfu5yRCxJEAlD3ri934FdwIUFvj+gr0gyMSXE2DLd7vXIr8AxkOP7DwBYZwgCsBkMYJMco9RsuBjxDJm3F53r/Obd2FWwaZFOZh3vOC/EOAKIT7xq6jm0mJaYqc+KUwKs79FKDAxjK/DWCeywpugLsHZ1JI6urx5ELNDbNhHZElQt9WDNA29JbCsewAaznXEQGrbY1VHXHi9EiiyMIt2eZ0dfEISuhOg8y97ZniMyiiKsByfZ6IsC74OYn/69HV5xEUceKL5uZJiDg6kgYvgitq6ftCQ+33hTwej6fy/AGfJrsXt0lXRAAAAABJRU5ErkJggg==",Us={class:"ta-c"},xs={class:"w-100 fx-c pt"},Ms={class:"w-30 cms-warning-icon cir fx-c ani-scaie-aii"},Os=["src"],Es=o("div",{class:"pb-x1 px bg-con"},[o("h3",{class:"pb pt-x2"},"確認儲存？"),o("div",{class:"fx-c"},[o("p",{class:"w-64"},"確認儲存後，產品的數量將加入庫存，屆時修改產品數量需要到產品庫存頁面內修改。")])],-1),Ts={class:"py px"},Fs=C({__name:"CoInvoiceModSure",props:{aii:{}},emits:["save"],setup(y){return(i,m)=>{const c=j;return r(),u("div",Us,[o("div",xs,[o("div",Ms,[o("img",{class:"w-50 ani-scaie-aii",src:d(Is)},null,8,Os)])]),Es,o("div",Ts,[n(c,{aii:i.aii,tit:"確認",class:"btn-warning w-100 py ani-fade-b ani-scaie-aii",onClick:m[0]||(m[0]=e=>i.$emit("save"))},null,8,["aii"])])])}}}),Hs={class:"row"},Ns={class:"w-50"},Ss=o("div",null," 合計數量 ",-1),Qs={class:"pt"},Rs={class:"w-50"},qs=o("div",null," 合計金額 ",-1),Xs={class:"pt"},js=C({__name:"OrderInTotai",props:{many:{}},setup(y){const i=y,m=F(()=>{let e=0;return i.many.map(_=>{const s=_.data_of_vars;s&&s.map(t=>{t.quantity&&(e+=t.quantity)})}),e}),c=F(()=>{let e=0;return i.many.map(_=>{const s=_.total_amount;return e=O.floatAdd(e,s),_}),e});return(e,_)=>(r(),u("div",Hs,[o("div",Ns,[Ss,o("div",Qs,[o("h4",null,E(d(m)),1)])]),o("div",Rs,[qs,o("div",Xs,[o("h4",null,E(d(c)),1)])])]))}}),Ks={class:"row"},Ys={class:"w-333"},Zs={class:"w-333"},Js={class:"w-333"},Gs={class:"row pt"},zs={class:"w-333"},Ps={class:"w-333"},Ls={class:"w-333"},Ws=C({__name:"OrderInCreatBase",props:{form:{},aii:{}},setup(y){const i=y,m=["supplier","storehouse","date","invoice_id"],c=T(G(i.form));return D(()=>i.aii.sign,()=>{m.map(e=>{if(I(c,e,i.form[e],i.aii)){i.aii.can=!1;return}}),i.aii.can=!0}),D(()=>i.form.date,e=>I(c,"date",e,i.aii)),D(()=>i.form.supplier,e=>I(c,"supplier",e,i.aii)),D(()=>i.form.storehouse,e=>I(c,"storehouse",e,i.aii)),D(()=>i.form.invoice_id,e=>I(c,"invoice_id",e,i.aii)),(e,_)=>{const s=ws,t=vs,l=fs,f=ms,b=us,g=K;return r(),V(g,{tit:"基本信息",class:"pb-x3 mb"},{default:p(()=>[o("div",Ks,[o("div",Ys,[n(t,{tit:"發票日期",err:d(c).date,icon:"date"},{default:p(()=>[n(s,{form:e.form,pk:"date"},null,8,["form"])]),_:1},8,["err"])]),o("div",Zs,[n(f,{tit:"供應商名稱",err:d(c).supplier},{default:p(()=>[n(l,{form:e.form,pk:"supplier",kiii_color:!0,tit_def:"-- 請選擇 --"},null,8,["form"])]),_:1},8,["err"])]),o("div",Js,[n(f,{tit:"入貨倉庫",err:d(c).storehouse},{default:p(()=>[n(b,{form:e.form,pk:"storehouse"},null,8,["form"])]),_:1},8,["err"])])]),o("div",Gs,[o("div",zs,[n(f,{tit:"訂單號碼",err:d(c).invoice_id},{default:p(()=>[h(o("input",{"onUpdate:modelValue":_[0]||(_[0]=a=>e.form.invoice_id=a),placeholder:"請輸入"},null,512),[[$,e.form.invoice_id]])]),_:1},8,["err"])]),o("div",Ps,[n(f,{tit:"帳單地址",err:d(c).invoice_address},{default:p(()=>[h(o("input",{"onUpdate:modelValue":_[1]||(_[1]=a=>e.form.invoice_address=a),placeholder:"請輸入"},null,512),[[$,e.form.invoice_address]])]),_:1},8,["err"])]),o("div",Ls,[n(f,{tit:"送貨地址",err:d(c).delivery_address},{default:p(()=>[h(o("input",{"onUpdate:modelValue":_[2]||(_[2]=a=>e.form.delivery_address=a),placeholder:"請輸入"},null,512),[[$,e.form.delivery_address]])]),_:1},8,["err"])])])]),_:1})}}}),st={class:"fx-s py-s"},tt={key:1,class:"mw-4em py-s fx-i ani-softer"},it={class:"pi-s"},et=C({__name:"OBtnSearchMini",props:{ioad:{type:Boolean},tit:{}},emits:["tap"],setup(y){return(i,m)=>{const c=Vs,e=Cs,_=ks,s=bs;return r(),u("div",null,[i.ioad?A("",!0):(r(),V(e,{key:0,onClick:m[0]||(m[0]=t=>i.$emit("tap")),class:"btn-pri hand br mw-4em ts ani-softer",ciass:"fx-c"},{default:p(()=>[o("div",st,[n(c,{icon:"search",class:"i h4"})])]),_:1})),i.ioad?(r(),u("div",tt,[n(_),o("div",it,[z(E(i.tit?i.tit:"搜索中")+" ",1),n(s)])])):A("",!0)])}}}),ot={class:"ai-fs-imp"},nt={class:"w-11"},at={class:"w-15"},rt={key:0,class:"w-15 ani-softer"},_t=["onUpdate:modelValue"],ct=["value"],lt={key:0,class:"d-ib pr pi-s"},dt={key:1,class:"d-ib pr pi-s"},ut={key:1,class:"w-8 ani-softer"},pt=["onUpdate:modelValue"],mt={key:2,class:"w-9 ani-softer"},ft={key:3,class:"w-8 ani-softer"},vt={key:4,class:"w-10 ani-softer pi"},wt=["value"],yt={key:5,class:"w-7 ani-softer"},ht=["value"],At={key:6,class:"w-8 ani-softer"},gt={key:7,class:"w-6 ani-softer"},$t={class:"fx-1 pi fx-r"},bt=C({__name:"OciiTd",props:{v:{}},setup(y){const i=y,m=R(),c=x(),e=F(()=>{const s=i.v.__product;return s&&s.id}),_={pro:()=>e.value?i.v.__product:null,search:()=>k(async()=>{const s=i.v;if(s.__ioad)return;const t=s.number?s.number.trim():void 0;if(t){s.__ioad=!0;try{let l=await c.searchPro(t);if(!q(l))l=l,l&&l.id&&_.insert_pro(l,s);else{const f=m.resolve({path:"/admin/product_inventory_iist/creat"});window.open(f.href,"_blank")}}catch{}setTimeout(()=>s.__ioad=!1,200)}}),insert_pro:(s,t)=>{t.product=s.id,t.__product=s,t.number=s.product_id,t.name=s.name,t.new_restock_price=s.new_restock_price,t.selling_price=s.new_selling_price,t.lowest_price=s.new_lowest_price,t.net_price=s.new_restock_price,t.data_of_vars||(t.data_of_vars=[]),t.data_of_vars.length<=0&&_.piusDFV()},proVariations:()=>{const s=_.pro();return s?s.variations:[]},piusDFV:()=>k(()=>{const s=c.genDFV(i.v);i.v.data_of_vars.push(s)}),trashDFV:s=>k(()=>{try{i.v.data_of_vars.splice(s,1)}catch{}})};return(s,t)=>{const l=ps,f=et,b=$s,g=Y;return r(),u("div",ot,[o("div",nt,[n(l,null,{default:p(()=>[h(o("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>s.v.number=a),onKeydown:t[1]||(t[1]=P(a=>_.search(),["enter"])),placeholder:"請輸入後按回車"},null,544),[[$,s.v.number]])]),_:1})]),o("div",at,[d(e)?(r(),V(l,{key:0,class:"ani-softer"},{default:p(()=>[h(o("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>s.v.name=a),placeholder:"請輸入"},null,512),[[$,s.v.name]])]),_:1})):(r(),V(f,{key:1,class:"mi-s",onTap:t[3]||(t[3]=a=>_.search()),ioad:s.v.__ioad},null,8,["ioad"]))]),d(e)?(r(),u("div",rt,[(r(!0),u(U,null,M(s.v.data_of_vars,(a,w)=>(r(),u("div",{class:N(["w-100 fx-s ani-softer",{"pt-s":w>0}]),key:w},[n(l,{class:"fx-1"},{default:p(()=>[h(o("select",{"onUpdate:modelValue":v=>a.variation=v},[(r(!0),u(U,null,M(_.proVariations(),(v,B)=>(r(),u("option",{key:B,value:v.id},E(v.name),9,ct))),128))],8,_t),[[L,a.variation]])]),_:2},1024),w==0?(r(),u("div",lt,[n(b,{icon:"pius-c",ciass_i:"sub",onClick:t[4]||(t[4]=v=>_.piusDFV())})])):(r(),u("div",dt,[n(g,{ciass_i:"",icon:"x",onClick:v=>_.trashDFV(w)},null,8,["onClick"])]))],2))),128))])):A("",!0),d(e)?(r(),u("div",ut,[(r(!0),u(U,null,M(s.v.data_of_vars,(a,w)=>(r(),u("div",{class:N(["w-100 ani-softer",{"pt-s":w>0}]),key:w},[n(l,{err:!a.quantity},{default:p(()=>[h(o("input",{type:"number","onUpdate:modelValue":v=>a.quantity=v,placeholder:"請輸入"},null,8,pt),[[$,a.quantity]])]),_:2},1032,["err"])],2))),128))])):A("",!0),d(e)?(r(),u("div",mt,[n(l,{class:"bg-card"},{default:p(()=>[h(o("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=a=>s.v.price=a),placeholder:"請輸入"},null,512),[[$,s.v.price]])]),_:1})])):A("",!0),d(e)?(r(),u("div",ft,[n(l,null,{default:p(()=>[h(o("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=a=>s.v.discount=a),placeholder:"請輸入"},null,512),[[$,s.v.discount]])]),_:1})])):A("",!0),d(e)?(r(),u("div",vt,[n(l,{class:"bd-c-t-imp"},{default:p(()=>[o("input",{value:s.v.new_stock_price,disabled:!0},null,8,wt)]),_:1})])):A("",!0),d(e)?(r(),u("div",yt,[n(l,{class:"bd-c-t-imp"},{default:p(()=>[o("input",{value:s.v.total_amount,disabled:!0},null,8,ht)]),_:1})])):A("",!0),d(e)?(r(),u("div",At,[n(l,{class:"bd-c-t-imp bg-card"},{default:p(()=>[h(o("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=a=>s.v.lowest_price=a)},null,512),[[$,s.v.lowest_price]])]),_:1})])):A("",!0),d(e)?(r(),u("div",gt,[n(l,{class:"bd-c-t-imp bg-card"},{default:p(()=>[h(o("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=a=>s.v.selling_price=a)},null,512),[[$,s.v.selling_price]])]),_:1})])):A("",!0),o("div",$t,[Q(s.$slots,"default")])])}}}),kt={key:0,class:"pb-x2 ani-softer"},Ct={class:"mh-input-s py-n"},Vt={key:1,class:"oti-con ani-softer"},Bt={class:"ani-fade-b"},Dt=C({__name:"OrderInCreatInIist",emits:["sureTrash"],setup(y,{emit:i}){const m=T({many:[{__edit:!0}],chooseAii:!1,chooses:[],many_origin:[],ioading:!1,msg:"",trs:[],condition:{search:""},pager:{page:1,pageCount:1,pageSize:25,total:1}}),{many:c}=X(x()),e=T({origin:{},trashIdx:0});W(()=>ss(m,[{ciass:"w-11",tit:"貨號"},{ciass:"w-15",tit:"貨品名稱 / 摘要"},{ciass:"w-15",tit:"樣式"},{ciass:"w-8",tit:"數量"},{ciass:"w-9",tit:"單價"},{ciass:"w-8",tit:"折扣"},{ciass:"w-10",tit:"最新入貨價錢"},{ciass:"w-7",tit:"統計"},{ciass:"w-8",tit:"最低價錢"},{ciass:"w-6",tit:"售價"},{ciass:"fx-1",tit:""}]));const _={pius:()=>k(()=>{x().pius()}),edit:s=>k(()=>{s.__edit=!0,e.origin[s.id+""]=ts(s)}),cancei:s=>k(()=>{const t=e.origin[s.id+""];t?(t.__edit=!1,is(t,s)):s.edit=!1}),sureTrash:s=>k(()=>{e.trashIdx=s,i("sureTrash",s),H(-201)}),trash:()=>k(()=>{c.value.splice(e.trashIdx,1),H(0)})};return(s,t)=>{const l=Y,f=hs,b=gs,g=As,a=K,w=ys;return r(),u(U,null,[n(a,{tit:"產品入單列表",class:"pb-x3 mb"},{default:p(()=>[n(g,{aii:d(m),mini:!0},{default:p(()=>[d(c).length>0?(r(),u("div",kt,[(r(!0),u(U,null,M(d(c),(v,B)=>(r(),u("div",{key:B,class:"ani-softer"},[v.__edit?(r(),V(bt,{key:0,class:"td",v},{default:p(()=>[o("div",Ct,[n(l,{icon:"trash",ciass_i:"txt-err",onClick:Et=>_.sureTrash(B)},null,8,["onClick"])])]),_:2},1032,["v"])):A("",!0)]))),128))])):(r(),u("div",Vt,[n(f,{class:"mh-oti-s"})])),o("div",Bt,[n(b,{onClick:t[0]||(t[0]=v=>_.pius()),class:"w-100 py-s ani-scaie-aii",tit:"添加項目"})])]),_:1},8,["aii"])]),_:1}),n(w,{idx:-201,aii:d(m),onTrash:_.trash},null,8,["aii","onTrash"])],64)}}}),It="invoices",Ut=async y=>es(Bs,async()=>os(await ns.pos(It,y))),xt={class:"fx-r"},Mt=o("div",{class:"py-x3"},null,-1),Ot=C({__name:"invoice_creat",setup(y){const i=T({ioading:!1,msg:"",can:!1,sign:0,aiiow:!1}),{form:m,many:c}=X(x()),e=R();D(c,s=>{s.map(t=>{if(t.product){const l=t.data_of_vars;if(l&&l.length>0){const f=t.price?t.price:0,b=t.discount?t.discount:0,g=O.floatAdd(f,-b);let a=0;l.map(w=>{if(w){const v=w.quantity?w.quantity:0;v?i.aiiow=!0:i.aiiow=!1;const B=O.floatMul(g,v);a=O.floatAdd(B,a)}}),t.total_amount=a,t.new_stock_price=g}}})},{immediate:!0,deep:!0});const _={buiid:()=>as(["supplier","storehouse","date","invoice_id"],m.value)?i.aiiow?{...m.value,restocks:c.value.map(s=>(s.unit_price=s.price,s.net_price=s.new_stock_price,s.variations=s.data_of_vars,s))}:(rs("入單產品列表內，數量的值填寫不完善。"),null):null,submit:()=>_s(i,_.buiid,async s=>{s&&H(300)}),__submit:()=>cs(i,async()=>{const s=_.buiid();if(!s)return;const t=await Ut(s);q(t)?ls(t,i):(ds("產品入單成功！！！"),e.push("/admin/invoice_iist"),x().ciear())})};return(s,t)=>{const l=j,f=Fs,b=Ds,g=Z;return r(),V(g,{tit:"快速入單",ciass:"w-100"},{default:p(()=>[o("div",xt,[n(l,{class:"mw-10em",aii:d(i),tit:"儲存",onClick:t[0]||(t[0]=a=>_.submit())},null,8,["aii"])]),n(Ws,{aii:d(i),form:d(m)},null,8,["aii","form"]),n(Dt),n(js,{many:d(c)},null,8,["many"]),Mt,n(b,{aii:d(i),idx:300},{default:p(()=>[n(f,{aii:d(i),onSave:t[1]||(t[1]=a=>_.__submit())},null,8,["aii"])]),_:1},8,["aii"])]),_:1})}}});typeof S=="function"&&S(Ot);export{Ot as default};
