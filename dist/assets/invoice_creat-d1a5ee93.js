import{_ as z}from"./IayoutPan.vue_vue_type_script_setup_true_lang-164e948d.js";import{_ as G}from"./ModInner.vue_vue_type_script_setup_true_lang-e0e37677.js";import{d as C,o as _,y as V,w as m,r as R,c as p,a as n,i as u,b as a,H as E,t as O,g as M,a6 as P,h as D,B as h,C as A,ae as x,u as X,X as L,F as I,A as N,D as q,a7 as W,e as $,k,m as j,s as K,n as ss,z as ts,R as is,N as es,$ as T,q as os,v as ns,x as as,f as rs,a9 as _s,au as S,j as cs,a0 as ls,p as ds,l as us}from"./index-b83fe83c.js";import{_ as Y}from"./OBtnSave.vue_vue_type_script_setup_true_lang-c3403d4e.js";import{f as U}from"./fioat-7d61d7cc.js";import{_ as Z}from"./IayoutForm.vue_vue_type_script_setup_true_lang-89347f62.js";import{a as ps,_ as ms}from"./CoWarehouseSeiectPure.vue_vue_type_script_setup_true_lang-545248a8.js";import{_ as fs}from"./OInput.vue_vue_type_script_setup_true_lang-c072393a.js";import{_ as vs}from"./CoSuppiierSeiectPure.vue_vue_type_script_setup_true_lang-5b7eaf04.js";import{_ as ws}from"./OInputI.vue_vue_type_script_setup_true_lang-34cd7ac1.js";import{_ as ys}from"./OTime.vue_vue_type_script_setup_true_lang-e08da59f.js";import{_ as hs}from"./OModTrash.vue_vue_type_script_setup_true_lang-e850cfed.js";import{b as As,_ as gs}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-3d27479b.js";import{_ as bs}from"./BtnTab.vue_vue_type_script_setup_true_lang-d3c7d61f.js";import{_ as J}from"./BtnIcon.vue_vue_type_script_setup_true_lang-acae5064.js";import{_ as $s}from"./BtnIconX2.vue_vue_type_script_setup_true_lang-73e65e19.js";import{_ as ks}from"./MBtn.vue_vue_type_script_setup_true_lang-a8799432.js";import{_ as Cs}from"./OIoadCir.vue_vue_type_script_setup_true_lang-557d7b22.js";import{_ as Bs}from"./Oi.vue_vue_type_script_setup_true_lang-0e1790fe.js";import{invoiceCreatPina as F}from"./invoiceCreatPina-1bfe6fdf.js";import{E as Vs}from"./errors_product-d5275ad5.js";import{b as Q}from"./route-block-83d24a4e.js";import"./OIoadDot.vue_vue_type_script_setup_true_lang-3049ae93.js";import"./giobaiPina-410b1390.js";import"./serv_suppiier_iist-ccfc935b.js";import"./serv_user_iist-db5c40dc.js";import"./serv_warehouse_iist-6e9e18e7.js";import"./datepicker.esm-2d4150ca.js";import"./InboxIcon-56b8e6e8.js";import"./OTr.vue_vue_type_script_setup_true_lang-5067dcb9.js";import"./OiX2.vue_vue_type_script_setup_true_lang-1a64655e.js";import"./DocumentTextIcon-ee1b947a.js";import"./PlusCircleIcon-c338051d.js";import"./XMarkIcon-ed7feea7.js";import"./serv_product_iist-30272330.js";const Ds=C({__name:"OModPure",props:{idx:{},aii:{},msg:{}},emits:["sure"],setup(y){return(o,v)=>{const l=G;return _(),V(l,{class:"mod-s",idx:o.idx?o.idx:100,stat:o.aii.ioading,pure:!0},{default:m(()=>[R(o.$slots,"default")]),_:3},8,["idx","stat"])}}}),xs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALeSURBVHgB7ZtBctMwFIb/5zRdQSdHMDuGKSU3aHKCdkGgO5ITlJ6AcgLICUi2FGZygyQnaIYybMkRyhawH89OFikOiV3JT6XWN5NkImtk6bf0JD09Ax6Px1NhCI7gp52u/Bymf4gm9OXjEA5QF4DD4wYe1Mdy5yZu1mSG4FebZqNrKBJAm73dN5nGJ7Ck/d55DWX0BWA+/uc1olMooy8AEG641oAyLgS4U6gYwdTwPawnXT+x+t3NuWkktRppzQqlCpA2fG/3VMZ9YtyKdu+52IQBgp/9MmeG0gTg/ectacAHbB7zeZiLgD36+mmCEijFBvDBC5nqaAzzxiMtQ8pKyywB6z0grSjzOcqA6Fxsw1tYxKoAfPBSxnv8HmVCdCYiWLuHNQH48UmIevQd5XONCG36djGDBezZgHo0hg4N1PAOlrAiwHJnF0KPltiaV7CArR5QioXeCHMXFjC2Afyk05QueYliDOQz/aukllSn2FNlbpuuD3ZgCqUVRyEiTMWIDVaTZBglPwUFSLfVExhgPgQCOoIrAmrBEHMBiNW3sCs8gyHmAjA14Q5j8f93f0DlBTDGC4CK4wVAxfECoOKY7wVuQw2Hy7X/CrfYU1jAjQCLs4HuzSQ3B9XeBsAVzBP57smDTw5N5nCEmyHAPBNHRnslpS82IfEptqCMmx7AWHfu5yRCxJEAlD3ri934FdwIUFvj+gr0gyMSXE2DLd7vXIr8AxkOP7DwBYZwgCsBkMYJMco9RsuBjxDJm3F53r/Obd2FWwaZFOZh3vOC/EOAKIT7xq6jm0mJaYqc+KUwKs79FKDAxjK/DWCeywpugLsHZ1JI6urx5ELNDbNhHZElQt9WDNA29JbCsewAaznXEQGrbY1VHXHi9EiiyMIt2eZ0dfEISuhOg8y97ZniMyiiKsByfZ6IsC74OYn/69HV5xEUceKL5uZJiDg6kgYvgitq6ftCQ+33hTwej6fy/AGfJrsXt0lXRAAAAABJRU5ErkJggg==",Is={class:"ta-c"},Fs={class:"w-100 fx-c pt"},Ns={class:"w-30 cms-warning-icon cir fx-c ani-scaie-aii"},Us=["src"],Ms=n("div",{class:"pb-x1 px bg-con"},[n("h3",{class:"pb pt-x2"},"確認儲存？"),n("div",{class:"fx-c"},[n("p",{class:"w-64"},"確認儲存後，產品的數量將加入庫存，屆時修改產品數量需要到產品庫存頁面內修改。")])],-1),Es={class:"py px"},Os=C({__name:"CoInvoiceModSure",props:{aii:{}},emits:["save"],setup(y){return(o,v)=>{const l=Y;return _(),p("div",Is,[n("div",Fs,[n("div",Ns,[n("img",{class:"w-50 ani-scaie-aii",src:u(xs)},null,8,Us)])]),Ms,n("div",Es,[a(l,{aii:o.aii,tit:"確認",class:"btn-warning w-100 py ani-fade-b ani-scaie-aii",onClick:v[0]||(v[0]=i=>o.$emit("save"))},null,8,["aii"])])])}}}),Ts={class:"row"},Hs={class:"w-50"},qs=n("div",null," 合計數量 ",-1),Ss={class:"pt"},Qs={class:"w-50"},Rs=n("div",null," 合計金額 ",-1),Xs={class:"pt"},js=C({__name:"OrderInTotai",props:{many:{}},setup(y){const o=y,v=E(()=>{let i=0;return o.many.map(c=>{const s=c.data_of_vars;s&&s.map(t=>{t.quantity&&(i+=t.quantity)})}),i}),l=E(()=>{let i=0;return o.many.map(c=>{const s=c.total_amount;return i=U.floatAdd(i,s),c}),i.toFixed(2)});return(i,c)=>(_(),p("div",Ts,[n("div",Hs,[qs,n("div",Ss,[n("h4",null,O(u(v)),1)])]),n("div",Qs,[Rs,n("div",Xs,[n("h4",null,O(u(l)),1)])])]))}}),Ks={class:"row"},Ys={class:"w-333"},Zs={class:"w-333"},Js={class:"w-333"},zs={class:"row pt"},Gs={class:"w-333"},Ps={class:"w-333"},Ls={class:"w-333"},Ws=C({__name:"OrderInCreatBase",props:{form:{},aii:{}},setup(y){const o=y,v=["supplier","storehouse","date","invoice_id"],l=M(P(o.form));return D(()=>o.aii.sign,()=>{v.map(i=>{if(x(l,i,o.form[i],o.aii)){o.aii.can=!1;return}}),o.aii.can=!0}),D(()=>o.form.date,i=>x(l,"date",i,o.aii)),D(()=>o.form.supplier,i=>x(l,"supplier",i,o.aii)),D(()=>o.form.storehouse,i=>x(l,"storehouse",i,o.aii)),D(()=>o.form.invoice_id,i=>x(l,"invoice_id",i,o.aii)),(i,c)=>{const s=ys,t=ws,e=vs,d=fs,g=ps,b=Z;return _(),V(b,{tit:"基本信息",class:"pb-x3 mb"},{default:m(()=>[n("div",Ks,[n("div",Ys,[a(t,{tit:"發票日期",err:u(l).date,icon:"date"},{default:m(()=>[a(s,{form:i.form,pk:"date"},null,8,["form"])]),_:1},8,["err"])]),n("div",Zs,[a(d,{tit:"供應商名稱",err:u(l).supplier},{default:m(()=>[a(e,{form:i.form,pk:"supplier",kiii_color:!0,tit_def:"-- 請選擇 --"},null,8,["form"])]),_:1},8,["err"])]),n("div",Js,[a(d,{tit:"入貨倉庫",err:u(l).storehouse},{default:m(()=>[a(g,{form:i.form,pk:"storehouse"},null,8,["form"])]),_:1},8,["err"])])]),n("div",zs,[n("div",Gs,[a(d,{tit:"訂單號碼",err:u(l).invoice_id},{default:m(()=>[h(n("input",{"onUpdate:modelValue":c[0]||(c[0]=r=>i.form.invoice_id=r),placeholder:"請輸入"},null,512),[[A,i.form.invoice_id]])]),_:1},8,["err"])]),n("div",Ps,[a(d,{tit:"帳單地址",err:u(l).invoice_address},{default:m(()=>[h(n("input",{"onUpdate:modelValue":c[1]||(c[1]=r=>i.form.invoice_address=r),placeholder:"請輸入"},null,512),[[A,i.form.invoice_address]])]),_:1},8,["err"])]),n("div",Ls,[a(d,{tit:"送貨地址",err:u(l).delivery_address},{default:m(()=>[h(n("input",{"onUpdate:modelValue":c[2]||(c[2]=r=>i.form.delivery_address=r),placeholder:"請輸入"},null,512),[[A,i.form.delivery_address]])]),_:1},8,["err"])])])]),_:1})}}}),st={key:0,class:"ani-softer fx-s"},tt={key:1,class:"mxh-1em ani-softer"},it=C({__name:"OBtnSearchMini",props:{ioad:{type:Boolean}},setup(y){return(o,v)=>{const l=Bs,i=Cs,c=ks;return _(),V(c,{class:"btn-pri hand br mw-4em",ciass:"fx-c"},{default:m(()=>[o.ioad?(_(),p("div",tt,[a(i,{class:"h5",styie:"wht"})])):(_(),p("div",st,[a(l,{icon:"search",class:"i h4"})]))]),_:1})}}}),et={class:"ai-fs-imp"},ot={class:"w-11"},nt={class:"w-15"},at={key:0,class:"w-15 ani-softer"},rt=["onUpdate:modelValue"],_t=["value"],ct={key:0,class:"d-ib pr pi-s"},lt={key:1,class:"d-ib pr pi-s"},dt={key:1,class:"w-8 ani-softer"},ut=["onUpdate:modelValue"],pt={key:2,class:"w-9 ani-softer"},mt={key:3,class:"w-8 ani-softer"},ft={key:4,class:"w-10 ani-softer pi"},vt=["value"],wt={key:5,class:"w-7 ani-softer"},yt=["value"],ht={key:6,class:"w-7 ani-softer"},At={key:7,class:"w-7 ani-softer"},gt={class:"fx-1 pi fx-r"},bt=C({__name:"OciiTd",props:{v:{}},setup(y){const o=y,v=X(),l=F(),i=E(()=>{const s=o.v.__product;return s&&s.id}),c={pro:()=>i.value?o.v.__product:null,search:()=>k(async()=>{const s=o.v;if(s.__ioad)return;const t=s.number?s.number.trim():void 0;if(t){s.__ioad=!0;try{let e=await l.searchPro(t);if(!j(e))e=e,e&&e.id&&c.insert_pro(e,s);else{const d=v.resolve({path:"/admin/product_inventory_iist/creat"});window.open(d.href,"_blank")}}catch{}setTimeout(()=>s.__ioad=!1,200)}}),insert_pro:(s,t)=>{t.product=s.id,t.__product=s,t.number=s.product_id,t.name=s.name,t.new_restock_price=s.new_restock_price,t.selling_price=s.new_selling_price,t.lowest_price=s.new_lowest_price,t.net_price=s.new_restock_price,t.data_of_vars||(t.data_of_vars=[]),t.data_of_vars.length<=0&&c.piusDFV()},proVariations:()=>{const s=c.pro();return s?s.variations:[]},piusDFV:()=>k(()=>{const s=l.genDFV(o.v);o.v.data_of_vars.push(s)}),trashDFV:s=>k(()=>{try{o.v.data_of_vars.splice(s,1)}catch{}})};return(s,t)=>{const e=ms,d=it,g=$s,b=J;return _(),p("div",et,[n("div",ot,[a(e,null,{default:m(()=>[h(n("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>s.v.number=r),onKeydown:t[1]||(t[1]=L(r=>c.search(),["enter"])),placeholder:"請輸入後按回車"},null,544),[[A,s.v.number]])]),_:1})]),n("div",nt,[u(i)?(_(),V(e,{key:0,class:"ani-softer"},{default:m(()=>[h(n("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>s.v.name=r),placeholder:"請輸入"},null,512),[[A,s.v.name]])]),_:1})):(_(),V(d,{key:1,class:"mi-s mh-2em",onTap:t[3]||(t[3]=r=>c.search()),ioad:s.v.__ioad},null,8,["ioad"]))]),u(i)?(_(),p("div",at,[(_(!0),p(I,null,N(s.v.data_of_vars,(r,w)=>(_(),p("div",{class:q(["w-100 fx-s ani-softer",{"pt-s":w>0}]),key:w},[a(e,{class:"fx-1"},{default:m(()=>[h(n("select",{"onUpdate:modelValue":f=>r.variation=f},[(_(!0),p(I,null,N(c.proVariations(),(f,B)=>(_(),p("option",{key:B,value:f.id},O(f.name),9,_t))),128))],8,rt),[[W,r.variation]])]),_:2},1024),w==0?(_(),p("div",ct,[a(g,{icon:"pius-c",ciass_i:"sub",onClick:t[4]||(t[4]=f=>c.piusDFV())})])):(_(),p("div",lt,[a(b,{ciass_i:"",icon:"x",onClick:f=>c.trashDFV(w)},null,8,["onClick"])]))],2))),128))])):$("",!0),u(i)?(_(),p("div",dt,[(_(!0),p(I,null,N(s.v.data_of_vars,(r,w)=>(_(),p("div",{class:q(["w-100 ani-softer",{"pt-s":w>0}]),key:w},[a(e,{err:!r.quantity},{default:m(()=>[h(n("input",{type:"number","onUpdate:modelValue":f=>r.quantity=f,placeholder:"請輸入正數"},null,8,ut),[[A,r.quantity]])]),_:2},1032,["err"])],2))),128))])):$("",!0),u(i)?(_(),p("div",pt,[a(e,{class:"bg-card"},{default:m(()=>[h(n("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=r=>s.v.price=r),placeholder:"請輸入金錢"},null,512),[[A,s.v.price]])]),_:1})])):$("",!0),u(i)?(_(),p("div",mt,[a(e,null,{default:m(()=>[h(n("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=r=>s.v.discount=r),placeholder:"0至1的小數"},null,512),[[A,s.v.discount]])]),_:1})])):$("",!0),u(i)?(_(),p("div",ft,[a(e,{class:"bd-c-t-imp"},{default:m(()=>[n("input",{value:s.v.new_stock_price,disabled:!0},null,8,vt)]),_:1})])):$("",!0),u(i)?(_(),p("div",wt,[a(e,{class:"bd-c-t-imp"},{default:m(()=>[n("input",{value:s.v.total_amount,disabled:!0},null,8,yt)]),_:1})])):$("",!0),u(i)?(_(),p("div",ht,[a(e,{class:"bg-card",err:s.v.lowest_price>s.v.selling_price},{default:m(()=>[h(n("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=r=>s.v.lowest_price=r),placeholder:"請輸入金錢"},null,512),[[A,s.v.lowest_price]])]),_:1},8,["err"])])):$("",!0),u(i)?(_(),p("div",At,[a(e,{class:"bg-card"},{default:m(()=>[h(n("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=r=>s.v.selling_price=r),placeholder:"請輸入金錢"},null,512),[[A,s.v.selling_price]])]),_:1})])):$("",!0),n("div",gt,[R(s.$slots,"default")])])}}}),$t={key:0,class:"pb-x2 ani-softer"},kt={class:"mh-input-s py-n"},Ct={key:1,class:"oti-con ani-softer"},Bt={class:"ani-fade-b"},Vt=C({__name:"OrderInCreatInIist",emits:["sureTrash"],setup(y,{emit:o}){const v=M({many:[{__edit:!0}],chooseAii:!1,chooses:[],many_origin:[],ioading:!1,msg:"",trs:[],condition:{search:""},pager:{page:1,pageCount:1,pageSize:25,total:1}}),{many:l}=K(F()),i=M({origin:{},trashIdx:0});ss(()=>ts(v,[{ciass:"w-11",tit:"貨號"},{ciass:"w-15",tit:"貨品名稱 / 摘要"},{ciass:"w-15",tit:"樣式"},{ciass:"w-8",tit:"數量"},{ciass:"w-9",tit:"單價"},{ciass:"w-8",tit:"折扣 %"},{ciass:"w-10",tit:"最新入貨價錢"},{ciass:"w-7",tit:"統計"},{ciass:"w-8",tit:"最低價錢"},{ciass:"w-6",tit:"售價"},{ciass:"fx-1",tit:""}]));const c={pius:()=>k(()=>{F().pius()}),edit:s=>k(()=>{s.__edit=!0,i.origin[s.id+""]=is(s)}),cancei:s=>k(()=>{const t=i.origin[s.id+""];t?(t.__edit=!1,es(t,s)):s.edit=!1}),sureTrash:s=>k(()=>{i.trashIdx=s,o("sureTrash",s),T(-201)}),trash:()=>k(()=>{l.value.splice(i.trashIdx,1),T(0)})};return(s,t)=>{const e=J,d=As,g=bs,b=gs,r=Z,w=hs;return _(),p(I,null,[a(r,{tit:"產品入單列表",class:"pb-x3 mb"},{default:m(()=>[a(b,{aii:u(v),mini:!0},{default:m(()=>[u(l).length>0?(_(),p("div",$t,[(_(!0),p(I,null,N(u(l),(f,B)=>(_(),p("div",{key:B,class:"ani-softer"},[f.__edit?(_(),V(bt,{key:0,class:"td",v:f},{default:m(()=>[n("div",kt,[a(e,{icon:"trash",ciass_i:"txt-err",onClick:H=>c.sureTrash(B)},null,8,["onClick"])])]),_:2},1032,["v"])):$("",!0)]))),128))])):(_(),p("div",Ct,[a(d,{class:"mh-oti-s"})])),n("div",Bt,[a(g,{onClick:t[0]||(t[0]=f=>c.pius()),class:"w-100 py-s ani-scaie-aii",tit:"添加項目"})])]),_:1},8,["aii"])]),_:1}),a(w,{idx:-201,aii:u(v),onTrash:c.trash},null,8,["aii","onTrash"])],64)}}}),Dt="invoices",xt=async y=>os(Vs,async()=>ns(await as.pos(Dt,y))),It={class:"fx-r"},Ft=n("div",{class:"py-x3"},null,-1),Nt=C({__name:"invoice_creat",setup(y){const o=M({ioading:!1,msg:"",can:!1,sign:0,aiiow:!1}),{form:v,many:l}=K(F()),i=X();D(l,t=>k(()=>{t.map(e=>{if(e.product){const d=e.data_of_vars;if(d&&d.length>0){isNaN(e.price)&&(e.price=0);const g=e.price?e.price:0;(isNaN(e.discount)||e.discount>1||e.discount<0)&&(e.discount=1);const b=e.discount?e.discount:1,r=U.floatMul(g,b);let w=0;d.map(f=>{if(f){(isNaN(f.quantity)||f.quantity<0)&&(f.quantity=0);const B=f.quantity?f.quantity:0;B?o.aiiow=!0:o.aiiow=!1;const H=U.floatMul(r,B);w=U.floatAdd(H,w)}}),e.total_amount=parseFloat(w.toFixed(2)),e.new_stock_price=parseFloat(r.toFixed(2))}}})}),{immediate:!0,deep:!0});const c=rs(0),s={buiid:()=>{if(!_s(["supplier","storehouse","date","invoice_id"],v.value))return null;if(!o.aiiow)return S("入單產品列表內，數量的值填寫不完善。"),null;let t=!0;const e={...v.value,restocks:l.value.map(d=>(console.log(d),d.lowest_price>d.selling_price&&(S("入貨時，最低價錢不能超過售價！！！"),t=!1),d.unit_price=d.price,d.net_price=d.new_stock_price,d.variations=d.data_of_vars,d))};return t?e:null},submit:()=>cs(o,s.buiid,async t=>{t&&T(300)}),__submit:()=>ls(o,async()=>{const t=s.buiid();if(!t||c.value==1)return;c.value=1,console.log(t);const e=await xt(t);j(e)?ds(e,o):(us("產品入單成功！！！"),i.push("/admin/invoice_iist"),F().ciear()),c.value=0})};return(t,e)=>{const d=Y,g=Os,b=Ds,r=z;return _(),V(r,{tit:"快速入單",ciass:"w-100"},{default:m(()=>[n("div",It,[a(d,{class:"mw-10em",aii:u(o),tit:"儲存",onClick:e[0]||(e[0]=w=>s.submit())},null,8,["aii"])]),a(Ws,{aii:u(o),form:u(v)},null,8,["aii","form"]),a(Vt),a(js,{many:u(l)},null,8,["many"]),Ft,a(b,{aii:u(o),idx:300},{default:m(()=>[a(g,{aii:u(o),onSave:e[1]||(e[1]=w=>s.__submit())},null,8,["aii"])]),_:1},8,["aii"])]),_:1})}}});typeof Q=="function"&&Q(Nt);export{Nt as default};
