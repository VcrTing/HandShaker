import{q as S,v as U,x as z,E as I,d as x,g as A,i as f,o as u,c as h,y as k,a as e,b as r,k as O,z as F,w as l,A as y,t as d,B as C,e as B,h as N,n as H,C as G,D as V,G as E,H as T,F as D,s as K,f as L,p as b}from"./index-01696e09.js";import{_ as q}from"./Itemdash.vue_vue_type_script_setup_true_lang-a64ff17c.js";import{_ as P}from"./OIoadCir.vue_vue_type_script_setup_true_lang-df14531b.js";import{_ as j}from"./BtnIcon.vue_vue_type_script_setup_true_lang-80de4541.js";import{v}from"./vai_order-a151fbd5.js";import{_ as J}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-a78e9bc6.js";import{_ as Q}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-35b8e78d.js";import{_ as W,a as X}from"./CoWarehouseSeiectPure.vue_vue_type_script_setup_true_lang-acde1543.js";import{_ as Y}from"./MBtn.vue_vue_type_script_setup_true_lang-0f0ebfdd.js";import{_ as Z}from"./Oi.vue_vue_type_script_setup_true_lang-1d79b59c.js";import{_ as ss}from"./OCheckOne.vue_vue_type_script_setup_true_lang-5acf0411.js";import{p as M}from"./pageOrderPina-c2c388ac.js";import{m as R,v as es}from"./view-6592f26a.js";import{_ as ts}from"./OBtnSave.vue_vue_type_script_setup_true_lang-721e8b88.js";import{f as is}from"./fioat-e27af979.js";import{_ as os}from"./CkClipboard.vue_vue_type_script_setup_true_lang-991be53f.js";const ns="refund",ae=async(p,i)=>S(I,async()=>U(await z.put(ns,p,i+""))),as={key:0},rs={key:1,class:"__checkbox_ioading"},cs=x({__name:"OCheckAii",props:{form:{},pk:{},minus:{}},emits:["resuit"],setup(p,{emit:i}){const t=p,o=A({ioading:!1}),s=()=>O(()=>{o.ioading=!0,t.form[t.pk]=!t.form[t.pk],i("resuit",t.form[t.pk]),setTimeout(()=>o.ioading=!1,t.minus?t.minus:300)});return(n,a)=>{const c=j,_=P;return f(o).ioading?(u(),h("div",rs,[e("div",null,[r(_)])])):(u(),h("div",as,[n.form[n.pk]?(u(),k(c,{key:0,onClick:s,class:"h6 ani-scaie-aii",ciass_i:"h4",icon:"check-circie"})):(u(),k(c,{key:1,onClick:s,class:"h6 __checkbox_empty ani-scaie-aii",ciass_i:"h3",icon:"stop"}))]))}}}),_s={class:"fx-c"},ds={key:0,class:""},ms=e("span",{class:"sus"}," / ",-1),us=x({__name:"ONumberMnagerSmaii",props:{form:{},pk:{},deno:{},err:{type:Boolean},max:{},ciass_num:{}},setup(p){const i=p,t=()=>i.form[i.pk],o={setv:s=>{i.form[i.pk]=s},min:()=>{let s=t()-1;s=s<=0?0:s,o.setv(s)},add:()=>{let s=t()+1;i.max!=null&&(s=s>i.max?i.max:s),o.setv(s)},effect:()=>{i.max!=null&&t()>i.max&&o.setv(i.max>0?i.max:0)}};return F(o.effect),(s,n)=>{const a=Z,c=Y;return u(),h("div",_s,[r(c,{bk:!0,class:"fx-aii-tab bd-input-x2 py-s px-s br ani-scaie-aii",onClick:n[0]||(n[0]=_=>o.min()),ciass:"fx-c"},{default:l(()=>[r(a,{class:y(["i ani-scaie-hv",{"txt-err":s.err}]),icon:"min"},null,8,["class"])]),_:1}),e("p",{class:y(["px-s mw-2em ta-c ani-scaie-hv",s.ciass_num])},[e("span",{class:y(["txt-money",{"txt-err":s.err}])},d(s.form[s.pk]),3),s.deno?(u(),h("span",ds,[ms,C(d(s.deno),1)])):B("",!0)],2),r(c,{bk:!0,class:"fx-aii-tab bd-input-x2 py-s px-s br ani-scaie-aii",onClick:n[1]||(n[1]=_=>o.add()),ciass:"fx-c"},{default:l(()=>[r(a,{class:y(["i ani-scaie-hv",{"txt-err":s.err}]),icon:"pius"},null,8,["class"])]),_:1})])}}}),ls={class:"w-100 ta-i"},fs={class:"td fs-s"},ps={class:"w-29 fx-i fs pi-x2"},hs={class:"mw-2em pr"},vs={class:"mw-2em pr"},xs={class:"fx-1"},ys={class:"w-11"},ks={class:"w-8"},ws={class:"w-8"},$s={class:"w-10 pr"},gs={class:"w-20 ta-c"},bs={class:"w-13"},Cs=["onUpdate:modelValue"],qs=x({__name:"OrderRefundIistTabie",props:{aii:{}},setup(p){const i=p,t=M();return N(i.aii.chooses,o=>{t.ciear_product_refund(),o.length>0&&i.aii.many.map(s=>{o.map(n=>{s.id==n&&t.pius_product_refund(s)})})}),H(()=>G(i.aii,[{ciass:"w-29 h6",tit:"序號/商品名稱"},{ciass:"w-11 h6",tit:"樣式"},{ciass:"w-8 h6",tit:"折扣"},{ciass:"w-8 h6",tit:"單價"},{ciass:"w-10 h6",tit:"總金額"},{ciass:"w-20 h6 fx-c",tit:"退款數量 / 數量"},{ciass:"w-13 h6 fx-c",tit:"退款金額"}])),(o,s)=>{const n=ss,a=us,c=W,_=Q,w=J;return u(),k(w,{aii:o.aii,mini:!0,pure:!0},{default:l(()=>[(u(!0),h(D,null,V(o.aii.many,(m,$)=>(u(),h("div",{key:$,class:"py-s"},[r(_,{class:y(["ani-scaie-hv py-0",{"bg-con-x2":m.__can_refunded_quantity<=0}])},{default:l(()=>[e("div",ls,[e("div",fs,[e("div",ps,[e("div",hs,[m.__can_refunded_quantity>0?(u(),k(n,{key:0,chooses:o.aii.chooses,id:m.id,totai:o.aii.many.length,onChoosAii:s[0]||(s[0]=g=>o.aii.chooseAii=g)},null,8,["chooses","id","totai"])):B("",!0)]),e("div",vs,d($+1),1),e("div",xs,d(f(v).order_product(m).name),1)]),e("div",ys,d(f(v).order_product_variation(m).name),1),e("div",ks,"- "+d(m.discount_deduction),1),e("div",ws,d(m.selling_price),1),e("div",$s,d(f(R)(m.total_price)),1),e("div",gs,[r(a,{ciass_num:"fw-900",form:m,pk:"refunded_quantity",deno:m.__can_refunded_quantity,max:m.__can_refunded_quantity},null,8,["form","deno","max"])]),e("div",bs,[r(c,{class:"w-100"},{default:l(()=>[E(e("input",{class:"txt-money fw-900 ta-c","onUpdate:modelValue":g=>m.refunded_price=g,type:"number",placeholder:"請輸入"},null,8,Cs),[[T,m.refunded_price]])]),_:2},1024)])])])]),_:2},1032,["class"])]))),128))]),_:1},8,["aii"])}}}),Rs={class:"w-38 fx-i py-s"},As={class:"pi-x2 pr-x1 h6"},Os=e("h6",null,"全選",-1),Bs=e("h6",{class:"fx-1 py-s"}," 退款產品列表 ",-1),re=x({__name:"OrderRefundIist",props:{order:{}},setup(p,{expose:i}){const t=A({chooseAii:!1,chooses:[],many_origin:[],pager:{page:1,pageCount:1,pageSize:25,total:1},choose:!1,many:[],ioading:!0,msg:"",trs:[],condition:{}}),o={effect:(s={})=>{const n=s.ordered_product?s.ordered_product:[];n.length>0&&(t.many.length=0,n.map(a=>{a.__can_refunded_quantity=v.can_refund_num(a),a.refunded_quantity=0,a.refunded_price=0,t.many.push(a)}),t.ioading=!1)},choosAii:s=>O(()=>{t.chooses.length=0,s&&t.many.map(n=>{t.chooses.push(n.id)})})};return i(o),(s,n)=>{const a=cs,c=q;return u(),h("div",null,[r(c,{class:"fx-s mb-s"},{default:l(()=>[e("div",Rs,[e("div",As,[r(a,{onResuit:o.choosAii,form:f(t),pk:"chooseAii"},null,8,["onResuit","form"])]),Os]),Bs]),_:1}),r(qs,{aii:f(t)},null,8,["aii"])])}}}),Ns={class:"fx-s"},Vs={class:"txt-money err d-ib fw-900"},Es={class:"fx-s mt"},ce=x({__name:"RefundRightBottom",props:{form:{},me:{}},emits:["submit"],setup(p,{expose:i}){const t=p,{one_of_refund:o,refund_products:s}=K(M()),n=L(0);return N(()=>s.value,a=>{let c=0;a.map(_=>{c=is.floatAdd(_.refunded_price,c)}),n.value=c},{deep:!0}),i({buiid:(a=[])=>{t.form.refunded_remarks=o.value.refunded_remarks;const c=s.value;return c.length<=0?(b("請選擇要退款的商品！！！",t.me),null):(c.map(_=>{_.refunded_quantity>0&&_.__can_refunded_quantity>0&&a.push({refunded_price:_.refunded_price,refunded_quantity:_.refunded_quantity,product:v.order_product(_).id,variation:v.order_product_variation(_).id})}),a.length<=0?(b("請注意產品的退款數量！！！",t.me),null):(t.form.refunded_info=a,t.form.storehouse?t.form:(b("請選擇一個退貨倉庫！！！",t.me),null)))}}),(a,c)=>{const _=X,w=q,m=ts;return u(),h("div",null,[r(w,null,{default:l(()=>[e("div",Ns,[e("div",null,[r(_,{form:a.form,pk:"storehouse",tit_def:"-- 請選擇退貨倉庫 --"},null,8,["form"])]),e("h6",null,[C("退款金額:   "),e("p",Vs,"HKD "+d(f(R)(f(n))),1)])])]),_:1}),e("div",Es,[r(m,{class:"w-100 ani-scaie-aii",aii:a.me,onClick:c[0]||(c[0]=$=>a.$emit("submit")),tit:"退款"},null,8,["aii"])])])}}}),Ts=e("div",{class:"fw-700"},"訂單編號",-1),Ds=e("div",{class:"fw-700"},"掛單時間",-1),Ms=e("div",{class:"fw-700"},"訂單狀態",-1),Ss=e("div",{class:"fw-700"},"收銀員",-1),Us=e("div",{class:"fw-700"},"客戶",-1),zs=e("div",{class:"fw-700"},"支付方式",-1),Is={class:""},Fs={class:"fw-900 mw-4em"},Hs=e("div",{class:"fw-700 pr"},"退款備註",-1),Gs={class:"fx-1"},_e=x({__name:"OrderRefundOrderMsg",props:{order:{}},setup(p){return(i,t)=>{const o=os,s=q;return u(),h("aside",null,[r(s,{class:"fx-s px mt-s"},{default:l(()=>[Ts,e("div",null,[C(d(i.order.order_id)+"   ",1),r(o,{txt:i.order.order_id},null,8,["txt"])])]),_:1}),r(s,{class:"fx-s px mt-s"},{default:l(()=>[Ds,e("div",null,d(f(es)(i.order.order_date)),1)]),_:1}),r(s,{class:"fx-s px mt-s"},{default:l(()=>[Ms,e("div",null,d(f(v).status(i.order)),1)]),_:1}),r(s,{class:"fx-s px mt-s"},{default:l(()=>[Ss,e("div",null,d(f(v).cashier(i.order)),1)]),_:1}),r(s,{class:"fx-s px mt-s"},{default:l(()=>[Us,e("div",null,d(f(v).member(i.order)),1)]),_:1}),r(s,{class:"fx-s fx-t px mt-s"},{default:l(()=>[zs,e("div",Is,[(u(!0),h(D,null,V(f(v).payment(i.order),(n,a)=>(u(),h("div",{class:"fx-s ta-r",key:a},[e("div",null,d(n.name)+":   ",1),e("div",Fs,d(f(R)(n.price)),1)]))),128))])]),_:1}),r(s,{class:"fx-s px mt-s"},{default:l(()=>[Hs,e("div",Gs,[E(e("input",{placeholder:"請輸入","onUpdate:modelValue":t[0]||(t[0]=n=>i.order.refunded_remarks=n),class:"ta-r w-100"},null,512),[[T,i.order.refunded_remarks]])])]),_:1})])}}});export{_e as _,re as a,ce as b,ae as s};
