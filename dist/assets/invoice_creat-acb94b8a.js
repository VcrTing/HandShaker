import{_ as J}from"./IayoutPan.vue_vue_type_script_setup_true_lang-200a71fc.js";import{_ as z}from"./ModInner.vue_vue_type_script_setup_true_lang-8f99b8fb.js";import{d as C,o as _,y as B,w as p,r as Q,c as u,a as o,i as d,b as a,N as E,t as O,g as U,a6 as G,h as D,B as h,C as g,ae as x,u as R,X as P,F as I,A as F,D as H,a7 as L,e as $,k,m as X,s as j,n as W,z as ss,R as ts,M as is,$ as T,q as es,v as os,x as ns,f as as,a9 as rs,au as q,j as _s,a0 as cs,p as ls,l as ds}from"./index-cf5102bf.js";import{_ as K}from"./OBtnSave.vue_vue_type_script_setup_true_lang-2475e86c.js";import{f as N}from"./fioat-e27af979.js";import{_ as Y}from"./IayoutForm.vue_vue_type_script_setup_true_lang-2b4548cf.js";import{a as us,_ as ps}from"./CoWarehouseSeiectPure.vue_vue_type_script_setup_true_lang-5ba850cc.js";import{_ as ms}from"./OInput.vue_vue_type_script_setup_true_lang-08415c53.js";import{_ as fs}from"./CoSuppiierSeiectPure.vue_vue_type_script_setup_true_lang-3e21e6a9.js";import{_ as vs}from"./OInputI.vue_vue_type_script_setup_true_lang-8c40ec6f.js";import{_ as ws}from"./OTime.vue_vue_type_script_setup_true_lang-e40194c8.js";import{_ as ys}from"./OModTrash.vue_vue_type_script_setup_true_lang-93e5983f.js";import{b as hs,_ as As}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-075b1746.js";import{_ as gs}from"./BtnTab.vue_vue_type_script_setup_true_lang-348d181b.js";import{_ as Z}from"./BtnIcon.vue_vue_type_script_setup_true_lang-afebbc56.js";import{_ as bs}from"./BtnIconX2.vue_vue_type_script_setup_true_lang-95d63242.js";import{_ as $s}from"./MBtn.vue_vue_type_script_setup_true_lang-bf772aa5.js";import{_ as ks}from"./OIoadCir.vue_vue_type_script_setup_true_lang-7fa39a2f.js";import{_ as Cs}from"./Oi.vue_vue_type_script_setup_true_lang-6ea7d837.js";import{invoiceCreatPina as M}from"./invoiceCreatPina-842e17d5.js";import{E as Bs}from"./errors_product-d5275ad5.js";import{b as S}from"./route-block-83d24a4e.js";import"./OIoadDot.vue_vue_type_script_setup_true_lang-2106b064.js";import"./giobaiPina-4953ad24.js";import"./serv_suppiier_iist-19f35835.js";import"./serv_user_iist-9b64bd7f.js";import"./serv_warehouse_iist-91a38968.js";import"./datepicker.esm-797dba94.js";import"./InboxIcon-4b5d38a6.js";import"./OTr.vue_vue_type_script_setup_true_lang-f8fa6d02.js";import"./OiX2.vue_vue_type_script_setup_true_lang-5d88de9a.js";import"./DocumentTextIcon-3e38a63f.js";import"./PlusCircleIcon-30c3dc2b.js";import"./XMarkIcon-92d7288b.js";import"./serv_product_iist-c9cb4852.js";const Vs=C({__name:"OModPure",props:{idx:{},aii:{},msg:{}},emits:["sure"],setup(y){return(e,m)=>{const l=z;return _(),B(l,{class:"mod-s",idx:e.idx?e.idx:100,stat:e.aii.ioading,pure:!0},{default:p(()=>[Q(e.$slots,"default")]),_:3},8,["idx","stat"])}}}),Ds="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALeSURBVHgB7ZtBctMwFIb/5zRdQSdHMDuGKSU3aHKCdkGgO5ITlJ6AcgLICUi2FGZygyQnaIYybMkRyhawH89OFikOiV3JT6XWN5NkImtk6bf0JD09Ax6Px1NhCI7gp52u/Bymf4gm9OXjEA5QF4DD4wYe1Mdy5yZu1mSG4FebZqNrKBJAm73dN5nGJ7Ck/d55DWX0BWA+/uc1olMooy8AEG641oAyLgS4U6gYwdTwPawnXT+x+t3NuWkktRppzQqlCpA2fG/3VMZ9YtyKdu+52IQBgp/9MmeG0gTg/ectacAHbB7zeZiLgD36+mmCEijFBvDBC5nqaAzzxiMtQ8pKyywB6z0grSjzOcqA6Fxsw1tYxKoAfPBSxnv8HmVCdCYiWLuHNQH48UmIevQd5XONCG36djGDBezZgHo0hg4N1PAOlrAiwHJnF0KPltiaV7CArR5QioXeCHMXFjC2Afyk05QueYliDOQz/aukllSn2FNlbpuuD3ZgCqUVRyEiTMWIDVaTZBglPwUFSLfVExhgPgQCOoIrAmrBEHMBiNW3sCs8gyHmAjA14Q5j8f93f0DlBTDGC4CK4wVAxfECoOKY7wVuQw2Hy7X/CrfYU1jAjQCLs4HuzSQ3B9XeBsAVzBP57smDTw5N5nCEmyHAPBNHRnslpS82IfEptqCMmx7AWHfu5yRCxJEAlD3ri934FdwIUFvj+gr0gyMSXE2DLd7vXIr8AxkOP7DwBYZwgCsBkMYJMco9RsuBjxDJm3F53r/Obd2FWwaZFOZh3vOC/EOAKIT7xq6jm0mJaYqc+KUwKs79FKDAxjK/DWCeywpugLsHZ1JI6urx5ELNDbNhHZElQt9WDNA29JbCsewAaznXEQGrbY1VHXHi9EiiyMIt2eZ0dfEISuhOg8y97ZniMyiiKsByfZ6IsC74OYn/69HV5xEUceKL5uZJiDg6kgYvgitq6ftCQ+33hTwej6fy/AGfJrsXt0lXRAAAAABJRU5ErkJggg==",xs={class:"ta-c"},Is={class:"w-100 fx-c pt"},Fs={class:"w-30 cms-warning-icon cir fx-c ani-scaie-aii"},Ns=["src"],Us=o("div",{class:"pb-x1 px bg-con"},[o("h3",{class:"pb pt-x2"},"確認儲存？"),o("div",{class:"fx-c"},[o("p",{class:"w-64"},"確認儲存後，產品的數量將加入庫存，屆時修改產品數量需要到產品庫存頁面內修改。")])],-1),Ms={class:"py px"},Es=C({__name:"CoInvoiceModSure",props:{aii:{}},emits:["save"],setup(y){return(e,m)=>{const l=K;return _(),u("div",xs,[o("div",Is,[o("div",Fs,[o("img",{class:"w-50 ani-scaie-aii",src:d(Ds)},null,8,Ns)])]),Us,o("div",Ms,[a(l,{aii:e.aii,tit:"確認",class:"btn-warning w-100 py ani-fade-b ani-scaie-aii",onClick:m[0]||(m[0]=i=>e.$emit("save"))},null,8,["aii"])])])}}}),Os={class:"row"},Ts={class:"w-50"},Hs=o("div",null," 合計數量 ",-1),qs={class:"pt"},Ss={class:"w-50"},Qs=o("div",null," 合計金額 ",-1),Rs={class:"pt"},Xs=C({__name:"OrderInTotai",props:{many:{}},setup(y){const e=y,m=E(()=>{let i=0;return e.many.map(c=>{const s=c.data_of_vars;s&&s.map(t=>{t.quantity&&(i+=t.quantity)})}),i}),l=E(()=>{let i=0;return e.many.map(c=>{const s=c.total_amount;return i=N.floatAdd(i,s),c}),i.toFixed(2)});return(i,c)=>(_(),u("div",Os,[o("div",Ts,[Hs,o("div",qs,[o("h4",null,O(d(m)),1)])]),o("div",Ss,[Qs,o("div",Rs,[o("h4",null,O(d(l)),1)])])]))}}),js={class:"row"},Ks={class:"w-333"},Ys={class:"w-333"},Zs={class:"w-333"},Js={class:"row pt"},zs={class:"w-333"},Gs={class:"w-333"},Ps={class:"w-333"},Ls=C({__name:"OrderInCreatBase",props:{form:{},aii:{}},setup(y){const e=y,m=["supplier","storehouse","date","invoice_id"],l=U(G(e.form));return D(()=>e.aii.sign,()=>{m.map(i=>{if(x(l,i,e.form[i],e.aii)){e.aii.can=!1;return}}),e.aii.can=!0}),D(()=>e.form.date,i=>x(l,"date",i,e.aii)),D(()=>e.form.supplier,i=>x(l,"supplier",i,e.aii)),D(()=>e.form.storehouse,i=>x(l,"storehouse",i,e.aii)),D(()=>e.form.invoice_id,i=>x(l,"invoice_id",i,e.aii)),(i,c)=>{const s=ws,t=vs,n=fs,v=ms,b=us,A=Y;return _(),B(A,{tit:"基本信息",class:"pb-x3 mb"},{default:p(()=>[o("div",js,[o("div",Ks,[a(t,{tit:"發票日期",err:d(l).date,icon:"date"},{default:p(()=>[a(s,{form:i.form,pk:"date"},null,8,["form"])]),_:1},8,["err"])]),o("div",Ys,[a(v,{tit:"供應商名稱",err:d(l).supplier},{default:p(()=>[a(n,{form:i.form,pk:"supplier",kiii_color:!0,tit_def:"-- 請選擇 --"},null,8,["form"])]),_:1},8,["err"])]),o("div",Zs,[a(v,{tit:"入貨倉庫",err:d(l).storehouse},{default:p(()=>[a(b,{form:i.form,pk:"storehouse"},null,8,["form"])]),_:1},8,["err"])])]),o("div",Js,[o("div",zs,[a(v,{tit:"訂單號碼",err:d(l).invoice_id},{default:p(()=>[h(o("input",{"onUpdate:modelValue":c[0]||(c[0]=r=>i.form.invoice_id=r),placeholder:"請輸入"},null,512),[[g,i.form.invoice_id]])]),_:1},8,["err"])]),o("div",Gs,[a(v,{tit:"帳單地址",err:d(l).invoice_address},{default:p(()=>[h(o("input",{"onUpdate:modelValue":c[1]||(c[1]=r=>i.form.invoice_address=r),placeholder:"請輸入"},null,512),[[g,i.form.invoice_address]])]),_:1},8,["err"])]),o("div",Ps,[a(v,{tit:"送貨地址",err:d(l).delivery_address},{default:p(()=>[h(o("input",{"onUpdate:modelValue":c[2]||(c[2]=r=>i.form.delivery_address=r),placeholder:"請輸入"},null,512),[[g,i.form.delivery_address]])]),_:1},8,["err"])])])]),_:1})}}}),Ws={key:0,class:"ani-softer fx-s"},st={key:1,class:"mxh-1em ani-softer"},tt=C({__name:"OBtnSearchMini",props:{ioad:{type:Boolean}},setup(y){return(e,m)=>{const l=Cs,i=ks,c=$s;return _(),B(c,{class:"btn-pri hand br mw-4em",ciass:"fx-c"},{default:p(()=>[e.ioad?(_(),u("div",st,[a(i,{class:"h5",styie:"wht"})])):(_(),u("div",Ws,[a(l,{icon:"search",class:"i h4"})]))]),_:1})}}}),it={class:"ai-fs-imp"},et={class:"w-11"},ot={class:"w-15"},nt={key:0,class:"w-15 ani-softer"},at=["onUpdate:modelValue"],rt=["value"],_t={key:0,class:"d-ib pr pi-s"},ct={key:1,class:"d-ib pr pi-s"},lt={key:1,class:"w-8 ani-softer"},dt=["onUpdate:modelValue"],ut={key:2,class:"w-9 ani-softer"},pt={key:3,class:"w-8 ani-softer"},mt={key:4,class:"w-10 ani-softer pi"},ft=["value"],vt={key:5,class:"w-7 ani-softer"},wt=["value"],yt={key:6,class:"w-7 ani-softer"},ht={key:7,class:"w-7 ani-softer"},At={class:"fx-1 pi fx-r"},gt=C({__name:"OciiTd",props:{v:{}},setup(y){const e=y,m=R(),l=M(),i=E(()=>{const s=e.v.__product;return s&&s.id}),c={pro:()=>i.value?e.v.__product:null,search:()=>k(async()=>{const s=e.v;if(s.__ioad)return;const t=s.number?s.number.trim():void 0;if(t){s.__ioad=!0;try{let n=await l.searchPro(t);if(!X(n))n=n,n&&n.id&&c.insert_pro(n,s);else{const v=m.resolve({path:"/admin/product_inventory_iist/creat"});window.open(v.href,"_blank")}}catch{}setTimeout(()=>s.__ioad=!1,200)}}),insert_pro:(s,t)=>{t.product=s.id,t.__product=s,t.number=s.product_id,t.name=s.name,t.new_restock_price=s.new_restock_price,t.selling_price=s.new_selling_price,t.lowest_price=s.new_lowest_price,t.net_price=s.new_restock_price,t.data_of_vars||(t.data_of_vars=[]),t.data_of_vars.length<=0&&c.piusDFV()},proVariations:()=>{const s=c.pro();return s?s.variations:[]},piusDFV:()=>k(()=>{const s=l.genDFV(e.v);e.v.data_of_vars.push(s)}),trashDFV:s=>k(()=>{try{e.v.data_of_vars.splice(s,1)}catch{}})};return(s,t)=>{const n=ps,v=tt,b=bs,A=Z;return _(),u("div",it,[o("div",et,[a(n,null,{default:p(()=>[h(o("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>s.v.number=r),onKeydown:t[1]||(t[1]=P(r=>c.search(),["enter"])),placeholder:"請輸入後按回車"},null,544),[[g,s.v.number]])]),_:1})]),o("div",ot,[d(i)?(_(),B(n,{key:0,class:"ani-softer"},{default:p(()=>[h(o("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>s.v.name=r),placeholder:"請輸入"},null,512),[[g,s.v.name]])]),_:1})):(_(),B(v,{key:1,class:"mi-s mh-2em",onTap:t[3]||(t[3]=r=>c.search()),ioad:s.v.__ioad},null,8,["ioad"]))]),d(i)?(_(),u("div",nt,[(_(!0),u(I,null,F(s.v.data_of_vars,(r,f)=>(_(),u("div",{class:H(["w-100 fx-s ani-softer",{"pt-s":f>0}]),key:f},[a(n,{class:"fx-1"},{default:p(()=>[h(o("select",{"onUpdate:modelValue":w=>r.variation=w},[(_(!0),u(I,null,F(c.proVariations(),(w,V)=>(_(),u("option",{key:V,value:w.id},O(w.name),9,rt))),128))],8,at),[[L,r.variation]])]),_:2},1024),f==0?(_(),u("div",_t,[a(b,{icon:"pius-c",ciass_i:"sub",onClick:t[4]||(t[4]=w=>c.piusDFV())})])):(_(),u("div",ct,[a(A,{ciass_i:"",icon:"x",onClick:w=>c.trashDFV(f)},null,8,["onClick"])]))],2))),128))])):$("",!0),d(i)?(_(),u("div",lt,[(_(!0),u(I,null,F(s.v.data_of_vars,(r,f)=>(_(),u("div",{class:H(["w-100 ani-softer",{"pt-s":f>0}]),key:f},[a(n,{err:!r.quantity},{default:p(()=>[h(o("input",{type:"number","onUpdate:modelValue":w=>r.quantity=w,placeholder:"請輸入正數"},null,8,dt),[[g,r.quantity]])]),_:2},1032,["err"])],2))),128))])):$("",!0),d(i)?(_(),u("div",ut,[a(n,{class:"bg-card"},{default:p(()=>[h(o("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=r=>s.v.price=r),placeholder:"請輸入金錢"},null,512),[[g,s.v.price]])]),_:1})])):$("",!0),d(i)?(_(),u("div",pt,[a(n,null,{default:p(()=>[h(o("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=r=>s.v.discount=r),placeholder:"0至1的小數"},null,512),[[g,s.v.discount]])]),_:1})])):$("",!0),d(i)?(_(),u("div",mt,[a(n,{class:"bd-c-t-imp"},{default:p(()=>[o("input",{value:s.v.new_stock_price,disabled:!0},null,8,ft)]),_:1})])):$("",!0),d(i)?(_(),u("div",vt,[a(n,{class:"bd-c-t-imp"},{default:p(()=>[o("input",{value:s.v.total_amount,disabled:!0},null,8,wt)]),_:1})])):$("",!0),d(i)?(_(),u("div",yt,[a(n,{class:"bg-card",err:s.v.lowest_price>s.v.selling_price},{default:p(()=>[h(o("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=r=>s.v.lowest_price=r),placeholder:"請輸入金錢"},null,512),[[g,s.v.lowest_price]])]),_:1},8,["err"])])):$("",!0),d(i)?(_(),u("div",ht,[a(n,{class:"bg-card"},{default:p(()=>[h(o("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=r=>s.v.selling_price=r),placeholder:"請輸入金錢"},null,512),[[g,s.v.selling_price]])]),_:1})])):$("",!0),o("div",At,[Q(s.$slots,"default")])])}}}),bt={key:0,class:"pb-x2 ani-softer"},$t={class:"mh-input-s py-n"},kt={key:1,class:"oti-con ani-softer"},Ct={class:"ani-fade-b"},Bt=C({__name:"OrderInCreatInIist",emits:["sureTrash"],setup(y,{emit:e}){const m=U({many:[{__edit:!0}],chooseAii:!1,chooses:[],many_origin:[],ioading:!1,msg:"",trs:[],condition:{search:""},pager:{page:1,pageCount:1,pageSize:25,total:1}}),{many:l}=j(M()),i=U({origin:{},trashIdx:0});W(()=>ss(m,[{ciass:"w-11",tit:"貨號"},{ciass:"w-15",tit:"貨品名稱 / 摘要"},{ciass:"w-15",tit:"樣式"},{ciass:"w-8",tit:"數量"},{ciass:"w-9",tit:"單價"},{ciass:"w-8",tit:"折扣 %"},{ciass:"w-10",tit:"最新入貨價錢"},{ciass:"w-7",tit:"統計"},{ciass:"w-8",tit:"最低價錢"},{ciass:"w-6",tit:"售價"},{ciass:"fx-1",tit:""}]));const c={pius:()=>k(()=>{M().pius()}),edit:s=>k(()=>{s.__edit=!0,i.origin[s.id+""]=ts(s)}),cancei:s=>k(()=>{const t=i.origin[s.id+""];t?(t.__edit=!1,is(t,s)):s.edit=!1}),sureTrash:s=>k(()=>{i.trashIdx=s,e("sureTrash",s),T(-201)}),trash:()=>k(()=>{l.value.splice(i.trashIdx,1),T(0)})};return(s,t)=>{const n=Z,v=hs,b=gs,A=As,r=Y,f=ys;return _(),u(I,null,[a(r,{tit:"產品入單列表",class:"pb-x3 mb"},{default:p(()=>[a(A,{aii:d(m),mini:!0},{default:p(()=>[d(l).length>0?(_(),u("div",bt,[(_(!0),u(I,null,F(d(l),(w,V)=>(_(),u("div",{key:V,class:"ani-softer"},[w.__edit?(_(),B(gt,{key:0,class:"td",v:w},{default:p(()=>[o("div",$t,[a(n,{icon:"trash",ciass_i:"txt-err",onClick:Nt=>c.sureTrash(V)},null,8,["onClick"])])]),_:2},1032,["v"])):$("",!0)]))),128))])):(_(),u("div",kt,[a(v,{class:"mh-oti-s"})])),o("div",Ct,[a(b,{onClick:t[0]||(t[0]=w=>c.pius()),class:"w-100 py-s ani-scaie-aii",tit:"添加項目"})])]),_:1},8,["aii"])]),_:1}),a(f,{idx:-201,aii:d(m),onTrash:c.trash},null,8,["aii","onTrash"])],64)}}}),Vt="invoices",Dt=async y=>es(Bs,async()=>os(await ns.pos(Vt,y))),xt={class:"fx-r"},It=o("div",{class:"py-x3"},null,-1),Ft=C({__name:"invoice_creat",setup(y){const e=U({ioading:!1,msg:"",can:!1,sign:0,aiiow:!1}),{form:m,many:l}=j(M());R(),D(l,s=>k(()=>{s.map(t=>{if(t.product){const n=t.data_of_vars;if(n&&n.length>0){isNaN(t.price)&&(t.price=0);const v=t.price?t.price:0;(isNaN(t.discount)||t.discount>1||t.discount<0)&&(t.discount=1);const b=t.discount?t.discount:1,A=N.floatMul(v,b);let r=0;n.map(f=>{if(f){(isNaN(f.quantity)||f.quantity<0)&&(f.quantity=0);const w=f.quantity?f.quantity:0;w?e.aiiow=!0:e.aiiow=!1;const V=N.floatMul(A,w);r=N.floatAdd(V,r)}}),t.total_amount=parseFloat(r.toFixed(2)),t.new_stock_price=parseFloat(A.toFixed(2))}}})}),{immediate:!0,deep:!0});const i=as(0),c={buiid:()=>{if(!rs(["supplier","storehouse","date","invoice_id"],m.value))return null;if(!e.aiiow)return q("入單產品列表內，數量的值填寫不完善。"),null;let s=!0;const t={...m.value,restocks:l.value.map(n=>(console.log(n),n.lowest_price>n.selling_price&&(q("入貨時，最低價錢不能超過售價！！！"),s=!1),n.unit_price=n.price,n.net_price=n.new_stock_price,n.variations=n.data_of_vars,n))};return s?t:null},submit:()=>_s(e,c.buiid,async s=>{s&&T(300)}),__submit:()=>cs(e,async()=>{const s=c.buiid();if(!s||i.value==1)return;i.value=1,console.log(s);const t=await Dt(s);if(X(t))ls(t,e);else{ds("產品入單成功！！！");return}i.value=0})};return(s,t)=>{const n=K,v=Es,b=Vs,A=J;return _(),B(A,{tit:"快速入單",ciass:"w-100"},{default:p(()=>[o("div",xt,[a(n,{class:"mw-10em",aii:d(e),tit:"儲存",onClick:t[0]||(t[0]=r=>c.submit())},null,8,["aii"])]),a(Ls,{aii:d(e),form:d(m)},null,8,["aii","form"]),a(Bt),a(Xs,{many:d(l)},null,8,["many"]),It,a(b,{aii:d(e),idx:300},{default:p(()=>[a(v,{aii:d(e),onSave:t[1]||(t[1]=r=>c.__submit())},null,8,["aii"])]),_:1},8,["aii"])]),_:1})}}});typeof S=="function"&&S(Ft);export{Ft as default};
