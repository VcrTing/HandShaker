import{_ as F,a as P}from"./ModInner.vue_vue_type_script_setup_true_lang-88424812.js";import{_ as U}from"./MBtn.vue_vue_type_script_setup_true_lang-6b0b8f4f.js";import{_ as E}from"./OIoadCir.vue_vue_type_script_setup_true_lang-e3e6ca3d.js";import{d as w,o as c,c as g,w as r,a as i,b as s,t as d,e as p,f as O,r as y,g as k,u as m,n as T,h as j,F as M,i as z,j as H,v as K,k as L,l as G,s as J,m as S,$ as Q}from"./index-eba50101.js";import{_ as W}from"./scroiiy-983ca456.js";import{_ as X}from"./OBtn.vue_vue_type_script_setup_true_lang-f9a35333.js";import{_ as Y}from"./CoWarehouseSeiectPure.vue_vue_type_script_setup_true_lang-a7930a21.js";import{_ as Z}from"./OBtnBack.vue_vue_type_script_setup_true_lang-5aaa7c4c.js";import{_ as x}from"./Itemdash.vue_vue_type_script_setup_true_lang-aa6b186d.js";import{v as $}from"./vai_order-88408183.js";import{n as ss}from"./conn-bb36a56e.js";import{a as os,s as ts}from"./net-tooi-1d3bb44e.js";import{E as is}from"./errors_user-be6d0865.js";import{f as R,i as es,m as b,s as ns}from"./credit-977c08c3.js";import{i as as}from"./judge-13dfac2e.js";import{v as rs,m as _s}from"./view-8e3be13d.js";import{_ as cs}from"./BtnIcon.vue_vue_type_script_setup_true_lang-96b90075.js";import{h as ds}from"./iodash-1eed2347.js";import{_ as ms}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-12656a35.js";import{_ as ls}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-31c44548.js";import{_ as ps}from"./OCheckOne.vue_vue_type_script_setup_true_lang-76da3b49.js";import{p as us}from"./pageOrderPina-ec11937b.js";import{b as A}from"./route-block-83d24a4e.js";import"./giobaiPina-9a1d6554.js";import"./serv_suppiier_iist-29ddfdaf.js";import"./serv_warehouse_iist-1bd2f49f.js";import"./dayjs.min-668a802a.js";import"./Oi.vue_vue_type_script_setup_true_lang-3448f539.js";import"./XMarkIcon-41f2689f.js";import"./OTabieIoading.vue_vue_type_script_setup_true_lang-928ba505.js";import"./OIoadDot.vue_vue_type_script_setup_true_lang-70d375fa.js";import"./OTr.vue_vue_type_script_setup_true_lang-c71ef323.js";import"./TrangieGroup.vue_vue_type_script_setup_true_lang-26ff5dca.js";const fs={class:"pt-x3 fx-c"},hs={key:0},vs={key:1},$s={key:0},ws={key:1},ys=w({__name:"OModSure",props:{idx:{},aii:{},msg:{}},emits:["sure"],setup(f){return(o,e)=>{const t=E,l=U,_=F,n=P;return c(),g(n,{class:"mod-t",idx:o.idx?o.idx:100},{default:r(()=>[i(_,{tit:"提示"},{default:r(()=>[s("p",null,d(o.msg?o.msg:"你確定嗎？"),1),s("div",fs,[i(l,{class:"py-s mw-618 px-x2 btn-err-weak br",onClick:e[0]||(e[0]=a=>o.$emit("sure"))},{default:r(()=>[o.aii.ioading?(c(),p("div",hs,[i(t,{styie:"pri"})])):(c(),p("div",vs,[o.aii.msg?(c(),p("span",ws,d(o.aii.msg),1)):(c(),p("span",$s," 確定 "))]))]),_:1})])]),_:1})]),_:1},8,["idx"])}}}),gs={class:"iayout-pan-two bg-con h-iayout ps-r"},ks={class:"fx-s fx-t ani-softer"},bs={class:"pi-row pr-s"},xs=s("div",{class:"py-row"},null,-1),Rs={key:0,class:"pb"},Cs=s("div",{class:"py-x3"},null,-1),Os=s("div",{class:"w-1"},null,-1),Ss=s("div",{class:"py-row"},null,-1),As={key:0,class:"pb"},Es=s("div",{class:"py-x3"},null,-1),Ts={class:"iayout-pan-two-bottom fx-s fx-b py-row bg-con"},Ms={class:"w-32 w-37-p pi-row pr-s"},Ns=s("div",{class:"w-1"},null,-1),Vs={class:"w-67 w-62-p"},Bs=w({__name:"IayoutPanTwo",props:{ciass:{},tit:{}},setup(f){return(o,e)=>{const t=W;return c(),p("div",gs,[s("div",ks,[i(t,{class:"w-32 w-37-p ps-r iayout-pan-scroii h-iayout-max"},{default:r(()=>[s("div",bs,[xs,o.tit?(c(),p("h3",Rs,d(o.tit),1)):O("",!0),y(o.$slots,"ieft"),Cs])]),_:3}),Os,i(t,{class:"w-67 w-62-p h-iayout-max"},{default:r(()=>[s("section",null,[Ss,o.tit?(c(),p("h3",As," ")):O("",!0),y(o.$slots,"right"),Es])]),_:3})]),s("div",Ts,[s("div",Ms,[y(o.$slots,"bottom_ieft")]),Ns,s("aside",Vs,[y(o.$slots,"bottom_right")])]),y(o.$slots,"extra")])}}}),Ds="refund",Is=async(f,o)=>os(is,async()=>ts(await ss.put(Ds,f,o+""))),qs={key:0},Fs={key:1,class:"__checkbox_ioading"},Ps=w({__name:"OCheckAii",props:{form:{},pk:{},minus:{}},emits:["resuit"],setup(f,{emit:o}){const e=f,t=k({ioading:!1}),l=()=>R(()=>{t.ioading=!0,e.form[e.pk]=!e.form[e.pk],o("resuit",e.form[e.pk]),setTimeout(()=>t.ioading=!1,e.minus?e.minus:800)});return(_,n)=>{const a=cs,h=E;return m(t).ioading?(c(),p("div",Fs,[s("div",null,[i(h)])])):(c(),p("div",qs,[_.form[_.pk]?(c(),g(a,{key:0,onClick:l,class:"h6 ani-scaie-aii",ciass_i:"h4",icon:"check-circie"})):(c(),g(a,{key:1,onClick:l,class:"h6 __checkbox_empty ani-scaie-aii",ciass_i:"h3",icon:"stop"}))]))}}}),Us={class:"w-100 ta-i"},js={class:"td fs-s"},zs={class:"w-40 fx-i fs pi-x2"},Hs={class:"mw-2em pr"},Ks={class:"mw-3em pr"},Ls={class:"fx-1"},Gs={class:"w-16"},Js={class:"w-10"},Qs={class:"w-12"},Ws={class:"w-10"},Xs={class:"w-13 fw-900 ta-r pr"},Ys=w({__name:"OrderRefundIistTabie",props:{aii:{}},setup(f){const o=f;return T(()=>es(o.aii,[{ciass:"w-40 h6",tit:"序號/商品名稱"},{ciass:"w-16 h6",tit:"樣式"},{ciass:"w-10 h6",tit:"折扣"},{ciass:"w-12 h6",tit:"單價"},{ciass:"w-10 h6",tit:"數量"},{ciass:"w-13 h6",tit:"應退金額"}])),(e,t)=>{const l=ps,_=ls,n=ms;return c(),g(n,{aii:e.aii,mini:!0,pure:!0},{default:r(()=>[(c(!0),p(M,null,j(e.aii.many,(a,h)=>(c(),p("div",{key:h,class:"py-s"},[i(_,{class:"ani-scaie-aii py-0"},{default:r(()=>[s("div",Us,[s("div",js,[s("div",zs,[s("div",Hs,[i(l,{chooses:e.aii.chooses,id:a.id,totai:e.aii.many.length},null,8,["chooses","id","totai"])]),s("div",Ks,d(h+1),1),s("div",Ls,d(m($).order_product(a).name),1)]),s("div",Gs,d(m($).order_product_variation(a).name),1),s("div",Js,"- "+d(a.discount_deduction),1),s("div",Qs,d(a.selling_price),1),s("div",Ws,d(a.quantity),1),s("div",Xs,d(a.total_price),1)])])]),_:2},1024)]))),128))]),_:1},8,["aii"])}}}),Zs={class:"w-38 fx-i pb"},so={class:"pi-x2 pr-x1 h6"},oo=s("h6",null,"全選",-1),to=s("h6",{class:"fx-1 pb"}," 退款產品列表 ",-1),io=w({__name:"OrderRefundIist",props:{order:{}},setup(f,{expose:o}){const e=f,t=k({chooseAii:!1,chooses:[],many_origin:[],pager:{page:1,pageCount:1,pageSize:25,total:1},choose:!1,many:[],ioading:!0,msg:"",trs:[],condition:{}}),l={effect:()=>{const _=e.order?e.order:{},n=_.ordered_product?_.ordered_product:[];n.length>0&&(t.many.length=0,n.map(a=>{t.many.push(a)}),t.ioading=!1)},resuit:()=>{let _=[];return t.many.map(n=>{ds(n.id,t.chooses)&&_.push(n)}),_},choosAii:_=>R(()=>{t.chooses.length=0,_&&t.many.map(n=>{t.chooses.push(n.id)})})};return z(l.effect),o(l),(_,n)=>{const a=Ps,h=x;return c(),p("div",null,[i(h,{class:"fx-s mb-s"},{default:r(()=>[s("div",Zs,[s("div",so,[i(a,{onResuit:l.choosAii,form:m(t),pk:"chooseAii"},null,8,["onResuit","form"])]),oo]),to]),_:1}),i(Ys,{aii:m(t)},null,8,["aii"])])}}}),eo=s("div",{class:"fw-700"},"訂單編號",-1),no=s("div",{class:"fw-700"},"掛單時間",-1),ao=s("div",{class:"fw-700"},"訂單狀態",-1),ro=s("div",{class:"fw-700"},"收銀員",-1),_o=s("div",{class:"fw-700"},"客戶",-1),co=s("div",{class:"fw-700"},"支付方式",-1),mo=s("div",{class:"fw-700 pr"},"退款備註",-1),lo={class:"fx-1"},po=w({__name:"OrderRefundOrderMsg",props:{order:{}},setup(f){return(o,e)=>{const t=x;return c(),p("aside",null,[i(t,{class:"fx-s px mt-s"},{default:r(()=>[eo,s("div",null,d(o.order.order_id),1)]),_:1}),i(t,{class:"fx-s px mt-s"},{default:r(()=>[no,s("div",null,d(m(rs)(o.order.order_date)),1)]),_:1}),i(t,{class:"fx-s px mt-s"},{default:r(()=>[ao,s("div",null,d(m($).status(o.order)),1)]),_:1}),i(t,{class:"fx-s px mt-s"},{default:r(()=>[ro,s("div",null,d(m($).cashier(o.order)),1)]),_:1}),i(t,{class:"fx-s px mt-s"},{default:r(()=>[_o,s("div",null,d(m($).member(o.order)),1)]),_:1}),i(t,{class:"fx-s px mt-s"},{default:r(()=>[co,s("div",null,d(m($).payment(o.order)),1)]),_:1}),i(t,{class:"fx-s px mt-s"},{default:r(()=>[mo,s("div",lo,[H(s("input",{placeholder:"請輸入","onUpdate:modelValue":e[0]||(e[0]=l=>o.order.refunded_remarks=l),class:"ta-r w-100"},null,512),[[K,o.order.refunded_remarks]])])]),_:1})])}}}),uo={class:"fx-s"},fo={class:"txt-money err d-ib"},ho={class:"fx-s mt"},vo=w({__name:"order_refund",setup(f){const o=L(),e=G(),{one_of_refund:t,refund_price:l,refund_products:_}=J(us()),n=k({msg:"",many:[{}],pager:{},ioading:!1}),a=k({refunded_remarks:"",storehouse:0,refunded_info:[]}),h={buiid:(u=[])=>(a.refunded_remarks=t.value.refunded_remarks,_.value.length<=0?(b("請選擇要退款的商品！！！",n),null):a.storehouse?(_.value.map(v=>{u.push({refunded_quantity:v.quantity,product:$.order_product(v).id,variation:$.order_product_variation(v).id})}),a.refunded_info=u,a):(b("請選擇一個退貨倉庫！！！",n),null)),submit:()=>ns(n,h.buiid,async u=>{u&&Q(100),console.log("退款 =",u)}),__submit:()=>R(async()=>{n.ioading=!0;let u=await Is(a,t.value.id);as(u)?b(u,n):h.success(u),n.ioading=!1}),success:u=>{console.log("結果 RES =",u)}};return T(()=>{t.value.id||e.back()}),(u,v)=>{const C=x,N=Z,V=Y,B=X,D=Bs,I=ys;return c(),p(M,null,[i(D,{tit:"退貨 / 退款"},{ieft:r(()=>[i(po,{order:m(t)},null,8,["order"])]),right:r(()=>[i(io,{ref_key:"ori",ref:o,order:m(t)},null,8,["order"])]),bottom_ieft:r(()=>[i(C),i(N,{class:"w-100 mt refund"})]),bottom_right:r(()=>[i(C,null,{default:r(()=>[s("div",uo,[s("div",null,[i(V,{form:m(a),pk:"storehouse",tit_def:"-- 請選擇退貨倉庫 --"},null,8,["form"])]),s("h6",null,[S("退款金額:   "),s("p",fo,"HKD "+d(m(_s)(m(l))),1)])])]),_:1}),s("div",ho,[i(B,{aii:m(n),onClick:v[0]||(v[0]=q=>h.submit()),class:"btn-pri fx-1 py refund"},{default:r(()=>[S("退款")]),_:1},8,["aii"])])]),_:1}),i(I,{idx:100,aii:m(n),onSure:v[1]||(v[1]=q=>h.__submit()),msg:"您確定要退款嗎？"},null,8,["aii"])],64)}}});typeof A=="function"&&A(vo);export{vo as default};
