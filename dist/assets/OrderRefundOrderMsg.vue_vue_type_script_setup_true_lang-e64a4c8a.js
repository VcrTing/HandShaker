import{q as T,v as E,x as M,E as U,d as y,g as A,i as l,o as f,c as v,y as $,a as s,b as d,k as R,h as C,n as z,z as F,w as m,A as O,e as I,t as c,B as V,C as B,D as G,F as D,s as H,f as K,p as k,G as N}from"./index-52859a34.js";import{_ as b}from"./Itemdash.vue_vue_type_script_setup_true_lang-b00f3e72.js";import{_ as L}from"./OIoadCir.vue_vue_type_script_setup_true_lang-dbb2dd22.js";import{_ as P}from"./BtnIcon.vue_vue_type_script_setup_true_lang-fff7dfad.js";import{v as h}from"./vai_order-52bad24c.js";import{f as x}from"./fioat-e27af979.js";import{_ as j}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-e40e0185.js";import{_ as J}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-89450a83.js";import{_ as Q,a as W}from"./CoWarehouseSeiectPure.vue_vue_type_script_setup_true_lang-4ec2e4c4.js";import{_ as X}from"./OCheckOne.vue_vue_type_script_setup_true_lang-556116c7.js";import{p as S}from"./pageOrderPina-490da162.js";import{m as q,v as Y}from"./view-028bf5b9.js";import{_ as Z}from"./OBtnSave.vue_vue_type_script_setup_true_lang-4fb529e9.js";import{_ as ss}from"./CkClipboard.vue_vue_type_script_setup_true_lang-f8887b1b.js";const es="refund",Ys=async(p,n)=>T(U,async()=>E(await M.put(es,p,n+""))),ts={key:0},is={key:1,class:"__checkbox_ioading"},os=y({__name:"OCheckAii",props:{form:{},pk:{},minus:{}},emits:["resuit"],setup(p,{emit:n}){const t=p,a=A({ioading:!1}),i=()=>R(()=>{a.ioading=!0,t.form[t.pk]=!t.form[t.pk],n("resuit",t.form[t.pk]),setTimeout(()=>a.ioading=!1,t.minus?t.minus:300)});return(o,e)=>{const r=P,_=L;return l(a).ioading?(f(),v("div",is,[s("div",null,[d(_)])])):(f(),v("div",ts,[o.form[o.pk]?(f(),$(r,{key:0,onClick:i,class:"h6 ani-scaie-aii",ciass_i:"h4",icon:"check-circie"})):(f(),$(r,{key:1,onClick:i,class:"h6 __checkbox_empty ani-scaie-aii",ciass_i:"h3",icon:"stop"}))]))}}}),ns={class:"w-100 ta-i"},as={class:"td fs-s"},rs={class:"w-28 fx-i fs pi-x2"},_s={class:"mw-2em pr"},ds={class:"fx-1"},cs={class:"w-11"},us={class:"w-8"},ls={class:"w-10"},fs={class:"w-9"},ms={class:"w-10 pr"},ps={class:"w-11 pi"},hs={class:"w-13"},vs=["onUpdate:modelValue"],ys=s("div",{class:"py-x3"},null,-1),ws=y({__name:"OrderRefundIistTabie",props:{aii:{}},setup(p){const n=p,t=S();return C(n.aii.chooses,a=>{t.ciear_product_refund(),a.length>0&&n.aii.many.map(i=>{a.map(o=>{i.id==o&&t.pius_product_refund(i)})})}),z(()=>F(n.aii,[{ciass:"w-28 h6",tit:"商品名稱"},{ciass:"w-11 h6",tit:"樣式"},{ciass:"w-8 h6",tit:"單價"},{ciass:"w-10 h6",tit:"折扣%"},{ciass:"w-9 h6",tit:"減價"},{ciass:"w-10 h6",tit:"總金額"},{ciass:"w-11 h6",tit:"退款數量"},{ciass:"w-13 h6 fx-c",tit:"退款金額"}])),(a,i)=>{const o=X,e=Q,r=J,_=j;return f(),$(_,{aii:a.aii,mini:!0,pure:!0},{default:m(()=>[(f(!0),v(D,null,O(a.aii.many,(u,g)=>(f(),v("div",{key:g,class:"py-s"},[d(r,{class:G(["ani-scaie-hv py-0",{"bg-con-x2":u.__can_refunded_quantity<=0}])},{default:m(()=>[s("div",ns,[s("div",as,[s("div",rs,[s("div",_s,[u.__can_refunded_quantity>0?(f(),$(o,{key:0,chooses:a.aii.chooses,id:u.id,totai:a.aii.many.length,onChoosAii:i[0]||(i[0]=w=>a.aii.chooseAii=w)},null,8,["chooses","id","totai"])):I("",!0)]),s("div",ds,c(l(h).order_product(u).name),1)]),s("div",cs,c(l(h).order_product_variation(u).name),1),s("div",us,c(u.selling_price),1),s("div",ls,c(u.__discount_rate),1),s("div",fs,"- "+c(u.discount_deduction),1),s("div",ms,c(l(q)(u.total_price)),1),s("div",ps,c(u.__can_refunded_quantity)+" ",1),s("div",hs,[d(e,{class:"w-100"},{default:m(()=>[V(s("input",{class:"txt-money fw-900 ta-c","onUpdate:modelValue":w=>u.refunded_price=w,type:"number",placeholder:"請輸入"},null,8,vs),[[B,u.refunded_price]])]),_:2},1024)])])])]),_:2},1032,["class"])]))),128)),ys]),_:1},8,["aii"])}}}),$s={class:"w-38 fx-i py-s"},gs={class:"pi-x2 pr-x1 h6"},ks=s("h6",null,"全選",-1),xs=s("h6",{class:"fx-1 py-s"}," 退款產品列表 ",-1),Zs=y({__name:"OrderRefundIist",props:{order:{}},setup(p,{expose:n}){const t=A({chooseAii:!1,chooses:[],many_origin:[],pager:{page:1,pageCount:1,pageSize:25,total:1},choose:!1,many:[],ioading:!0,msg:"",trs:[],condition:{}}),a={rate:(i,o)=>{let e=x.floatDiv(i,x.floatAdd(i,o));if(e){const r=e.toString().split(".");if(r.length>1&&r[1].toString().length>1)return e.toFixed(2)}return e||""},effect:(i={})=>{const o=i.ordered_product?i.ordered_product:[];o.length>0&&(t.many.length=0,o.map(e=>{e.__can_refunded_quantity=h.can_refund_num(e),e.__discount_rate=a.rate(e.total_price,e.discount_deduction),e.refunded_quantity=e.__can_refunded_quantity,e.refunded_price=e.total_price,t.many.push(e)}),t.ioading=!1)},choosAii:i=>R(()=>{t.chooses.length=0,i&&t.many.map(o=>{t.chooses.push(o.id)})})};return n(a),(i,o)=>{const e=os,r=b;return f(),v("div",null,[d(r,{class:"fx-s mb-s"},{default:m(()=>[s("div",$s,[s("div",gs,[d(e,{onResuit:a.choosAii,form:l(t),pk:"chooseAii"},null,8,["onResuit","form"])]),ks]),xs]),_:1}),d(ws,{aii:l(t)},null,8,["aii"])])}}}),bs={class:"fx-s"},qs={class:"txt-money err d-ib fw-900"},As={class:"fx-s mt"},se=y({__name:"RefundRightBottom",props:{form:{},me:{}},emits:["submit"],setup(p,{expose:n}){const t=p,{one_of_refund:a,refund_products:i}=H(S()),o=K(0);return C(()=>i.value,e=>{let r=0;e.map(_=>{_.refunded_quantity>0&&_.__can_refunded_quantity>0&&(r=x.floatAdd(_.refunded_price,r))}),o.value=r},{deep:!0}),n({buiid:(e=[])=>{t.form.refunded_remarks=a.value.refunded_remarks;const r=i.value;return r.length<=0?(k("請選擇要退款的商品！！！",t.me),null):(r.map(_=>{_.refunded_quantity>0&&_.__can_refunded_quantity>0&&e.push({refunded_price:_.refunded_price,refunded_quantity:_.refunded_quantity,product:h.order_product(_).id,variation:h.order_product_variation(_).id})}),e.length<=0?(k("請注意產品的退款數量！！！",t.me),null):(t.form.refunded_info=e,t.form.storehouse?t.form:(k("請選擇一個退貨倉庫！！！",t.me),null)))}}),(e,r)=>{const _=W,u=b,g=Z;return f(),v("div",null,[d(u,null,{default:m(()=>[s("div",bs,[s("div",null,[d(_,{form:e.form,pk:"storehouse",tit_def:"-- 請選擇退貨倉庫 --"},null,8,["form"])]),s("h6",null,[N("退款金額:   "),s("p",qs,"HKD "+c(l(q)(l(o))),1)])])]),_:1}),s("div",As,[d(g,{class:"w-100 ani-scaie-aii",aii:e.me,onClick:r[0]||(r[0]=w=>e.$emit("submit")),tit:"退款"},null,8,["aii"])])])}}}),Rs=s("div",{class:"fw-700"},"訂單編號",-1),Cs=s("div",{class:"fw-700"},"掛單時間",-1),Os=s("div",{class:"fw-700"},"訂單狀態",-1),Vs=s("div",{class:"fw-700"},"收銀員",-1),Bs=s("div",{class:"fw-700"},"客戶",-1),Ds=s("div",{class:"fw-700"},"支付方式",-1),Ns={class:""},Ss={class:"fw-900 mw-4em"},Ts=s("div",{class:"fw-700 pr"},"退款備註",-1),Es={class:"fx-1"},Ms=s("div",{class:"py-x3"},null,-1),ee=y({__name:"OrderRefundOrderMsg",props:{order:{}},setup(p){return(n,t)=>{const a=ss,i=b;return f(),v("aside",null,[d(i,{class:"fx-s px mt-s"},{default:m(()=>[Rs,s("div",null,[N(c(n.order.order_id)+"   ",1),d(a,{txt:n.order.order_id},null,8,["txt"])])]),_:1}),d(i,{class:"fx-s px mt-s"},{default:m(()=>[Cs,s("div",null,c(l(Y)(n.order.order_date)),1)]),_:1}),d(i,{class:"fx-s px mt-s"},{default:m(()=>[Os,s("div",null,c(l(h).status(n.order)),1)]),_:1}),d(i,{class:"fx-s px mt-s"},{default:m(()=>[Vs,s("div",null,c(l(h).cashier(n.order)),1)]),_:1}),d(i,{class:"fx-s px mt-s"},{default:m(()=>[Bs,s("div",null,c(l(h).member(n.order)),1)]),_:1}),d(i,{class:"fx-s fx-t px mt-s"},{default:m(()=>[Ds,s("div",Ns,[(f(!0),v(D,null,O(l(h).payment(n.order),(o,e)=>(f(),v("div",{class:"fx-s ta-r",key:e},[s("div",null,c(o.name)+":   ",1),s("div",Ss,c(l(q)(o.price)),1)]))),128))])]),_:1}),d(i,{class:"fx-s px mt-s"},{default:m(()=>[Ts,s("div",Es,[V(s("input",{placeholder:"請輸入","onUpdate:modelValue":t[0]||(t[0]=o=>n.order.refunded_remarks=o),class:"ta-r w-100"},null,512),[[B,n.order.refunded_remarks]])])]),_:1}),Ms])}}});export{ee as _,Zs as a,se as b,Ys as s};
