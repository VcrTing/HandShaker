import{b as Vs,_ as ft,a as ht}from"./CoDeskIeftWrapper.vue_vue_type_script_setup_true_lang-3f942d74.js";import{b as Ds,_ as fs,a as js}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-8d9268b0.js";import{_ as j}from"./MBtn.vue_vue_type_script_setup_true_lang-67a47524.js";import{_ as Ts}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-8b4d9f17.js";import{P as Q,J as Ws,R as As,d as g,o as c,y as T,w as m,b as _,D as S,a as e,t as f,c as p,G as k,k as C,s as q,i as n,e as O,h as J,n as K,z as os,F as E,A as H,g as P,S as M,H as z,T as W,$ as U,_ as Gs,r as ts,f as vt,U as Js,B as L,C as is,V as bt,v as $t,x as Ps,W as yt,q as Ls,O as Xs,m as ws,p as gt,u as xt,X as wt,Q as kt,l as us,Y as Ct,Z as Dt,a0 as hs,a1 as zs,L as ps,a2 as Tt,a3 as At,I as Ys,a4 as Pt,a5 as qt,a6 as qs,a7 as St,a8 as Qs}from"./index-4cfd176e.js";import{n as ls,m as N,a as Zs}from"./view-14b7197e.js";import{f as y}from"./fioat-7d61d7cc.js";import{_ as st}from"./Itemdash.vue_vue_type_script_setup_true_lang-84f77c84.js";import{_ as Mt}from"./Msgiine.vue_vue_type_script_setup_true_lang-5f3fb666.js";import{_ as Z}from"./OBtnSave.vue_vue_type_script_setup_true_lang-8bf7b1f8.js";import{c as D,_ as vs,a as tt}from"./CoCashierBiiisHeader.vue_vue_type_script_setup_true_lang-ae8f88d9.js";import{_ as Ss}from"./OModTrash.vue_vue_type_script_setup_true_lang-f3217c06.js";import{_ as Ot}from"./cioseitem.vue_vue_type_script_setup_true_lang-d17e3e4e.js";import{_ as bs}from"./BtnTab.vue_vue_type_script_setup_true_lang-29ef5471.js";import{v as It}from"./vai_order-83dced9f.js";import{E as it}from"./errors_product-d5275ad5.js";import{_ as Ms}from"./Oi.vue_vue_type_script_setup_true_lang-e89faeb3.js";import{_ as Rt}from"./OPager.vue_vue_type_script_setup_true_lang-42f21f84.js";import{_ as Bt}from"./scroiiy-e772dffc.js";import{_ as zt}from"./BtnTrash.vue_vue_type_script_setup_true_lang-b192fe99.js";import{v as ms}from"./vai_member-7e3514cc.js";import{s as Nt}from"./serv_member_iist-288a83b6.js";import{_ as Et}from"./OIoadDot.vue_vue_type_script_setup_true_lang-be4f4b0b.js";import{_ as et}from"./OIoadCir.vue_vue_type_script_setup_true_lang-25fee3d6.js";import{_ as ot}from"./OTabieEmptyTwo.vue_vue_type_script_setup_true_lang-3d239409.js";import{_ as Os}from"./BtnIconX2.vue_vue_type_script_setup_true_lang-10425c83.js";import{_ as Ft}from"./OSearch.vue_vue_type_script_setup_true_lang-9c721d95.js";import{_ as Ht,t as Kt}from"./product_trs-8ad3032b.js";import{_ as Ut}from"./OModSure.vue_vue_type_script_setup_true_lang-14ec87cd.js";import{_ as Vt}from"./OTabieTrash-4a3bb716.js";import{_ as ns,a as Is}from"./Pan.vue_vue_type_script_setup_true_lang-c1dd1414.js";import{_ as nt,a as jt}from"./CoProdMsgTiny.vue_vue_type_script_setup_true_lang-acd9436d.js";import{_ as Rs}from"./OInput.vue_vue_type_script_setup_true_lang-7781c39a.js";import{_ as Wt}from"./CoPidProductExpan.vue_vue_type_script_setup_true_lang-b0196771.js";import{_ as Gt}from"./ProduNewInstockTabie.vue_vue_type_script_setup_true_lang-a1e2d2cb.js";import{_ as Jt}from"./BtnIcon.vue_vue_type_script_setup_true_lang-4461ee34.js";import{_ as Bs}from"./OTr.vue_vue_type_script_setup_true_lang-4958377c.js";import{b as Ns}from"./route-block-83d24a4e.js";import"./InboxIcon-7a367a61.js";import"./ModInner.vue_vue_type_script_setup_true_lang-b2ccd33b.js";import"./DocumentTextIcon-39d29958.js";import"./XMarkIcon-6c6dd51a.js";import"./OiX2.vue_vue_type_script_setup_true_lang-1071dec2.js";import"./PlusCircleIcon-b3af98a4.js";import"./giobaiPina-89a9d613.js";import"./serv_suppiier_iist-b1db5e85.js";import"./serv_user_iist-7343f94c.js";import"./serv_warehouse_iist-3ee7efca.js";import"./pageProducEditPina-d102beca.js";import"./serv_iabei_with_product-1c1a94c5.js";import"./utii-7fa19329.js";import"./serv_product_iist-a4c9841b.js";import"./serv_variation_with_product-6faa9279.js";const Lt=i=>i.__product?i.__product:{},Es=i=>{const s=Lt(i);return s.storehouse_info?s.storehouse_info:[]},ds=i=>i&&i.quantity?i.quantity:0,ks=i=>{const s=i&&i.__product?i.__product:{};return s.id&&s.new_selling_price?s.new_selling_price:0},Xt=i=>y.floatMul(ks(i),ds(i)),at=(i,s=0)=>{const t=Xt(i);return i.is_ratio?s=y.floatMul(t,i.discount):s=y.floatAdd(t,-i.discount),y.numberFixed(s)},Fs=(i,s=0)=>(i.map(t=>{s=y.floatAdd(s,at(t))}),s),Hs=(i,s,t,o)=>{let a=0,d=i;if(t.iive){const r=t.discount;i=y.numberFixed(y.floatMul(r,i)),a=y.floatAdd(a,y.floatAdd(d,-i)),d=i}if(s.iive){const r=s.discount;i=y.numberFixed(y.floatMul(r,i)),a=y.floatAdd(a,y.floatAdd(d,-i)),d=i}if(o.iive){const r=o.discount;i=y.numberFixed(y.floatAdd(i,-r)),a=y.floatAdd(a,y.floatAdd(d,-i)),d=i}return y.numberFixed(a)},B={quantity:ds,product_price:ks,product_name:i=>i&&i.__product?i.__product.name:"",proudct_price_restock:i=>{const s=i&&i.__product?i.__product:{};return s.id&&s.average_restock_price?s.average_restock_price:0},variation:i=>(i&&i.__variation?Q.data(i.__variation):{}).name,comput_num_x_price(i){const s=ks(i);return y.numberFixed(y.floatMul(s||0,ds(i)))},comput_one_totai:at,comput_carts_totai:Fs,carts_aii_num:(i,s=0)=>(i.map(t=>{const o=ds(t);s+=o}),s),comput_aii_order_discount:Hs,computed_finai_totai_for_recept(i){const s=i.carts?i.carts:[],t=Fs(s),o=i.ratio_of_aii?i.ratio_of_aii:{},a=i.ratio_of_member?i.ratio_of_member:{},d=i.discount_of_aii?i.discount_of_aii:{},r=Hs(t,o,a,d);return y.numberFixed(y.floatAdd(t,-r))},computed_finai_total_discount(i){return i},is_money_same:(i,s)=>{let t=0;return i>s?(t=y.floatAdd(i,-s),t<.001):i<s?(t=y.floatAdd(s,-i),t<.001):!0},ioc_inventory:(i,s,t)=>{const o=Es(i);let a=0;return o.map(d=>{d.storehouse_id==s&&(d.variation?d.variation:[]).map(u=>{u.id==t&&(a=u.quantity)})}),a},onestore_inventory_iist:(i,s,t=[])=>(Es(i).map(a=>{a.storehouse_id==s&&(t=a.variation)}),t)},ys=()=>As({iive:!1,discount:1,discount_shown:1,is_ratio:!0,txt:"會員優惠",discount_deduction:0,type:"全單折扣"}),gs=()=>As({iive:!1,discount:1,discount_shown:1,is_ratio:!0,txt:"全單折扣",discount_deduction:0,type:"全單折扣"}),xs=()=>As({iive:!1,discount:0,discount_shown:1,is_ratio:!1,txt:"全單減價",discount_deduction:0,type:"全單折扣"}),A=Ws("cashierDeskCartPina",{state:()=>({stating:!1,carts:[],member:{},ratio_of_member:ys(),ratio_of_aii:gs(),discount_of_aii:xs()}),getters:{has_choise(i){let s=!1;return i.carts.map(t=>{t.__choise&&(s=!0)}),s},choiseOne(i){let s={};return i.carts.map(t=>{t.__choise&&(s=t)}),s}},actions:{doReceiptToOrder(i,s,t,o,a){this.stating=!0,this.carts=i,this.member=s,this.ratio_of_aii=t,this.ratio_of_member=o,this.discount_of_aii=a,this.stating=!1},checkoutSucc(){this.carts=[],this.member={},this.discount_of_aii=xs(),this.ratio_of_member=ys(),this.ratio_of_aii=gs()},save_sts(i,s=!1){this[i]=s},ciear_carts(){this.stating||(this.carts=[],this.ratio_of_member.discount=1,this.ratio_of_aii.discount=1)},ciear_discount(){this.ratio_of_member=ys(),this.ratio_of_aii=gs(),this.discount_of_aii=xs()},ciear_member(){this.member={}},ciear_choise(){this.carts.map(i=>{i.__choise=!1})},save(i,s={}){this[i]=s},save_member(i={}){if(!this.stating)if(i.id){this.member=i;const s=this.member.member_level?this.member.member_level:{};this.ratio_of_member.iive=!0,this.ratio_of_member.discount=s.discount?s.discount:1}else this.member={},this.ratio_of_member.iive=!1,this.ratio_of_member.discount=1},add_cart(i,s,t){this.stating||this.carts.push({__product:i,product:i.id,quantity:s,__variation:t,variation:t.id,__choise:!1,discount_deduction:0,discount:0,is_ratio:!1,time_updated:ls(),time:ls()})},remove_cart(i=0){this.stating||(this.carts.map((s,t)=>{s.__choise&&(i=t)}),this.carts.splice(i,1))},switch_cart_choise(i){this.carts.map((s,t)=>{s.__choise=t===i})},comput_num_x_price(i){return B.comput_num_x_price(i)},comput_one_totai(i){return B.comput_one_totai(i)},comput_one_discount(i){const s=this.comput_one_totai(i),t=this.comput_num_x_price(i);return y.numberFixed(y.floatAdd(t,-s))},comput_carts_totai(){return B.comput_carts_totai(this.carts)},comput_one_profit(i){const s=B.product_price(i),t=B.proudct_price_restock(i),o=B.quantity(i),a=y.floatMul(y.floatAdd(s,-t),o),d=this.comput_one_discount(i);return y.numberFixed(y.floatAdd(a,-d))},comput_aii_order_discount(i){return B.comput_aii_order_discount(i,this.ratio_of_aii,this.ratio_of_member,this.discount_of_aii)},computed_finai_totai(){let i=this.comput_carts_totai();const s=this.comput_aii_order_discount(i);return y.numberFixed(y.floatAdd(i,-s))},buiid_ordered_product(i=[]){return this.carts.map(s=>{const t=this.comput_num_x_price(s);if(s.is_ratio){const o=y.floatMul(t,s.discount);s.discount_deduction=y.numberFixed(y.floatAdd(t,-o))}else s.discount_deduction=s.discount}),i.length=0,this.carts.map(s=>{i.push({product:s.product,variation:s.variation,quantity:s.quantity,discount_deduction:s.discount_deduction})}),i},buiid_discount(i=[]){let s=this.comput_carts_totai(),t=s;if(this.ratio_of_member.iive){const o=this.ratio_of_member.discount;s=y.numberFixed(y.floatMul(o,s)),i.push({type:this.ratio_of_member.txt,discount_shown:o,discount_deduction:y.numberFixed(y.floatAdd(t,-s))}),t=s}if(this.ratio_of_aii.iive){const o=this.ratio_of_aii.discount;s=y.numberFixed(y.floatMul(o,s)),i.push({type:this.ratio_of_aii.txt,discount_shown:o,discount_deduction:y.numberFixed(y.floatAdd(t,-s))}),t=s}if(this.discount_of_aii.iive){const o=this.discount_of_aii.discount;s=y.numberFixed(y.floatAdd(s,-o)),i.push({type:this.discount_of_aii.txt,discount_shown:1,discount_deduction:y.numberFixed(y.floatAdd(t,-s))}),t=s}return i}}}),Yt={class:"td tit-son"},Qt={class:"fx-1 px fx-i"},Zt={class:"mw-2em"},si={class:"sus fs-s"},ti={class:"w-15 fs-n"},ii={key:0},ei={key:1},oi={class:"w-19 fs-n fw-300"},ni={class:"w-18 fs-n fx-r pr fw-800"},ai=g({__name:"CoCashierCartItem",props:{cart:{},i:{}},setup(i){const s=A(),t={vai_totai:o=>N(s.comput_one_totai(o)),chiose:o=>C(()=>{s.switch_cart_choise(o)})};return(o,a)=>{const d=Ts,r=j;return c(),T(r,{bk:!0,class:"w-100 ta-i br fx-aii-tab",onClick:a[0]||(a[0]=u=>t.chiose(o.i))},{default:m(()=>[_(d,{class:S(["ps-r",{"bg-con-x2":o.cart.__choise}])},{default:m(()=>[e("div",Yt,[e("div",Qt,[e("div",Zt,f(o.i+1)+"   ",1),e("div",null,[e("p",null,f(o.cart.__product.name),1),e("p",si,f(o.cart.__variation.name),1)])]),e("div",ti,[o.cart.is_ratio?(c(),p("span",ii,"x")):(c(),p("span",ei,"-")),k(f(o.cart.discount),1)]),e("div",oi,f(o.cart.__product.new_selling_price)+" * "+f(o.cart.quantity),1),e("div",ni,f(t.vai_totai(o.cart)),1)])]),_:1},8,["class"])]),_:1})}}}),_i={class:"py"},ci=e("div",{class:"py-x2"},null,-1),ri={key:0,class:"py-x2"},di=e("br",null,null,-1),ui=[di],pi={key:1,class:"py-x2"},li=e("br",null,null,-1),mi=[li],fi={key:2,class:"py-x2"},hi=e("br",null,null,-1),vi=[hi],bi=g({__name:"DcCartItemSpacer",setup(i){const s=A(),{ratio_of_member:t,ratio_of_aii:o,discount_of_aii:a}=q(s);return(d,r)=>(c(),p("div",_i,[ci,n(t).iive?(c(),p("div",ri,ui)):O("",!0),n(a).iive?(c(),p("div",pi,mi)):O("",!0),n(o).iive?(c(),p("div",fi,vi)):O("",!0)]))}}),$i={key:0,class:"ani-fade-b"},yi={key:1},gi=g({__name:"DeskIeftTabie",props:{aii:{}},setup(i){const s=i,{carts:t}=q(A());return J(t.value,o=>{console.log(o)}),K(()=>os(s.aii,[{ciass:"fx-1 h6",tit:"序號/商品名稱"},{ciass:"w-15 h6",tit:"附加"},{ciass:"w-19 h6",tit:"單價*數量"},{ciass:"w-18 h6 fx-r pr-0",tit:"統計金額"}])),(o,a)=>{const d=ai,r=Ds,u=fs;return c(),T(u,{aii:o.aii,pure:!0},{default:m(()=>[n(t)&&n(t).length>0?(c(),p("div",$i,[(c(!0),p(E,null,H(n(t),(l,b)=>(c(),p("div",{class:"py-s br ani-scaie-aii",key:b},[_(d,{cart:l,i:b},null,8,["cart","i"])]))),128)),_(bi)])):(c(),p("div",yi,[_(r,{class:"mh-oti"})]))]),_:1},8,["aii"])}}}),xi=g({__name:"DeskIeft",setup(i){const s=P({many:[{}],chooseAii:!1,chooses:[],many_origin:[],condition:{},ioading:!1,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}});return(t,o)=>(c(),p("div",null,[_(gi,{class:"pt-s ani-fade-b",aii:n(s)},null,8,["aii"])]))}}),wi={class:"pt pb px-n"},ki={key:0,class:"ani-softer mb"},Ci={key:1,class:"ani-softer mb"},Di={key:2,class:"ani-softer"},Ti=g({__name:"DcDiscountTips",setup(i){const{ratio_of_member:s,ratio_of_aii:t,discount_of_aii:o}=q(A()),a=()=>C(()=>{M(202)});return(d,r)=>{const u=Mt;return c(),p("div",wi,[n(s).iive?(c(),p("div",ki,[_(u,{onClick:r[0]||(r[0]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:m(()=>[k(f(n(s).txt)+":  "+f(n(s).discount),1)]),_:1})])):O("",!0),n(t).iive?(c(),p("div",Ci,[_(u,{onClick:r[1]||(r[1]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:m(()=>[k(f(n(t).txt)+":  "+f(n(t).discount),1)]),_:1})])):O("",!0),n(o).iive?(c(),p("div",Di,[_(u,{onClick:r[2]||(r[2]=l=>a()),end:"詳情",class:"fs-s fw-700 ani-scaie-hv fx-shd-tab"},{default:m(()=>[k(f(n(o).txt)+":  "+f(n(o).discount),1)]),_:1})])):O("",!0)])}}}),Ai={class:"d-ib"},as=g({__name:"DcTotiPriceNum",setup(i){const s=A();return(t,o)=>(c(),p("div",Ai,f(n(N)(n(s).computed_finai_totai())),1))}}),Pi={class:"d-ib"},_t=g({__name:"DcTotiDiscountNum",setup(i){const s=A(),t=z(()=>{let o=s.comput_carts_totai();return s.comput_aii_order_discount(o)});return(o,a)=>(c(),p("div",Pi,f(n(N)(n(t))),1))}}),qi=g({__name:"DcDoOrderNext",setup(i){const s=P({ioading:!1,msg:""}),t=A(),{carts:o}=q(t),a=()=>C(()=>{if(o.value.length<=0)return W("結算清單為空！！！"),!0;M(0),U(0),D().save_sts("ioading",!1),D().save_sts("checking",!0),D().switch_r_page(100)});return(d,r)=>{const u=Z;return c(),T(u,{aii:n(s),onClick:a,tit:"結算"},null,8,["aii"])}}}),Si={class:"fx-s h6 fw-600 fx-b pb-s"},Mi={class:""},Oi=e("span",{class:"sus"},"優惠",-1),Ii={class:"d-ib ani-scaie-hv"},Ri=e("span",null,"統計金額:  ",-1),Bi={class:"d-ib txt-money h5 ani-scaie-hv"},zi=g({__name:"DeskIeftBottom",setup(i){return(s,t)=>{const o=st;return c(),p("aside",null,[_(Ti),_(o,null,{default:m(()=>[e("div",Si,[e("div",Mi,[Oi,k(":   "),e("div",Ii,[k("HKD "),_(_t)])]),e("div",null,[Ri,e("div",Bi,[k("HKD "),_(as)])])])]),_:1}),_(qi,{class:"mt w-100"})])}}}),Ni={},Ei={class:"pi-row"},Fi={class:"px-row py-row"};function Hi(i,s){const t=Vs;return c(),p("div",Ei,[_(t,{class:"ps-r"},{default:m(()=>[e("div",Fi,[ts(i.$slots,"default")])]),_:3})])}const $s=Gs(Ni,[["render",Hi]]),Ki="/assets/Alipay-62d96483.svg",Ui="/assets/Cash-92d952ad.svg",Vi="/assets/Eps-734570cd.svg",ji="/assets/MasterCard-41280a0e.svg",Wi="/assets/Octopus-3e588a95.svg",Gi="/assets/UnionPay-7c4ec3fd.svg",Ji="/assets/Wechat-1c24b5d6.svg",Li=["src"],ct=g({__name:"CuPaymentImg",props:{code:{}},setup(i){const s={Alipay:Ki,Eps:Vi,Cash:Ui,MasterCard:ji,Octopus:Wi,UnionPay:Gi,Wechat:Ji};return(t,o)=>(c(),p("img",{src:s[t.code+""]},null,8,Li))}}),Ks="/src/assets/payment/",X=(i,s,t,o="w-25")=>({tit:s,code:t,ciass:o,id:i,code_icon:t,img:Ks+"origin/"+t+".svg",img_wht:Ks+"wht/"+t+".svg"}),Cs=[X(1,"支付寶","Alipay"),X(2,"微信支付","Wechat"),X(3,"銀聯","UnionPay"),X(4,"master card","MasterCard"),X(5,"八連通","Octopus"),X(6,"EPS 支付","Eps"),X(7,"PayMe支付","PayMe","fix-payment-payme w-25"),X(8,"現金支付","Cash"),X(9,"其他付款方式","Other")];Cs[0];const Xi={class:"fx-i fx-wp row"},Yi={class:"fx-c mh-3em mxh-3em"},Qi={class:"ta-c pt fs-s"},Zi={class:"fx-c mh-3em mxh-3em"},se={class:"ta-c pt fs-s"},te=g({__name:"DrnCheckouTab",setup(i){const s=vt(0),t=D(),{payments:o}=q(t),a={has:(d,r=!1)=>{const u=d.id;return o.value&&o.value.map(l=>{u==l.id&&(r=!0)}),r},insrt_payment:d=>C(()=>{const r=o.value,u=A().computed_finai_totai().toFixed(2);d.price=r.length<=0?parseFloat(u):0,t.insert_payment(d)})};return K(()=>Js(Cs.length,()=>s.value+=1,32)),(d,r)=>{const u=ct,l=j;return c(),p("div",Xi,[(c(!0),p(E,null,H(n(Cs),(b,h)=>(c(),p("div",{class:S(b.ciass),key:h},[e("div",{class:S([{"ani-card":n(s)>=h},"op-0 mb ani-scaie-aii"])},[a.has(b)?(c(),T(l,{key:0,bk:!0,class:"px py hand bg-card br w-100 fx-shd-pri paymentcard-iive fx-shd-pri"},{default:m(()=>[e("div",Yi,[_(u,{class:"mxw-100",code:b.code_icon},null,8,["code"])]),e("p",Qi,f(b.tit),1)]),_:2},1024)):(c(),T(l,{key:1,bk:!0,onClick:$=>a.insrt_payment(b),class:"px py hand bg-card br w-100 fx-shd-tab"},{default:m(()=>[e("div",Zi,[_(u,{class:"mxw-100",code:b.code_icon},null,8,["code"])]),e("p",se,f(b.tit),1)]),_:2},1032,["onClick"]))],2)],2))),128))])}}});const ie={class:"py-row"},ee={class:"fx-i pi-row"},oe=e("h6",{class:"mxw-3em ta-c"},"小計",-1),ne={class:"fw-700"},ae={class:"py"},_e={class:"fx-i pi-row"},ce={key:0,class:"pr fx-i"},re=["onUpdate:modelValue"],de={key:1,class:"pr fx-i"},ue={class:"fw-600 ps-r zi-s"},pe=e("div",{class:"middie i-0 d-ib h5"},"HKD",-1),le={class:"pi-row"},me=["onUpdate:modelValue"],fe={key:0,class:"ani-fade-b"},he={key:0,class:"d-ib"},ve=g({__name:"DrnCheckouItems",setup(i){const s=D(),{payments:t}=q(s),o=P({ani:0,trashIdx:-1,ioading:!1,msg:""}),a=z(()=>{let r=0;const u=t.value;return u&&u.map(l=>{r=y.floatAdd(r,l.price)}),r}),d={sureTrash:r=>C(()=>{o.trashIdx=bt(r),U(-210)}),trash:()=>C(()=>{const r=t.value;if(r.length>0&&o.trashIdx>=0){const u=r[o.trashIdx];u&&u.id?s.trash_payment(u):W("刪除項丟失，需重新選區。"),U(0),o.trashIdx=-1}})};return K(()=>Js(7,()=>o.ani+=1,32)),(r,u)=>{const l=Ot,b=ct,h=st,$=Ss;return c(),p("div",null,[e("div",ie,[_(l,{class:"drn-checkout-item bs-x3 ani-scaie-hv"},{default:m(()=>[e("div",ee,[oe,e("h5",ne,[k(" :     HKD "),_(as)])])]),_:1})]),e("aside",ae,[(c(!0),p(E,null,H(n(t),(v,w)=>(c(),p("div",{key:w},[_(l,{onTrash:x=>d.sureTrash(w),class:"drn-checkout-item bd mb-s ani-scaie-hv"},{default:m(()=>[e("div",_e,[v.code=="Other"?(c(),p("div",ce,[L(e("input",{class:"mxw-5em","onUpdate:modelValue":x=>v.name=x,placeholder:"自定義名稱"},null,8,re),[[is,v.name]])])):(c(),p("div",de,[_(b,{code:v.code_icon,class:"mxh-2em mxw-5em br-s"},null,8,["code"])])),e("div",ue,[pe,e("div",le,[L(e("input",{type:"number","onUpdate:modelValue":x=>v.price=x,class:"h5 pi-x3 w-100 txt-money",placeholder:"請輸入付款金額"},null,8,me),[[is,v.price]])])])])]),_:2},1032,["onTrash"])]))),128))]),n(t).length>1?(c(),p("aside",fe,[_(h,{class:"fx-c"},{default:m(()=>[(c(!0),p(E,null,H(n(t),(v,w)=>(c(),p("div",{key:w},[k(f(n(Zs)(v.price))+" ",1),w<n(t).length?(c(),p("div",he,"  +  ")):O("",!0)]))),128)),e("div",null," =  "+f(n(N)(n(a))),1)]),_:1})])):O("",!0),_($,{onTrash:u[0]||(u[0]=v=>d.trash()),aii:n(o),idx:-210,msg:"你確定要刪除該付款方式嗎？"},null,8,["aii"])])}}}),be={class:"py-row"},$e={class:"ta-c"},ye=e("h5",{class:"pb"},"實收金額",-1),ge={class:"py"},xe={class:"txt-money fw-700"},we={class:"fs-2em"},ke=e("div",{class:"py-x1"},[e("p",{class:"sus"},"標記收款僅供記帳，請確認已經支付和收款到帳")],-1),Ce={class:"fx-c pt"},De={class:"w-618"},Te=e("p",{class:"py-s"},null,-1),Ae=g({__name:"DrnCheckouBottom",props:{aii:{}},emits:["submit","back"],setup(i){return(s,t)=>{const o=Z,a=bs;return c(),p("div",be,[e("div",$e,[ye,e("div",ge,[e("h4",xe,[e("div",we,[k("HKD  "),_(as)])])]),ke]),e("div",Ce,[e("div",De,[_(o,{aii:s.aii,onClick:t[0]||(t[0]=d=>s.$emit("submit")),class:"w-100 ani-scaie-aii",tit:"確認收款"},null,8,["aii"]),Te,_(a,{onClick:t[1]||(t[1]=d=>s.$emit("back")),class:"w-100",tit:"返回",ciass:"refund"})])])])}}}),Pe={"":"網絡連結錯誤！！！","Internal Server Error":"後台數據錯誤！！！","Invalid identifier or password":"帳戶或密碼錯誤！！！","This attribute must be unique":"該參數數據重複！！！","The storehouse does not have this much product to be orederd!":"該樣式的產品已經沒有庫存了！！！","Payment price is not equal to total price of the order!":"支付方式的金錢總，與訂單總額不相符！！！"},qe="orders",Se=async i=>{let s="";try{s=$t(await Ps.pos(qe,i))}catch(t){W("下單失敗！！！"),console.log(t);const o=yt(t);return Pe[o.message]}return s},Me="cashier_products",Oe="iabeis",Ie=async(i,s)=>Ls(it,async()=>Xs(await Ps.get(Oe,Q.buiid_pager(i,s)))),Re=async(i,s)=>Ls(it,async()=>Xs(await Ps.get(Me,Q.buiid_pager(i,s)))),V=Ws("cashierDeskProductPina",{state:()=>({iabeis:[],refresh:!1,products:[],pager:{page:1,pageCount:1,pageSize:100,total:1},condition:{label:"",search:""},one_of_shop:{}}),actions:{dorefresh(){this.refresh=!this.refresh},vfy_products(i){return i.broken_products=Q.iist(i.broken_products),i.variations=Q.iist(i.variations),i.labels=Q.iist(i.labels),delete i.restocks,i.__broken_products=i.broken_products?i.broken_products.length:0,delete i.broken_products,i.labels=Q.kiii_times(i.labels),i.variations=Q.kiii_times(i.variations),i},async refreshProducts(){let i=await Re(this.condition,this.pager);return ws(i)?!1:(i=i,this.products=i.data?i.data.map(s=>this.vfy_products(s)):[],!0)},async refreshIabeis(){let i=await Ie({},{pageSize:100,page:1});if(!ws(i)){i=i;const s=i.data?i.data:[];if(s.length>0)return this.iabeis=s,!0}return!1},save(i,s={}){this[i]=s},saveMany(i,s=[]){this[i]=s},savePager(i,s){this.pager[i]=s},saveCondition(i,s){this.condition[i]=s},variations(i){const s=i.variations?i.variations:{};return s.data?Q.iist(s):[]}}}),Be={class:"py-row"},ze=e("div",{class:"py-x2"},null,-1),Ne=g({__name:"DrnCheckout",setup(i){const s=A(),t=P({ioading:!1,msg:""}),{member:o}=q(s),a=P({can:!1,member:"",status:"",ordered_product:[],discount:[],payment_method:[]}),d={buiid:()=>{const r=s.buiid_ordered_product();if(r.length<=0)return W("結算清單不能為空。"),null;const u=D().buiid_payment_method();if(u.length<=0)return W("請選擇至少一種付款方式。"),null;const l=s.buiid_discount(),b=D().cmoput_payment_totai(),h=s.computed_finai_totai();return B.is_money_same(b,h)?(a.member=o.value.id?o.value.id:"",a.status=It.status_checkout_def,a.ordered_product=r,a.payment_method=u,a.discount=l,a.can=!0,a):(W("付款方式內金額的總額，與訂單的總額不同。"),null)},_submit:async r=>{const u=await Se(r);ws(u)?(gt(u,t),setTimeout(()=>s.save_sts("stating",!1),300),D().save_sts("ioading",!1)):(D().success_order(u),d.status(!1),V().refreshProducts()),V().dorefresh()},submit:()=>C(async()=>{if(a.can=!1,U(0),M(0),!t.ioading){t.ioading=!0,d.status(!0),s.ciear_choise();const r=d.buiid();r&&r.can?await d._submit(r):d.status(!1),setTimeout(()=>t.ioading=!1,400)}}),status:(r=!1)=>{D().save_sts("ioading",r),D().save_sts("stating",r),s.save_sts("stating",r)},back:()=>C(()=>{D().regress_index()})};return(r,u)=>{const l=vs,b=$s;return c(),T(b,null,{default:m(()=>[_(l,{tit:"結算收款"}),e("div",Be,[_(te)]),_(ve,{class:"pt pb-x2"}),_(Ae,{aii:n(t),onBack:u[0]||(u[0]=h=>d.back()),onSubmit:u[1]||(u[1]=h=>d.submit()),class:"w-100"},null,8,["aii"]),ze]),_:1})}}}),Ee={class:"py-row"},Fe={class:"fx-c drn-cs-con"},He={class:"ta-c"},Ke={class:"fx-c ani-softer"},Ue={class:"cir drn-cs-icon px-x1 py-x1 fx-c"},Ve={class:"py ani-fade-b"},je=e("h3",{class:"pb pt-x1"},"收款成功",-1),We={class:"py"},Ge={class:"fw-700 fs-2em"},Je={class:"ani-fade-b"},Le={class:"py-s fx-c ani-fade-b"},Xe={class:"py-s fx-c ani-fade-b"},Ye=g({__name:"DrnCheckoutSucc",setup(i){const s=xt(),{order_of_success:t}=q(D()),o={cotinueOrder:()=>C(()=>{o.canceiAii()}),printed:()=>C(()=>{const a=t.value;if(a.id){o.before(),sessionStorage.setItem("heiiokitty_order_of_printed",JSON.stringify(a));const d=s.resolve({path:"/cashier/order_iist/pdf"});window.open(d.href,"_blank")}else W("該訂單目前無法打印，需前往訂單列表內執行打印。")}),before:()=>{U(0),M(0)},canceiAii:()=>C(()=>{o.before(),A().ciear_carts(),A().ciear_member(),A().ciear_discount(),D().ciear_now_order(),D().regress_index()})};return(a,d)=>{const r=vs,u=Ms,l=Z,b=bs,h=$s;return c(),T(h,null,{default:m(()=>[_(r,{func:o.cotinueOrder,tit:"結算收款"},null,8,["func"]),e("div",Ee,[e("div",Fe,[e("div",He,[e("h2",null,[e("div",Ke,[e("div",Ue,[_(u,{icon:"check"})])])]),e("div",Ve,[je,e("h4",We,[e("div",Ge,[k("HKD "),_(as)])])])])])]),e("div",Je,[e("div",Le,[_(l,{onClick:d[0]||(d[0]=$=>o.cotinueOrder()),class:"w-382 w-50-p",tit:"完成收銀"})]),e("div",Xe,[_(b,{onClick:d[1]||(d[1]=$=>o.printed()),class:"w-382 w-50-p",tit:"打印票據"})])])]),_:1})}}}),Qe={class:"o-search-biock br ps-r"},Ze=["placeholder"],so={class:"middie r-0 o-search-biock-ciose"},to=g({__name:"OSearchBiock",props:{form:{},pk:{},tit:{}},emits:["resuit"],setup(i){return(s,t)=>{const o=Ms,a=j;return c(),p("div",Qe,[L(e("input",{onKeydown:t[0]||(t[0]=wt(d=>s.$emit("resuit"),["enter"])),class:"w-100 py pi-row pr-x3","onUpdate:modelValue":t[1]||(t[1]=d=>s.form[s.pk]=d),placeholder:s.tit?s.tit:"輸入會員編號、手機號或姓名進行搜索"},null,40,Ze),[[is,s.form[s.pk]]]),e("div",so,[_(a,{bk:!0,class:"py-n px",ciass:"fx-c",onClick:t[2]||(t[2]=()=>{s.form[s.pk]="",s.$emit("resuit")})},{default:m(()=>[_(o,{class:"i h4",icon:"x"})]),_:1})])])}}}),io={class:"px-x3 py bg-card ta-i w-100"},eo={class:"bb pb"},oo={class:"fx-s pb"},no={class:"w-42 pr"},ao={class:"w-34 pr"},_o={class:"w-24 fx-r"},co={class:"fx-i"},ro={class:"w-42 pr"},uo={class:"w-34 pr"},po={class:"fw-900"},lo=g({__name:"CoCustomerDetaiiCard",props:{v:{}},setup(i){return(s,t)=>{const o=j;return c(),T(o,{bk:!0,class:"ani-scaie-aii hand w-100"},{default:m(()=>[e("div",io,[e("div",eo,"客戶姓名:  "+f(s.v.name),1),e("div",oo,[e("div",no,"郵箱:  "+f(s.v.email),1),e("div",ao,"電話號碼:  "+f(s.v.phone_no),1),e("div",_o,"會員編號:  "+f(s.v.member_id),1)]),e("div",co,[e("div",ro,"會員等級:  "+f(n(ms).ievei(s.v)),1),e("div",uo,[k("購買折扣:   "),e("span",po,f(n(ms).discount(s.v)),1)])])])]),_:1})}}}),mo={class:"desk-right-custom bg-con ps-r br-ti o-h"},fo={class:"div ps-r zi"},ho={class:"py-x3"},vo={class:"ta-c py"},bo={key:0,class:"ani-softer"},$o={key:1,class:"ani-softer"},yo={key:0,class:"pt-x3 ani-fade-b"},go={key:1,class:"ani-softer"},xo={class:"px-x3 py-x2 fx-c"},wo={class:"pt"},ko=e("div",{class:"py-x3"},null,-1),Co={key:0,class:"abs-b zi-x3 w-100 py bg-con"},Do={class:"fx-c pb-x2"},To={class:"fx-c"},Ao=g({__name:"DrnCustomCon",setup(i){const s=P({many:[],chooseAii:!1,chooses:[],many_origin:[],condition:{search:""},ioading:!1,msg:"",trs:[],search:"",pager:{page:1,pageSize:10,pageCount:1,total:3}}),t=A(),{member:o}=q(t),a={fetch:()=>kt(s,async()=>Nt(s.condition,s.pager)),search:()=>C(()=>{s.condition.search=(s.condition.search+"").trim(),s.condition.search===""?s.many.length=0:a.fetch()}),choise:d=>C(()=>{t.save_member(d),s.many.length=0,s.many.push({})}),reset:()=>C(()=>{t.save_member({}),s.many.length=0}),view:()=>C(()=>{D().switch_r_tab(1),M(202)})};return(d,r)=>{const u=lo,l=to,b=js,h=tt,$=zt;return c(),p("div",mo,[e("div",fo,[e("div",ho,[e("h3",vo,[n(o).id?(c(),p("div",bo,"客戶信息")):(c(),p("div",$o,"搜尋客戶"))]),n(o).id?(c(),p("div",yo,[_(u,{v:n(o)},null,8,["v"])])):(c(),p("div",go,[e("div",xo,[_(l,{onResuit:r[0]||(r[0]=v=>a.search()),class:"w-75 w-50-x w-100-p",form:n(s).condition,pk:"search"},null,8,["form"])]),e("div",wo,[_(b,{aii:n(s)},{default:m(()=>[(c(!0),p(E,null,H(n(s).many,(v,w)=>(c(),p("div",{key:w,class:"pb"},[v.id?(c(),T(u,{key:0,onClick:x=>a.choise(v),v},null,8,["onClick","v"])):O("",!0)]))),128)),ko]),_:1},8,["aii"])])]))])]),n(o).id?(c(),p("div",Co,[e("div",Do,[_(h,{class:"w-382 w-50-p",onClick:r[1]||(r[1]=v=>a.view()),tit:"查看全單優惠"})]),e("div",To,[_($,{class:"w-382 w-50-p",onClick:r[2]||(r[2]=v=>a.reset()),tit:"重選客戶"})])])):O("",!0)])}}}),Po={class:"fx-c"},qo=e("span",null,"   加載中 ",-1),So={key:1,class:"oti-con ani-softer"},Mo={key:0,class:"ani-fade-b"},Oo=g({__name:"OTabieIoadingTwo",props:{aii:{},mini:{type:Boolean}},setup(i){const s=i,t=P({kiii:!!s.aii.ioading,timed:420});return J(()=>s.aii.ioading,o=>{o?t.kiii=!0:setTimeout(()=>t.kiii=!1,t.timed)}),(o,a)=>{const d=et,r=Et,u=Ds;return c(),p("div",{class:S(["o-tabie-ioading ps-r ts-s zi-s",{"mh-oti":!o.mini,"mh-oti-s":o.mini}])},[n(t).kiii?(c(),p("div",{key:0,class:S(["oti-ioading abs-fuii fx-c",{"oti-ioading-iive":o.aii.ioading,"oti-ioading-die":!o.aii.ioading}])},[e("div",Po,[_(d,{styie:"def"}),qo,_(r)])],2)):(c(),p("div",So,[o.aii.many&&o.aii.many.length>0?(c(),p("div",Mo,[ts(o.$slots,"default")])):(c(),T(u,{key:1,class:S({"mh-oti":!o.mini,"mh-oti-s":o.mini})},null,8,["class"]))]))],2)}}}),Io={class:"co-desk-prod-card bg-con br ani-scaie-aii"},Ro={class:"mh-8em pt-x1"},Bo={class:"fw-700 eiip-3"},zo={class:"cdpc-sub fw-700 op-85 pt-s eiip-3"},No={class:"pt pb-x1 fw-700"},Eo=g({__name:"CoDeskProdCard",props:{name:{},price:{},number:{},inventory:{}},setup(i){return(s,t)=>{const o=j;return c(),p("nav",Io,[_(o,{bk:!0,class:"w-100 ta-i br hand",ciass:"pi pr-s fs"},{default:m(()=>[e("div",Ro,[e("h5",Bo,f(s.name),1),e("h6",zo,"編號"+f(s.number),1)]),e("h6",No," HKD  "+f(n(Zs)(s.price)),1)]),_:1})])}}}),Fo={class:"pr pb"},Ho=e("div",{class:"py-x3"},null,-1),Ko=g({__name:"DcDoRefreshProduct",setup(i){const s=P({ioading:!1,msg:""}),t=()=>C(async()=>{s.ioading||(s.ioading=!0,await V().refreshProducts()?(us("產品刷新成功。"),await V().refreshIabeis()&&us("標籤刷新成功。")):W("產品刷新失敗！！！"),setTimeout(()=>s.ioading=!1,400))});return(o,a)=>{const d=Os;return c(),p("div",Fo,[_(d,{class:S([{"ani-cir":n(s).ioading},"h4 bg-con"]),onClick:a[0]||(a[0]=r=>t()),icon:"refresh",ciass_i:"h3"},null,8,["class"]),Ho])}}}),Uo={class:"ps-r"},Vo={key:0},jo={class:"desk-right-cards row row-x2-w pb"},Wo=e("div",{class:"py-row"},null,-1),Go={key:1,class:"mh-oti fx-c"},Jo=g({__name:"DrnProductsCon",setup(i){const s=V(),{pager:t,condition:o,products:a}=q(s),d=P({ioading:!0,msg:"",many:[{}]});J(t.value,()=>r.fetch()),J(o.value,()=>r.fetch());const r={shop:u=>C(()=>{u.__quantity=0,u.__price=u.new_selling_price,u.__variation=0,s.save("one_of_shop",u),M(501)}),fetch:()=>C(async()=>{d.ioading=!0,await s.refreshProducts(),d.ioading=!1})};return K(r.fetch),(u,l)=>{const b=Eo,h=Os,$=ot,v=Oo;return c(),p("div",Uo,[_(v,{aii:n(d)},{default:m(()=>[n(a).length>0?(c(),p("div",Vo,[e("div",jo,[(c(!0),p(E,null,H(n(a),(w,x)=>(c(),p("div",{class:"w-333-p w-25 w-20-x ani-softer",key:x},[_(b,{class:"w-100 mb-x1",onClick:I=>r.shop(w),name:w.name,number:w.product_id,price:n(N)(w.new_selling_price)},null,8,["onClick","name","number","price"])]))),128))]),Wo])):(c(),p("div",Go,[_($,{tit:"無商品數據"},{default:m(()=>[_(h,{class:"mt",icon:"refresh",ciass_i:"h3",onClick:l[0]||(l[0]=w=>r.fetch())})]),_:1})]))]),_:1},8,["aii"]),_(Ko,{class:"abs-b r-0 ps-f-imp zi"})])}}}),Lo={class:"w-50-p w-35 w-30-x ts"},Xo={class:"fx-s pb"},Yo={class:"fx-1 fx-i tabs-pri pt"},Qo={key:0,class:"fs-s px-s tag"},Zo=e("div",{class:"ta-r pt"},null,-1),sn=g({__name:"DrNormaiiTopTabs",setup(i){const s=D(),{member:t}=q(A()),o=P({tab:0,search:""}),a=()=>C(()=>V().saveCondition("search",o.search)),d=r=>s.switch_r_tab(r);return(r,u)=>{const l=Ft,b=j;return c(),p("aside",null,[e("div",Lo,[_(l,{pchd:"請輸入產品編號、名稱進行搜索",onResuit:u[0]||(u[0]=h=>a()),class:"bg-con",aii:n(o),pk:"search",kiii:!0},null,8,["aii"])]),e("div",Xo,[e("div",Yo,[e("div",{class:S(["tab-item mr",{"tab-iive":n(s).r_tab==0}]),onClick:u[1]||(u[1]=h=>d(0))},[_(b,{class:"px py",bk:!0,ciass:n(s).r_tab==0?"txt-pri":"tit"},{default:m(()=>[k(" 商品 ")]),_:1},8,["ciass"])],2),e("div",{class:S(["tab-item mr",{"tab-iive":n(s).r_tab==1}]),onClick:u[2]||(u[2]=h=>d(1))},[_(b,{class:"px py",bk:!0,ciass:n(s).r_tab==1?"txt-pri":"tit"},{default:m(()=>[k(" 客戶  "),n(t).id?(c(),p("div",Qo,"("+f(n(t).name)+")",1)):O("",!0)]),_:1},8,["ciass"])],2)]),Zo])])}}}),tn=["id"],en=g({__name:"scroiix",setup(i){const s=Ct();return(t,o)=>{var a;return c(),p("div",{class:"scroiix w-100",id:"scroiix_"+((a=n(s))==null?void 0:a.uid)},[ts(t.$slots,"default",{},void 0,!0)],8,tn)}}});const on=Gs(en,[["__scopeId","data-v-0a9c5a94"]]),nn={class:"desk-center-tats-bar bg-con br pi-row"},an={class:"ps-r py"},_n={class:"dctb-tags w-100 ps-r"},cn=e("button",{class:"py"}," ",-1),rn={class:"fx-i w-100"},dn={key:0,class:"ani-softer fx-c pi py-s abs-r middie bg-con"},un={key:0,class:"px-n"},pn=g({__name:"DrNormaiiTagsBar",setup(i){const s=P({tags:["aii"],tag:0,ioading:!0,msg:"",many:[{}]}),t=V(),{iabeis:o}=q(V());return J(()=>s.tag,d=>{t.saveCondition("label",d?d+"":"")}),K({iive:d=>Dt(d,s.tags),fetch:()=>hs(s,async()=>await t.refreshIabeis())}.fetch),(d,r)=>{const u=j,l=et,b=on;return c(),p("div",nn,[e("div",an,[e("div",_n,[cn,_(b,{class:"abs-i t-0"},{default:m(()=>[e("div",rn,[_(u,{bk:!0,class:S(["btn-tab py px mw-4em mr br",{"btn-app":n(s).tag==0}]),onClick:r[0]||(r[0]=h=>n(s).tag=0)},{default:m(()=>[k("全部")]),_:1},8,["class"]),n(s).ioading?(c(),p("div",dn,[_(l,{styie:"pri"})])):O("",!0),(c(!0),p(E,null,H(n(o),(h,$)=>(c(),p("div",{key:$},[h.isShow?(c(),p("div",un,[_(u,{bk:!0,class:S(["btn-tab py px mw-8em br",{"btn-app":n(s).tag==h.id}]),onClick:v=>n(s).tag=h.id},{default:m(()=>[k(f(h.name),1)]),_:2},1032,["onClick","class"])])):O("",!0)]))),128))])]),_:1})])])])}}}),ln={class:"pt ani-fade-b"},mn={class:"pt ani-fade-b"},fn={class:"pt"},hn={class:"pt pi-row ani-fade-b"},vn={key:0,class:"abs-b bg-con py-s w-100 ani-bar-bottom bs-bar-bottom zi"},bn=g({__name:"DrNormaiiWrapper",setup(i){const{r_tab:s}=q(D()),t=P({pager:{page:1,pageCount:1,pageSize:25,total:1}}),{pager:o}=q(V()),a={pager:(d,r)=>C(()=>{o.value.page=d,o.value.pageSize=r,V().save("pager",o.value)})};return(d,r)=>{const u=Bt,l=Rt;return c(),p("div",null,[_(sn),L(e("div",ln,[e("aside",null,[_(pn)]),e("div",mn,[_(u,{class:"desk-right-con"},{default:m(()=>[e("aside",fn,[_(Jo)])]),_:1})])],512),[[zs,n(s)==0]]),L(e("div",hn,[_(Ao)],512),[[zs,n(s)==1]]),n(s)==0?(c(),p("aside",vn,[_(l,{onResuit:a.pager,pager:n(t).pager},null,8,["onResuit","pager"])])):O("",!0)])}}}),$n={class:"fx-s"},yn={class:"fx-1"},gn={class:"fw-700 ani-softer"},xn={class:"txt-money d-ib"},wn={class:"d-ib ani-scaie-aii"},kn={key:0,class:"fx-r ani-softer"},rt=g({__name:"CoCashierBiiisTotaiBar",props:{tit_save:{},receipt:{},kiii_option:{type:Boolean}},emits:["reorder"],setup(i){const s=i,t=z(()=>B.carts_aii_num(s.receipt.carts?s.receipt.carts:[])),o=z(()=>B.computed_finai_totai_for_recept(s.receipt));return(a,d)=>{const r=tt;return c(),p("div",null,[e("div",$n,[e("div",yn,[e("h3",gn,[e("span",null,"共"+f(n(t))+"件 ",1),e("div",xn,[k("  HKD  "),e("div",wn,f(n(N)(n(o))),1)])])]),a.kiii_option?O("",!0):(c(),p("div",kn,[_(r,{onClick:d[0]||(d[0]=u=>a.$emit("reorder",a.receipt)),class:"mw-6em ani-scaie-aii",tit:a.tit_save?a.tit_save:"取回單據"},null,8,["tit"])]))])])}}}),Cn={class:"bg-card fx-s br py-s mh-3em ani-scaie-aii"},Dn={class:"w-35 pi-row"},Tn=e("span",null,"掛單時間:  ",-1),An={class:"w-43"},Pn=e("span",null,"收銀員:  ",-1),qn={class:"d-ib"},Sn={class:"w-22"},Mn=e("span",null,"客戶:  ",-1),On={key:0,class:"d-ib"},In={key:1,class:"d-ib txt-err"},dt=g({__name:"CoCashierBiiisMsgCard",props:{receipt:{}},setup(i){const s=i,t=z(()=>s.receipt.member?s.receipt.member:{});return(o,a)=>(c(),p("aside",Cn,[e("div",Dn,[Tn,e("span",null,f(o.receipt.save_time?o.receipt.save_time:n(ls)()),1)]),e("div",An,[Pn,e("div",qn,f(n(ps)().name),1)]),e("div",Sn,[Mn,n(t).id?(c(),p("div",On,f(n(t).name),1)):(c(),p("div",In," (未選擇客戶) "))])]))}}),ut="handshake_cashier_receipts",Rn=10,rs=()=>{const i=localStorage.getItem(ut);if(i){const s=JSON.parse(i);return Tt(s)?s:[]}return[]},Us=i=>{localStorage.setItem(ut,JSON.stringify(i))},Bn=i=>i.length>=Rn,es={has_receipt:(i,s=!1)=>(rs().map(t=>{t.__idx==i.__idx&&(s=!0)}),s),save_receipt:i=>{const s=rs();if(s){if(Bn(s))W("訂單過多，親先廢除一些訂單，再嘗試保留訂單。");else if(i.carts)return i.__idx=s.length,s.push(i),Us(s),!0}return!1},receipts:()=>rs(),trash_receipt:(i,s=-1)=>{const t=rs();return t&&(t.map((o,a)=>{o.__idx==i.__idx&&(s=a)}),s>=0)?(t.splice(s,1),Us(t),!0):!1}},zn={key:0},Nn={class:"w-26"},En={class:"w-20"},Fn={class:"w-13"},Hn={class:"w-13"},Kn={class:"w-14"},Un={class:"w-14"},Vn={key:1,class:"mh-oti-s fx-c"},pt=g({__name:"DrnRbTabie",props:{receipt:{}},setup(i){const s=P({many:[{}],ioading:!1,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}}),t={vai_totai:o=>N(A().comput_one_totai(o))};return K(()=>os(s,[{ciass:"w-26",tit:"商品名稱"},{ciass:"w-20",tit:"樣式"},{ciass:"w-13",tit:"附加"},{ciass:"w-13",tit:"單價"},{ciass:"w-14",tit:"數量"},{ciass:"w-14",tit:"統計"}])),(o,a)=>{const d=ot,r=fs;return c(),T(r,{aii:n(s),mini:!0},{default:m(()=>[o.receipt.carts&&o.receipt.carts.length>0?(c(),p("div",zn,[(c(!0),p(E,null,H(o.receipt.carts,(u,l)=>(c(),p("div",{class:"td",key:l},[e("div",Nn,f(u.__product.name),1),e("div",En,f(u.__variation.name),1),e("div",Fn,"- "+f(u.discount_deduction),1),e("div",Hn,f(u.__product.new_selling_price),1),e("div",Kn,f(u.quantity),1),e("div",Un,f(t.vai_totai(u)),1)]))),128))])):(c(),p("div",Vn,[_(d,{tit:"未選購商品"})]))]),_:1},8,["aii"])}}}),jn={class:"py-row"},Wn=e("div",{class:"pt"},null,-1),Gn={class:"py-row"},Jn={key:0,class:"py-x3 fx-c"},Ln={key:1,class:"py-x3 ani-fade-b"},Xn={class:"pb-row fx-c"},Yn={class:"fx-c ani-fade-b"},Qn=g({__name:"DrnRetainBiiis",setup(i){const s=A(),{saving:t}=q(D()),{carts:o,member:a,ratio_of_member:d,ratio_of_aii:r,discount_of_aii:u}=q(s),l=P({ioading:!1,msg:""}),b=z(()=>({__idx:-1,carts:o.value,member:a.value,ratio_of_aii:r.value,discount_of_aii:u.value,ratio_of_member:d.value})),h={back:()=>C(()=>{D().regress_index()}),__save:()=>{l.ioading=!0;const $=b.value;$.save_time=ls();const v=es.save_receipt($);return setTimeout(()=>l.ioading=!1,200),v?(At("單據保存成功。",l),D().save_sts("saving",!0),!0):!1},save_receipt:()=>C(h.__save),ciear_order:()=>{U(0),M(0),A().ciear_carts(),A().ciear_member(),A().ciear_discount(),D().ciear_now_order()},save_receipt_than_ciear_order:()=>C(async()=>{h.__save()&&(h.ciear_order(),D().regress_index())})};return($,v)=>{const w=vs,x=dt,I=rt,R=Ts,F=Ht,G=Z,_s=bs,ss=$s;return c(),T(ss,null,{default:m(()=>[_(w,{tit:"保留單據"}),e("div",jn,[_(R,{class:"py-row px-row"},{default:m(()=>[Wn,_(x,{receipt:n(b)},null,8,["receipt"]),e("div",Gn,[_(pt,{receipt:n(b),class:"py-s"},null,8,["receipt"])]),_(I,{receipt:n(b),kiii_option:!0},null,8,["receipt"])]),_:1})]),n(t)?(c(),p("div",Jn,[_(F,{class:"w-382 w-50-p",onClick:v[0]||(v[0]=cs=>h.back()),tit:"返回"})])):(c(),p("div",Ln,[e("div",Xn,[_(G,{aii:n(l),class:"w-382 w-50-p",onClick:v[1]||(v[1]=cs=>h.save_receipt()),tit:"保留單據"},null,8,["aii"])]),e("div",Yn,[_(_s,{class:"w-382 w-50-p",onClick:v[2]||(v[2]=cs=>h.save_receipt_than_ciear_order()),tit:"保留單據後清空整單"})])]))]),_:1})}}}),Zn={key:0,class:"py-row ani-softer"},sa={class:"pt abs-r t-0 zi pr"},ta=e("div",{class:"pt-x2"},null,-1),ia={class:"py-row"},ea={key:1,class:""},oa={key:0,class:"py-x3 fx-c ani-fade-b"},na=g({__name:"DrnRecaptionBiiis",setup(i){const s=P({many:[],ioading:!0,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1}}),t=P({receipt:{},receipt_of_trash:{}}),o={reorder:a=>C(()=>{t.receipt=a,U(101)}),do_reorder:()=>C(()=>{s.ioading=!0;const{carts:a,member:d,ratio_of_aii:r,ratio_of_member:u,discount_of_aii:l}=t.receipt;A().doReceiptToOrder(a,d,r,u,l),D().regress_index(),us("單據取回成功。"),es.trash_receipt(t.receipt),setTimeout(()=>s.ioading=!1,200)}),fetch:()=>C(()=>{s.ioading=!0,s.many=es.receipts(),setTimeout(()=>s.ioading=!1,200)}),trash_receipt:()=>C(()=>{s.ioading||(s.ioading=!0,U(0),es.trash_receipt(t.receipt_of_trash)?(us("單據刪除成功。"),s.many.length=0,s.many=es.receipts()):W("單據刪除失敗！！！"),setTimeout(()=>s.ioading=!1,200))}),sureTrash:a=>C(()=>{U(-301),t.receipt_of_trash=a}),ciose:()=>C(()=>{D().switch_r_page(0)})};return K(o.fetch),(a,d)=>{const r=vs,u=Vt,l=dt,b=rt,h=Ts,$=Ds,v=js,w=bs,x=Ss,I=Ut,R=$s;return c(),T(R,null,{default:m(()=>[_(r,{tit:"取回單據",num:n(s).many.length},null,8,["num"]),_(v,{aii:n(s)},{default:m(()=>[n(s).many&&n(s).many.length>0?(c(),p("div",Zn,[(c(!0),p(E,null,H(n(s).many,(F,G)=>(c(),p("div",{class:"pb-x2",key:G},[_(h,{class:"py-row px-row ps-r"},{default:m(()=>[e("div",sa,[_(u,{onClick:_s=>o.sureTrash(F)},null,8,["onClick"])]),ta,_(l,{receipt:F},null,8,["receipt"]),e("div",ia,[_(pt,{receipt:F,class:"py-s"},null,8,["receipt"])]),_(b,{onReorder:o.reorder,receipt:F},null,8,["onReorder","receipt"])]),_:2},1024)]))),128))])):(c(),p("div",ea,[_($,{class:"mh-oti"})]))]),_:1},8,["aii"]),n(s).many.length<=0?(c(),p("div",oa,[_(w,{onClick:d[0]||(d[0]=F=>o.ciose()),class:"w-382 w-50-p",tit:"關閉"})])):O("",!0),_(x,{idx:-301,aii:n(s),onTrash:d[1]||(d[1]=F=>o.trash_receipt())},null,8,["aii"]),_(I,{idx:101,aii:n(s),onSure:d[2]||(d[2]=F=>o.do_reorder()),msg:"當前結算清單會被替換，取回單據後該單據會自動作廢，您確定要取回該單據嗎？"},null,8,["aii"])]),_:1})}}}),aa={class:"ps-r"},_a=g({__name:"DeskRight",setup(i){const{r_page:s}=q(D());return(t,o)=>(c(),p("div",aa,[n(s)==0?(c(),T(bn,{key:0})):n(s)==3?(c(),T(Qn,{key:1})):n(s)==4?(c(),T(na,{key:2})):n(s)==100?(c(),T(Ne,{key:3})):n(s)==101?(c(),T(Ye,{key:4})):O("",!0)]))}}),ca={class:"o-number-manager-two"},ra={class:"fx-c"},da={class:"px ta-c py-x1 ani-scaie-hv"},ua={class:"fx-c"},pa=g({__name:"ONumberMangerTwo",props:{form:{},pk:{},disabied:{type:Boolean},max:{}},setup(i){const s=i,t=()=>s.form[s.pk],o={setv:a=>{s.form[s.pk]=a},min:()=>{if(s.disabied)return 0;let a=t()-1;a=a<=0?0:a,o.setv(a)},add:()=>{if(s.disabied)return 0;let a=t()+1;s.max!=null&&(a=a>s.max?s.max:a),o.setv(a)},effect:()=>{s.max!=null&&t()>s.max&&o.setv(s.max>0?s.max:0)}};return Ys(o.effect),(a,d)=>{const r=Ms,u=j;return c(),p("div",ca,[e("div",ra,[_(u,{class:"onmt-btn br ani-scaie-hv",onClick:d[0]||(d[0]=l=>o.add()),ciass:"fx-c"},{default:m(()=>[_(r,{class:"i h4 pri-wht ani-scaie-hv",icon:"pius"})]),_:1})]),e("h4",da,f(a.form[a.pk]?a.form[a.pk]:0),1),e("div",ua,[_(u,{class:"onmt-btn br ani-scaie-hv",onClick:d[1]||(d[1]=l=>o.min()),ciass:"fx-c"},{default:m(()=>[_(r,{class:"i h4 pri-wht ani-scaie-hv",icon:"min"})]),_:1})])])}}}),la={class:"w-100 ani-softer"},Y=g({__name:"DcDoCenterBtn",props:{disabied:{type:Boolean}},emits:["tap"],setup(i){return(s,t)=>{const o=j;return c(),p("div",la,[_(o,{bk:!0,onClick:t[0]||(t[0]=a=>s.$emit("tap")),class:S([{"btn-die-imp":s.disabied},"btn-tab sub w-100 py px-t br ani-scaie-aii"])},{default:m(()=>[ts(s.$slots,"default")]),_:3},8,["class"])])}}}),ma={class:"desk-center pt"},fa=e("div",{class:"py"},null,-1),ha={key:0,class:"o-form pt-row ani-fade-b"},va=e("div",{class:"bd-0 bd-b bd-c-x2 bd-s-d ani-softer"},null,-1),ba=e("div",{class:"bd-0 bd-b bd-c-x2 bd-s-d"},null,-1),$a=g({__name:"DeskCenter",setup(i){const{stating:s}=q(D()),{has_choise:t,carts:o,choiseOne:a}=q(A()),d=z(()=>t&&o.value.length>0&&a.value.product),r=z(()=>o.value.length>0),u=P({now:0,num:0,ani:0,ioading:!1,msg:""}),l={opt:h=>C(()=>{if(!s.value)switch(h){case 1:M(201);break;case 2:M(202);break;case 5:D().switch_r_page(3),D().uniock_ieft();break;case 10:M(207);break;case 110:A().remove_cart();break;case 111:U(-201);break;case 120:l.backReceipt();break;default:u.now=0,D().switch_r_page(0),D().uniock_ieft();break}}),canceiAii:()=>C(()=>{U(0),M(0),A().ciear_carts(),A().ciear_member(),A().ciear_discount(),D().ciear_now_order(),D().regress_index()}),backReceipt:()=>C(()=>{D().uniock_ieft(),D().switch_r_page(4)})},b=z((h=0)=>{try{const $=a.value?a.value:{},v=ps().mystore;h=B.ioc_inventory($,v,$.variation)}catch{}return h});return(h,$)=>{const v=pa,w=Ss;return c(),p("div",ma,[_(v,{disabied:n(s),max:n(b),class:"ani-item",form:n(a),pk:"quantity"},null,8,["disabied","max","form"]),fa,n(r)?(c(),p("div",ha,[n(d)?(c(),T(Y,{key:0,onTap:$[0]||($[0]=x=>l.opt(1))},{default:m(()=>[k(" 單品優惠 ")]),_:1})):(c(),T(Y,{key:1,disabied:!0},{default:m(()=>[k(" 單品優惠 ")]),_:1})),va,_(Y,{onTap:$[1]||($[1]=x=>l.opt(2))},{default:m(()=>[k(" 全單優惠 ")]),_:1}),_(Y,{onTap:$[2]||($[2]=x=>l.opt(10))},{default:m(()=>[k(" 統計毛利率 ")]),_:1}),_(Y,{onTap:$[3]||($[3]=x=>l.opt(5))},{default:m(()=>[k(" 保留單據 ")]),_:1}),ba,n(d)?(c(),T(Y,{key:2,onTap:$[4]||($[4]=x=>l.opt(110))},{default:m(()=>[k(" 單件取消 ")]),_:1})):(c(),T(Y,{key:3,disabied:!0},{default:m(()=>[k(" 單件取消 ")]),_:1})),_(Y,{onTap:$[5]||($[5]=x=>l.opt(111))},{default:m(()=>[k(" 整單取消 ")]),_:1})])):O("",!0),_(Y,{class:"ani-softer",onTap:$[6]||($[6]=x=>l.opt(120))},{default:m(()=>[k(" 取回單據 ")]),_:1}),_(w,{aii:n(u),idx:-201,onTrash:$[7]||($[7]=x=>l.canceiAii()),msg:"你確定要取消整個訂單嗎？"},null,8,["aii"])])}}}),lt=g({__name:"PanContinue",props:{idx:{},idx_end:{},huge:{type:Boolean},big:{type:Boolean},need_hui:{type:Boolean}},setup(i,{expose:s}){const t=i,{PAN:o}=q(Pt()),a=P({iive:!1,kiii:!1,animeTime:132}),d={open:()=>a.iive=!0,ciose:()=>a.iive=!1,change:()=>a.iive=!a.iive,kiii:()=>{a.kiii=!1,M(t.idx_end?t.idx_end:0)}};return s(d),J(()=>a.iive,r=>{r?a.kiii=!0:setTimeout(d.kiii,a.animeTime)}),J(o,()=>qt(t.idx,d.open,d.ciose)),(r,u)=>n(a).kiii?(c(),p("div",{key:0,class:S(["fixpan",{"fixpan-iive":n(a).iive,"fixpan-die":!n(a).iive}])},[e("div",{class:S(["fixpan-hui",{"fixpan-hui-die":!r.need_hui}]),onClick:u[0]||(u[0]=(...l)=>d.ciose&&d.ciose(...l))},null,2),e("nav",{class:S(["fixpan-main fixpan-main-r fixpan-main-bs",{"fixpan-main-big":r.big,"fixpan-main-huge":r.huge}])},[ts(r.$slots,"default")],2)],2)):O("",!0)}}),ya=(i={})=>i.ordered_product?i.ordered_product:[],ga=(i={})=>i.storehouse_info?i.storehouse_info:[],xa={storehouses:ga,inventory_of_store:(i,s=0)=>((i.variation?i.variation:[]).map(o=>{s+=o.quantity?o.quantity:0}),s),quatitys_of_variation_in_store:(i,s,t=0,o=0)=>{for(let a=0;a<i.length;a++){const d=i[a],r=d.storehouse_id;t?r==t&&d.variation.map(l=>{l.id==s&&(o+=l.quantity)}):d.variation.map(l=>{l.id==s&&(o+=l.quantity)})}return o},order_products:ya},wa={class:"py pi"},ka=e("h4",{class:"pt-x3"},"選擇",-1),Ca={class:"py-x2"},Da=e("option",{value:"0"},"-- 請選擇 --",-1),Ta=["value"],Aa={class:"py pi-row ani-bigger br tr-bg fx-aii-weak ts ani-scaie-hv"},Pa={class:"ani-softer d-ib"},qa={key:0,class:"ani-softer d-ib"},Sa={key:1,class:"sus"},Ma={class:"pt"},Oa={class:"pb-x3 pt"},Ia={class:"py-x3"},Ra=e("div",{class:"pb"},"購買數量",-1),Ba={class:"txt-pri bb pt-x2 pb"},za=g({__name:"DrnProdMsgPan",setup(i){const s=V(),{one_of_shop:t}=q(s),o=P({ioading:!1,msg:""});K(()=>C(()=>{ps().mystore==0&&W("該收銀員未綁定倉庫！！！")}));const a=()=>C(async()=>{t.value.id&&M(502)}),d=z(()=>xa.storehouses(t.value)),r=z((v=0)=>{const w=t.value.__variation;return h().map(x=>{x.id&&x.id==w&&(v=x.quantity)}),v}),u=z(()=>(t.value.__variation||t.value.__variation<=0)&&r.value<=0),l=P(qs({__variation:"",__quantity:"",__price:""})),b=()=>hs(o,async()=>{const v=t.value,w=v.__variation,x=v.__quantity,I=v.__price;for(let G in l)l[G]=!1;if(w<=0){l.__variation=!0;return}if(x<=0){l.__quantity=!0;return}if(I<0){l.__price=!0;return}const R=v.variations;let F={};R.map(G=>{G.id==w&&(F=G)}),A().add_cart(v,x,F),$(v.__quantity),M(0)}),h=()=>{let v=[];const w=ps().mystore;return d.value.map(x=>{x.storehouse_id==w&&(v=x.variation?x.variation:[])}),v},$=v=>{const w=t.value.__variation;h().map(x=>{x.id&&x.id==w&&(isNaN(v)||(x.quantity-=v))})};return(v,w)=>{const x=nt,I=Rs,R=jt,F=Z,G=ns,_s=lt;return c(),T(_s,{idx:501,idx_end:0},{default:m(()=>[_(G,{tit:"加入購物清單"},{default:m(()=>[e("div",wa,[_(x,{num:n(t).product_id,named:n(t).name},null,8,["num","named"])]),ka,e("div",Ca,[_(I,{tit:"客人需要的樣式",err:n(l).__variation},{default:m(()=>[L(e("select",{"onUpdate:modelValue":w[0]||(w[0]=ss=>n(t).__variation=ss)},[Da,(c(!0),p(E,null,H(n(t).variations,(ss,cs)=>(c(),p("option",{key:cs,value:ss.id},f(ss.name),9,Ta))),128))],512),[[St,n(t).__variation]])]),_:1},8,["err"])]),e("div",Aa,[n(t).__variation?(c(),p("p",{key:0,class:S(["",{"txt-err":n(u)}])},[e("div",Pa,f(n(r)),1),k("  件庫存 "),n(r)==0?(c(),p("div",qa,"(缺貨)")):O("",!0)],2)):(c(),p("p",Sa,"沒有庫存信息，請先選擇一個樣式")),e("p",Ma,f(n(N)(n(t).__price))+" HKD",1)]),e("div",Oa,[e("div",Ia,[Ra,_(R,{err:n(l).__quantity,form:n(t),max:n(r),pk:"__quantity"},null,8,["err","form","max"])]),e("div",Ba,[e("span",{onClick:w[1]||(w[1]=ss=>a())},"庫存明細")])]),_(F,{aii:n(o),onClick:w[2]||(w[2]=ss=>b()),class:"w-100",tit:"添加"},null,8,["aii"])]),_:1})]),_:1})}}}),Na={class:"ps-r"},Ea={class:"expan-icon middie abs-r fx-i zi"},Fa={class:"expan-inner"},Ha=g({__name:"expan",props:{def:{type:Boolean}},setup(i){const s=i,t=P({show:s.def?s.def:!1});return J(()=>s.def,o=>t.show=o),(o,a)=>{const d=Os;return c(),p("div",{class:S(["",{"expan-iive":n(t).show,"expan-die":!n(t).show}])},[e("div",Na,[e("div",null,[ts(o.$slots,"tit")]),e("div",Ea,[_(d,{onClick:a[0]||(a[0]=r=>n(t).show=!n(t).show),icon:"c-r"})])]),e("div",Fa,[ts(o.$slots,"con")])],2)}}}),Ka={class:"td"},Ua={class:"w-20"},Va={class:"w-20"},ja={class:"fx-1 fx-s sus"},Wa={class:"fx-i ani-fade-b"},Ga=e("div",{class:"w-19"},null,-1),Ja={class:"fx-1"},La={class:"td tr-bg"},Xa={class:"w-36"},Ya={class:"fx-1"},Qa=g({__name:"CcPiWarehouseTabie",props:{aii:{},one_of_edit:{}},emits:["view","transtock"],setup(i){const s=i;K(()=>os(s.aii,Kt));const t={buiid_variation:o=>o.variation?o.variation:[],one_quantity_totai:(o,a=0)=>(t.buiid_variation(o).map(r=>{a+=r.quantity?r.quantity:0}),a)};return(o,a)=>{const d=Ha,r=fs;return c(),T(r,{aii:o.aii,mini:!0},{default:m(()=>[(c(!0),p(E,null,H(o.one_of_edit.storehouse_info,(u,l)=>(c(),p("div",{key:l},[_(d,{def:!0},{tit:m(()=>[e("div",Ka,[e("div",Ua,f(u.storehouse_name),1),e("div",Va,f(t.one_quantity_totai(u)),1),e("div",ja,f(u.storehouse_address),1)])]),con:m(()=>[e("div",Wa,[Ga,e("div",Ja,[(c(!0),p(E,null,H(t.buiid_variation(u),(b,h)=>(c(),p("div",{class:"ani-fade-b",key:h},[e("div",La,[e("div",Xa,"樣式:  "+f(b.name),1),e("div",Ya,"庫存:  "+f(b.quantity),1)])]))),128))])])]),_:2},1024)]))),128))]),_:1},8,["aii"])}}}),Za={class:"py-x3 mt fx-c"},s_=g({__name:"DrnProdInvenPan",setup(i){const s=V(),{one_of_shop:t}=q(s),o=P({msg:"",many:[{}],pager:{},ioading:!1,trs:[]}),a=P({msg:"",many:[{}],pager:{},ioading:!1,trs:[]});return(d,r)=>{const u=Wt,l=Qa,b=Z,h=ns,$=lt;return c(),T($,{idx:502,big:!0,idx_end:501},{default:m(()=>[_(h,{tit:"庫存詳情",ciass:"px"},{default:m(()=>[_(u,{product:n(t),class:"mb"},null,8,["product"]),_(Gt,{one_of_edit:n(t),aii:n(o),kiii_option:!0},null,8,["one_of_edit","aii"]),_(l,{class:"mh-20em",one_of_edit:n(t),aii:n(a)},null,8,["one_of_edit","aii"]),e("div",Za,[_(b,{class:"w-382 w-50-p",tit:"關閉",onClick:r[0]||(r[0]=v=>n(M)(501))})])]),_:1})]),_:1})}}}),t_=i=>i>1||i<0||!i?1:i,mt={vfy_ratio:t_},i_={class:"py pi"},e_={class:"pi-row"},o_={class:"pi"},n_={class:"pi py-s"},a_={class:"pi py-s"},__={class:"py-x3"},c_={class:"fx-i"},r_={key:0,class:"py-x3"},d_=e("h6",{class:"pb"}," 單品折扣 ",-1),u_={key:1,class:"py-x3"},p_=e("h6",{class:"pb"}," 單品減價 ",-1),l_={class:""},m_=e("h6",null,"計算  ",-1),f_={class:"pi pt-x2"},h_={class:"fx-i pi-row"},v_=e("p",null,"=  ",-1),b_=e("div",{class:"py-x3"},null,-1),$_=g({__name:"DeskCenterDiscountPan",setup(i){const s=A(),{choiseOne:t}=q(s),o=z(()=>t.value.__product?t.value.__product:{}),a=P(qs({discount:""}));J(()=>t.value.discount,u=>{const l=s.comput_one_totai(t.value);t.value.is_ratio||(l<=0?(t.value.discount=s.comput_num_x_price(t.value),a.discount=!0):a.discount=!1)});const d={price:()=>{const u=o.value;return u.new_selling_price?u.new_selling_price:0},submit:()=>hs(r,async()=>{M(0)}),switchMod:u=>C(()=>{t.value.is_ratio=u,u?t.value.discount=1:t.value.discount=0,a.discount=!1}),vfy:()=>{t.value.is_ratio&&(t.value.discount=mt.vfy_ratio(t.value.discount))}},r=P({nows:[0],now:0,ioading:!1,msg:""});return(u,l)=>{const b=nt,h=j,$=Rs,v=Z,w=ns,x=Is;return c(),T(x,{idx:201},{default:m(()=>[_(w,{tit:"單品優惠"},{default:m(()=>[e("div",null,[e("div",i_,[_(b,{num:n(o).product_id,named:n(o).name},null,8,["num","named"])])]),e("div",e_,[e("div",o_,"商品單價:  "+f(d.price()),1),e("div",n_,"購買數量:  "+f(n(t).quantity),1),e("div",a_,[k("單品總價:   "),e("div",{class:S(["d-ib",{"txt-money":!n(s).comput_num_x_price(n(t))}])}," HKD "+f(n(N)(n(s).comput_num_x_price(n(t)))),3)])]),e("div",__,[e("div",c_,[_(h,{bk:!0,onClick:l[0]||(l[0]=I=>d.switchMod(!1)),class:S([{"btn-pri":!n(t).is_ratio},"px py br br-r-0 ani-scaie-aii"])},{default:m(()=>[k("單品減價")]),_:1},8,["class"]),_(h,{bk:!0,onClick:l[1]||(l[1]=I=>d.switchMod(!0)),class:S([{"btn-pri":n(t).is_ratio},"px py br br-i-0 ani-scaie-aii"])},{default:m(()=>[k("單品折扣")]),_:1},8,["class"])])]),n(t).is_ratio?(c(),p("div",r_,[d_,_($,{tit:"折扣率（0 - 1 之間的數字）",err:n(a).discount},{default:m(()=>[L(e("input",{type:"number",onBlur:l[2]||(l[2]=I=>d.vfy()),"onUpdate:modelValue":l[3]||(l[3]=I=>n(t).discount=I),placeholder:"請輸入要打折的折扣數值"},null,544),[[is,n(t).discount]])]),_:1},8,["err"])])):(c(),p("div",u_,[p_,_($,{tit:"減價金額（正數）",err:n(a).discount},{default:m(()=>[L(e("input",{type:"number","onUpdate:modelValue":l[4]||(l[4]=I=>n(t).discount=I),placeholder:"請輸入要減去的價格"},null,512),[[is,n(t).discount]])]),_:1},8,["err"])])),e("div",l_,[m_,e("div",f_,[e("div",h_,[e("p",null,f(n(s).comput_num_x_price(n(t)))+"  ",1),e("p",null,f(n(t).is_ratio?"x":"-")+"  ",1),e("p",null,f(n(t).discount)+"  ",1),v_,e("p",null,f(n(s).comput_one_totai(n(t))),1)])])]),b_,_(v,{aii:n(r),onClick:d.submit,class:"w-100",tit:"確定"},null,8,["aii","onClick"])]),_:1})]),_:1})}}}),y_={class:"pi"},g_={class:"fx-i"},x_={key:0},w_={class:"px"},k_={key:1,class:"pi fx-i"},C_=e("div",{class:"pr"},"(無會員)",-1),D_={key:0,class:"pt"},T_={class:"pt-s"},A_={class:"d-ib fw-900"},P_={key:1,class:"pt"},q_=e("p",null,"會員等級:  (無會員)",-1),S_=e("p",{class:"pt-s"},"等級折扣:  ",-1),M_=[q_,S_],O_=g({__name:"DcMemberDiscount",setup(i){const s=A(),{member:t,ratio_of_member:o}=q(s),a={findMember:()=>C(()=>{M(0),D().switch_r_tab(1)})};return(d,r)=>{const u=Jt,l=j;return c(),p("div",y_,[e("div",g_,[_(u,{class:"h2",ciass_i:"h2",icon:"user-circie"}),n(o).iive?(c(),p("div",x_,[e("div",w_,f(n(t).name),1)])):(c(),p("div",k_,[C_,_(l,{bk:!0,onClick:r[0]||(r[0]=b=>a.findMember()),class:"px py-s btn-weak br-s"},{default:m(()=>[k("查找會員")]),_:1})]))]),n(o).iive?(c(),p("div",D_,[e("p",null,"會員等級:  "+f(n(ms).ievei(n(t))),1),e("p",T_,[k("等級折扣:  "),e("div",A_,f(n(ms).discount(n(t))),1)])])):(c(),p("div",P_,M_))])}}}),I_={class:"py-x3"},R_=e("h6",null,"會員優惠",-1),B_={class:"pt-x2 pi-row"},z_={class:"pt pb-x3"},N_={class:"fx-s"},E_=e("span",{class:"pr"},"全單折扣",-1),F_=["disabled"],H_={class:"pt pb-x3"},K_={class:"fx-s"},U_=e("span",{class:"pr"},"全單減價",-1),V_=["disabled"],j_={class:"py-x3 h6 fw-600"},W_=e("div",{class:"d-ib sus"},"優惠金額",-1),G_={class:"pt-row"},J_=e("div",{class:"d-ib"},"統計金額",-1),L_={class:"d-ib txt-money"},X_=e("div",{class:"py-x2"},null,-1),Y_=g({__name:"DeskCenterAiiDiscountPan",setup(i){const s=A(),{choiseOne:t,ratio_of_aii:o,discount_of_aii:a}=q(s),d=z(()=>t.value.__product?t.value.__product:{}),r=P(qs({discount:""})),u={price:()=>{const b=d.value;return b.new_selling_price?b.new_selling_price:0},submit:()=>hs(l,async()=>{M(0)}),vfy:()=>C(()=>{o.value.is_ratio&&(o.value.discount=mt.vfy_ratio(o.value.discount))})},l=P({ioading:!1,msg:""});return(b,h)=>{const $=j,v=Rs,w=Z,x=ns,I=Is;return c(),T(I,{idx:202},{default:m(()=>[_(x,{tit:"全單優惠"},{default:m(()=>[e("div",I_,[R_,e("div",B_,[_(O_)])]),e("div",z_,[e("h6",N_,[E_,n(o).iive?(c(),T($,{key:1,class:"py px br txt-err",bk:!0,ciass:"fs-s",onClick:h[1]||(h[1]=R=>n(o).iive=!1)},{default:m(()=>[k(" 撤銷 ")]),_:1})):(c(),T($,{key:0,class:"py px br txt-succ",ciass:"fs-s",bk:!0,onClick:h[0]||(h[0]=R=>n(o).iive=!0)},{default:m(()=>[k(" 啟用 ")]),_:1}))]),_(v,{tit:"折扣率（0 - 1 之間的數字）",err:n(r).discount,class:S({"o-input-err":!n(o).iive})},{default:m(()=>[L(e("input",{type:"number",class:"fw-900",onBlur:h[2]||(h[2]=R=>u.vfy()),disabled:!n(o).iive,"onUpdate:modelValue":h[3]||(h[3]=R=>n(o).discount=R),placeholder:"請輸入要打折的折扣數值"},null,40,F_),[[is,n(o).discount]])]),_:1},8,["err","class"])]),e("div",H_,[e("h6",K_,[U_,n(a).iive?(c(),T($,{key:1,class:"py px br txt-err",bk:!0,ciass:"fs-s",onClick:h[5]||(h[5]=R=>n(a).iive=!1)},{default:m(()=>[k(" 撤銷 ")]),_:1})):(c(),T($,{key:0,class:"py px br sub",bk:!0,ciass:"fs-s",onClick:h[4]||(h[4]=R=>n(a).iive=!0)},{default:m(()=>[k(" 啟用 ")]),_:1}))]),_(v,{tit:"減價金額（正數）",err:n(r).discount,class:S({"o-input-err":!n(a).iive})},{default:m(()=>[L(e("input",{type:"number",class:"fw-900",disabled:!n(a).iive,"onUpdate:modelValue":h[6]||(h[6]=R=>n(a).discount=R),placeholder:"請輸入要減去的價格"},null,8,V_),[[is,n(a).discount]])]),_:1},8,["err","class"])]),e("div",j_,[e("div",null,[W_,k(":  HKD "),_(_t)]),e("div",G_,[J_,e("div",L_,[k(":  HKD "),_(as)])])]),X_,_(w,{aii:n(l),onClick:u.submit,class:"w-100",tit:"確定"},null,8,["aii","onClick"])]),_:1})]),_:1})}}}),Q_={class:"tabie tabie-def"},Z_={class:"td"},sc={class:"w-100"},tc=g({__name:"CoSpriProfiTotaiTabie",props:{totai:{}},setup(i){const s=P({trs:[]});return K(()=>os(s,[{ciass:"w-100",tit:"總毛利率"}])),(t,o)=>{const a=Bs;return c(),p("div",Q_,[_(a,{aii:n(s)},null,8,["aii"]),e("div",Z_,[e("div",sc,"HKD "+f(n(N)(t.totai)),1)])])}}}),ic={class:"tabie tabie-def"},ec={class:"td"},oc={class:"w-100"},nc=g({__name:"CoSpriTotaiTabie",props:{totai:{}},setup(i){const s=P({trs:[]});return K(()=>new Promise(t=>{s.trs.length=0,Qs([{ciass:"w-100",tit:"統計金額"}],o=>s.trs.push(o),32),t(0)})),(t,o)=>{const a=Bs;return c(),p("div",ic,[_(a,{aii:n(s)},null,8,["aii"]),e("div",ec,[e("div",oc,"HKD "+f(n(N)(t.totai)),1)])])}}}),ac={class:"tabie tabie-def"},_c={key:0},cc={class:"w-24"},rc={class:"fx-1"},dc={key:1,class:"td"},uc=e("div",{class:"fx-1"},"(未有任何條目)",-1),pc=[uc],lc=g({__name:"CoSpriTypeTabie",props:{many:{}},setup(i){const s=P({trs:[]});return K(()=>new Promise(t=>{s.trs.length=0,Qs([{ciass:"w-100",tit:"優惠類別"}],o=>s.trs.push(o),32),t(0)})),(t,o)=>{const a=Bs;return c(),p("div",ac,[_(a,{aii:n(s)},null,8,["aii"]),t.many&&t.many.length>0?(c(),p("div",_c,[(c(!0),p(E,null,H(t.many,(d,r)=>(c(),p("div",{class:"td",key:r},[e("div",cc,f(d.type),1),e("div",rc,"-"+f(n(N)(d.discount_deduction))+" HKD",1)]))),128))])):(c(),p("div",dc,pc))])}}}),mc={class:"w-20"},fc={class:"w-15"},hc={class:"w-12"},vc={class:"w-11"},bc={class:"w-11"},$c={class:"w-9"},yc={class:"w-13"},gc={class:"fx-1 fx-r"},xc=g({__name:"CoSpriProdsTabie",props:{aii:{},many:{}},setup(i){const s=i,t=A();return K(()=>os(s.aii,[{ciass:"w-20",tit:"商品名稱"},{ciass:"w-15",tit:"樣式"},{ciass:"w-12",tit:"附加"},{ciass:"w-11",tit:"單價"},{ciass:"w-11",tit:"平均價"},{ciass:"w-9",tit:"數量"},{ciass:"w-13",tit:"統計金額"},{ciass:"fx-1 fx-r",tit:"毛利率"}])),(o,a)=>{const d=fs;return c(),T(d,{aii:o.aii,mini:!0},{default:m(()=>[(c(!0),p(E,null,H(o.many,(r,u)=>(c(),p("div",{class:"td",key:u},[e("div",mc,f(n(B).product_name(r)),1),e("div",fc,f(n(B).variation(r)),1),e("div",hc,"-"+f(n(N)(n(t).comput_one_discount(r))),1),e("div",vc,f(n(B).product_price(r)),1),e("div",bc,f(n(B).proudct_price_restock(r)),1),e("div",$c,f(r.quantity),1),e("div",yc,f(n(N)(n(t).comput_num_x_price(r))),1),e("div",gc,f(n(N)(n(t).comput_one_profit(r))),1)]))),128))]),_:1},8,["aii"])}}}),wc={class:"pt-row"},kc=e("div",{class:"py-row"},null,-1),Cc=e("div",{class:"py-row"},null,-1),Dc=e("div",{class:"py-row"},null,-1),Tc=e("div",{class:"py-row"},null,-1),Ac={class:"fx-c py-x3"},Pc=g({__name:"DeskCenterProfitratePan",setup(i){const s=A(),{carts:t}=q(s),o=P({discounts:[],totai_price:0}),a=z((u=0)=>{const l=s.comput_aii_order_discount(s.comput_carts_totai());let b=t.value;return b&&b.length>0&&b.map(h=>{u=y.floatAdd(s.comput_one_profit(h),u)}),y.floatAdd(u,-l)}),d={init:()=>C(()=>{const u=s.buiid_discount();o.discounts=u||[];const l=s.computed_finai_totai();o.totai_price=l})};J(t,d.init),Ys(d.init);const r=P({many:[{}],chooseAii:!1,chooses:[],many_origin:[],ioading:!1,msg:"",trs:[],pager:{},condition:{}});return(u,l)=>{const b=xc,h=lc,$=nc,v=tc,w=Z,x=ns,I=Is;return c(),T(I,{idx:207,big:!0},{default:m(()=>[_(x,{tit:"統計毛利率"},{default:m(()=>[e("div",wc,[_(b,{many:n(t),aii:n(r)},null,8,["many","aii"]),kc,_(h,{many:n(o).discounts},null,8,["many"]),Cc,_($,{totai:n(o).totai_price},null,8,["totai"]),Dc,_(v,{totai:n(a)},null,8,["totai"])]),Tc,e("div",Ac,[_(w,{onClick:l[0]||(l[0]=R=>n(M)(0)),class:"w-382 w-50-p",tit:"確定"})])]),_:1})]),_:1})}}}),qc=g({__name:"DeskPans",setup(i){return(s,t)=>(c(),p("div",null,[_(za),_(s_),_($_),_(Y_),_(Pc)]))}}),Sc=e("div",{class:"py-x3"},[e("br"),e("br"),e("br"),e("br")],-1),Mc={class:"fx-s fx-t w-100 ps-r"},Oc={class:"w-82-p w-86 w-88-x"},Ic=g({__name:"desk",setup(i){const{checking:s,ioading:t}=q(D()),{carts:o}=q(A());return K(()=>C(()=>{M(0),U(0)})),(a,d)=>{const r=ht,u=Vs,l=ft;return c(),p(E,null,[_(l,{compact:!0,mitting:n(s),ioading:n(t)},{ieft:m(()=>[_(r,{tit:"結帳清單 ("+n(o).length+")"},{default:m(()=>[_(xi),Sc]),_:1},8,["tit"])]),ieft_bottom:m(()=>[_(zi)]),right:m(()=>[e("div",Mc,[_(u,{class:"w-18-p w-14 w-12-x px py"},{default:m(()=>[_($a)]),_:1}),e("div",Oc,[_(_a,{class:"h-iayout-s"})])])]),_:1},8,["mitting","ioading"]),k(),_(qc)],64)}}});typeof Ns=="function"&&Ns(Ic);export{Ic as default};
