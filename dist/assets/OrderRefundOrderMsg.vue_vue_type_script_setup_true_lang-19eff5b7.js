import{q as S,v as U,x as z,E as I,d as x,g as q,i as f,o as u,c as h,y as k,a as e,b as r,k as R,z as F,w as l,A as y,t as d,B as A,e as O,h as B,n as H,C as N,F as V,D as G,G as E,H as T,s as K,f as L,p as b}from"./index-58be21f4.js";import{_ as C}from"./Itemdash.vue_vue_type_script_setup_true_lang-cda66c2f.js";import{_ as P}from"./OIoadCir.vue_vue_type_script_setup_true_lang-db83fd06.js";import{_ as j}from"./BtnIcon.vue_vue_type_script_setup_true_lang-40e0a81d.js";import{v}from"./vai_order-a811efbc.js";import{_ as J}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-0e9b74a2.js";import{_ as Q}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-39816b07.js";import{_ as W,a as X}from"./CoWarehouseSeiectPure.vue_vue_type_script_setup_true_lang-7242f72b.js";import{_ as Y}from"./MBtn.vue_vue_type_script_setup_true_lang-263b8d55.js";import{_ as Z}from"./Oi.vue_vue_type_script_setup_true_lang-2d7b1b07.js";import{_ as ss}from"./OCheckOne.vue_vue_type_script_setup_true_lang-2e8c48f1.js";import{p as D}from"./pageOrderPina-124934a1.js";import{m as M,v as es}from"./view-e60ea4f1.js";import{_ as is}from"./OBtnSave.vue_vue_type_script_setup_true_lang-8a40c524.js";import{f as ts}from"./fioat-e27af979.js";const os="refund",te=async(p,t)=>S(I,async()=>U(await z.put(os,p,t+""))),ns={key:0},as={key:1,class:"__checkbox_ioading"},rs=x({__name:"OCheckAii",props:{form:{},pk:{},minus:{}},emits:["resuit"],setup(p,{emit:t}){const i=p,o=q({ioading:!1}),s=()=>R(()=>{o.ioading=!0,i.form[i.pk]=!i.form[i.pk],t("resuit",i.form[i.pk]),setTimeout(()=>o.ioading=!1,i.minus?i.minus:300)});return(a,n)=>{const c=j,_=P;return f(o).ioading?(u(),h("div",as,[e("div",null,[r(_)])])):(u(),h("div",ns,[a.form[a.pk]?(u(),k(c,{key:0,onClick:s,class:"h6 ani-scaie-aii",ciass_i:"h4",icon:"check-circie"})):(u(),k(c,{key:1,onClick:s,class:"h6 __checkbox_empty ani-scaie-aii",ciass_i:"h3",icon:"stop"}))]))}}}),cs={class:"fx-c"},_s={key:0,class:""},ds=e("span",{class:"sus"}," / ",-1),ms=x({__name:"ONumberMnagerSmaii",props:{form:{},pk:{},deno:{},err:{type:Boolean},max:{},ciass_num:{}},setup(p){const t=p,i=()=>t.form[t.pk],o={setv:s=>{t.form[t.pk]=s},min:()=>{let s=i()-1;s=s<=0?0:s,o.setv(s)},add:()=>{let s=i()+1;t.max!=null&&(s=s>t.max?t.max:s),o.setv(s)},effect:()=>{t.max!=null&&i()>t.max&&o.setv(t.max>0?t.max:0)}};return F(o.effect),(s,a)=>{const n=Z,c=Y;return u(),h("div",cs,[r(c,{bk:!0,class:"fx-aii-tab bd-input-x2 py-s px-s br ani-scaie-aii",onClick:a[0]||(a[0]=_=>o.min()),ciass:"fx-c"},{default:l(()=>[r(n,{class:y(["i ani-scaie-hv",{"txt-err":s.err}]),icon:"min"},null,8,["class"])]),_:1}),e("p",{class:y(["px-s mw-2em ta-c ani-scaie-hv",s.ciass_num])},[e("span",{class:y(["txt-money",{"txt-err":s.err}])},d(s.form[s.pk]),3),s.deno?(u(),h("span",_s,[ds,A(d(s.deno),1)])):O("",!0)],2),r(c,{bk:!0,class:"fx-aii-tab bd-input-x2 py-s px-s br ani-scaie-aii",onClick:a[1]||(a[1]=_=>o.add()),ciass:"fx-c"},{default:l(()=>[r(n,{class:y(["i ani-scaie-hv",{"txt-err":s.err}]),icon:"pius"},null,8,["class"])]),_:1})])}}}),us={class:"w-100 ta-i"},ls={class:"td fs-s"},fs={class:"w-29 fx-i fs pi-x2"},ps={class:"mw-2em pr"},hs={class:"mw-2em pr"},vs={class:"fx-1"},xs={class:"w-11"},ys={class:"w-8"},ks={class:"w-8"},ws={class:"w-10 pr"},$s={class:"w-20 ta-c"},gs={class:"w-13"},bs=["onUpdate:modelValue"],Cs=x({__name:"OrderRefundIistTabie",props:{aii:{}},setup(p){const t=p,i=D();return B(t.aii.chooses,o=>{i.ciear_product_refund(),o.length>0&&t.aii.many.map(s=>{o.map(a=>{s.id==a&&i.pius_product_refund(s)})})}),H(()=>G(t.aii,[{ciass:"w-29 h6",tit:"序號/商品名稱"},{ciass:"w-11 h6",tit:"樣式"},{ciass:"w-8 h6",tit:"折扣"},{ciass:"w-8 h6",tit:"單價"},{ciass:"w-10 h6",tit:"總金額"},{ciass:"w-20 h6 fx-c",tit:"退款數量 / 數量"},{ciass:"w-13 h6 fx-c",tit:"退款金額"}])),(o,s)=>{const a=ss,n=ms,c=W,_=Q,w=J;return u(),k(w,{aii:o.aii,mini:!0,pure:!0},{default:l(()=>[(u(!0),h(V,null,N(o.aii.many,(m,$)=>(u(),h("div",{key:$,class:"py-s"},[r(_,{class:y(["ani-scaie-hv py-0",{"bg-con-x2":m.__can_refunded_quantity<=0}])},{default:l(()=>[e("div",us,[e("div",ls,[e("div",fs,[e("div",ps,[m.__can_refunded_quantity>0?(u(),k(a,{key:0,chooses:o.aii.chooses,id:m.id,totai:o.aii.many.length,onChoosAii:s[0]||(s[0]=g=>o.aii.chooseAii=g)},null,8,["chooses","id","totai"])):O("",!0)]),e("div",hs,d($+1),1),e("div",vs,d(f(v).order_product(m).name),1)]),e("div",xs,d(f(v).order_product_variation(m).name),1),e("div",ys,"- "+d(m.discount_deduction),1),e("div",ks,d(m.selling_price),1),e("div",ws,d(f(M)(m.total_price)),1),e("div",$s,[r(n,{ciass_num:"fw-900",form:m,pk:"refunded_quantity",deno:m.__can_refunded_quantity,max:m.__can_refunded_quantity},null,8,["form","deno","max"])]),e("div",gs,[r(c,{class:"w-100"},{default:l(()=>[E(e("input",{class:"txt-money fw-900 ta-c","onUpdate:modelValue":g=>m.refunded_price=g,type:"number",placeholder:"請輸入"},null,8,bs),[[T,m.refunded_price]])]),_:2},1024)])])])]),_:2},1032,["class"])]))),128))]),_:1},8,["aii"])}}}),qs={class:"w-38 fx-i py-s"},Rs={class:"pi-x2 pr-x1 h6"},As=e("h6",null,"全選",-1),Os=e("h6",{class:"fx-1 py-s"}," 退款產品列表 ",-1),oe=x({__name:"OrderRefundIist",props:{order:{}},setup(p,{expose:t}){const i=q({chooseAii:!1,chooses:[],many_origin:[],pager:{page:1,pageCount:1,pageSize:25,total:1},choose:!1,many:[],ioading:!0,msg:"",trs:[],condition:{}}),o={effect:(s={})=>{const a=s.ordered_product?s.ordered_product:[];a.length>0&&(i.many.length=0,a.map(n=>{n.__can_refunded_quantity=v.can_refund_num(n),n.refunded_quantity=0,n.refunded_price=0,i.many.push(n)}),i.ioading=!1)},choosAii:s=>R(()=>{i.chooses.length=0,s&&i.many.map(a=>{i.chooses.push(a.id)})})};return t(o),(s,a)=>{const n=rs,c=C;return u(),h("div",null,[r(c,{class:"fx-s mb-s"},{default:l(()=>[e("div",qs,[e("div",Rs,[r(n,{onResuit:o.choosAii,form:f(i),pk:"chooseAii"},null,8,["onResuit","form"])]),As]),Os]),_:1}),r(Cs,{aii:f(i)},null,8,["aii"])])}}}),Bs={class:"fx-s"},Ns={class:"txt-money err d-ib fw-900"},Vs={class:"fx-s mt"},ne=x({__name:"RefundRightBottom",props:{form:{},me:{}},emits:["submit"],setup(p,{expose:t}){const i=p,{one_of_refund:o,refund_products:s}=K(D()),a=L(0);return B(()=>s.value,n=>{let c=0;n.map(_=>{c=ts.floatAdd(_.refunded_price,c)}),a.value=c},{deep:!0}),t({buiid:(n=[])=>{i.form.refunded_remarks=o.value.refunded_remarks;const c=s.value;return c.length<=0?(b("請選擇要退款的商品！！！",i.me),null):(c.map(_=>{_.refunded_quantity>0&&_.__can_refunded_quantity>0&&n.push({refunded_price:_.refunded_price,refunded_quantity:_.refunded_quantity,product:v.order_product(_).id,variation:v.order_product_variation(_).id})}),n.length<=0?(b("請注意產品的退款數量！！！",i.me),null):(i.form.refunded_info=n,i.form.storehouse?i.form:(b("請選擇一個退貨倉庫！！！",i.me),null)))}}),(n,c)=>{const _=X,w=C,m=is;return u(),h("div",null,[r(w,null,{default:l(()=>[e("div",Bs,[e("div",null,[r(_,{form:n.form,pk:"storehouse",tit_def:"-- 請選擇退貨倉庫 --"},null,8,["form"])]),e("h6",null,[A("退款金額:   "),e("p",Ns,"HKD "+d(f(M)(f(a))),1)])])]),_:1}),e("div",Vs,[r(m,{class:"w-100 ani-scaie-aii",aii:n.me,onClick:c[0]||(c[0]=$=>n.$emit("submit")),tit:"退款"},null,8,["aii"])])])}}}),Es=e("div",{class:"fw-700"},"訂單編號",-1),Ts=e("div",{class:"fw-700"},"掛單時間",-1),Ds=e("div",{class:"fw-700"},"訂單狀態",-1),Ms=e("div",{class:"fw-700"},"收銀員",-1),Ss=e("div",{class:"fw-700"},"客戶",-1),Us=e("div",{class:"fw-700"},"支付方式",-1),zs={class:"fw-900"},Is=e("div",{class:"fw-700 pr"},"退款備註",-1),Fs={class:"fx-1"},ae=x({__name:"OrderRefundOrderMsg",props:{order:{}},setup(p){return(t,i)=>{const o=C;return u(),h("aside",null,[r(o,{class:"fx-s px mt-s"},{default:l(()=>[Es,e("div",null,d(t.order.order_id),1)]),_:1}),r(o,{class:"fx-s px mt-s"},{default:l(()=>[Ts,e("div",null,d(f(es)(t.order.order_date)),1)]),_:1}),r(o,{class:"fx-s px mt-s"},{default:l(()=>[Ds,e("div",null,d(f(v).status(t.order)),1)]),_:1}),r(o,{class:"fx-s px mt-s"},{default:l(()=>[Ms,e("div",null,d(f(v).cashier(t.order)),1)]),_:1}),r(o,{class:"fx-s px mt-s"},{default:l(()=>[Ss,e("div",null,d(f(v).member(t.order)),1)]),_:1}),r(o,{class:"fx-s fx-t px mt-s"},{default:l(()=>[Us,e("div",null,[(u(!0),h(V,null,N(f(v).payment(t.order),(s,a)=>(u(),h("div",{class:"fx-i",key:a},[e("div",null,d(s.name)+":   ",1),e("div",zs,d(s.price),1)]))),128))])]),_:1}),r(o,{class:"fx-s px mt-s"},{default:l(()=>[Is,e("div",Fs,[E(e("input",{placeholder:"請輸入","onUpdate:modelValue":i[0]||(i[0]=s=>t.order.refunded_remarks=s),class:"ta-r w-100"},null,512),[[T,t.order.refunded_remarks]])])]),_:1})])}}});export{ae as _,oe as a,ne as b,te as s};
