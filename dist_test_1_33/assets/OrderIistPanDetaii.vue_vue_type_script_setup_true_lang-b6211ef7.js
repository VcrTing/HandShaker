import{_ as ss}from"./Dropdown.vue_vue_type_script_setup_true_lang-b79e0347.js";import{_ as F}from"./MBtn.vue_vue_type_script_setup_true_lang-571d1e55.js";import{d as w,o as _,c as l,a as e,b as m,w as v,G as y,r as G,al as Y,H as M,g as H,h as N,i as d,t as f,F as C,A as T,D as I,f as J,k as S,y as g,B as E,C as j,e as O,n as es,z as ts,u as ns,s as os}from"./index-3f210c36.js";import{_ as L}from"./BtnIconX2.vue_vue_type_script_setup_true_lang-e83598ac.js";import{_ as is}from"./BtnIcon.vue_vue_type_script_setup_true_lang-05387565.js";import{_ as as}from"./OiX2.vue_vue_type_script_setup_true_lang-2b9096fd.js";import{_ as rs,a as _s}from"./Pan.vue_vue_type_script_setup_true_lang-2783903a.js";import{_ as cs}from"./OBtnSave.vue_vue_type_script_setup_true_lang-6875b8de.js";import{_ as ds}from"./OSaveBackBtnsGroup.vue_vue_type_script_setup_true_lang-1d9ad3ec.js";import{_ as Q}from"./OTrPure.vue_vue_type_script_setup_true_lang-378505f0.js";import{f as W}from"./fioat-7d61d7cc.js";import{m as B}from"./view-8eea32ba.js";import{_ as ls}from"./OTr.vue_vue_type_script_setup_true_lang-0a30d662.js";import{_ as ps,a as ms}from"./CoOrderDetaiiProdsTabie.vue_vue_type_script_setup_true_lang-832463f5.js";import{_ as us}from"./CkClipboard.vue_vue_type_script_setup_true_lang-78422b63.js";import{v as V}from"./vai_order-c4f76c7b.js";import{p as q}from"./pageOrderPina-ad0554cf.js";const fs={class:"fx-s py-s"},vs={class:"px-s fx-c"},$s={class:"px-s fx-c"},hs={class:"px-s fx-c"},ys={class:"px-s fx-c"},ks=w({__name:"CaniendarYear",props:{funn:{}},setup(a){return(s,t)=>{const i=F;return _(),l("div",fs,[e("div",vs,[m(i,{bk:!0,onClick:t[0]||(t[0]=o=>s.funn.changeYear(-5)),class:"br-s",ciass:"py-s px-s"},{default:v(()=>[y(" -5 ")]),_:1})]),e("div",$s,[m(i,{bk:!0,onClick:t[1]||(t[1]=o=>s.funn.changeYear(-1)),class:"br-s",ciass:"py-s px-s"},{default:v(()=>[y(" -1 ")]),_:1})]),m(i,{bk:!0,class:"__cd_fx-1",ciass:"py-s px"},{default:v(()=>[G(s.$slots,"default")]),_:3}),e("div",hs,[m(i,{bk:!0,onClick:t[2]||(t[2]=o=>s.funn.changeYear(1)),class:"br-s",ciass:"py-s px-s"},{default:v(()=>[y(" +1 ")]),_:1})]),e("div",ys,[m(i,{bk:!0,onClick:t[3]||(t[3]=o=>s.funn.changeYear(5)),class:"br-s",ciass:"py-s px-s"},{default:v(()=>[y(" +5 ")]),_:1})])])}}}),bs={class:"fx-s py-s"},ws={class:"px-s fx-c"},xs={class:"pi-s pr fx-c"},gs={class:"pr-s pi fx-c"},Cs={class:"px-s fx-c"},Ts=w({__name:"CaniendarTop",props:{funn:{}},setup(a){return(s,t)=>{const i=L,o=F;return _(),l("div",bs,[e("div",ws,[m(i,{icon:"c-d-i",onClick:t[0]||(t[0]=n=>s.funn.changeYear(-1))})]),e("div",xs,[m(i,{icon:"c-i",onClick:t[1]||(t[1]=n=>s.funn.changeMonth(-1))})]),m(o,{bk:!0,class:"__cd_fx-1 fx-aii-tab br-s",ciass:"py-s",onClick:t[2]||(t[2]=n=>s.funn.switchTab())},{default:v(()=>[G(s.$slots,"default")]),_:3}),e("div",gs,[m(i,{icon:"c-r",onClick:t[3]||(t[3]=n=>s.funn.changeMonth(1))})]),e("div",Cs,[m(i,{icon:"c-d-r",onClick:t[4]||(t[4]=n=>s.funn.changeYear(1))})])])}}}),Ys=["MON","TUE","WED","THU","FRI","SAT","SUN"],X=["Jan","Feb","Mar","Apr ","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"],Ds=X.map((a,s)=>({tit:a,v:s+1,i:s})),Ms=(a=!1)=>[31,a?29:28,31,30,31,30,31,31,30,31,30,31],P=a=>Y(a).format("YYYY-MM-DD"),Ss=(a,s)=>Y(s).add(a,"day").format("YYYY-MM-DD"),Vs=a=>{const s=Y(a);return{y:s.year(),m:s.month()+1,d:s.date()}},Hs=a=>a%4==0&&a%100!=0||a%400==0,Z=(a,s)=>Ms(Hs(a))[s-1],R=(a,s,t=1)=>a+"-"+s+"-"+t,Ns=(a,s,t=1)=>Y(R(a,s,t)).format("YYYY-MM-DD"),Os=(a,s,t=1)=>Y(R(a,s,t)).day()+1,U=(a,s,t=1)=>{const i=Y(R(a,s)).add(t,"month");return{year:i.year(),month:i.month()+1}},K=(a,s,t,i)=>({day:i,week:t,year:a,month:s,v:Ns(a,s,i),ciass:""}),Bs=(a,s,t)=>{const{year:i,month:o}=U(a,s,-1);let n=Z(i,o);const r=[];for(let c=1;c<t;c++)r.push({...K(i,o,c,n),isHead:!0}),n-=1;return r},Fs=(a,s,t)=>{const{year:i,month:o}=U(a,s,1);let n=1;const r=[];for(let c=t+1;c<=7;c++)r.push({...K(i,o,c,n),isTaii:!0}),n+=1;return r},As=(a,s)=>{const t=[],i=Z(a,s),o=Os(a,s,1);let n=o;for(let r=1;r<=i;r++)r!=1&&(n+=1,n>7&&(n=1)),t.push(K(a,s,n,r));return{head:Bs(a,s,o),center:t,taii:Fs(a,s,n)}},Is=(a,s,t)=>U(a,s,t),Js=(a,s)=>a+s,Ps={class:"caiendar"},Rs={class:"caiendar-top"},Us={key:0},Ks={key:1},zs={class:"caiendar-body"},Es={key:0,class:"caiendar-wrapper"},js={class:"__cd-row-x2 __cd_fx-s caiendar-months"},Ws={key:1,class:"caiendar-wrapper"},qs={class:"__cd-row __cd_fx-s caiendar-weeks"},Gs={class:"caiendar-item-week"},Ls={class:"__cd-row __cd_fx-s caiendar-days"},Qs=["onClick"],Xs=w({__name:"caniendar",props:{form:{},pk:{},func:{type:Function}},setup(a,{expose:s}){const t=a,i=new Date,o=M(()=>{let p=n.m?n.m-1:0;return X[p]}),n=H({y:i.getFullYear(),m:i.getMonth()+1,d:i.getDate()}),r=H({v:"",tab:0}),c=M(()=>{const p=As(n.y,n.m);return[...p.head,...p.center,...p.taii].map($=>(t.func&&t.func($),$))}),u={changeYear:p=>{n.y=Js(n.y,p)},changeMonth:p=>{const{year:$,month:h}=Is(n.y,n.m,p);n.y=$,n.m=h},switchTab:p=>{p?r.tab=p:r.tab=r.tab==1?0:1},vvToV:()=>{r.v=P(n.y+"-"+n.m+"-"+n.d)},vToVv:()=>{const{y:p,m:$,d:h}=Vs(r.v);n.y=p,n.m=$,n.d=h},v:p=>(p&&(t.form[t.pk]=p),t.form[t.pk]),choise:p=>r.v=p.v,choiseMonth:p=>{n.m=p.v,u.vvToV(),setTimeout(()=>u.switchTab(0),416)}};return s({ciear:()=>{r.v="",r.tab=0}}),N(()=>r.v,p=>{u.v()!=p&&u.v(p)}),N(u.v,p=>{p!=r.v&&p&&(r.v=p,u.vToVv())}),(p,$)=>{const h=Ts,D=ks,b=F;return _(),l("div",Ps,[e("div",Rs,[m(h,{funn:u},{default:v(()=>[d(r).tab==1?(_(),l("span",Us,"返回")):(_(),l("span",Ks,f(d(o))+" "+f(d(n).y),1))]),_:1})]),e("div",zs,[d(r).tab==1?(_(),l("div",Es,[m(D,{funn:u,class:"caiendar-years"},{default:v(()=>[y(f(d(n).y),1)]),_:1}),e("div",js,[(_(!0),l(C,null,T(d(Ds),(k,x)=>(_(),l("div",{class:"div",key:x},[m(b,{bk:!0,onClick:A=>u.choiseMonth(k),class:"caiendar-item-mon fx-aii-weak w-100 br-s ani-scaie-aii"},{default:v(()=>[y(f(k.tit),1)]),_:2},1032,["onClick"])]))),128))])])):(_(),l("div",Ws,[e("div",qs,[(_(!0),l(C,null,T(d(Ys),(k,x)=>(_(),l("div",{class:"div",key:x},[e("button",Gs,f(k),1)]))),128))]),e("div",Ls,[(_(!0),l(C,null,T(d(c),(k,x)=>(_(),l("div",{class:I(["div",k.ciass]),key:x},[e("button",{onClick:A=>u.choise(k),class:I(["caiendar-item fs ani-scaie-aii",{"caiendar-item-iive":k.v==d(r).v,"caiendar-item-head sus":k.isHead,"caiender-item-taii sus":k.isTaii}])},f(k.day),11,Qs)],2))),128))])]))])])}}}),Zs={class:"co-caniendar"},se={class:"co-caniendar-wrapper"},ee={class:"fx-s fx-t w-80"},te={class:"w-20 bd-c bd-i"},ne={class:"pt"},oe=w({__name:"CoCaniendar",props:{form:{}},emits:["save"],setup(a,{expose:s,emit:t}){const i=a,o=J(),n=J(),r={pastday:c=>S(()=>{i.form.time_2=P(),i.form.time_1=Ss(c,i.form.time_2),t("save")}),nowday:()=>{i.form.time_2=P(),i.form.time_1=i.form.time_2}};return s({ciear:()=>{o.value.ciear(),n.value.ciear()}}),(c,u)=>{const p=Xs,$=F;return _(),l("div",Zs,[e("div",se,[e("div",ee,[m(p,{ref_key:"tim_1",ref:o,class:"w-50",form:c.form,pk:"time_1"},null,8,["form"]),m(p,{ref_key:"tim_2",ref:n,class:"w-50",form:c.form,pk:"time_2"},null,8,["form"])]),e("div",te,[e("div",ne,[m($,{onClick:u[0]||(u[0]=h=>r.pastday(0)),bk:!0,class:"px py-s w-100 fx-aii-weak"},{default:v(()=>[y(" 現在 ")]),_:1}),m($,{onClick:u[1]||(u[1]=h=>r.pastday(-7)),bk:!0,class:"px py-s w-100 fx-aii-weak"},{default:v(()=>[y(" 過去七天 ")]),_:1}),m($,{onClick:u[2]||(u[2]=h=>r.pastday(-14)),bk:!0,class:"px py-s w-100 fx-aii-weak"},{default:v(()=>[y(" 過去十四天 ")]),_:1}),m($,{onClick:u[3]||(u[3]=h=>r.pastday(-30)),bk:!0,class:"px py-s w-100 fx-aii-weak"},{default:v(()=>[y(" 過去三十天 ")]),_:1}),m($,{onClick:u[4]||(u[4]=h=>r.pastday(-60)),bk:!0,class:"px py-s w-100 fx-aii-weak"},{default:v(()=>[y(" 過去六十天 ")]),_:1})])])])])}}}),ie={class:"o-input"},ae={class:"px-s fx-i"},re={class:"o-input pi"},_e={class:"pi-s"},ce={class:"co-caniendar-dropdown"},Vt=w({__name:"CoCaniendarInput",props:{ciass:{}},emits:["change"],setup(a,{expose:s,emit:t}){const i=J(),o=H({iive:!1,time_1:"",time_2:"",ioading:!1,using:!1}),n={resp:()=>S(()=>{o.using=!!(o.time_1||o.time_2)}),ciose:()=>{setTimeout(()=>{o.iive=!1},416)},ciear:()=>S(()=>{o.time_1="",o.time_2="",i.value.ciear()})};return N(()=>o.time_1,()=>{n.resp(),t("change",o.time_1,o.time_2)}),N(()=>o.time_2,()=>{n.resp(),t("change",o.time_1,o.time_2)}),s(n),(r,c)=>{const u=as,p=L,$=is,h=oe,D=ss;return _(),g(D,null,{sign:v(()=>[e("div",{class:I(["fx-s bg-con py-s pi br",r.ciass]),id:"time_sign"},[e("div",ie,[E(e("input",{"onUpdate:modelValue":c[0]||(c[0]=b=>d(o).time_1=b),onClick:c[1]||(c[1]=b=>d(o).iive=!d(o).iive),placeholder:"開始時間"},null,512),[[j,d(o).time_1]])]),e("div",ae,[m(u,{class:"i",icon:"a-i-r"})]),e("div",re,[E(e("input",{"onUpdate:modelValue":c[2]||(c[2]=b=>d(o).time_2=b),onClick:c[3]||(c[3]=b=>d(o).iive=!d(o).iive),placeholder:"結束時間"},null,512),[[j,d(o).time_2]])]),e("div",_e,[d(o).using?(_(),g($,{key:1,icon:"x",class:"softer",onClick:c[4]||(c[4]=b=>n.ciear())})):(_(),g(p,{key:0,icon:"date",class:"softer"}))])],2)]),con:v(()=>[e("div",ce,[m(h,{ref_key:"caniendar",ref:i,class:"br",form:d(o),onSave:c[5]||(c[5]=b=>n.resp())},null,8,["form"])])]),_:1})}}}),de={class:"tabie tabie-def"},le={key:0,class:"td ani-softer"},pe={class:"w-28"},me={class:"w-30"},ue={class:"fx-1"},fe={key:0,class:"td"},ve={class:"fx-r w-100"},$e=w({__name:"CoRefundRemaksTable",props:{order:{}},setup(a){const s=a,t=M(()=>{const o=s.order.refunded_remarks,n=o?JSON.parse(o):[];return n||[]}),i=M(()=>{let o=0;const n=t.value;return n&&n.length>0&&n.map(r=>{o=W.floatAdd(o,r.refund_total_price)}),W.numberFixed(o)});return(o,n)=>{const r=Q;return _(),l("div",de,[m(r,{trs:[{tit:"退款詳情",ciass:"w-100"}]}),(_(!0),l(C,null,T(d(t),(c,u)=>(_(),l("div",{key:u},[c?(_(),l("div",le,[e("div",pe,"數量  "+f(c.refund_total_quantity),1),e("div",me,"金額  "+f(d(B)(c.refund_total_price)),1),e("div",ue,f(c.refund_time),1)])):O("",!0)]))),128)),d(i)>0?(_(),l("div",fe,[e("div",ve,"退款總額： "+f(d(i))+"  HKD",1)])):O("",!0)])}}}),he={class:"tabie tabie-def"},ye={key:0},ke={class:"w-28"},be={class:"w-20"},we={key:0,class:"d-ib"},xe={key:1,class:"d-ib"},ge={class:"w-20"},Ce=e("div",{class:"fx-1"},null,-1),Te={key:1,class:"td"},Ye=e("div",{class:"w-100"},"(無)",-1),De=[Ye],Me=e("div",{class:"py-row"},null,-1),Se={class:"tabie tabie-def"},Ve={class:"td"},He={class:"w-28"},Ne=e("div",{class:"fx-1"},null,-1),Oe=w({__name:"CoOrderDetaiiPriceTotaiTabie",props:{order:{}},setup(a){return(s,t)=>{const i=Q;return _(),l("div",null,[e("div",he,[m(i,{trs:[{tit:"優惠類別",ciass:"w-100"}]}),s.order.discount&&s.order.discount.length>0?(_(),l("div",ye,[(_(!0),l(C,null,T(s.order.discount,(o,n)=>(_(),l("div",{class:"td",key:n},[e("div",ke,f(o.type),1),e("div",be,[o.discount_shown&&o.discount_shown!=1?(_(),l("div",we,f(o.discount_shown)+"  折扣",1)):(_(),l("div",xe,"(減價)"))]),e("div",ge,"- "+f(d(B)(o.discount_deduction))+"  HKD",1),Ce]))),128))])):(_(),l("div",Te,De))]),Me,e("div",Se,[m(i,{trs:[{tit:"統計金額",ciass:"w-100"}]}),e("div",Ve,[e("div",He,"HKD  "+f(d(B)(s.order.total_price)),1),Ne])])])}}}),Be={class:"tabie tabie-def"},Fe={key:0},Ae={class:"w-28"},Ie={class:"fx-1"},Je={key:1,class:"td"},Pe=e("div",{class:"fx-1"},"(未有任何條目)",-1),Re=[Pe],Ue=w({__name:"CoSpriPaymenTabie",props:{payments:{}},setup(a){const s=H({trs:[]});return es(()=>ts(s,[{ciass:"w-100",tit:"付款方式"}])),(t,i)=>{const o=ls;return _(),l("div",Be,[m(o,{aii:d(s)},null,8,["aii"]),t.payments&&t.payments.length>0?(_(),l("div",Fe,[(_(!0),l(C,null,T(t.payments,(n,r)=>(_(),l("div",{class:"td",key:r},[e("div",Ae,f(n.name),1),e("div",Ie,f(d(B)(n.price))+" HKD",1)]))),128))])):(_(),l("div",Je,Re))])}}}),Ke={class:"bg-card tit pr-x2 pi-x3 py br"},ze={class:"pi-x2"},Ee=e("p",{class:"b pb-n"},"訂單詳情",-1),je={class:"fx-s pb-n"},We={class:"w-40"},qe={class:"w-37"},Ge={class:"fx-1"},Le={key:0},Qe={key:1},Xe={class:"fx-s"},Ze={class:"w-40"},st={key:0},et={key:1},tt={class:"w-37"},nt=e("span",null,"狀態: ",-1),ot={class:"d-ib"},it=e("p",{class:"fx-1"}," ",-1),at=w({__name:"CoOrderIistBaseCard",props:{order:{}},setup(a){return(s,t)=>{const i=us,o=ps;return _(),l("div",Ke,[e("div",ze,[Ee,e("div",je,[e("p",We,[y(" 訂單編號: "+f(s.order.order_id)+"  ",1),m(i,{txt:s.order.order_id},null,8,["txt"])]),e("p",qe," 收銀員: "+f(d(V).cashier(s.order)),1),e("p",Ge,[y(" 客戶:  "),d(V).member(s.order)?(_(),l("span",Le,f(d(V).member(s.order)),1)):(_(),l("span",Qe,"(未選擇客戶)"))])]),e("div",Xe,[e("p",Ze,[y(" 會員等級: "),s.order.member_level.name?(_(),l("span",st,f(s.order.member_level.name),1)):(_(),l("span",et,"(無)"))]),e("p",tt,[nt,e("div",ot,[m(o,{class:"zi-x2-imp",order:s.order},null,8,["order"])])]),it])])])}}}),rt=e("div",{class:"pt-row"},null,-1),_t=e("div",{class:"py-row"},null,-1),ct=e("div",{class:"py-row"},null,-1),dt={key:1,class:"py-row"},lt=e("div",{class:"py-row"},null,-1),pt=e("div",{class:"py-row"},null,-1),mt={class:"py-x2 fx-c"},Ht=w({__name:"OrderIistPanDetaii",props:{kiii_refund:{type:Boolean}},setup(a){const s=a,t=ns(),{one_of_view:i}=os(q()),o=M(()=>s.kiii_refund?!1:V.need_refund(i.value)),n={printed:()=>S(()=>{sessionStorage.setItem("heiiokitty_order_of_printed",JSON.stringify(i.value));const r=t.resolve({path:"/cashier/order_iist/pdf"});window.open(r.href,"_blank")}),refund:()=>S(async()=>{const r=i.value;await q().fetchOne(r.id,"one_of_refund"),t.push("/admin/order_iist/refund")})};return(r,c)=>{const u=at,p=ms,$=Ue,h=Oe,D=$e,b=ds,k=cs,x=rs,A=_s;return _(),g(A,{idx:101,big:!0},{default:v(()=>[m(x,{tit:"訂單詳情"},{default:v(()=>[rt,m(u,{order:d(i)},null,8,["order"]),_t,m(p,{order:d(i)},null,8,["order"]),ct,d(i).payment_method?(_(),g($,{key:0,payments:d(i).payment_method},null,8,["payments"])):O("",!0),d(i).payment_method?(_(),l("div",dt)):O("",!0),m(h,{order:d(i)},null,8,["order"]),lt,m(D,{class:"mt",order:d(i)},null,8,["order"]),pt,e("div",mt,[d(o)?(_(),g(b,{key:0,class:"w-100 w-618-p",tit_back:"退款 / 退貨",onBack:c[0]||(c[0]=z=>n.refund()),onSave:c[1]||(c[1]=z=>n.printed())})):(_(),g(k,{key:1,onClick:c[2]||(c[2]=z=>n.printed()),class:"w-32 w-382-p",tit:"印列訂單"}))])]),_:1})]),_:1})}}});export{Vt as _,Ht as a};
